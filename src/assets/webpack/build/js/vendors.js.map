{"version":3,"file":"js/vendors.js","mappings":"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,sBAAsB,oBAAoB,SAAS,kBAAkB,aAAa,SAAS,KAAK,iBAAiB,iBAAiB,cAAc,cAAc,cAAc,eAAe,cAAc,YAAY,YAAY,aAAa;YACpbqE,MAAQrE,GAAE,EAAC,6BAA6B,MAAM,uBAAuB,WAAW,cAAc,YAAY,YAAY,aAAa;YACnIsE,OAAStE,GAAE,EAAC,MAAM,MAAM,MAAM,KAAK,MAAM,MAAM,YAAY,YAAY;;QAIxD1uB,KAAwBizB,IAAGvE,GAAE,EAC5C,KACA,YACA,WACA,gBACA,UACA,YACA,QACA,WACA,WACA,iBACA,uBACA,eACA,oBACA,qBACA,qBACA,WACA,kBACA,WACA,WACA,gBACA,YACA,sBACA,UACA,gBACA,UACA,QACA,iBACA,KACA,SACA,YACA,SACA,QACA,kBACA,UACA,QACA,iBACA,QACA,WACA,WACA,YACA,kBACA,QACA,QACA,OACA,UACA,UACA,QACA,YACA,QACA,SACA;QAIe1uB,KAA0BkzB,IAAGxE,GAAE,EAC9C,sBACA,kBACA,aACA,aACA,QACA,+BACA,uBACA,iBACA,mBACA,SACA,UACA,aACA,WACA,qBACA,qBACA,gBACA,aACA,QACA,UACA,eACA,iBACA,eACA,oBACA,aACA,gBACA,cACA,gBACA,eACA,gCACA,8BACA,mBACA,WACA,kBACA,kBACA,cACA,cACA,gBACA,QACA,WACA,YACA,kBACA,mBACA,cACA,gBACA,oBACA,qBACA,kBACA,mBACA,qBACA,kBACA,gBACA,UACA,eACA,mBACA,kBACA,gBACA,cACA,gBACA;QAKA1uB,KAAKmzB,aAAa3W,EAASQ,WAAWmW;QAEtC,MAAMC,IAAM5W,EAAS6W,SAASC,cAAc;QAC5CF,EAAIG,YAAY;QAChB,IAAwC,eAApCH,EAAII,kBAAmBC,UAAyB;YAElD,MAAMlB,IAAMvyB,KAAK4uB;YACjB,IAAI8E,IAAMnB,EAAI1D;YACd0D,EAAI1D,WAAW0D,EAAIzD;YACnByD,EAAIzD,WAAW4E;YACfA,IAAMnB,EAAIxD;YACVwD,EAAIxD,cAAcwD,EAAIvD;YACtBuD,EAAIvD,cAAc0E;YAClB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A,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IAEAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IAEAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IAEAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IACAA,EAAAA,EAAA;IAC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mB;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,8BAAmB;AAC7B;AACA;AACA,UAAU,8BAAmB;AAC7B;AACA;AACA,UAAU,8BAAmB;AAC7B,eAAe,8BAAmB;AAClC;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,UAAU,8BAAmB;AAC7B;AACA,oCAAoC,4BAA4B;AAChE,0CAA0C;AAC1C,WAAW,8BAAmB;AAC9B;AACA;AACA;AACA;AACA,UAAU,8BAAmB,kCAAkC;AAC/D;AACA;AACA,UAAU,8BAAmB;AAC7B;AACA;AACA,iBAAiB,8BAAmB,CAAC,8BAAmB;AACxD,UAAU;AACV;AACA;AACA;AACA,iCAAiC,+BAAmB;;AAEpD;;AAEA,+CAA+C,aAAa;AAC5D,kBAAkB,+BAAmB;AACrC,eAAe,+BAAmB;AAClC,aAAa,+BAAmB;AAChC,eAAe,+BAAmB;AAClC,eAAe,+BAAmB;AAClC,cAAc,+BAAmB;AACjC,cAAc,+BAAmB;AACjC,aAAa,+BAAmB;AAChC,mBAAmB,+BAAmB;AACtC,cAAc,+BAAmB;AACjC,cAAc,+BAAmB;AACjC,cAAc,+BAAmB;AACjC,eAAe,+BAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,8CAA8C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,uBAAuB;AAC5C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA,iCAAiC,+BAAmB;;AAEpD,WAAW,+BAAmB;AAC9B,YAAY,+BAAmB;AAC/B,aAAa,+BAAmB;AAChC,SAAS,+BAAmB;;;AAG5B,8CAA8C;;;AAG9C;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,kBAAkB;AACvC;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA,QAAQ;AACR,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAoB;;AAEpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,YAAY;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA,4BAA4B,iDAAiD;;AAE7E;AACA,OAAO;AACP,4BAA4B,4BAA4B;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,cAAc,gCAAmB;;AAEjC;;AAEA,kBAAkB,gCAAmB;;AAErC;;AAEA,iBAAiB,gCAAmB;;AAEpC;;AAEA,aAAa,gCAAmB;;AAEhC;;AAEA,cAAc,gCAAmB;;AAEjC;;AAEA,YAAY,gCAAmB;;AAE/B;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,qGAAqG,qBAAqB,mBAAmB;;AAE7I,mCAAmC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,uCAAuC,cAAc,WAAW,YAAY,UAAU,MAAM,2CAA2C,UAAU,sBAAsB,eAAe,2BAA2B,0BAA0B,cAAc,2CAA2C,gCAAgC,OAAO,mFAAmF;;AAErpB,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,gCAAmB;;AAEnB,kBAAkB,gCAAmB;;AAErC;;AAEA,cAAc,gCAAmB;;AAEjC;;AAEA,gBAAgB,gCAAmB;;AAEnC;;AAEA,cAAc,gCAAmB;;AAEjC;;AAEA,iBAAiB,gCAAmB;;AAEpC;;AAEA,iBAAiB,gCAAmB;;AAEpC;;AAEA,cAAc,gCAAmB;;AAEjC;;AAEA,cAAc,gCAAmB;;AAEjC;;AAEA,aAAa,gCAAmB;;AAEhC;;AAEA,uCAAuC,uCAAuC;;AAE9E,4CAA4C,kBAAkB,kCAAkC,oEAAoE,KAAK,OAAO,oBAAoB;;AAEpM,kDAAkD,0CAA0C;;AAE5F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,WAAW;AACX;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,+FAA+F;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,yFAAyF;AACzF,UAAU;AACV;AACA;AACA,UAAU;AACV,yFAAyF;AACzF;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,+CAA+C;AAC/C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,MAAK,GAAG,CAAK;;AAE9B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG,IAAI;AACP;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,oBAAoB,uBAAuB;AACxF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG,IAAI;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,YAAY,gCAAmB;;AAE/B;;AAEA,iBAAiB,gCAAmB;;AAEpC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,iBAAiB,gCAAmB;;AAEpC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,CAAC;;AAED;;AAEA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,oBAAoB,gCAAmB;;AAEvC;;AAEA,cAAc,gCAAmB;;AAEjC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;;AAEA;;AAEA;AACA;AACA,oEAAoE,aAAa;AACjF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL,GAAG;AACH,CAAC;;AAED;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,6FAA6F,eAAe;AAC5G;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,uCAAuC,8BAA8B;AACrE;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;;AAED,kDAAkD,0CAA0C;;AAE5F;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA;;AAEA,uFAAuF,aAAa;AACpG;AACA;;AAEA,wDAAwD;AACxD;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA;AACA;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;AACA,iBAAiB,gCAAmB;AACpC,kBAAkB,gCAAmB;;AAErC;AACA;AACA;AACA;AACA;;AAEA,IAAI;AACJ;;AAEA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,cAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,WAAW;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA,0BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;;AAEA,+CAA+C,aAAa;AAC5D,eAAe,gCAAmB;AAClC;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kDAAkD;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY;AACZ,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA,2FAA2F;AAC3F;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,SAAS;AACT;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4BAA4B;AACxD;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,gCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,mCAAmC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,uCAAuC,cAAc,WAAW,YAAY,UAAU,MAAM,2CAA2C,UAAU,sBAAsB,eAAe,2BAA2B,0BAA0B,cAAc,2CAA2C,gCAAgC,OAAO,mFAAmF;;AAErpB,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,iBAAiB,gCAAmB;;AAEpC;;AAEA,aAAa,gCAAmB;;AAEhC;;AAEA,iBAAiB,gCAAmB;;AAEpC;;AAEA,gBAAgB,gCAAmB;;AAEnC;;AAEA,cAAc,gCAAmB;;AAEjC;;AAEA,uCAAuC,uCAAuC;;AAE9E,mCAAmC,0BAA0B,0CAA0C,gBAAgB,OAAO,oBAAoB,eAAe,OAAO;;AAExK,kDAAkD,0CAA0C;;AAE5F;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,mEAAmE;AACpF,eAAe,+DAA+D;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,iBAAiB,iCAAmB;;AAEpC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,oBAAoB,iCAAmB;AACvC,eAAe,iCAAmB;AAClC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,mBAAmB,iCAAmB;AACtC,cAAc,iCAAmB;AACjC,kBAAkB,iCAAmB;AACrC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,eAAe,iCAAmB;AAClC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD,YAAY,iCAAmB;AAC/B,aAAa,iCAAmB;;;AAGhC;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,IAAI;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,IAAI;AACX;AACA,KAAK;;AAEL;AACA;AACA;AACA,gCAAgC;AAChC;AACA,6DAA6D;AAC7D;AACA,OAAO,IAAI;AACX;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,eAAe;AACf,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,aAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT,OAAO;AACP,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,oBAAoB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,6BAA6B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;AAED;AACA;AACA;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,mCAAmC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,uCAAuC,cAAc,WAAW,YAAY,UAAU,MAAM,2CAA2C,UAAU,sBAAsB,eAAe,2BAA2B,0BAA0B,cAAc,2CAA2C,gCAAgC,OAAO,mFAAmF;;AAErpB,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,iBAAiB,iCAAmB;;AAEpC;;AAEA,eAAe,iCAAmB;;AAElC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,YAAY,iCAAmB;;AAE/B;;AAEA,iBAAiB,iCAAmB;;AAEpC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,IAAI;AACX;AACA;AACA,oEAAoE;AACpE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,mIAAmI;AACnI;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oIAAoI;AACpI;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,qGAAqG,qBAAqB,mBAAmB;;AAE7I,mCAAmC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,uCAAuC,cAAc,WAAW,YAAY,UAAU,MAAM,2CAA2C,UAAU,sBAAsB,eAAe,2BAA2B,0BAA0B,cAAc,2CAA2C,gCAAgC,OAAO,mFAAmF;;AAErpB,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,aAAa,iCAAmB;;AAEhC;;AAEA,iBAAiB,iCAAmB;;AAEpC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,kBAAkB,iCAAmB;;AAErC;;AAEA,UAAU,iCAAmB;;AAE7B;;AAEA,iBAAiB,iCAAmB;;AAEpC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,uCAAuC,uCAAuC;;AAE9E,4CAA4C,kBAAkB,kCAAkC,oEAAoE,KAAK,OAAO,oBAAoB;;AAEpM,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,uBAAuB,0CAA0C;AACjE,uBAAuB,sEAAsE,gBAAgB;AAC7G;AACA;AACA,yBAAyB,8BAA8B,IAAI,iBAAiB;AAC5E,yBAAyB,2BAA2B,IAAI,iBAAiB;AACzE,MAAM;AACN,yBAAyB,8BAA8B,IAAI,iCAAiC;AAC5F,yBAAyB,2BAA2B,IAAI,iCAAiC;AACzF;AACA,uBAAuB,8BAA8B,IAAI,kBAAkB;AAC3E,uBAAuB,2BAA2B,IAAI,kBAAkB;AACxE,uBAAuB,0FAA0F,IAAI,4BAA4B;AACjJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;;AAEA,8CAA8C,oBAAoB,iBAAiB;AACnF,wIAAwI,mBAAmB;AAC3J;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+IAA+I,cAAc;AAC7J;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8IAA8I,aAAa;AAC3J;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4GAA4G,oBAAoB;AAChI;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,2DAA2D;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,IAAI;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,cAAc,oBAAoB;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;AACP;AACA,iCA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A;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,iBAAiB,iCAAmB;;AAEpC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,iBAAiB,iCAAmB;;AAEpC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,YAAY,iCAAmB;;AAE/B;;AAEA,iBAAiB,iCAAmB;;AAEpC;;AAEA,eAAe,iCAAmB;;AAElC;;AAEA,gBAAgB,iCAAmB;;AAEnC;;AAEA,uCAAuC,uCAAuC;;AAE9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA,+CAA+C,aAAa;AAC5D,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA,+CAA+C,aAAa;AAC5D,mBAAmB,iCAAmB;AACtC,cAAc,iCAAmB;AACjC,cAAc,iCAAmB;AACjC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,IAAI;AACb;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,mBAAmB,iCAAmB;AACtC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,mBAAmB,iCAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;;AAED,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6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AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL,sCAAsC,0BAA0B;AAChE,sCAAsC,0CAA0C;AAChF;AACA,wCAAwC,0BAA0B;AAClE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,qBAAqB;AACrB;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,cAAc,iCAAmB;;AAEjC;;AAEA,kBAAkB,iCAAmB;;AAErC;;AAEA,eAAe,iCAAmB;;AAElC;;AAEA,gBAAgB,iCAAmB;;AAEnC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,mBAAmB,iCAAmB;;AAEtC;;AAEA,kBAAkB,iCAAmB;;AAErC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,eAAe,iCAAmB;;AAElC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,cAAc;AACd;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2HAA2H,wBAAwB;AACnJ;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,+CAA+C,aAAa;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,uBAAuB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,kBAAkB,iCAAmB;AACrC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,eAAe,iCAAmB;AAClC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,eAAe,iCAAmB;AAClC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,aAAa,iCAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;AAEA;AACA;AACA,WAAW,gBAAgB,sCAAsC,kBAAkB;AACnF,0BAA0B;AAC1B;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,+CAA+C,aAAa;AAC5D,aAAa,iCAAmB;AAChC,eAAe,iCAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAsB,YAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,KAAK;AAChB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,cAAc;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,WAAW;AAC7B;AACA,gCAAgC,iBAAiB;AACjD;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gCAAgC,iBAAiB;AACjD;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;;AAEA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,cAAc,gBAAgB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,mCAAmC,kBAAkB;AACrD;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,kBAAkB;AACpC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,kBAAkB;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,YAAY,OAAO;AACnB;AACA;AACA;AACA,mCAAmC,0BAA0B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA2D,OAAO;AAClE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,aAAa,SAAS;AACtB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0CAA0C,SAAS;AACnD;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA,gBAAgB,YAAY;AAC5B;;AAEA;AACA,4DAA4D;AAC5D,gEAAgE;AAChE,oEAAoE;AACpE,wEAAwE;AACxE;AACA,2DAA2D,SAAS;AACpE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,UAAU;AACrB,WAAW,OAAO;AAClB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,UAAU;AACrB,WAAW,OAAO;AAClB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,UAAU;AACrB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,4DAA4D,YAAY;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,aAAa,cAAc;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,qGAAqG,qBAAqB,mBAAmB;;AAE7I,mCAAmC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,uCAAuC,cAAc,WAAW,YAAY,UAAU,MAAM,2CAA2C,UAAU,sBAAsB,eAAe,2BAA2B,0BAA0B,cAAc,2CAA2C,gCAAgC,OAAO,mFAAmF;;AAErpB,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,eAAe,iCAAmB;;AAElC;;AAEA,kBAAkB,iCAAmB;;AAErC;;AAEA,iBAAiB,iCAAmB;;AAEpC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,aAAa,iCAAmB;;AAEhC,kBAAkB,iCAAmB;;AAErC,YAAY,iCAAmB;;AAE/B;;AAEA,aAAa,iCAAmB;;AAEhC,iBAAiB,iCAAmB;;AAEpC,YAAY,iCAAmB;;AAE/B,YAAY,iCAAmB;;AAE/B,uCAAuC,uCAAuC;;AAE9E,4CAA4C,kBAAkB,kCAAkC,oEAAoE,KAAK,OAAO,oBAAoB;;AAEpM,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,CAAC,IAAI;;AAEL;AACA;AACA;AACA,CAAC,IAAI;;AAEL;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE;AACzE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA,QAAQ;AACR,+DAA+D,oBAAoB;AACnF;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAqC,wCAAwC;AAC7E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kDAAkD;AAClD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA,yFAAyF,gBAAgB;AACzG;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,cAAc,iCAAmB;;AAEjC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,mCAAmC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,uCAAuC,cAAc,WAAW,YAAY,UAAU,MAAM,2CAA2C,UAAU,sBAAsB,eAAe,2BAA2B,0BAA0B,cAAc,2CAA2C,gCAAgC,OAAO,mFAAmF;;AAErpB,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,kBAAkB,iCAAmB;;AAErC;;AAEA,iBAAiB,iCAAmB;;AAEpC;;AAEA,aAAa,iCAAmB;;AAEhC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,cAAc,iCAAmB;;AAEjC;;AAEA,uCAAuC,uCAAuC;;AAE9E,4CAA4C,kBAAkB,kCAAkC,oEAAoE,KAAK,OAAO,oBAAoB;;AAEpM,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,6CAA6C;;;AAG7C;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA,mIAAmI;AACnI,UAAU;AACV;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;;AAED,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,cAAc,iCAAmB;;AAEjC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AAC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CA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,sDAAsD,kDAAkD,8DAA8D,0BAA0B,4CAA4C,uBAAuB,oBAAoB,OAAO,4CAA4C,4BAA4B,qBAAqB,OAAO,uBAAuB,4BAA4B,oBAAoB;;AAEzc,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,cAAc,iCAAmB;;AAEjC;;AAEA,eAAe,iCAAmB;;AAElC;;AAEA,YAAY,iCAAmB;;AAE/B;;AAEA,iBAAiB,iCAAmB;;AAEpC,aAAa,iCAAmB;;AAEhC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX,qDAAqD,WAAW,IAAI,WAAW;;AAE/E;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA;AACA;;AAEA,OAAO;AACP;AACA,iCAAiC,iCAAmB;;AAEpD,iBAAiB,iCAAmB;;;AAGpC,OAAO;AACP;AACA,CAAC;;;;;;;;;;ACzyWD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,mDAAmD;AACnD,eAAe;AACf;AACA;AACA,mDAAmD;AACnD,eAAe;AACf;AACA;AACA,mDAAmD;AACnD,eAAe;AACf;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,oBAAoB;AACxC;AACA;AACA,oBAAoB,oBAAoB;AACxC;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,wBAAwB,YAAY;AACpC;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,8EAA8E;AAC9E;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA,OAAO;AACP;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;;;AAGA;AACA;AACA;AACA;AACA,gBAAgB,cAAc;AAC9B,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,UAAU;AAC1B,gBAAgB,UAAU;AAC1B,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,KAAK;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kBAAkB,WAAW;AACxD;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,SAAS;AACT;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS,IAAI;AACb;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,oEAAoE,gBAAgB;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,sCAAsC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA,MAAM,IAA4B;AAClC;AACA,IAAI,KAAK,EAQN;;AAEH,CAAC;;;;;;;;;;;AC3jCD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM,KAA0B;AAChC;AACA;AACA,IAAI,SAAS,IAA0C;AACvD;AACA,IAAI,oCAAO,OAAO;AAAA;AAAA;AAAA;AAAA,kGAAC;AACnB,IAAI,KAAK,EAGN;AACH,CAAC;AACD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,cAAc;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,WAAW;AAC/B;AACA,sBAAsB,QAAQ;AAC9B;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;;AAEV,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;ACxLD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM,KAA0B;AAChC;AACA;AACA,IAAI,SAAS,IAA0C;AACvD;AACA,IAAI,oCAAO,OAAO;AAAA;AAAA;AAAA;AAAA,kGAAC;AACnB,IAAI,KAAK,EAGN;AACH,CAAC;AACD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;;;;;;;;;;ACpPD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,KAA0B;AAChC;AACA,6BAA6B,mBAAO,CAAC,kEAAY,GAAG,mBAAO,CAAC,0DAAQ,GAAG,mBAAO,CAAC,sFAAsB;AACrG,IAAI,SAAS,IAA0C;AACvD;AACA,IAAI,iCAAO,CAAC,uFAAY,EAAE,+EAAQ,EAAE,2GAAsB,CAAC,oCAAE,OAAO;AAAA;AAAA;AAAA,kGAAC;AACrE,IAAI,KAAK,EAGN;AACH,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,wCAAwC;AACxC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN,yCAAyC,YAAY;AACrD;AACA;AACA,MAAM;AACN;AACA;;AAEA,sCAAsC,YAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC,YAAY;AACrD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,sCAAsC,YAAY;AAClD;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,oCAAoC,OAAO;AAC3C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI;AAC3D;AACA;AACA;AACA,2CAA2C,IAAI,GAAG,EAAE,aAAa,IAAI,mBAAmB,IAAI,GAAG,EAAE,cAAc,IAAI,yEAAyE,EAAE,oBAAoB,IAAI,GAAG,EAAE,gBAAgB,IAAI,EAAE,IAAI,2EAA2E,EAAE,oBAAoB,IAAI,GAAG,EAAE,gBAAgB,IAAI,EAAE,IAAI,iBAAiB,IAAI,2EAA2E,EAAE,qBAAqB,IAAI,GAAG,EAAE,gBAAgB,IAAI,EAAE,IAAI,iBAAiB,IAAI,EAAE,IAAI,yEAAyE,EAAE,qBAAqB,IAAI,GAAG,EAAE,gBAAgB,IAAI,EAAE,IAAI,iBAAiB,IAAI,EAAE,IAAI,yEAAyE,EAAE,qBAAqB,IAAI,GAAG,EAAE,gBAAgB,IAAI,EAAE,IAAI,iBAAiB,IAAI,EAAE,IAAI,yEAAyE,EAAE,yBAAyB,IAAI,EAAE,IAAI,iBAAiB,IAAI,EAAE,IAAI,yEAAyE,EAAE;AAC9jC;AACA;AACA;AACA;AACA,qDAAqD,IAAI,kBAAkB,IAAI,yBAAyB,IAAI,0GAA0G;AACtN;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,2CAA2C;AAC3C,sCAAsC,GAAG,IAAI;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,4EAA4E;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;;AAEA,gDAAgD,YAAY;AAC5D;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC,GAAG;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oBAAoB,YAAY;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,iDAAiD,YAAY;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA,wCAAwC,YAAY;AACpD;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,sBAAsB,sBAAsB;AAC5C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAkB,cAAc;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAM;AACN;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,kCAAkC,OAAO;AACzC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR,yCAAyC,OAAO;AAChD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;AACN,gCAAgC,OAAO;AACvC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,GAAG;;AAEtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uEAAuE,OAAO;AAC9E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,qBAAqB;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;;;;;;;;;;;AC3zED;AACA,CAAC;;AAED;AACA,mBAAmB,KAA0B;AAC7C;AACA,kBAAkB,KAAyB;AAC3C;AACA,yBAAyB,qBAAM,gBAAgB,qBAAM;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,UAAU;AACtB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,UAAU;AACtB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA,MAAM;AACN,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,cAAc,QAAQ;AACtB;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,mCAAmC;AACnE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB;;AAEzB,0CAA0C,qBAAqB;;AAE/D;AACA;AACA;AACA;AACA;AACA,mCAAmC,oBAAoB;;AAEvD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,cAAc,iBAAiB;AAC/B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,eAAe,iBAAiB;AAChC;;AAEA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B,oBAAoB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE,IAEU;AACZ;AACA,EAAE,mCAAmB;AACrB;AACA,GAAG;AAAA,kGAAC;AACJ,GAAG,KAAK,EAaN;;AAEF,CAAC;;;;;;;;;;;;;;;;;;;;;;ACphByC;;AAE1C;AACA,+CAA+C;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA,WAAW,kFAAkF;AAC7F;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,UAAU,+DAAiB;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oGAAoG;AACpG;AACA;AACA,cAAc,mIAAmI,EAAE;AACnJ;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,2HAA2H;AAC3H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEkH;AAClH;;;;;;;;;;;;;;;;;;;AC9UA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,kDAAkD;AACjE;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA,gEAAgE,qBAAqB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAqF;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,kCAAkC;AACjD;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,OAAO;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,OAAO;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,EAAE;AAC1C;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,uDAAuD;AACjE;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gGAAgG,aAAa,kBAAkB,yBAAyB;AACxJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,CAAC,cAAc;;AAEf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,kBAAkB,YAAY;AAC7C,gDAAgD,OAAO,sCAAsC,qBAAqB,OAAO;AACzH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEyE;AACzE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1WiE;;AAEwO;;AAE6H;;AAExS;;AAE1E;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mDAAmD,+EAAC;AACpD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uDAAuD,EAAE,cAAc,EAAE,YAAY,KAAK;AAC1F;;AAEA;AACA,oHAAoH,UAAU;AAC9H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,cAAc,kDAAkD,EAAE,GAAG,EAAE;AACvG,cAAc;AACd;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA6B,EAAE,GAAG,aAAa;AAC/C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,+DAA+D,EAAE,GAAG,EAAE;AACtE;AACA;AACA;;AAEA;AACA,oHAAoH,UAAU;AAC9H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kEAAkE,EAAE,GAAG,EAAE;AACzE;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,+EAAC;AACd;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,OAAO;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iHAAiH,gCAAgC,QAAQ;AACzJ;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW,+DAAiB;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,SAAS;AACxE;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA,gBAAgB,6DAAC,SAAS,oDAAC;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,QAAQ,QAAQ,SAAS,aAAa,aAAa;AAC5F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,QAAQ,iBAAiB,kBAAkB,aAAa,aAAa;AAC/G;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ,iBAAiB,kBAAkB,uBAAuB,uBAAuB;AACjI;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,QAAQ,iBAAiB,kBAAkB,WAAW,oBAAoB;AACrH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,QAAQ,iBAAiB,kBAAkB,UAAU,mBAAmB;AAClH;AACA;;AAEA,WAAW,+DAAiB;;AAE5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,0DAAC;;AAEjB,WAAW,+DAAiB;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E,aAAa,sBAAsB,EAAE;AACjH,UAAU;AACV;AACA,wDAAwD,OAAO,kBAAkB,aAAa;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,EAAE,UAAU,EAAE,SAAS,EAAE;AAC1E,UAAU;AACV,wEAAwE,EAAE,SAAS,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,EAAE,UAAU,EAAE,SAAS,EAAE;AAC7E,UAAU;AACV,2EAA2E,EAAE,SAAS,EAAE;AACxF;AACA;AACA;AACA;AACA,eAAe,iCAAiC;AAChD,yCAAyC,EAAE,EAAE,MAAM,EAAE,EAAE;AACvD,2CAA2C,EAAE;AAC7C;AACA;AACA;AACA;AACA,qDAAqD,EAAE,QAAQ,EAAE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA,mBAAmB,EAAE,GAAG,EAAE;AAC1B;AACA,+CAA+C,EAAE,SAAS,EAAE;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,EAAE,SAAS,EAAE;AAC/D;AACA;AACA;;AAEA,KAAK,kDAAC;;AAEN,KAAK,kDAAC;;AAEN,gBAAgB,oDAAC,oBAAoB,2DAAC,SAAS,4DAAC,SAAS,0DAAC;;AAE1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,6CAA6C;AAC7C,cAAc,EAAE,EAAE,EAAE;AACpB;;AAEA;AACA,oDAAoD,EAAE;AACtD;;AAEA,qFAAqF;;AAErF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,EAAE;AACxD;AACA;AACA,oCAAoC,GAAG,WAAW,YAAY,MAAM,WAAW,eAAe,UAAU,WAAW,UAAU;AAC7H;AACA;AACA,uDAAuD,UAAU,aAAa,YAAY,MAAM,WAAW;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,OAAO;AAC/B;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gBAAgB;;AAEjB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kBAAkB,eAAe,mBAAmB,gBAAgB,gBAAgB,WAAW,YAAY;AAC1I;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,oDAAC,2BAA2B,eAAe;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAkB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uIAAuI,KAAK;AAC5I,wGAAwG,KAAK;AAC7G;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,yIAAyI,KAAK;AAC9I;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;;AAEA;AACA,4EAA4E,KAAK;AACjF;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,0DAAC;AACtB;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,0EAA0E,iBAAiB;AAC3F;AACA,yBAAyB,0DAAC;AAC1B;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB,aAAa;AACb;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+EAA+E;AAC/E;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,YAAY,SAAS,WAAW,gBAAgB,iBAAiB,MAAM,cAAc,KAAK,cAAc,YAAY,cAAc;AAC9J;AACA;AACA;AACA,kHAAkH;AAClH;AACA;AACA;AACA;AACA;AACA,+CAA+C,GAAG,KAAK,KAAK;AAC5D;AACA;;AAEA;AACA,4EAA4E,gBAAgB,KAAK,EAAE;AACnG;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gBAAgB;;AAEjB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B,+PAA+P;AAC/P;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,OAAO,mCAAmC,OAAO;AAC3F;AACA,cAAc;AACd;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,EAAE;AACzC;AACA,0CAA0C,EAAE;AAC5C,0DAA0D,oCAAoC;AAC9F,uDAAuD;AACvD,kDAAkD,EAAE;AACpD;AACA,SAAS,aAAa;AACtB,0BAA0B,sEAAsE,IAAI,YAAY;AAChH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,oDAAC;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,EAAE;AACzD,WAAW,0DAAC;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA,gFAAgF;AAChF,WAAW,0DAAC;AACZ;AACA;AACA,mBAAmB,0DAAC,CAAC,2DAAC,mFAAmF,2DAAC;AAC1G;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA,eAAe,2DAAC;AAChB,KAAK;AACL;;AAEA;AACA;AACA,8BAA8B,oDAAC;AAC/B;AACA,sCAAsC,EAAE;AACxC,WAAW,0DAAC,oBAAoB,2DAAC;AACjC;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;;AAEA;AACA;AACA,8BAA8B,oDAAC;AAC/B;AACA,0CAA0C,EAAE;AAC5C,WAAW,0DAAC;AACZ;AACA,eAAe,0DAAC,CAAC,2DAAC;AAClB;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA,yDAAyD,EAAE;AAC3D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,2DAAC;;AAEpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oEAAoE,wDAAC;AACrE,+CAA+C,sEAAC,KAAK,+DAAC,KAAK,wEAAC,iCAAiC,wDAAC;AAC9F;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,EAAE,GAAG,kBAAkB;AAC1C,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,EAAE,qCAAqC,eAAe,mDAAmD,EAAE,6BAA6B,EAAE,kDAAkD,iBAAiB;AAC3Q,uCAAuC,EAAE;AACzC;AACA;AACA,yDAAyD,EAAE,YAAY;AACvE;AACA;AACA,iCAAiC,EAAE,gCAAgC;AACnE;AACA;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,0DAAC;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0DAA0D,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0DAA0D,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kEAAkE,aAAa;AAC/E;AACA,cAAc,mDAAmD,YAAY;AAC7E,6BAA6B;AAC7B;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kEAAkE,aAAa;AAC/E;AACA,cAAc,mDAAmD,YAAY;AAC7E,6MAA6M;AAC7M;AACA;AACA;AACA,4CAA4C,EAAE,wEAAwE,eAAe,6BAA6B,EAAE,kDAAkD,iBAAiB;AACvO;AACA,KAAK;AACL;;AAEA;AACA,WAAW,0DAAC;AACZ;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,uCAAuC,sEAAC,KAAK,+DAAC,KAAK,wEAAC,sCAAsC,wDAAC;AAC3F;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,WAAW,2DAAC;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,EAAE,GAAG,kCAAkC,EAAE,GAAG;AAClE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,qBAAqB,4BAA4B;AACjD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ,gBAAgB,kBAAkB,YAAY,aAAa;AAC1F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,IAAI;AACjB,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ,YAAY,aAAa,iBAAiB,kBAAkB,WAAW,aAAa;AACnH;AACA;;AAEA,WAAW,+DAAiB;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,wBAAwB,oDAAC;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,IAAI;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,uEAAuE;AACvE;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,mEAAmE,UAAU;AAC7E;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb,iEAAiE,UAAU;AAC3E;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb,gEAAgE,UAAU;AAC1E;AACA,aAAa;AACb,8DAA8D,UAAU;AACxE;AACA,aAAa;AACb,8DAA8D,UAAU;AACxE;AACA,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,+FAA+F,eAAe;AAC9G;AACA;AACA;AACA,UAAU,UAAU,0DAAC;AACrB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA,gBAAgB,uDAAC,SAAS,4DAAC,SAAS,oDAAC;;AAErC,WAAW,+DAAiB;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,2FAA2F,gBAAgB;AAC3G,oGAAoG,cAAc;AAClH,qBAAqB,sBAAsB,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,uBAAuB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC,0FAA0F,cAAc;AACxG,iEAAiE,oCAAoC;AACrG;AACA,sBAAsB,EAAE;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6DAAC,wBAAwB;AACpD,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,sBAAsB,EAAE,GAAG,KAAK;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC,UAAU;AACV;AACA;AACA;AACA;AACA,gCAAgC,EAAE;AAClC,qBAAqB,EAAE,EAAE,EAAE,EAAE,EAAE;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oCAAoC;AACvD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gBAAgB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,2DAAC;AACd,yCAAyC,uEAAQ;AACjD,sBAAsB,8EAAe;AACrC;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,YAAY,+EAAC;AACb,yBAAyB,0EAAC;AAC1B;AACA,sBAAsB,uEAAQ;AAC9B,sBAAsB,8EAAe;AACrC;AACA;AACA,6CAA6C,KAAK;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,eAAe;;AAE3C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,gBAAgB;;AAElD;AACA;;AAEA;AACA,+BAA+B,8EAAe,8BAA8B;;AAE5E;AACA;;AAEA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;;AAEA,WAAW,uDAAC;;AAEZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU,qEAAiB;AAC3B;AACA,eAAe,8DAAQ;AACvB,KAAK;AACL;AACA;AACA,QAAQ,8DAAQ;AAChB;AACA,KAAK;AACL;AACA,gDAAgD;AAChD,eAAe,8DAAQ;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,0DAAC;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,gEAAC;AAC5C,yFAAyF,QAAQ,sCAAsC,EAAE;AACzI;AACA;;AAEA;AACA;;AAEA;AACA,mBAAmB,8EAAe;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,iBAAiB;AAC5E,8DAA8D,EAAE,WAAW,oBAAoB,QAAQ,cAAc,KAAK,8BAA8B,EAAE,eAAe,gBAAgB;AACzL;AACA;;AAEA;AACA,UAAU,qEAAiB;AAC3B;AACA,eAAe,8DAAQ;AACvB,KAAK;AACL;AACA,QAAQ,8DAAQ;AAChB,KAAK;AACL;AACA,iCAAiC,8DAAQ;AACzC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oDAAC,4BAA4B,eAAe;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,iEAAK;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,4BAA4B;AAClF;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,oDAAoD,0BAA0B;AAC9E;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,mDAAmD,yBAAyB;AAC5E;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,iDAAiD,uBAAuB;AACxE;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,0BAA0B,sBAAsB,OAAO,+BAA+B;AACtF;AACA;;AAEA,WAAW,+DAAiB;;AAE5B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,mCAAmC,eAAe,GAAG,OAAO;AAC5D;AACA,4BAA4B,oDAAC,0BAA0B,kBAAkB;AACzE;AACA,kCAAkC,0DAAC;AACnC;AACA,2BAA2B,8DAAC,oCAAoC,6DAAC;AACjE,mCAAmC,6DAAC;AACpC;AACA;AACA,8BAA8B,sEAAC;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,iDAAC;AAC/B,cAAc,yHAAyH;AACvI;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gJAAgJ,KAAK;AACrJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E,KAAK;AACnF;AACA;AACA;AACA,uFAAuF,GAAG,oBAAoB,KAAK;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,oDAAC;AACzB,mBAAmB,2DAAC;AACpB;AACA,eAAe,eAAe,QAAQ,2DAAC;AACvC;AACA;AACA;AACA,mBAAmB,kEAAU;AAC7B;AACA;AACA;AACA;AACA,wBAAwB,oDAAC;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAC;AAChC,sBAAsB,uEAAK;AAC3B;AACA,aAAa;AACb,sDAAsD,WAAW,iBAAiB,kBAAkB;AACpG;AACA,UAAU;AACV,0EAA0E,WAAW;AACrF;AACA;AACA,YAAY,+EAAC;AACb;AACA,oEAAoE,kBAAkB;AACtF;AACA;AACA,YAAY,gFAAC;AACb;AACA,qEAAqE,kBAAkB;AACvF;AACA;AACA,8CAA8C,kCAAkC;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,GAAG,OAAO,iBAAiB;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yIAAyI;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,6CAA6C,EAAE;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,mGAAmG;AACnG;AACA;AACA;AACA,iDAAiD,EAAE;AACnD,eAAe,0DAAC;AAChB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,qBAAqB,EAAE,IAAI,GAAG;AAC9B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE;AACA;AACA,qDAAqD,GAAG;AACxD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,2BAA2B,kBAAkB,eAAe,EAAE;AAC9D;AACA;AACA;AACA,wBAAwB,sBAAsB,eAAe,cAAc,EAAE,aAAa;AAC1F;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,WAAW,uEAAQ;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,OAAO,WAAW,UAAU,YAAY,yBAAyB,YAAY,aAAa;AAC5I;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,eAAe;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,EAAE,IAAI,EAAE;AAChD;;AAEA;AACA,iCAAiC,EAAE,GAAG,EAAE;AACxC;;AAEA;AACA,0BAA0B,EAAE,GAAG,UAAU;AACzC;AACA;AACA,0BAA0B,sBAAsB,IAAI,YAAY;AAChE;AACA;;AAEA,KAAK,2DAAC;;AAEN,KAAK,2DAAC;;AAEN,KAAK,2DAAC;;AAEN,KAAK,2DAAC;;AAEN,KAAK,2DAAC;;AAEN,UAAU,oEAAC;AACX;AACA,CAAC,SAAS,oDAAC;;AAEX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F,EAAE;AACjG;AACA;AACA;AACA,6CAA6C,aAAa,EAAE,mBAAmB,GAAG,oBAAoB,aAAa,EAAE,EAAE,GAAG,oBAAoB,aAAa,EAAE,EAAE;AAC/J,8EAA8E,aAAa,EAAE,EAAE;AAC/F;AACA,iBAAiB;AACjB,cAAc;AACd;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB,GAAG;AACpB;AACA,iBAAiB;AACjB;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,kBAAkB,uEAAK;AACvB;AACA,SAAS;AACT,yEAAyE,sEAAsE;AAC/I;AACA;AACA;AACA;AACA;;AAEA,KAAK,+DAAC;AACN,UAAU,gEAAQ;AAClB;AACA;AACA,CAAC;;AAED,KAAK,+DAAC;AACN,UAAU,gEAAQ;AAClB;AACA,CAAC;;AAED,KAAK,+DAAC;AACN,UAAU,gEAAQ;AAClB,CAAC;;AAED,KAAK,+DAAC;AACN,UAAU,kEAAU;AACpB,CAAC;;AAED,UAAU,sEAAC,gBAAgB,+DAAC,SAAS,wDAAC,+BAA+B,kEAAC;;AAEtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,6DAAC,UAAU,gFAAe;AAClF;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA,KAAK,+DAAC;AACN,UAAU,gEAAQ;AAClB,CAAC;;AAED,UAAU,sEAAC;AACX;AACA;AACA,CAAC,SAAS,+DAAC,SAAS,wDAAC,oBAAoB,kEAAC,oBAAoB,0DAAC;;AAE/D;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,sBAAsB,mEAAU,CAAC,uDAAC,yBAAyB,wEAAe;AAC1E,YAAY,2DAAC,+CAA+C;AAC5D,yBAAyB;AACzB,KAAK,IAAI,0EAAiB;AAC1B;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW,+DAAiB;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAE0jC;AAC1jC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1qH6D;;AAE6R;;AAErO;;AAE03B;;AAE96B;;AAE8B;;AAElD;;AAEgE;;AAEsE;;AAEuE;;AAE1P,UAAU,kFAAa;;AAEvB;AACA,WAAW,+DAAiB,YAAY,kEAAU,CAAC,4DAAC,MAAM,wEAAC;AAC3D;;AAEA,sBAAsB,0DAAC;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,uEAAQ;AACpB,sBAAsB,8EAAe;AACrC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEsD;AACtD","sources":["webpack:///../../../../node_modules/@aurelia/kernel/src/utilities.ts","webpack:///../../../../node_modules/@aurelia/kernel/src/functions.ts","webpack:///../../../../node_modules/@aurelia/kernel/src/resource.ts","webpack:///../../../../node_modules/@aurelia/kernel/src/di.ts","webpack:///../../../../node_modules/@aurelia/kernel/src/platform.ts","webpack:///../../../../node_modules/node_modules/tslib/tslib.es6.js","webpack:///../../../../node_modules/@aurelia/kernel/src/logger.ts","webpack:///../../../../node_modules/@aurelia/kernel/src/module-loader.ts","webpack:///../../../../node_modules/@aurelia/kernel/src/eventaggregator.ts","webpack:///../../../../node_modules/@aurelia/metadata/src/index.ts","webpack:///../../../../node_modules/@aurelia/platform-browser/src/index.ts","webpack:///../../../../node_modules/@aurelia/platform/src/index.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/shared.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/utilities.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/bindable.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/bindable-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/attribute-pattern.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/platform.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/svg-analyzer.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/attribute-mapper.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/call-binding.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/element-attribute-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/binding-utils.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/attribute.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/interpolation-binding.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/let-binding.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/property-binding.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/ref-binding.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/app-task.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/templating/children.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/custom-attribute.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/watch.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/custom-element.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/class-attribute-accessor.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/templating/styles.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/templating/watchers.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/templating/lifecycle-hooks.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/templating/view.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/templating/rendering.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/templating/controller.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/app-root.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/dom.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding/listener.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/event-delegator.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/slot-injectables.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/renderer.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/binding-command.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/template-element-factory.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/utilities-di.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/template-compiler.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding-behaviors/binding-mode.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding-behaviors/debounce.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding-behaviors/signals.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/binding-behaviors/throttle.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/data-attribute-accessor.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/binding-behaviors/attr.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/binding-behaviors/self.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/attribute-ns-accessor.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/checked-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/select-value-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/style-attribute-accessor.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/value-attribute-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/observation/observer-locator.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/binding-behaviors/update-trigger.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/custom-attributes/focus.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/custom-attributes/show.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/template-controllers/portal.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/template-controllers/flags.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/template-controllers/if.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/template-controllers/repeat.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/template-controllers/with.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/template-controllers/switch.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/template-controllers/promise.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/create-element.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/custom-elements/au-render.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/custom-elements/au-compose.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/custom-elements/au-slot.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/value-converters/sanitize.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/value-converters/view.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/configuration.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/aurelia.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/resources/resources-shared.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/plugins/dialog/dialog-interfaces.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/plugins/dialog/dialog-controller.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/plugins/dialog/dialog-service.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/plugins/dialog/dialog-default-impl.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/plugins/dialog/dialog-configuration.ts","webpack:///../../../../node_modules/@aurelia/runtime-html/src/plugins/web-components.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/utilities-objects.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/alias.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/binding-context.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/signaler.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/binding-behavior.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/value-converter.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/binding/ast.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/subscriber-collection.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/flush-queue.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/collection-length-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/array-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/set-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/map-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/binding/connectable.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/binding/expression-parser.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/connectable-switcher.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/proxy-observation.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/computed-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/dirty-checker.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/primitive-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/property-accessor.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/setter-observer.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/observer-locator.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/observation.ts","webpack:///../../../../node_modules/@aurelia/runtime/src/observation/observable.ts","webpack:///0","webpack:///../../../../node_modules/quill/dist/quill.js","webpack:///../../../../node_modules/resumablejs/resumable.js","webpack:///../../../../node_modules/urijs/src/IPv6.js","webpack:///../../../../node_modules/urijs/src/SecondLevelDomains.js","webpack:///../../../../node_modules/urijs/src/URI.js","webpack:///../../../../node_modules/urijs/src/punycode.js","webpack:///../../../../node_modules/@aurelia/fetch-client/dist/esm/index.mjs","webpack:///../../../../node_modules/@aurelia/route-recognizer/dist/esm/index.mjs","webpack:///../../../../node_modules/@aurelia/router-lite/dist/esm/index.mjs","webpack:///../../../../node_modules/aurelia/dist/esm/index.mjs"],"sourcesContent":["import { Metadata } from '@aurelia/metadata';\n\n/** @internal */ export const getOwnMetadata = Metadata.getOwn;\n/** @internal */ export const hasOwnMetadata = Metadata.hasOwn;\n/** @internal */ export const defineMetadata = Metadata.define;\n\n/** @internal */ export const isPromise = <T>(v: unknown): v is Promise<T> => v instanceof Promise;\n\n// eslint-disable-next-line @typescript-eslint/ban-types\n/** @internal */ export const isFunction = <T extends Function>(v: unknown): v is T => typeof v === 'function';\n\n/** @internal */ export const isString = (v: unknown): v is string => typeof v === 'string';\n/** @internal */ export const createObject = <T extends object>() => Object.create(null) as T;\n","import { emptyArray } from './platform.js';\nimport { Constructable, Overwrite } from './interfaces.js';\nimport { createObject } from './utilities.js';\n\nconst isNumericLookup: Record<string, boolean> = {};\n\n/**\n * Efficiently determine whether the provided property key is numeric\n * (and thus could be an array indexer) or not.\n *\n * Always returns true for values of type `'number'`.\n *\n * Otherwise, only returns true for strings that consist only of positive integers.\n *\n * Results are cached.\n */\nexport function isArrayIndex(value: unknown): value is number | string {\n  switch (typeof value) {\n    case 'number':\n      return value >= 0 && (value | 0) === value;\n    case 'string': {\n      const result = isNumericLookup[value];\n      if (result !== void 0) {\n        return result;\n      }\n      const length = value.length;\n      if (length === 0) {\n        return isNumericLookup[value] = false;\n      }\n      let ch = 0;\n      let i = 0;\n      for (; i < length; ++i) {\n        ch = value.charCodeAt(i);\n        if (i === 0 && ch === 0x30 && length > 1 /* must not start with 0 */ || ch < 0x30 /* 0 */ || ch > 0x39/* 9 */) {\n          return isNumericLookup[value] = false;\n        }\n      }\n      return isNumericLookup[value] = true;\n    }\n    default:\n      return false;\n  }\n}\n\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isNumberOrBigInt(value: unknown): value is number | bigint {\n  switch (typeof value) {\n    case 'number':\n    case 'bigint':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isStringOrDate(value: unknown): value is string | Date {\n  switch (typeof value) {\n    case 'string':\n      return true;\n    case 'object':\n      return value instanceof Date;\n    default:\n      return false;\n  }\n}\n\n/**\n * Base implementation of camel and kebab cases\n */\nconst baseCase = (function () {\n  const enum CharKind {\n    none  = 0,\n    digit = 1,\n    upper = 2,\n    lower = 3,\n  }\n\n  // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n  const isDigit = Object.assign(createObject(), {\n    '0': true,\n    '1': true,\n    '2': true,\n    '3': true,\n    '4': true,\n    '5': true,\n    '6': true,\n    '7': true,\n    '8': true,\n    '9': true,\n  } as Record<string, true | undefined>);\n\n  function charToKind(char: string): CharKind {\n    if (char === '') {\n      // We get this if we do charAt() with an index out of range\n      return CharKind.none;\n    }\n\n    if (char !== char.toUpperCase()) {\n      return CharKind.lower;\n    }\n\n    if (char !== char.toLowerCase()) {\n      return CharKind.upper;\n    }\n\n    if (isDigit[char] === true) {\n      return CharKind.digit;\n    }\n\n    return CharKind.none;\n  }\n\n  return function (input: string, cb: (char: string, sep: boolean) => string): string {\n    const len = input.length;\n    if (len === 0) {\n      return input;\n    }\n\n    let sep = false;\n    let output = '';\n\n    let prevKind: CharKind;\n\n    let curChar = '';\n    let curKind = CharKind.none;\n\n    let nextChar = input.charAt(0);\n    let nextKind = charToKind(nextChar);\n\n    let i = 0;\n    for (; i < len; ++i) {\n      prevKind = curKind;\n\n      curChar = nextChar;\n      curKind = nextKind;\n\n      nextChar = input.charAt(i + 1);\n      nextKind = charToKind(nextChar);\n\n      if (curKind === CharKind.none) {\n        if (output.length > 0) {\n          // Only set sep to true if it's not at the beginning of output.\n          sep = true;\n        }\n      } else {\n        if (!sep && output.length > 0 && curKind === CharKind.upper) {\n          // Separate UAFoo into UA Foo.\n          // Separate uaFOO into ua FOO.\n          sep = prevKind === CharKind.lower || nextKind === CharKind.lower;\n        }\n\n        output += cb(curChar, sep);\n        sep = false;\n      }\n    }\n\n    return output;\n  };\n})();\n\n/**\n * Efficiently convert a string to camelCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert DOM attribute names to ViewModel property names.\n *\n * Results are cached.\n */\nexport const camelCase = (function () {\n  const cache: Record<string, string | undefined> = createObject();\n\n  function callback(char: string, sep: boolean): string {\n    return sep ? char.toUpperCase() : char.toLowerCase();\n  }\n\n  return function (input: string): string {\n    let output = cache[input];\n    if (output === void 0) {\n      output = cache[input] = baseCase(input, callback);\n    }\n\n    return output;\n  };\n})();\n\n/**\n * Efficiently convert a string to PascalCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert element names to class names for synthetic types.\n *\n * Results are cached.\n */\nexport const pascalCase = (function () {\n  const cache: Record<string, string | undefined> = createObject();\n\n  return function (input: string): string {\n    let output = cache[input];\n    if (output === void 0) {\n      output = camelCase(input);\n      if (output.length > 0) {\n        output = output[0].toUpperCase() + output.slice(1);\n      }\n      cache[input] = output;\n    }\n\n    return output;\n  };\n})();\n\n/**\n * Efficiently convert a string to kebab-case.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert ViewModel property names to DOM attribute names.\n *\n * Results are cached.\n */\nexport const kebabCase = (function () {\n  const cache: Record<string, string | undefined> = createObject();\n\n  function callback(char: string, sep: boolean): string {\n    return sep ? `-${char.toLowerCase()}` : char.toLowerCase();\n  }\n\n  return function (input: string): string {\n    let output = cache[input];\n    if (output === void 0) {\n      output = cache[input] = baseCase(input, callback);\n    }\n\n    return output;\n  };\n})();\n\n/**\n * Efficiently (up to 10x faster than `Array.from`) convert an `ArrayLike` to a real array.\n *\n * Primarily used by Aurelia to convert DOM node lists to arrays.\n */\nexport function toArray<T = unknown>(input: ArrayLike<T>): T[] {\n  // benchmark: http://jsben.ch/xjsyF\n  const { length } = input;\n  const arr = Array(length) as T[];\n  let i = 0;\n  for (; i < length; ++i) {\n    arr[i] = input[i];\n  }\n  return arr;\n}\n\nconst ids: Record<string, number> = {};\n\n/**\n * Retrieve the next ID in a sequence for a given string, starting with `1`.\n *\n * Used by Aurelia to assign unique ID's to controllers and resources.\n *\n * Aurelia will always prepend the context name with `au$`, so as long as you avoid\n * using that convention you should be safe from collisions.\n */\nexport function nextId(context: string): number {\n  if (ids[context] === void 0) {\n    ids[context] = 0;\n  }\n  return ++ids[context];\n}\n\n/**\n * Reset the ID for the given string, so that `nextId` will return `1` again for the next call.\n *\n * Used by Aurelia to reset ID's in between unit tests.\n */\nexport function resetId(context: string): void {\n  ids[context] = 0;\n}\n\n/**\n * A compare function to pass to `Array.prototype.sort` for sorting numbers.\n * This is needed for numeric sort, since the default sorts them as strings.\n */\nexport function compareNumber(a: number, b: number): number {\n  return a - b;\n}\n\n/**\n * Efficiently merge and deduplicate the (primitive) values in two arrays.\n *\n * Does not deduplicate existing values in the first array.\n *\n * Guards against null or undefined arrays.\n *\n * Returns `emptyArray` if both arrays are either `null`, `undefined` or `emptyArray`\n *\n * @param slice - If `true`, always returns a new array copy (unless neither array is/has a value)\n */\nexport function mergeDistinct<T>(\n  arr1: readonly T[] | T[] | null | undefined,\n  arr2: readonly T[] | T[] | null | undefined,\n  slice: boolean,\n): T[] {\n  if (arr1 === void 0 || arr1 === null || arr1 === emptyArray) {\n    if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n      return emptyArray as T[];\n    } else {\n      return slice ? arr2.slice(0) : arr2 as T[];\n    }\n  } else if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n    return slice ? arr1.slice(0) : arr1 as T[];\n  }\n\n  const lookup: Record<string, true | undefined> = {};\n  const arr3 = slice ? arr1.slice(0) : arr1 as (readonly T[]) & T[];\n\n  let len1 = arr1.length;\n  let len2 = arr2.length;\n\n  while (len1-- > 0) {\n    lookup[arr1[len1] as unknown as string] = true;\n  }\n\n  let item;\n  while (len2-- > 0) {\n    item = arr2[len2];\n    if (lookup[item as unknown as string] === void 0) {\n      arr3.push(item);\n      lookup[item as unknown as string] = true;\n    }\n  }\n\n  return arr3;\n}\n\n/**\n * Decorator. (lazily) bind the method to the class instance on first call.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bound<T extends Function>(target: Object, key: string | symbol, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T> {\n  return {\n    configurable: true,\n    enumerable: descriptor.enumerable,\n    get(): T {\n      const boundFn = descriptor.value!.bind(this) as TypedPropertyDescriptor<T>;\n      Reflect.defineProperty(this, key, {\n        value: boundFn,\n        writable: true,\n        configurable: true,\n        enumerable: descriptor.enumerable,\n      });\n      return boundFn as T;\n    },\n  };\n}\n\nexport function mergeArrays<T>(...arrays: (readonly T[] | undefined)[]): T[] {\n  const result: T[] = [];\n  let k = 0;\n  const arraysLen = arrays.length;\n  let arrayLen = 0;\n  let array: readonly T[] | undefined;\n  let i = 0;\n  for (; i < arraysLen; ++i) {\n    array = arrays[i];\n    if (array !== void 0) {\n      arrayLen = array.length;\n      let j = 0;\n      for (; j < arrayLen; ++j) {\n        result[k++] = array[j];\n      }\n    }\n  }\n  return result;\n}\n\nexport function mergeObjects<T extends object>(...objects: readonly (T | undefined)[]): T {\n  const result: T = {} as unknown as T;\n  const objectsLen = objects.length;\n  let object: T | undefined;\n  let key: keyof T;\n  let i = 0;\n  for (; objectsLen > i; ++i) {\n    object = objects[i];\n    if (object !== void 0) {\n      for (key in object) {\n        result[key] = object[key];\n      }\n    }\n  }\n  return result;\n}\n\nexport function firstDefined<T>(...values: readonly (T | undefined)[]): T {\n  const len = values.length;\n  let value: T | undefined;\n  let i = 0;\n  for (; len > i; ++i) {\n    value = values[i];\n    if (value !== void 0) {\n      return value;\n    }\n  }\n  throw new Error(`No default value found`);\n}\n\nexport const getPrototypeChain = (function () {\n  const functionPrototype = Function.prototype;\n  const getPrototypeOf = Object.getPrototypeOf;\n\n  const cache = new WeakMap<Constructable, [Constructable, ...Constructable[]]>();\n  let proto = functionPrototype as Constructable;\n  let i = 0;\n  let chain: [Constructable, ...Constructable[]] | undefined = void 0;\n\n  return function <T extends Constructable> (Type: T): readonly [T, ...Constructable[]] {\n    chain = cache.get(Type);\n    if (chain === void 0) {\n      cache.set(Type, chain = [proto = Type]);\n      i = 0;\n      while ((proto = getPrototypeOf(proto)) !== functionPrototype) {\n        chain[++i] = proto;\n      }\n    }\n    return chain as [T, ...Constructable[]];\n  };\n})();\n\nexport function toLookup<\n  T1 extends {},\n>(\n  obj1: T1,\n): T1;\nexport function toLookup<\n  T1 extends {},\n  T2 extends {},\n>(\n  obj1: T1,\n  obj2: T2,\n): Overwrite<T1, T2>;\nexport function toLookup<\n  T1 extends {},\n  T2 extends {},\n  T3 extends {},\n>(\n  obj1: T1,\n  obj2: T2,\n  obj3: T3,\n): Overwrite<T1, Overwrite<T1, T2>>;\nexport function toLookup<\n  T1 extends {},\n  T2 extends {},\n  T3 extends {},\n  T4 extends {},\n>(\n  obj1: T1,\n  obj2: T2,\n  obj3: T3,\n  obj4: T4,\n): Readonly<T1 & T2 & T3 & T4>;\nexport function toLookup<\n  T1 extends {},\n  T2 extends {},\n  T3 extends {},\n  T4 extends {},\n  T5 extends {},\n>(\n  obj1: T1,\n  obj2: T2,\n  obj3: T3,\n  obj4: T4,\n  obj5: T5,\n): Readonly<T1 & T2 & T3 & T4 & T5>;\nexport function toLookup(...objs: {}[]): Readonly<{}> {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  return Object.assign(createObject(), ...objs);\n}\n\n/**\n * Determine whether the value is a native function.\n *\n * @param fn - The function to check.\n * @returns `true` is the function is a native function, otherwise `false`\n */\nexport const isNativeFunction = (function () {\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  const lookup: WeakMap<Function, boolean> = new WeakMap();\n\n  let isNative = false as boolean | undefined;\n  let sourceText = '';\n  let i = 0;\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  return function (fn: Function) {\n    isNative = lookup.get(fn);\n    if (isNative === void 0) {\n      sourceText = fn.toString();\n      i = sourceText.length;\n\n      // http://www.ecma-international.org/ecma-262/#prod-NativeFunction\n      isNative = (\n        // 29 is the length of 'function () { [native code] }' which is the smallest length of a native function string\n        i >= 29 &&\n        // 100 seems to be a safe upper bound of the max length of a native function. In Chrome and FF it's 56, in Edge it's 61.\n        i <= 100 &&\n        // This whole heuristic *could* be tricked by a comment. Do we need to care about that?\n        sourceText.charCodeAt(i -  1) === 0x7D && // }\n        // TODO: the spec is a little vague about the precise constraints, so we do need to test this across various browsers to make sure just one whitespace is a safe assumption.\n        sourceText.charCodeAt(i -  2)  <= 0x20 && // whitespace\n        sourceText.charCodeAt(i -  3) === 0x5D && // ]\n        sourceText.charCodeAt(i -  4) === 0x65 && // e\n        sourceText.charCodeAt(i -  5) === 0x64 && // d\n        sourceText.charCodeAt(i -  6) === 0x6F && // o\n        sourceText.charCodeAt(i -  7) === 0x63 && // c\n        sourceText.charCodeAt(i -  8) === 0x20 && //\n        sourceText.charCodeAt(i -  9) === 0x65 && // e\n        sourceText.charCodeAt(i - 10) === 0x76 && // v\n        sourceText.charCodeAt(i - 11) === 0x69 && // i\n        sourceText.charCodeAt(i - 12) === 0x74 && // t\n        sourceText.charCodeAt(i - 13) === 0x61 && // a\n        sourceText.charCodeAt(i - 14) === 0x6E && // n\n        sourceText.charCodeAt(i - 15) === 0x58    // [\n      );\n\n      lookup.set(fn, isNative);\n    }\n    return isNative;\n  };\n})();\n\ntype UnwrapPromise<T> = T extends Promise<infer R> ? R : T;\ntype MaybePromise<T> = T extends Promise<infer R> ? (T | R) : (T | Promise<T>);\n\n/**\n * Normalize a potential promise via a callback, to ensure things stay synchronous when they can.\n *\n * If the value is a promise, it is `then`ed before the callback is invoked. Otherwise the callback is invoked synchronously.\n */\nexport function onResolve<TValue, TRet>(\n  maybePromise: TValue,\n  resolveCallback: (value: UnwrapPromise<TValue>) => TRet,\n): MaybePromise<TRet> {\n  if (maybePromise instanceof Promise) {\n    return maybePromise.then(resolveCallback) as MaybePromise<TRet>;\n  }\n  return resolveCallback(maybePromise as UnwrapPromise<TValue>) as MaybePromise<TRet>;\n}\n\n/**\n * Normalize an array of potential promises, to ensure things stay synchronous when they can.\n *\n * If exactly one value is a promise, then that promise is returned.\n *\n * If more than one value is a promise, a new `Promise.all` is returned.\n *\n * If none of the values is a promise, nothing is returned, to indicate that things can stay synchronous.\n */\nexport function resolveAll(\n  ...maybePromises: (void | Promise<void>)[]\n): void | Promise<void> {\n  let maybePromise: Promise<void> | void = void 0;\n  let firstPromise: Promise<void> | void = void 0;\n  let promises: Promise<void>[] | undefined = void 0;\n  let i = 0;\n  // eslint-disable-next-line\n  let ii = maybePromises.length;\n  for (; i < ii; ++i) {\n    maybePromise = maybePromises[i];\n    if ((maybePromise = maybePromises[i]) instanceof Promise) {\n      if (firstPromise === void 0) {\n        firstPromise = maybePromise;\n      } else if (promises === void 0) {\n        promises = [firstPromise, maybePromise];\n      } else {\n        promises.push(maybePromise);\n      }\n    }\n  }\n\n  if (promises === void 0) {\n    return firstPromise;\n  }\n  return Promise.all(promises) as unknown as Promise<void>;\n}\n","import { IContainer } from './di.js';\nimport { Constructable } from './interfaces.js';\nimport { emptyArray } from './platform.js';\nimport { defineMetadata, hasOwnMetadata, getOwnMetadata } from './utilities.js';\n\nexport type ResourceType<\n  TUserType extends Constructable = Constructable,\n  TResInstance extends {} = {},\n  TResType extends {} = {},\n  TUserInstance extends InstanceType<TUserType> = InstanceType<TUserType>,\n> = (\n  new (...args: unknown[]) => TResInstance & TUserInstance\n) & {\n  readonly aliases?: readonly string[];\n} & TResType & TUserType;\n\nexport type ResourceDefinition<\n  TUserType extends Constructable = Constructable,\n  TResInstance extends {} = {},\n  TDef extends {} = {},\n  TResType extends {} = {},\n  TUserInstance extends InstanceType<TUserType> = InstanceType<TUserType>,\n> = {\n  readonly name: string;\n  readonly Type: ResourceType<TUserType, TResInstance, TResType, TUserInstance>;\n  readonly aliases?: readonly string[];\n\n  register(container: IContainer): void;\n} & TDef;\n\nexport type PartialResourceDefinition<TDef extends {} = {}> = {\n  readonly name: string;\n  readonly aliases?: readonly string[];\n} & TDef;\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport interface IResourceKind<TType extends ResourceType, TDef extends ResourceDefinition> {\n  readonly name: string;\n  keyFrom(name: string): string;\n}\n\nconst annoBaseName = 'au:annotation';\n/** @internal */\nexport const getAnnotationKeyFor = (name: string, context?: string): string => {\n  if (context === void 0) {\n    return `${annoBaseName}:${name}`;\n  }\n\n  return `${annoBaseName}:${name}:${context}`;\n};\n/** @internal */\nexport const appendAnnotation = (target: Constructable, key: string): void => {\n  const keys = getOwnMetadata(annoBaseName, target) as string[];\n  if (keys === void 0) {\n    defineMetadata(annoBaseName, [key], target);\n  } else {\n    keys.push(key);\n  }\n};\nconst annotation = Object.freeze({\n  name: 'au:annotation',\n  appendTo: appendAnnotation,\n  set(target: Constructable, prop: string, value: unknown): void {\n    defineMetadata(getAnnotationKeyFor(prop), value, target);\n  },\n  get: (target: Constructable, prop: string): unknown => getOwnMetadata(getAnnotationKeyFor(prop), target),\n  getKeys(target: Constructable): readonly string[] {\n    let keys = getOwnMetadata(annoBaseName, target) as string[];\n    if (keys === void 0) {\n      defineMetadata(annoBaseName, keys = [], target);\n    }\n    return keys;\n  },\n  isKey: (key: string): boolean  => key.startsWith(annoBaseName),\n  keyFor: getAnnotationKeyFor,\n});\n\nconst resBaseName = 'au:resource';\nconst resource = Object.freeze({\n  name: resBaseName,\n  appendTo(target: Constructable, key: string): void {\n    const keys = getOwnMetadata(resBaseName, target) as string[];\n    if (keys === void 0) {\n      defineMetadata(resBaseName, [key], target);\n    } else {\n      keys.push(key);\n    }\n  },\n  has: (target: unknown): target is Constructable => hasOwnMetadata(resBaseName, target),\n  getAll(target: Constructable): readonly ResourceDefinition[] {\n    const keys = getOwnMetadata(resBaseName, target) as string[];\n    if (keys === void 0) {\n      return emptyArray;\n    } else {\n      return keys.map(k => getOwnMetadata(k, target));\n    }\n  },\n  getKeys(target: Constructable): readonly string[] {\n    let keys = getOwnMetadata(resBaseName, target) as string[];\n    if (keys === void 0) {\n      defineMetadata(resBaseName, keys = [], target);\n    }\n    return keys;\n  },\n  isKey: (key: string): boolean => key.startsWith(resBaseName),\n  keyFor(name: string, context?: string): string {\n    if (context === void 0) {\n      return `${resBaseName}:${name}`;\n    }\n\n    return `${resBaseName}:${name}:${context}`;\n  },\n});\n\nexport const Protocol = {\n  annotation,\n  resource,\n};\n\nconst hasOwn = Object.prototype.hasOwnProperty;\n\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override the definition as well as static properties on the type.\n * 2. Definition properties (usually set by the customElement decorator object literal) come next. They override static properties on the type.\n * 3. Static properties on the type come last. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 4. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrDefinitionOrTypeOrDefault<\n  TDef extends PartialResourceDefinition,\n  K extends keyof TDef,\n>(\n  name: K,\n  def: TDef,\n  Type: Constructable,\n  getDefault: () => Required<TDef>[K],\n): Required<TDef>[K] {\n  let value = getOwnMetadata(getAnnotationKeyFor(name as string), Type) as TDef[K] | undefined;\n  if (value === void 0) {\n    value = def[name];\n    if (value === void 0) {\n      value = (Type as Constructable & TDef)[name] as TDef[K] | undefined;\n      if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n        return getDefault();\n      }\n      return value;\n    }\n    return value;\n  }\n  return value;\n}\n\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override static properties on the type.\n * 2. Static properties on the typ. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 3. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrTypeOrDefault<T, K extends keyof T, V>(\n  name: K,\n  Type: T,\n  getDefault: () => V,\n): V {\n  let value = getOwnMetadata(getAnnotationKeyFor(name as string), Type) as V;\n  if (value === void 0) {\n    value = Type[name] as unknown as V;\n    if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n      return getDefault();\n    }\n    return value;\n  }\n  return value;\n}\n\n/**\n * The order in which the values are checked:\n * 1. Definition properties.\n * 2. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromDefinitionOrDefault<\n  TDef extends PartialResourceDefinition,\n  K extends keyof TDef,\n>(\n  name: K,\n  def: TDef,\n  getDefault: () => Required<TDef>[K],\n): Required<TDef>[K] {\n  const value = def[name];\n  if (value === void 0) {\n    return getDefault();\n  }\n  return value;\n}\n","/* eslint-disable @typescript-eslint/prefer-nullish-coalescing */\n/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/no-unsafe-return */\nimport { isObject, applyMetadataPolyfill } from '@aurelia/metadata';\n\napplyMetadataPolyfill(Reflect, false, false);\n\nimport { isArrayIndex, isNativeFunction } from './functions.js';\nimport { Class, Constructable, IDisposable } from './interfaces.js';\nimport { emptyArray } from './platform.js';\nimport { appendAnnotation, getAnnotationKeyFor, IResourceKind, Protocol, ResourceDefinition, ResourceType } from './resource.js';\nimport { createObject, defineMetadata, getOwnMetadata, isFunction, isString } from './utilities.js';\n\nexport type ResolveCallback<T = any> = (handler: IContainer, requestor: IContainer, resolver: IResolver<T>) => T;\n\nexport type InterfaceSymbol<K = any> = (target: Injectable<K>, property: string, index: number) => void;\n\n// This interface exists only to break a circular type referencing issue in the IServiceLocator interface.\n// Otherwise IServiceLocator references IResolver, which references IContainer, which extends IServiceLocator.\ninterface IResolverLike<C, K = any> {\n  readonly $isResolver: true;\n  resolve(handler: C, requestor: C): Resolved<K>;\n  getFactory?(container: C): (K extends Constructable ? IFactory<K> : never) | null;\n}\n\nexport interface IResolver<K = any> extends IResolverLike<IContainer, K> { }\nexport interface IDisposableResolver<K = any> extends IResolver<K> {\n  dispose(): void;\n}\n\nexport interface IRegistration<K = any> {\n  register(container: IContainer, key?: Key): IResolver<K>;\n}\n\nexport type Transformer<K> = (instance: Resolved<K>) => Resolved<K>;\n\nexport interface IFactory<T extends Constructable = any> {\n  readonly Type: T;\n  registerTransformer(transformer: Transformer<T>): void;\n  construct(container: IContainer, dynamicDependencies?: unknown[]): Resolved<T>;\n}\n\nexport interface IServiceLocator {\n  has<K extends Key>(key: K | Key, searchAncestors: boolean): boolean;\n  get<K extends Key>(key: INewInstanceResolver<K>): Resolved<K>;\n  get<K extends Key>(key: ILazyResolver<K>): IResolvedLazy<K>;\n  get<K extends Key>(key: IFactoryResolver<K>): IResolvedFactory<K>;\n  get<K extends Key>(key: IResolver<K>): Resolved<K>;\n  get<K extends Key>(key: K): Resolved<K>;\n  get<K extends Key>(key: Key): Resolved<K>;\n  get<K extends Key>(key: K | Key): Resolved<K>;\n  getAll<K extends Key>(key: K, searchAncestors?: boolean): readonly Resolved<K>[];\n  getAll<K extends Key>(key: Key, searchAncestors?: boolean): readonly Resolved<K>[];\n  getAll<K extends Key>(key: K | Key, searchAncestors?: boolean): readonly Resolved<K>[];\n}\n\nexport interface IRegistry {\n  register(container: IContainer, ...params: unknown[]): void | IResolver | IContainer;\n}\n\nexport interface IContainer extends IServiceLocator, IDisposable {\n  readonly id: number;\n  readonly root: IContainer;\n  register(...params: any[]): IContainer;\n  registerResolver<K extends Key, T = K>(key: K, resolver: IResolver<T>, isDisposable?: boolean): IResolver<T>;\n  // deregisterResolverFor<K extends Key>(key: K, searchAncestors: boolean): void;\n  registerTransformer<K extends Key, T = K>(key: K, transformer: Transformer<T>): boolean;\n  getResolver<K extends Key, T = K>(key: K | Key, autoRegister?: boolean): IResolver<T> | null;\n  registerFactory<T extends Constructable>(key: T, factory: IFactory<T>): void;\n  invoke<T, TDeps extends unknown[] = unknown[]>(key: Constructable<T>, dynamicDependencies?: TDeps): T;\n  getFactory<T extends Constructable>(key: T): IFactory<T>;\n  createChild(config?: IContainerConfiguration): IContainer;\n  disposeResolvers(): void;\n  find<TType extends ResourceType, TDef extends ResourceDefinition>(kind: IResourceKind<TType, TDef>, name: string): TDef | null;\n  create<TType extends ResourceType, TDef extends ResourceDefinition>(kind: IResourceKind<TType, TDef>, name: string): InstanceType<TType> | null;\n}\n\nexport class ResolverBuilder<K> {\n  public constructor(\n    private container: IContainer,\n    private key: Key,\n  ) {}\n\n  public instance(value: K): IResolver<K> {\n    return this.registerResolver(ResolverStrategy.instance, value);\n  }\n\n  public singleton(value: Constructable): IResolver<K> {\n    return this.registerResolver(ResolverStrategy.singleton, value);\n  }\n\n  public transient(value: Constructable): IResolver<K> {\n    return this.registerResolver(ResolverStrategy.transient, value);\n  }\n\n  public callback(value: ResolveCallback<K>): IResolver<K> {\n    return this.registerResolver(ResolverStrategy.callback, value);\n  }\n\n  public cachedCallback(value: ResolveCallback<K>): IResolver<K> {\n    return this.registerResolver(ResolverStrategy.callback, cacheCallbackResult(value));\n  }\n\n  public aliasTo(destinationKey: Key): IResolver<K> {\n    return this.registerResolver(ResolverStrategy.alias, destinationKey);\n  }\n\n  private registerResolver(strategy: ResolverStrategy, state: unknown): IResolver<K> {\n    const { container, key } = this;\n    this.container = this.key = (void 0)!;\n    return container.registerResolver(key, new Resolver(key, strategy, state));\n  }\n}\n\nexport type RegisterSelf<T extends Constructable> = {\n  register(container: IContainer): IResolver<InstanceType<T>>;\n  registerInRequestor: boolean;\n};\n\nexport type Key = PropertyKey | object | InterfaceSymbol | Constructable | IResolver;\n\nexport type Resolved<K> = (\n  K extends InterfaceSymbol<infer T>\n    ? T\n    : K extends Constructable\n      ? InstanceType<K>\n      : K extends IResolverLike<any, infer T1>\n        ? T1 extends Constructable\n          ? InstanceType<T1>\n          : T1\n        : K\n);\n\nexport type Injectable<T = {}> = Constructable<T> & { inject?: Key[] };\n\nfunction cloneArrayWithPossibleProps<T>(source: readonly T[]): T[] {\n  const clone = source.slice();\n  const keys = Object.keys(source);\n  const len = keys.length;\n  let key: string;\n  for (let i = 0; i < len; ++i) {\n    key = keys[i];\n    if (!isArrayIndex(key)) {\n      clone[key] = source[key];\n    }\n  }\n  return clone;\n}\n\nexport interface IContainerConfiguration {\n  /**\n   * If `true`, `createChild` will inherit the resource resolvers from its parent container\n   * instead of only from the root container.\n   *\n   * Setting this flag will not implicitly perpetuate it in the child container hierarchy.\n   * It must be explicitly set on each call to `createChild`.\n   */\n  inheritParentResources?: boolean;\n  defaultResolver?(key: Key, handler: IContainer): IResolver;\n}\n\nexport const DefaultResolver = {\n  none(key: Key): IResolver {\n    if (__DEV__) {\n      throw Error(`${key.toString()} not registered, did you forget to add @singleton()?`);\n    } else {\n      throw Error(`AUR0002:${key.toString()}`);\n    }\n  },\n  singleton(key: Key): IResolver {return new Resolver(key, ResolverStrategy.singleton, key);},\n  transient(key: Key): IResolver {return new Resolver(key, ResolverStrategy.transient, key);},\n};\n\nexport class ContainerConfiguration implements IContainerConfiguration {\n  public static readonly DEFAULT: ContainerConfiguration = ContainerConfiguration.from({});\n\n  private constructor(\n    public readonly inheritParentResources: boolean,\n    public readonly defaultResolver: (key: Key, handler: IContainer) => IResolver,\n  ) {}\n\n  public static from(config?: IContainerConfiguration): ContainerConfiguration {\n    if (\n      config === void 0 ||\n      config === ContainerConfiguration.DEFAULT\n    ) {\n      return ContainerConfiguration.DEFAULT;\n    }\n    return new ContainerConfiguration(\n      config.inheritParentResources ?? false,\n      config.defaultResolver ?? DefaultResolver.singleton,\n    );\n  }\n}\n\nexport const DI = {\n  createContainer(config?: Partial<IContainerConfiguration>): IContainer {\n    return new Container(null, ContainerConfiguration.from(config));\n  },\n  getDesignParamtypes(Type: Constructable | Injectable): readonly Key[] | undefined {\n    return getOwnMetadata('design:paramtypes', Type);\n  },\n  getAnnotationParamtypes(Type: Constructable | Injectable): readonly Key[] | undefined {\n    const key = getAnnotationKeyFor('di:paramtypes');\n    return getOwnMetadata(key, Type);\n  },\n  getOrCreateAnnotationParamTypes: getOrCreateAnnotationParamTypes,\n  getDependencies: getDependencies,\n  /**\n   * creates a decorator that also matches an interface and can be used as a {@linkcode Key}.\n   * ```ts\n   * const ILogger = DI.createInterface<Logger>('Logger');\n   * container.register(Registration.singleton(ILogger, getSomeLogger()));\n   * const log = container.get(ILogger);\n   * log.info('hello world');\n   * class Foo {\n   *   constructor( @ILogger log: ILogger ) {\n   *     log.info('hello world');\n   *   }\n   * }\n   * ```\n   * you can also build default registrations into your interface.\n   * ```ts\n   * export const ILogger = DI.createInterface<Logger>('Logger', builder => builder.cachedCallback(LoggerDefault));\n   * const log = container.get(ILogger);\n   * log.info('hello world');\n   * class Foo {\n   *   constructor( @ILogger log: ILogger ) {\n   *     log.info('hello world');\n   *   }\n   * }\n   * ```\n   * but these default registrations won't work the same with other decorators that take keys, for example\n   * ```ts\n   * export const MyStr = DI.createInterface<string>('MyStr', builder => builder.instance('somestring'));\n   * class Foo {\n   *   constructor( @optional(MyStr) public readonly str: string ) {\n   *   }\n   * }\n   * container.get(Foo).str; // returns undefined\n   * ```\n   * to fix this add this line somewhere before you do a `get`\n   * ```ts\n   * container.register(MyStr);\n   * container.get(Foo).str; // returns 'somestring'\n   * ```\n   *\n   * - @param friendlyName used to improve error messaging\n   */\n  createInterface<K extends Key>(configureOrName?: string | ((builder: ResolverBuilder<K>) => IResolver<K>), configuror?: (builder: ResolverBuilder<K>) => IResolver<K>): InterfaceSymbol<K> {\n    const configure = isFunction(configureOrName) ? configureOrName : configuror;\n    const friendlyName = isString(configureOrName) ? configureOrName : undefined;\n\n    const Interface = function (target: Injectable<K>, property: string, index: number): void {\n      if (target == null || new.target !== undefined) {\n        if (__DEV__) {\n          throw new Error(`No registration for interface: '${Interface.friendlyName}'`);\n        } else {\n          throw new Error(`AUR0001:${Interface.friendlyName}`);\n        }\n      }\n      const annotationParamtypes = getOrCreateAnnotationParamTypes(target);\n      annotationParamtypes[index] = Interface;\n    };\n    Interface.$isInterface = true;\n    Interface.friendlyName = friendlyName == null ? '(anonymous)' : friendlyName;\n\n    if (configure != null) {\n      Interface.register = function (container: IContainer, key?: Key): IResolver<K> {\n          return configure(new ResolverBuilder(container, key ?? Interface));\n      };\n    }\n\n    Interface.toString = function toString(): string {\n      return `InterfaceSymbol<${Interface.friendlyName}>`;\n    };\n\n    return Interface;\n  },\n  inject(...dependencies: Key[]): (target: Injectable, key?: string | number, descriptor?: PropertyDescriptor | number) => void {\n    return function (target: Injectable, key?: string | number, descriptor?: PropertyDescriptor | number): void {\n      if (typeof descriptor === 'number') { // It's a parameter decorator.\n        const annotationParamtypes = getOrCreateAnnotationParamTypes(target);\n        const dep = dependencies[0];\n        if (dep !== void 0) {\n          annotationParamtypes[descriptor] = dep;\n        }\n      } else if (key) { // It's a property decorator. Not supported by the container without plugins.\n        const annotationParamtypes = getOrCreateAnnotationParamTypes((target as unknown as { constructor: Injectable }).constructor);\n        const dep = dependencies[0];\n        if (dep !== void 0) {\n          annotationParamtypes[key as number] = dep;\n        }\n      } else if (descriptor) { // It's a function decorator (not a Class constructor)\n        const fn = descriptor.value;\n        const annotationParamtypes = getOrCreateAnnotationParamTypes(fn);\n        let dep: Key;\n        for (let i = 0; i < dependencies.length; ++i) {\n          dep = dependencies[i];\n          if (dep !== void 0) {\n            annotationParamtypes[i] = dep;\n          }\n        }\n      } else { // It's a class decorator.\n        const annotationParamtypes = getOrCreateAnnotationParamTypes(target);\n        let dep: Key;\n        for (let i = 0; i < dependencies.length; ++i) {\n          dep = dependencies[i];\n          if (dep !== void 0) {\n            annotationParamtypes[i] = dep;\n          }\n        }\n      }\n    };\n  },\n  /**\n   * Registers the `target` class as a transient dependency; each time the dependency is resolved\n   * a new instance will be created.\n   *\n   * @param target - The class / constructor function to register as transient.\n   * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n   *\n   * @example ```ts\n   * // On an existing class\n   * class Foo { }\n   * DI.transient(Foo);\n   *\n   * // Inline declaration\n   * const Foo = DI.transient(class { });\n   * // Foo is now strongly typed with register\n   * Foo.register(container);\n   * ```\n   */\n  transient<T extends Constructable>(target: T & Partial<RegisterSelf<T>>): T & RegisterSelf<T> {\n    target.register = function register(container: IContainer): IResolver<InstanceType<T>> {\n      const registration = Registration.transient(target as T, target as T);\n      return registration.register(container, target);\n    };\n    target.registerInRequestor = false;\n    return target as T & RegisterSelf<T>;\n  },\n  /**\n   * Registers the `target` class as a singleton dependency; the class will only be created once. Each\n   * consecutive time the dependency is resolved, the same instance will be returned.\n   *\n   * @param target - The class / constructor function to register as a singleton.\n   * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n   * @example ```ts\n   * // On an existing class\n   * class Foo { }\n   * DI.singleton(Foo);\n   *\n   * // Inline declaration\n   * const Foo = DI.singleton(class { });\n   * // Foo is now strongly typed with register\n   * Foo.register(container);\n   * ```\n   */\n  singleton<T extends Constructable>(target: T & Partial<RegisterSelf<T>>, options: SingletonOptions = defaultSingletonOptions):\n    T & RegisterSelf<T> {\n    target.register = function register(container: IContainer): IResolver<InstanceType<T>> {\n      const registration = Registration.singleton(target, target);\n      return registration.register(container, target);\n    };\n    target.registerInRequestor = options.scoped;\n    return target as T & RegisterSelf<T>;\n  },\n};\n\nfunction getDependencies(Type: Constructable | Injectable): Key[] {\n  // Note: Every detail of this getDependencies method is pretty deliberate at the moment, and probably not yet 100% tested from every possible angle,\n  // so be careful with making changes here as it can have a huge impact on complex end user apps.\n  // Preferably, only make changes to the dependency resolution process via a RFC.\n\n  const key = getAnnotationKeyFor('di:dependencies');\n  let dependencies = getOwnMetadata(key, Type) as Key[] | undefined;\n  if (dependencies === void 0) {\n    // Type.length is the number of constructor parameters. If this is 0, it could mean the class has an empty constructor\n    // but it could also mean the class has no constructor at all (in which case it inherits the constructor from the prototype).\n\n    // Non-zero constructor length + no paramtypes means emitDecoratorMetadata is off, or the class has no decorator.\n    // We're not doing anything with the above right now, but it's good to keep in mind for any future issues.\n\n    const inject = (Type as Injectable).inject;\n    if (inject === void 0) {\n      // design:paramtypes is set by tsc when emitDecoratorMetadata is enabled.\n      const designParamtypes = DI.getDesignParamtypes(Type);\n      // au:annotation:di:paramtypes is set by the parameter decorator from DI.createInterface or by @inject\n      const annotationParamtypes = DI.getAnnotationParamtypes(Type);\n      if (designParamtypes === void 0) {\n        if (annotationParamtypes === void 0) {\n          // Only go up the prototype if neither static inject nor any of the paramtypes is defined, as\n          // there is no sound way to merge a type's deps with its prototype's deps\n          const Proto = Object.getPrototypeOf(Type);\n          if (isFunction(Proto) && Proto !== Function.prototype) {\n            dependencies = cloneArrayWithPossibleProps(getDependencies(Proto));\n          } else {\n            dependencies = [];\n          }\n        } else {\n          // No design:paramtypes so just use the au:annotation:di:paramtypes\n          dependencies = cloneArrayWithPossibleProps(annotationParamtypes);\n        }\n      } else if (annotationParamtypes === void 0) {\n        // No au:annotation:di:paramtypes so just use the design:paramtypes\n        dependencies = cloneArrayWithPossibleProps(designParamtypes);\n      } else {\n        // We've got both, so merge them (in case of conflict on same index, au:annotation:di:paramtypes take precedence)\n        dependencies = cloneArrayWithPossibleProps(designParamtypes);\n        let len = annotationParamtypes.length;\n        let auAnnotationParamtype: Key;\n        let i = 0;\n        for (; i < len; ++i) {\n          auAnnotationParamtype = annotationParamtypes[i];\n          if (auAnnotationParamtype !== void 0) {\n            dependencies[i] = auAnnotationParamtype;\n          }\n        }\n\n        const keys = Object.keys(annotationParamtypes);\n        let key: string;\n        i = 0;\n        len = keys.length;\n        for (i = 0; i < len; ++i) {\n          key = keys[i];\n          if (!isArrayIndex(key)) {\n            dependencies[key] = annotationParamtypes[key];\n          }\n        }\n      }\n    } else {\n      // Ignore paramtypes if we have static inject\n      dependencies = cloneArrayWithPossibleProps(inject);\n    }\n\n    defineMetadata(key, dependencies, Type);\n    appendAnnotation(Type, key);\n  }\n\n  return dependencies;\n}\n\nfunction getOrCreateAnnotationParamTypes(Type: Constructable | Injectable): Key[] {\n  const key = getAnnotationKeyFor('di:paramtypes');\n  let annotationParamtypes = getOwnMetadata(key, Type);\n  if (annotationParamtypes === void 0) {\n    defineMetadata(key, annotationParamtypes = [], Type);\n    appendAnnotation(Type, key);\n  }\n  return annotationParamtypes;\n}\n\nexport const IContainer = DI.createInterface<IContainer>('IContainer');\nexport const IServiceLocator = IContainer as unknown as InterfaceSymbol<IServiceLocator>;\n\nfunction createResolver(getter: (key: any, handler: IContainer, requestor: IContainer) => any): (key: any) => any {\n  return function (key: any): ReturnType<typeof DI.inject> {\n    const resolver: ReturnType<typeof DI.inject> & Partial<Pick<IResolver, 'resolve'>> & { $isResolver: true} = function (target: Injectable, property?: string | number, descriptor?: PropertyDescriptor | number): void {\n      DI.inject(resolver)(target, property, descriptor);\n    };\n\n    resolver.$isResolver = true;\n    resolver.resolve = function (handler: IContainer, requestor: IContainer): any {\n      return getter(key, handler, requestor);\n    };\n\n    return resolver;\n  };\n}\n\nexport const inject = DI.inject;\n\nfunction transientDecorator<T extends Constructable>(target: T & Partial<RegisterSelf<T>>):\n  T & RegisterSelf<T> {\n  return DI.transient(target);\n}\n/**\n * Registers the decorated class as a transient dependency; each time the dependency is resolved\n * a new instance will be created.\n *\n * @example ```ts\n * &#64;transient()\n * class Foo { }\n * ```\n */\nexport function transient<T extends Constructable>(): typeof transientDecorator;\n/**\n * Registers the `target` class as a transient dependency; each time the dependency is resolved\n * a new instance will be created.\n *\n * @param target - The class / constructor function to register as transient.\n *\n * @example ```ts\n * &#64;transient()\n * class Foo { }\n * ```\n */\nexport function transient<T extends Constructable>(target: T & Partial<RegisterSelf<T>>): T & RegisterSelf<T>;\nexport function transient<T extends Constructable>(target?: T & Partial<RegisterSelf<T>>): T & RegisterSelf<T> | typeof transientDecorator {\n  return target == null ? transientDecorator : transientDecorator(target);\n}\n\ntype SingletonOptions = { scoped: boolean };\nconst defaultSingletonOptions = { scoped: false };\n\nfunction singletonDecorator<T extends Constructable>(target: T & Partial<RegisterSelf<T>>): T & RegisterSelf<T> {\n  return DI.singleton(target);\n}\n/**\n * Registers the decorated class as a singleton dependency; the class will only be created once. Each\n * consecutive time the dependency is resolved, the same instance will be returned.\n *\n * @example ```ts\n * &#64;singleton()\n * class Foo { }\n * ```\n */\nexport function singleton<T extends Constructable>(): typeof singletonDecorator;\nexport function singleton<T extends Constructable>(options?: SingletonOptions): typeof singletonDecorator;\n/**\n * Registers the `target` class as a singleton dependency; the class will only be created once. Each\n * consecutive time the dependency is resolved, the same instance will be returned.\n *\n * @param target - The class / constructor function to register as a singleton.\n *\n * @example ```ts\n * &#64;singleton()\n * class Foo { }\n * ```\n */\nexport function singleton<T extends Constructable>(target: T & Partial<RegisterSelf<T>>): T & RegisterSelf<T>;\nexport function singleton<T extends Constructable>(targetOrOptions?: (T & Partial<RegisterSelf<T>>) | SingletonOptions): T & RegisterSelf<T> | typeof singletonDecorator {\n  if (isFunction(targetOrOptions)) {\n    return DI.singleton(targetOrOptions);\n  }\n  return function <T extends Constructable>($target: T) {\n    return DI.singleton($target, targetOrOptions);\n  };\n}\n\nfunction createAllResolver(\n  getter: (key: any, handler: IContainer, requestor: IContainer, searchAncestors: boolean) => readonly any[]\n): (key: any, searchAncestors?: boolean) => ReturnType<typeof DI.inject> {\n  return function (key: any, searchAncestors?: boolean): ReturnType<typeof DI.inject> {\n    searchAncestors = !!searchAncestors;\n    const resolver: ReturnType<typeof DI.inject>\n      & Required<Pick<IResolver, 'resolve'>>\n      & { $isResolver: true}\n      = function (\n          target: Injectable,\n          property?: string | number,\n          descriptor?: PropertyDescriptor | number\n        ): void {\n          DI.inject(resolver)(target, property, descriptor);\n        };\n\n    resolver.$isResolver = true;\n    resolver.resolve = function (handler: IContainer, requestor: IContainer): any {\n      return getter(key, handler, requestor, searchAncestors!);\n    };\n\n    return resolver;\n  };\n}\n\nexport const all = createAllResolver(\n  (key: any,\n    handler: IContainer,\n    requestor: IContainer,\n    searchAncestors: boolean\n  ) => requestor.getAll(key, searchAncestors)\n);\n\n/**\n * Lazily inject a dependency depending on whether the [[`Key`]] is present at the time of function call.\n *\n * You need to make your argument a function that returns the type, for example\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => number )\n * }\n * const foo = container.get(Foo); // instanceof Foo\n * foo.random(); // throws\n * ```\n * would throw an exception because you haven't registered `'random'` before calling the method. This, would give you a\n * new [['Math.random()']] number each time.\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => random )\n * }\n * container.register(Registration.callback('random', Math.random ));\n * container.get(Foo).random(); // some random number\n * container.get(Foo).random(); // another random number\n * ```\n * `@lazy` does not manage the lifecycle of the underlying key. If you want a singleton, you have to register as a\n * `singleton`, `transient` would also behave as you would expect, providing you a new instance each time.\n *\n * - @param key [[`Key`]]\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const lazy = createResolver((key: Key, handler: IContainer, requestor: IContainer) =>  {\n  return () => requestor.get(key);\n});\nexport type ILazyResolver<K = any> = IResolver<K>\n  // type only hack\n  & { __isLazy: undefined }\n  // any is needed for decorator usages\n  & ((...args: unknown[]) => any);\nexport type IResolvedLazy<K> = () => Resolved<K>;\n\n/**\n * Allows you to optionally inject a dependency depending on whether the [[`Key`]] is present, for example\n * ```ts\n * class Foo {\n *   constructor( @inject('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo); // throws\n * ```\n * would fail\n * ```ts\n * class Foo {\n *   constructor( @optional('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo).str // somestring\n * ```\n * if you use it without a default it will inject `undefined`, so rember to mark your input type as\n * possibly `undefined`!\n *\n * - @param key: [[`Key`]]\n *\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const optional = createResolver((key: Key, handler: IContainer, requestor: IContainer) =>  {\n  if (requestor.has(key, true)) {\n    return requestor.get(key);\n  } else {\n    return undefined;\n  }\n});\n/**\n * ignore tells the container not to try to inject a dependency\n */\nexport function ignore(target: Injectable, property?: string | number, descriptor?: PropertyDescriptor | number): void {\n  DI.inject(ignore)(target, property, descriptor);\n}\nignore.$isResolver = true;\nignore.resolve = () => undefined;\n\n/**\n * Inject a function that will return a resolved instance of the [[key]] given.\n * Also supports passing extra parameters to the invocation of the resolved constructor of [[key]]\n *\n * For typings, it's a function that take 0 or more arguments and return an instance. Example:\n * ```ts\n * class Foo {\n *   constructor( @factory(MyService) public createService: (...args: unknown[]) => MyService)\n * }\n * const foo = container.get(Foo); // instanceof Foo\n * const myService_1 = foo.createService('user service')\n * const myService_2 = foo.createService('content service')\n * ```\n *\n * ```ts\n * class Foo {\n *   constructor( @factory('random') public createRandomizer: () => Randomizer)\n * }\n * container.get(Foo).createRandomizer(); // create a randomizer\n * ```\n * would throw an exception because you haven't registered `'random'` before calling the method. This, would give you a\n * new instance of Randomizer each time.\n *\n * `@factory` does not manage the lifecycle of the underlying key. If you want a singleton, you have to register as a\n * `singleton`, `transient` would also behave as you would expect, providing you a new instance each time.\n *\n * - @param key [[`Key`]]\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const factory = createResolver((key: any, handler: IContainer, requestor: IContainer) => {\n  return (...args: unknown[]) => handler.getFactory(key).construct(requestor, args);\n}) as <K>(key: K) => IFactoryResolver<K>;\nexport type IFactoryResolver<K = any> = IResolver<K>\n  // type only hack\n  & { __isFactory: undefined }\n  // any is needed for decorator usage\n  & ((...args: unknown[]) => any);\nexport type IResolvedFactory<K> = (...args: unknown[]) => Resolved<K>;\n\nexport const newInstanceForScope = createResolver(\n  (key: any, handler: IContainer, requestor: IContainer) => {\n    const instance = createNewInstance(key, handler, requestor);\n    const instanceProvider: InstanceProvider<any> = new InstanceProvider<any>(String(key), instance);\n    /**\n     * By default the new instances for scope are disposable.\n     * If need be, we can always enhance the `createNewInstance` to support a 'injection' context, to make a non/disposable registration here.\n     */\n    requestor.registerResolver(key, instanceProvider, true);\n\n    return instance;\n  }) as <K>(key: K) => INewInstanceResolver<K>;\n\nexport const newInstanceOf = createResolver(\n  (key: any, handler: IContainer, requestor: IContainer) => createNewInstance(key, handler, requestor)\n) as <K>(key: K) => INewInstanceResolver<K>;\n\nexport type INewInstanceResolver<T> = {\n  __newInstance: undefined;\n  // any is needed for decorator usage\n  (...args: unknown[]): any;\n};\n\nfunction createNewInstance(key: any, handler: IContainer, requestor: IContainer) {\n  return handler.getFactory(key).construct(requestor);\n}\n\n/** @internal */\nexport const enum ResolverStrategy {\n  instance = 0,\n  singleton = 1,\n  transient = 2,\n  callback = 3,\n  array = 4,\n  alias = 5\n}\n\n/** @internal */\nexport class Resolver implements IResolver, IRegistration {\n  public constructor(\n    public key: Key,\n    public strategy: ResolverStrategy,\n    public state: any,\n  ) {}\n\n  public get $isResolver(): true { return true; }\n\n  private resolving: boolean = false;\n\n  public register(container: IContainer, key?: Key): IResolver {\n    return container.registerResolver(key || this.key, this);\n  }\n\n  public resolve(handler: IContainer, requestor: IContainer): any {\n    switch (this.strategy) {\n      case ResolverStrategy.instance:\n        return this.state;\n      case ResolverStrategy.singleton: {\n        if (this.resolving) {\n          if (__DEV__) {\n            throw new Error(`Cyclic dependency found: ${this.state.name}`);\n          } else {\n            throw new Error(`AUR0003:${this.state.name}`);\n          }\n        }\n        this.resolving = true;\n        this.state = handler.getFactory(this.state as Constructable).construct(requestor);\n        this.strategy = ResolverStrategy.instance;\n        this.resolving = false;\n        return this.state;\n      }\n      case ResolverStrategy.transient: {\n        // Always create transients from the requesting container\n        const factory = handler.getFactory(this.state as Constructable);\n        if (factory === null) {\n          if (__DEV__) {\n            throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n          } else {\n            throw new Error(`AUR0004:${String(this.key)}`);\n          }\n        }\n        return factory.construct(requestor);\n      }\n      case ResolverStrategy.callback:\n        return (this.state as ResolveCallback)(handler, requestor, this);\n      case ResolverStrategy.array:\n        return (this.state as IResolver[])[0].resolve(handler, requestor);\n      case ResolverStrategy.alias:\n        return requestor.get(this.state);\n      default:\n        if (__DEV__) {\n          throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`);\n        } else {\n          throw new Error(`AUR0005:${this.strategy}`);\n        }\n    }\n  }\n\n  public getFactory(container: IContainer): IFactory | null {\n    switch (this.strategy) {\n      case ResolverStrategy.singleton:\n      case ResolverStrategy.transient:\n        return container.getFactory(this.state as Constructable);\n      case ResolverStrategy.alias:\n        return container.getResolver(this.state)?.getFactory?.(container) ?? null;\n      default:\n        return null;\n    }\n  }\n}\n\n/** @internal */\nexport interface IInvoker<T extends Constructable = any> {\n  invoke(container: IContainer, fn: T, dependencies: Key[]): Resolved<T>;\n  invokeWithDynamicDependencies(\n    container: IContainer,\n    fn: T,\n    staticDependencies: Key[],\n    dynamicDependencies: Key[]\n  ): Resolved<T>;\n}\n\nfunction containerGetKey(this: IContainer, d: Key) {\n  return this.get(d);\n}\n\nfunction transformInstance<T>(inst: Resolved<T>, transform: (instance: any) => any) {\n  return transform(inst);\n}\n\n/** @internal */\nexport class Factory<T extends Constructable = any> implements IFactory<T> {\n  private transformers: ((instance: any) => any)[] | null = null;\n  public constructor(\n    public Type: T,\n    private readonly dependencies: Key[],\n  ) {}\n\n  public construct(container: IContainer, dynamicDependencies?: unknown[]): Resolved<T> {\n    let instance: Resolved<T>;\n    if (dynamicDependencies === void 0) {\n      instance = new this.Type(...this.dependencies.map(containerGetKey, container)) as Resolved<T>;\n    } else {\n      instance = new this.Type(...this.dependencies.map(containerGetKey, container), ...dynamicDependencies) as Resolved<T>;\n    }\n\n    if (this.transformers == null) {\n      return instance;\n    }\n\n    return this.transformers.reduce(transformInstance, instance);\n  }\n\n  public registerTransformer(transformer: (instance: any) => any): void {\n    (this.transformers ??= []).push(transformer);\n  }\n}\n\nconst containerResolver: IResolver = {\n  $isResolver: true,\n  resolve(handler: IContainer, requestor: IContainer): IContainer {\n    return requestor;\n  }\n};\n\nfunction isRegistry(obj: IRegistry | Record<string, IRegistry>): obj is IRegistry {\n  return isFunction(obj.register);\n}\n\nfunction isSelfRegistry<T extends Constructable>(obj: RegisterSelf<T>): obj is RegisterSelf<T> {\n  return isRegistry(obj) && typeof obj.registerInRequestor === 'boolean';\n}\n\nfunction isRegisterInRequester<T extends Constructable>(obj: RegisterSelf<T>): obj is RegisterSelf<T> {\n  return isSelfRegistry(obj) && obj.registerInRequestor;\n}\n\nfunction isClass<T extends { prototype?: any }>(obj: T): obj is Class<any, T> {\n  return obj.prototype !== void 0;\n}\n\nfunction isResourceKey(key: Key): key is string {\n  return isString(key) && key.indexOf(':') > 0;\n}\n\nconst InstrinsicTypeNames = new Set<string>([\n  'Array',\n  'ArrayBuffer',\n  'Boolean',\n  'DataView',\n  'Date',\n  'Error',\n  'EvalError',\n  'Float32Array',\n  'Float64Array',\n  'Function',\n  'Int8Array',\n  'Int16Array',\n  'Int32Array',\n  'Map',\n  'Number',\n  'Object',\n  'Promise',\n  'RangeError',\n  'ReferenceError',\n  'RegExp',\n  'Set',\n  'SharedArrayBuffer',\n  'String',\n  'SyntaxError',\n  'TypeError',\n  'Uint8Array',\n  'Uint8ClampedArray',\n  'Uint16Array',\n  'Uint32Array',\n  'URIError',\n  'WeakMap',\n  'WeakSet',\n]);\n\n// const factoryKey = 'di:factory';\n// const factoryAnnotationKey = Protocol.annotation.keyFor(factoryKey);\nlet containerId = 0;\n/** @internal */\nexport class Container implements IContainer {\n  public readonly id: number = ++containerId;\n  private _registerDepth: number = 0;\n\n  public get depth(): number {\n    return this.parent === null ? 0 : this.parent.depth + 1;\n  }\n  public readonly root: Container;\n\n  /**\n   * All own resolvers of this container\n   */\n  private readonly _resolvers: Map<Key, IResolver | IDisposableResolver>;\n  /**\n   * A map of Factory per Constructor (Type) of this container tree.\n   *\n   * Factories are \"global\" per container tree\n   */\n  private readonly _factories: Map<Constructable, Factory>;\n\n  /**\n   * A map of all resources resolver by their key\n   */\n  private res: Record<string, IResolver | IDisposableResolver | undefined>;\n\n  private readonly _disposableResolvers: Map<Key, IDisposableResolver> = new Map<Key, IDisposableResolver>();\n\n  public constructor(\n    private readonly parent: Container | null,\n    private readonly config: ContainerConfiguration,\n  ) {\n    if (parent === null) {\n      this.root = this;\n\n      this._resolvers = new Map();\n      this._factories = new Map<Constructable, Factory>();\n\n      this.res = createObject();\n    } else {\n      this.root = parent.root;\n\n      this._resolvers = new Map();\n      this._factories = parent._factories;\n\n      if (config.inheritParentResources) {\n        this.res = Object.assign(\n          createObject(),\n          parent.res,\n          this.root.res,\n        );\n      } else {\n        this.res = createObject();\n      }\n    }\n\n    this._resolvers.set(IContainer, containerResolver);\n  }\n\n  public register(...params: any[]): IContainer {\n    if (++this._registerDepth === 100) {\n      // TODO: change to reporter.error and add various possible causes in description.\n      // Most likely cause is trying to register a plain object that does not have a\n      // register method and is not a class constructor\n      if (__DEV__) {\n        throw new Error(`Unable to autoregister dependency: [${params.map(String)}]`);\n      } else {\n        throw new Error(`AUR0006:${params.map(String)}`);\n      }\n    }\n    let current: IRegistry | Record<string, IRegistry>;\n    let keys: string[];\n    let value: IRegistry;\n    let j: number;\n    let jj: number;\n    let i = 0;\n    // eslint-disable-next-line\n    let ii = params.length;\n    for (; i < ii; ++i) {\n      current = params[i];\n      if (!isObject(current)) {\n        continue;\n      }\n      if (isRegistry(current)) {\n        current.register(this);\n      } else if (Protocol.resource.has(current)) {\n        const defs = Protocol.resource.getAll(current);\n        if (defs.length === 1) {\n          // Fast path for the very common case\n          defs[0].register(this);\n        } else {\n          j = 0;\n          jj = defs.length;\n          while (jj > j) {\n            defs[j].register(this);\n            ++j;\n          }\n        }\n      } else if (isClass(current)) {\n        Registration.singleton(current, current as Constructable).register(this);\n      } else {\n        keys = Object.keys(current);\n        j = 0;\n        jj = keys.length;\n        for (; j < jj; ++j) {\n          value = current[keys[j]];\n          if (!isObject(value)) {\n            continue;\n          }\n          // note: we could remove this if-branch and call this.register directly\n          // - the extra check is just a perf tweak to create fewer unnecessary arrays by the spread operator\n          if (isRegistry(value)) {\n            value.register(this);\n          } else {\n            this.register(value);\n          }\n        }\n      }\n    }\n    --this._registerDepth;\n    return this;\n  }\n\n  public registerResolver<K extends Key, T = K>(key: K, resolver: IResolver<T>, isDisposable: boolean = false): IResolver<T> {\n    validateKey(key);\n\n    const resolvers = this._resolvers;\n    const result = resolvers.get(key);\n\n    if (result == null) {\n      resolvers.set(key, resolver);\n      if (isResourceKey(key)) {\n        if (this.res[key] !== void 0) {\n          if (__DEV__) {\n            throw new Error(`Resource key \"${key}\" already registered`);\n          } else {\n            throw new Error(`AUR0007:${key}`);\n          }\n        }\n        this.res[key] = resolver;\n      }\n    } else if (result instanceof Resolver && result.strategy === ResolverStrategy.array) {\n      (result.state as IResolver[]).push(resolver);\n    } else {\n      resolvers.set(key, new Resolver(key, ResolverStrategy.array, [result, resolver]));\n    }\n\n    if (isDisposable) {\n      this._disposableResolvers.set(key, resolver as IDisposableResolver<T>);\n    }\n\n    return resolver;\n  }\n\n  // public deregisterResolverFor<K extends Key>(key: K, searchAncestors: boolean): void {\n  //   validateKey(key);\n\n  //   // eslint-disable-next-line @typescript-eslint/no-this-alias\n  //   let current: Container | null = this;\n  //   let resolver: IResolver | undefined;\n\n  //   while (current != null) {\n  //     resolver = current._resolvers.get(key);\n\n  //     if (resolver != null) {\n  //       current._resolvers.delete(key);\n  //       break;\n  //     }\n  //     if (current.parent == null) { return; }\n  //     current = searchAncestors ? current.parent : null;\n  //   }\n\n  //   if (resolver == null) { return; }\n  //   if (resolver instanceof Resolver && resolver.strategy === ResolverStrategy.array) {\n  //     throw new Error('Cannot deregister a resolver with array strategy');\n  //   }\n  //   if (this._disposableResolvers.has(resolver as IDisposableResolver<K>)) {\n  //     (resolver as IDisposableResolver<K>).dispose();\n  //   }\n  //   if (isResourceKey(key)) {\n  //     // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n  //     delete this.res[key];\n  //   }\n  // }\n\n  public registerTransformer<K extends Key, T = K>(key: K, transformer: Transformer<T>): boolean {\n    const resolver = this.getResolver(key);\n\n    if (resolver == null) {\n      return false;\n    }\n\n    if (resolver.getFactory) {\n      const factory = resolver.getFactory(this);\n\n      if (factory == null) {\n        return false;\n      }\n\n      // This type cast is a bit of a hacky one, necessary due to the duplicity of IResolverLike.\n      // Problem is that that interface's type arg can be of type Key, but the getFactory method only works on\n      // type Constructable. So the return type of that optional method has this additional constraint, which\n      // seems to confuse the type checker.\n      factory.registerTransformer(transformer as unknown as Transformer<Constructable>);\n      return true;\n    }\n\n    return false;\n  }\n\n  public getResolver<K extends Key, T = K>(key: K | Key, autoRegister: boolean = true): IResolver<T> | null {\n    validateKey(key);\n\n    if ((key as unknown as IResolver).resolve !== void 0) {\n      return key as unknown as IResolver;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    let current: Container = this;\n    let resolver: IResolver | undefined;\n\n    while (current != null) {\n      resolver = current._resolvers.get(key);\n\n      if (resolver == null) {\n        if (current.parent == null) {\n          const handler = (isRegisterInRequester(key as unknown as RegisterSelf<Constructable>)) ? this : current;\n          return autoRegister ? this._jitRegister(key, handler) : null;\n        }\n\n        current = current.parent;\n      } else {\n        return resolver;\n      }\n    }\n\n    return null;\n  }\n\n  public has<K extends Key>(key: K, searchAncestors: boolean = false): boolean {\n    return this._resolvers.has(key)\n      ? true\n      : searchAncestors && this.parent != null\n        ? this.parent.has(key, true)\n        : false;\n  }\n\n  public get<K extends Key>(key: K): Resolved<K> {\n    validateKey(key);\n\n    if ((key as IResolver).$isResolver) {\n      return (key as IResolver).resolve(this, this);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    let current: Container = this;\n    let resolver: IResolver | undefined;\n\n    while (current != null) {\n      resolver = current._resolvers.get(key);\n\n      if (resolver == null) {\n        if (current.parent == null) {\n          const handler = (isRegisterInRequester(key as unknown as RegisterSelf<Constructable>)) ? this : current;\n          resolver = this._jitRegister(key, handler);\n          return resolver.resolve(current, this);\n        }\n\n        current = current.parent;\n      } else {\n        return resolver.resolve(current, this);\n      }\n    }\n\n    if (__DEV__) {\n      throw new Error(`Unable to resolve key: ${key}`);\n    } else {\n      throw new Error(`AUR0008:${key}`);\n    }\n  }\n\n  public getAll<K extends Key>(key: K, searchAncestors: boolean = false): readonly Resolved<K>[] {\n    validateKey(key);\n\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const requestor = this;\n    let current: Container | null = requestor;\n    let resolver: IResolver | undefined;\n\n    if (searchAncestors) {\n      let resolutions: any[] = emptyArray;\n      while (current != null) {\n        resolver = current._resolvers.get(key);\n        if (resolver != null) {\n          resolutions = resolutions.concat(buildAllResponse(resolver, current, requestor));\n        }\n        current = current.parent;\n      }\n      return resolutions;\n    } else {\n      while (current != null) {\n        resolver = current._resolvers.get(key);\n\n        if (resolver == null) {\n          current = current.parent;\n\n          if (current == null) {\n            return emptyArray;\n          }\n        } else {\n          return buildAllResponse(resolver, current, requestor);\n        }\n      }\n    }\n\n    return emptyArray;\n  }\n\n  public invoke<T, TDeps extends unknown[] = unknown[]>(Type: Constructable<T>, dynamicDependencies?: TDeps): T {\n    if (isNativeFunction(Type)) {\n      throw createNativeInvocationError(Type);\n    }\n    if (dynamicDependencies === void 0) {\n      return new Type(...getDependencies(Type).map(containerGetKey, this));\n    } else {\n      return new Type(...getDependencies(Type).map(containerGetKey, this), ...dynamicDependencies);\n    }\n  }\n\n  public getFactory<K extends Constructable>(Type: K): IFactory<K> {\n    let factory = this._factories.get(Type);\n    if (factory === void 0) {\n      if (isNativeFunction(Type)) {\n        throw createNativeInvocationError(Type);\n      }\n      this._factories.set(Type, factory = new Factory<K>(Type, getDependencies(Type)));\n    }\n    return factory;\n  }\n\n  public registerFactory<K extends Constructable>(key: K, factory: IFactory<K>): void {\n    this._factories.set(key, factory as Factory);\n  }\n\n  public createChild(config?: Partial<IContainerConfiguration>): IContainer {\n    if (config === void 0 && this.config.inheritParentResources) {\n      if (this.config === ContainerConfiguration.DEFAULT) {\n        return new Container(this, this.config);\n      }\n      return new Container(\n        this,\n        ContainerConfiguration.from({\n          ...this.config,\n          inheritParentResources: false,\n        }),\n      );\n    }\n    return new Container(this, ContainerConfiguration.from(config ?? this.config));\n  }\n\n  public disposeResolvers(): void {\n    const resolvers = this._resolvers;\n    const disposableResolvers = this._disposableResolvers;\n\n    let disposable: IDisposable;\n    let key: Key;\n\n    for ([key, disposable] of disposableResolvers.entries()) {\n      disposable.dispose();\n      resolvers.delete(key);\n    }\n    disposableResolvers.clear();\n  }\n\n  public find<TType extends ResourceType, TDef extends ResourceDefinition>(kind: IResourceKind<TType, TDef>, name: string): TDef | null {\n    const key = kind.keyFrom(name);\n    let resolver = this.res[key];\n    if (resolver === void 0) {\n      resolver = this.root.res[key];\n      if (resolver === void 0) {\n        return null;\n      }\n    }\n\n    if (resolver === null) {\n      return null;\n    }\n\n    if (isFunction(resolver.getFactory)) {\n      const factory = resolver.getFactory(this);\n      if (factory === null || factory === void 0) {\n        return null;\n      }\n\n      const definition = getOwnMetadata(kind.name, factory.Type);\n      if (definition === void 0) {\n        // TODO: we may want to log a warning here, or even throw. This would happen if a dependency is registered with a resource-like key\n        // but does not actually have a definition associated via the type's metadata. That *should* generally not happen.\n        return null;\n      }\n\n      return definition;\n    }\n\n    return null;\n  }\n\n  public create<TType extends ResourceType, TDef extends ResourceDefinition>(kind: IResourceKind<TType, TDef>, name: string): InstanceType<TType> | null {\n    const key = kind.keyFrom(name);\n    let resolver = this.res[key];\n    if (resolver === void 0) {\n      resolver = this.root.res[key];\n      if (resolver === void 0) {\n        return null;\n      }\n      return resolver.resolve(this.root, this) ?? null;\n    }\n    return resolver.resolve(this, this) ?? null;\n  }\n\n  public dispose(): void {\n    if (this._disposableResolvers.size > 0) {\n      this.disposeResolvers();\n    }\n    this._resolvers.clear();\n  }\n\n  /** @internal */\n  private _jitRegister(keyAsValue: any, handler: Container): IResolver {\n    if (!isFunction(keyAsValue)) {\n      if (__DEV__) {\n        throw new Error(`Attempted to jitRegister something that is not a constructor: '${keyAsValue}'. Did you forget to register this resource?`);\n      } else {\n        throw new Error(`AUR0009:${keyAsValue}`);\n      }\n    }\n    if (InstrinsicTypeNames.has(keyAsValue.name)) {\n      if (__DEV__) {\n        throw new Error(`Attempted to jitRegister an intrinsic type: ${keyAsValue.name}. Did you forget to add @inject(Key)`);\n      } else {\n        throw new Error(`AUR0010:${keyAsValue.name}`);\n      }\n    }\n\n    if (isRegistry(keyAsValue)) {\n      const registrationResolver = keyAsValue.register(handler, keyAsValue);\n      if (!(registrationResolver instanceof Object) || (registrationResolver as IResolver).resolve == null) {\n        const newResolver = handler._resolvers.get(keyAsValue);\n        if (newResolver != null) {\n          return newResolver;\n        }\n        if (__DEV__) {\n          throw new Error(`Invalid resolver returned from the static register method`);\n        } else {\n          throw new Error(`AUR0011`);\n        }\n      }\n      return registrationResolver as IResolver;\n    } else if (Protocol.resource.has(keyAsValue)) {\n      const defs = Protocol.resource.getAll(keyAsValue);\n      if (defs.length === 1) {\n        // Fast path for the very common case\n        defs[0].register(handler);\n      } else {\n        const len = defs.length;\n        for (let d = 0; d < len; ++d) {\n          defs[d].register(handler);\n        }\n      }\n      const newResolver = handler._resolvers.get(keyAsValue);\n      if (newResolver != null) {\n        return newResolver;\n      }\n      if (__DEV__) {\n        throw new Error(`Invalid resolver returned from the static register method`);\n      } else {\n        throw new Error(`AUR0011`);\n      }\n    } else if (keyAsValue.$isInterface) {\n      if (__DEV__) {\n        throw new Error(`Attempted to jitRegister an interface: ${keyAsValue.friendlyName}`);\n      } else {\n        throw new Error(`AUR0012:${keyAsValue.friendlyName}`);\n      }\n    } else {\n      const resolver = this.config.defaultResolver(keyAsValue, handler);\n      handler._resolvers.set(keyAsValue, resolver);\n      return resolver;\n    }\n  }\n}\n\n/**\n * An implementation of IRegistry that delegates registration to a\n * separately registered class. The ParameterizedRegistry facilitates the\n * passing of parameters to the final registry.\n */\nexport class ParameterizedRegistry implements IRegistry {\n  public constructor(\n    private readonly key: Key,\n    private readonly params: unknown[]\n  ) {}\n\n  public register(container: IContainer): void {\n    if (container.has(this.key, true)) {\n      const registry = container.get<IRegistry>(this.key);\n      registry.register(container, ...this.params);\n    } else {\n      container.register(...this.params.filter(x => typeof x === 'object'));\n    }\n  }\n}\n\ntype ResolverLookup = WeakMap<IResolver, unknown>;\nconst containerLookup = new WeakMap<IContainer, ResolverLookup>();\n\nfunction cacheCallbackResult<T>(fun: ResolveCallback<T>): ResolveCallback<T> {\n  return function (handler: IContainer, requestor: IContainer, resolver: IResolver): T {\n    let resolverLookup = containerLookup.get(handler);\n    if (resolverLookup === void 0) {\n      containerLookup.set(handler, resolverLookup = new WeakMap());\n    }\n    if (resolverLookup.has(resolver)) {\n      return resolverLookup.get(resolver) as T;\n    }\n    const t = fun(handler, requestor, resolver);\n    resolverLookup.set(resolver, t);\n    return t;\n  };\n}\n\n/**\n * you can use the resulting {@linkcode IRegistration} of any of the factory methods\n * to register with the container, e.g.\n * ```\n * class Foo {}\n * const container = DI.createContainer();\n * container.register(Registration.instance(Foo, new Foo()));\n * container.get(Foo);\n * ```\n */\nexport const Registration = {\n  /**\n   * allows you to pass an instance.\n   * Every time you request this {@linkcode Key} you will get this instance back.\n   * ```\n   * Registration.instance(Foo, new Foo()));\n   * ```\n   *\n   * @param key - key to register the instance with\n   * @param value - the instance associated with the key\n   */\n  instance<T>(key: Key, value: T): IRegistration<T> {\n    return new Resolver(key, ResolverStrategy.instance, value);\n  },\n  /**\n   * Creates an instance from the class.\n   * Every time you request this {@linkcode Key} you will get the same one back.\n   * ```\n   * Registration.singleton(Foo, Foo);\n   * ```\n   *\n   * @param key - key to register the singleton class with\n   * @param value - the singleton class to instantiate when a container resolves the associated key\n   */\n  singleton<T extends Constructable>(key: Key, value: T): IRegistration<InstanceType<T>> {\n    return new Resolver(key, ResolverStrategy.singleton, value);\n  },\n  /**\n   * Creates an instance from a class.\n   * Every time you request this {@linkcode Key} you will get a new instance.\n   * ```\n   * Registration.instance(Foo, Foo);\n   * ```\n   *\n   * @param key - key to register the transient class with\n   * @param value - the class to instantiate when a container resolves the associated key\n   */\n  transient<T extends Constructable>(key: Key, value: T): IRegistration<InstanceType<T>> {\n    return new Resolver(key, ResolverStrategy.transient, value);\n  },\n  /**\n   * Creates an instance from the method passed.\n   * Every time you request this {@linkcode Key} you will get a new instance.\n   * ```\n   * Registration.callback(Foo, () => new Foo());\n   * Registration.callback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n   * ```\n   *\n   * @param key - key to register the callback with\n   * @param callback - the callback to invoke when a container resolves the associated key\n   */\n  callback<T>(key: Key, callback: ResolveCallback<T>): IRegistration<Resolved<T>> {\n    return new Resolver(key, ResolverStrategy.callback, callback);\n  },\n  /**\n   * Creates an instance from the method passed.\n   * On the first request for the {@linkcode Key} your callback is called and returns an instance.\n   * subsequent requests for the {@linkcode Key}, the initial instance returned will be returned.\n   * If you pass the same {@linkcode Registration} to another container the same cached value will be used.\n   * Should all references to the resolver returned be removed, the cache will expire.\n   * ```\n   * Registration.cachedCallback(Foo, () => new Foo());\n   * Registration.cachedCallback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n   * ```\n   *\n   * @param key - key to register the cached callback with\n   * @param callback - the cache callback to invoke when a container resolves the associated key\n   */\n  cachedCallback<T>(key: Key, callback: ResolveCallback<T>): IRegistration<Resolved<T>> {\n    return new Resolver(key, ResolverStrategy.callback, cacheCallbackResult(callback));\n  },\n  /**\n   * creates an alternate {@linkcode Key} to retrieve an instance by.\n   * Returns the same scope as the original {@linkcode Key}.\n   * ```\n   * Register.singleton(Foo, Foo)\n   * Register.aliasTo(Foo, MyFoos);\n   *\n   * container.getAll(MyFoos) // contains an instance of Foo\n   * ```\n   *\n   * @param originalKey - the real key to resolve the get call from a container\n   * @param aliasKey - the key that a container allows to resolve the real key associated\n   */\n  aliasTo<T>(originalKey: T, aliasKey: Key): IRegistration<Resolved<T>> {\n    return new Resolver(aliasKey, ResolverStrategy.alias, originalKey);\n  },\n  /**\n   * @internal\n   * @param key - the key to register a defer registration\n   * @param params - the parameters that should be passed to the resolution of the key\n   */\n  defer(key: Key, ...params: unknown[]): IRegistry {\n    return new ParameterizedRegistry(key, params);\n  }\n};\n\nexport class InstanceProvider<K extends Key> implements IDisposableResolver<K | null> {\n  /** @internal */ private _instance: Resolved<K> | null = null;\n  /** @internal */ private readonly _name?: string;\n\n  public get friendlyName() {\n    return this._name;\n  }\n\n  public constructor(\n    name?: string,\n    /**\n     * if not undefined, then this is the value this provider will resolve to\n     * until overridden by explicit prepare call\n     */\n    instance?: Resolved<K> | null,\n  ) {\n    this._name = name;\n    if (instance !== void 0) {\n      this._instance = instance;\n    }\n  }\n\n  public prepare(instance: Resolved<K>): void {\n    this._instance = instance;\n  }\n\n  public get $isResolver(): true {return true;}\n\n  public resolve(): Resolved<K> | null {\n    if (this._instance == null) {\n      if (__DEV__) {\n        throw new Error(`Cannot call resolve ${this._name} before calling prepare or after calling dispose.`);\n      } else {\n        throw new Error(`AUR0013:${this._name}`);\n      }\n    }\n    return this._instance;\n  }\n\n  public dispose(): void {\n    this._instance = null;\n  }\n}\n\n/** @internal */\nexport function validateKey(key: any): void {\n  if (key === null || key === void 0) {\n    if (__DEV__) {\n      throw new Error('key/value cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?');\n    } else {\n      throw new Error(`AUR0014`);\n    }\n  }\n}\n\nfunction buildAllResponse(resolver: IResolver, handler: IContainer, requestor: IContainer): any[] {\n  if (resolver instanceof Resolver && resolver.strategy === ResolverStrategy.array) {\n    const state = resolver.state as IResolver[];\n    let i = state.length;\n    const results = new Array(i);\n\n    while (i--) {\n      results[i] = state[i].resolve(handler, requestor);\n    }\n\n    return results;\n  }\n\n  return [resolver.resolve(handler, requestor)];\n}\n\nfunction createNativeInvocationError(Type: Constructable): Error {\n  if (__DEV__) {\n    return new Error(`${Type.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);\n  }\n  return new Error(`AUR0015:${Type.name}`);\n}\n","import { Platform } from '@aurelia/platform';\nimport { DI } from './di.js';\n\nexport const emptyArray: any[] = Object.freeze<any>([]) as any;\nexport const emptyObject: any = Object.freeze({}) as any;\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function noop(): void {}\n\nexport interface IPlatform extends Platform {}\nexport const IPlatform = DI.createInterface<IPlatform>('IPlatform');\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","import { all, DI, IContainer, ignore, IRegistry, optional, Registration } from './di.js';\nimport { bound, toLookup } from './functions.js';\nimport { Class, Constructable } from './interfaces.js';\nimport { getAnnotationKeyFor } from './resource.js';\nimport { Metadata } from '@aurelia/metadata';\nimport { IPlatform } from './platform.js';\nimport { createObject, defineMetadata, isFunction } from './utilities.js';\n\nexport const enum LogLevel {\n  /**\n   * The most detailed information about internal app state.\n   *\n   * Disabled by default and should never be enabled in a production environment.\n   */\n  trace = 0,\n  /**\n   * Information that is useful for debugging during development and has no long-term value.\n   */\n  debug = 1,\n  /**\n   * Information about the general flow of the application that has long-term value.\n   */\n  info = 2,\n  /**\n   * Unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n   */\n  warn = 3,\n  /**\n   * Unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n   */\n  error = 4,\n  /**\n   * Unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n   */\n  fatal = 5,\n  /**\n   * No messages should be written.\n   */\n  none = 6,\n}\n\n/**\n * Flags to enable/disable color usage in the logging output.\n */\nexport const enum ColorOptions {\n  /**\n   * Do not use ASCII color codes in logging output.\n   */\n  noColors = 0,\n  /**\n   * Use ASCII color codes in logging output. By default, timestamps and the TRC and DBG prefix are colored grey. INF white, WRN yellow, and ERR and FTL red.\n   */\n  colors = 1,\n}\n\n/**\n * The global logger configuration.\n *\n * Properties on this object can be changed during runtime and will affect logging of all components that are housed under the same root DI container as the logger.\n */\nexport interface ILogConfig {\n  /**\n   * The global color options.\n   */\n  colorOptions: ColorOptions;\n  /**\n   * The global log level. Only log calls with the same level or higher are emitted.\n   */\n  level: LogLevel;\n}\n\ninterface ILoggingConfigurationOptions extends ILogConfig {\n  $console: IConsoleLike;\n  sinks: (Class<ISink> | IRegistry)[];\n}\n\n/**\n * Component that creates log event objects based on raw inputs sent to `ILogger`.\n *\n * To customize what data is sent to the sinks, replace the implementation for this interface with your own.\n *\n * @example\n *\n * ```ts\n * export class MyLogEventFactory {\n *   public createLogEvent(logger: ILogger, logLevel: LogLevel, message: string, optionalParams: unknown[]): ILogEvent {\n *     return {\n *       logLevel,\n *       optionalParams,\n *       toString() {\n *         return `[${logger.scope.join('.')}] ${message} ${optionalParams.join(', ')}`;\n *       }\n *     };\n *   }\n * }\n *\n * container.register(Registration.singleton(ILogEventFactory, MyLogEventFactory));\n * ```\n */\nexport interface ILogEventFactory {\n  /**\n   * Create a log event object based on the input parameters sent to `ILogger`.\n   *\n   * @param logger - The `ILogger` that received the message.\n   * @param logLevel - The `LogLevel` associated with the `ILogger` method that the message was passed into. E.g. `logger.debug` will result in `LogLevel.debug`\n   * @param message - The message (first parameter) that was passed into the logger. If a function was passed into the logger, this will be the return value of that function.\n   * @param optionalParams - Additional optional parameters there were passed into the logger, if any.\n   *\n   * @returns An `ILogEvent` object that, by default, only has a `.toString()` method.\n   *\n   * This is called by the default console sink to get the message to emit to the console.\n   * It could be any object of any shape, as long as the registered sinks understand that shape.\n   */\n  createLogEvent(logger: ILogger, logLevel: LogLevel, message: string, optionalParams: unknown[]): ILogEvent;\n}\n\n/**\n * A logging sink that emits `ILogEvent` objects to any kind of output. This can be the console, a database, a web api, a file, etc.\n *\n * Multiple sinks can be registered, and all events will be emitted to all of them.\n *\n * @example\n * // A buffered file sink that writes once per second:\n *\n * ```ts\n * export class BufferedFileSink {\n *   private readonly buffer: ILogEvent[] = [];\n *\n *   constructor() {\n *     setInterval(() => {\n *       const events = this.buffer.splice(0);\n *       if (events.length > 0) {\n *         fs.appendFileSync('my-log.txt', events.map(e => e.toString()).join('\\n'));\n *       }\n *     }, 1000);\n *   }\n *\n *   public emit(event: ILogEvent): void {\n *     this.buffer.push(event);\n *   }\n * }\n *\n * container.register(Registration.singleton(ISink, BufferedFileSink));\n * ```\n */\nexport interface ISink {\n  /**\n   * Handle the provided `ILogEvent` to the output interface wrapped by this sink.\n   *\n   * @param event - The event object to emit. Built-in sinks will call `.toString()` on the event object but custom sinks can do anything they like with the event.\n   */\n  handleEvent(event: ILogEvent): void;\n}\n\n/**\n * The main interface to the logging API.\n *\n * Inject this as a dependency in your components to add centralized, configurable logging capabilities to your application.\n */\nexport interface ILogger extends DefaultLogger {}\n\nexport const ILogConfig = DI.createInterface<ILogConfig>('ILogConfig', x => x.instance(new LogConfig(ColorOptions.noColors, LogLevel.warn)));\nexport const ISink = DI.createInterface<ISink>('ISink');\nexport const ILogEventFactory = DI.createInterface<ILogEventFactory>('ILogEventFactory', x => x.singleton(DefaultLogEventFactory));\nexport const ILogger = DI.createInterface<ILogger>('ILogger', x => x.singleton(DefaultLogger));\nexport const ILogScopes = DI.createInterface<string[]>('ILogScope');\n\ninterface SinkDefinition {\n  handles: Exclude<LogLevel, LogLevel.none>[];\n}\n\nexport const LoggerSink = Object.freeze({\n  key: getAnnotationKeyFor('logger-sink-handles'),\n  define<TSink extends ISink>(target: Constructable<TSink>, definition: SinkDefinition) {\n    defineMetadata(this.key, definition.handles, target.prototype);\n    return target;\n  },\n  getHandles<TSink extends ISink>(target: Constructable<TSink> | TSink) {\n    return Metadata.get(this.key, target) as LogLevel[] | undefined;\n  },\n});\nexport function sink(definition: SinkDefinition) {\n  return function <TSink extends ISink>(target: Constructable<TSink>): Constructable<TSink> {\n    return LoggerSink.define(target, definition);\n  };\n}\n\nexport interface IConsoleLike {\n  debug(message: string, ...optionalParams: unknown[]): void;\n  info(message: string, ...optionalParams: unknown[]): void;\n  warn(message: string, ...optionalParams: unknown[]): void;\n  error(message: string, ...optionalParams: unknown[]): void;\n}\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\nexport const format = toLookup({\n  red<T extends string>(str: T): T {\n    return `\\u001b[31m${str}\\u001b[39m` as T;\n  },\n  green<T extends string>(str: T): T {\n    return `\\u001b[32m${str}\\u001b[39m` as T;\n  },\n  yellow<T extends string>(str: T): T {\n    return `\\u001b[33m${str}\\u001b[39m` as T;\n  },\n  blue<T extends string>(str: T): T {\n    return `\\u001b[34m${str}\\u001b[39m` as T;\n  },\n  magenta<T extends string>(str: T): T {\n    return `\\u001b[35m${str}\\u001b[39m` as T;\n  },\n  cyan<T extends string>(str: T): T {\n    return `\\u001b[36m${str}\\u001b[39m` as T;\n  },\n  white<T extends string>(str: T): T {\n    return `\\u001b[37m${str}\\u001b[39m` as T;\n  },\n  grey<T extends string>(str: T): T {\n    return `\\u001b[90m${str}\\u001b[39m` as T;\n  },\n} as const);\n\nexport interface ILogEvent {\n  readonly severity: LogLevel;\n  readonly optionalParams?: readonly unknown[];\n  toString(): string;\n}\n\nexport class LogConfig implements ILogConfig {\n  public constructor(\n    public readonly colorOptions: ColorOptions,\n    public readonly level: LogLevel,\n  ) {}\n}\n\nconst getLogLevelString = (function () {\n  const logLevelString = [\n    toLookup({\n      TRC: 'TRC',\n      DBG: 'DBG',\n      INF: 'INF',\n      WRN: 'WRN',\n      ERR: 'ERR',\n      FTL: 'FTL',\n      QQQ: '???',\n    } as const),\n    toLookup({\n      TRC: format.grey('TRC'),\n      DBG: format.grey('DBG'),\n      INF: format.white('INF'),\n      WRN: format.yellow('WRN'),\n      ERR: format.red('ERR'),\n      FTL: format.red('FTL'),\n      QQQ: format.grey('???'),\n    } as const),\n  ] as const;\n\n  return function (level: LogLevel, colorOptions: ColorOptions): string {\n    if (level <= LogLevel.trace) {\n      return logLevelString[colorOptions].TRC;\n    }\n    if (level <= LogLevel.debug) {\n      return logLevelString[colorOptions].DBG;\n    }\n    if (level <= LogLevel.info) {\n      return logLevelString[colorOptions].INF;\n    }\n    if (level <= LogLevel.warn) {\n      return logLevelString[colorOptions].WRN;\n    }\n    if (level <= LogLevel.error) {\n      return logLevelString[colorOptions].ERR;\n    }\n    if (level <= LogLevel.fatal) {\n      return logLevelString[colorOptions].FTL;\n    }\n    return logLevelString[colorOptions].QQQ;\n  };\n})();\n\nfunction getScopeString(scope: readonly string[], colorOptions: ColorOptions): string {\n  if (colorOptions === ColorOptions.noColors) {\n    return scope.join('.');\n  }\n  return scope.map(format.cyan).join('.');\n}\n\nfunction getIsoString(timestamp: number, colorOptions: ColorOptions): string {\n  if (colorOptions === ColorOptions.noColors) {\n    return new Date(timestamp).toISOString();\n  }\n  return format.grey(new Date(timestamp).toISOString());\n}\n\nexport class DefaultLogEvent implements ILogEvent {\n  public constructor(\n    public readonly severity: LogLevel,\n    public readonly message: string,\n    public readonly optionalParams: unknown[],\n    public readonly scope: readonly string[],\n    public readonly colorOptions: ColorOptions,\n    public readonly timestamp: number,\n  ) {}\n\n  public toString(): string {\n    const { severity, message, scope, colorOptions, timestamp } = this;\n\n    if (scope.length === 0) {\n      return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)}] ${message}`;\n    }\n    return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)} ${getScopeString(scope, colorOptions)}] ${message}`;\n  }\n}\n\nexport class DefaultLogEventFactory implements ILogEventFactory {\n  public constructor(\n    @ILogConfig public readonly config: ILogConfig,\n  ) {}\n\n  public createLogEvent(logger: ILogger, level: LogLevel, message: string, optionalParams: unknown[]): ILogEvent {\n    return new DefaultLogEvent(level, message, optionalParams, logger.scope, this.config.colorOptions, Date.now());\n  }\n}\n\nexport class ConsoleSink implements ISink {\n  public static register(container: IContainer) {\n    Registration.singleton(ISink, ConsoleSink).register(container);\n  }\n\n  public readonly handleEvent: (event: ILogEvent) => void;\n\n  public constructor(\n    @IPlatform p: IPlatform,\n  ) {\n    const $console = p.console as {\n      debug(...args: unknown[]): void;\n      info(...args: unknown[]): void;\n      warn(...args: unknown[]): void;\n      error(...args: unknown[]): void;\n    };\n    this.handleEvent = function emit(event: ILogEvent): void {\n      const optionalParams = event.optionalParams;\n      if (optionalParams === void 0 || optionalParams.length === 0) {\n        const msg = event.toString();\n        switch (event.severity) {\n          case LogLevel.trace:\n          case LogLevel.debug:\n            return $console.debug(msg);\n          case LogLevel.info:\n            return $console.info(msg);\n          case LogLevel.warn:\n            return $console.warn(msg);\n          case LogLevel.error:\n          case LogLevel.fatal:\n            return $console.error(msg);\n        }\n      } else {\n        let msg = event.toString();\n        let offset = 0;\n        // console.log in chrome doesn't call .toString() on object inputs (https://bugs.chromium.org/p/chromium/issues/detail?id=1146817)\n        while (msg.includes('%s')) {\n          msg = msg.replace('%s', String(optionalParams[offset++]));\n        }\n        switch (event.severity) {\n          case LogLevel.trace:\n          case LogLevel.debug:\n            return $console.debug(msg, ...optionalParams.slice(offset));\n          case LogLevel.info:\n            return $console.info(msg, ...optionalParams.slice(offset));\n          case LogLevel.warn:\n            return $console.warn(msg, ...optionalParams.slice(offset));\n          case LogLevel.error:\n          case LogLevel.fatal:\n            return $console.error(msg, ...optionalParams.slice(offset));\n        }\n      }\n    };\n  }\n}\n\nexport class DefaultLogger {\n  /**\n   * The root `ILogger` instance. On the root logger itself, this property circularly references the root. It is never null.\n   *\n   * When using `.scopeTo`, a new `ILogger` is created. That new logger will have the `root` property set to the global (non-scoped) logger.\n   */\n  public readonly root: ILogger;\n  /**\n   * The parent `ILogger` instance. On the root logger itself, this property circularly references the root. It is never null.\n   *\n   * When using `.scopeTo`, a new `ILogger` is created. That new logger will have the `parent` property set to the logger that it was created from.\n   */\n  public readonly parent: ILogger;\n  /** @internal */\n  public readonly traceSinks: ISink[];\n  /** @internal */\n  public readonly debugSinks: ISink[];\n  /** @internal */\n  public readonly infoSinks: ISink[];\n  /** @internal */\n  public readonly warnSinks: ISink[];\n  /** @internal */\n  public readonly errorSinks: ISink[];\n  /** @internal */\n  public readonly fatalSinks: ISink[];\n\n  private readonly scopedLoggers: { [key: string]: ILogger | undefined } = createObject();\n\n  public constructor(\n    /**\n     * The global logger configuration.\n     */\n    @ILogConfig public readonly config: ILogConfig,\n    @ILogEventFactory private readonly factory: ILogEventFactory,\n    @all(ISink) sinks: readonly ISink[],\n    /**\n     * The scopes that this logger was created for, if any.\n     */\n    @optional(ILogScopes) public readonly scope: string[] = [],\n    @ignore parent: DefaultLogger | null = null,\n  ) {\n    let traceSinks: ISink[];\n    let debugSinks: ISink[];\n    let infoSinks: ISink[];\n    let warnSinks: ISink[];\n    let errorSinks: ISink[];\n    let fatalSinks: ISink[];\n    if (parent === null) {\n      this.root = this;\n      this.parent = this;\n\n      traceSinks = this.traceSinks = [];\n      debugSinks = this.debugSinks = [];\n      infoSinks = this.infoSinks = [];\n      warnSinks = this.warnSinks = [];\n      errorSinks = this.errorSinks = [];\n      fatalSinks = this.fatalSinks = [];\n      for (const $sink of sinks) {\n        const handles = LoggerSink.getHandles($sink);\n        if (handles?.includes(LogLevel.trace) ?? true) {\n          traceSinks.push($sink);\n        }\n        if (handles?.includes(LogLevel.debug) ?? true) {\n          debugSinks.push($sink);\n        }\n        if (handles?.includes(LogLevel.info) ?? true) {\n          infoSinks.push($sink);\n        }\n        if (handles?.includes(LogLevel.warn) ?? true) {\n          warnSinks.push($sink);\n        }\n        if (handles?.includes(LogLevel.error) ?? true) {\n          errorSinks.push($sink);\n        }\n        if (handles?.includes(LogLevel.fatal) ?? true) {\n          fatalSinks.push($sink);\n        }\n      }\n    } else {\n      this.root = parent.root;\n      this.parent = parent;\n\n      traceSinks = this.traceSinks = parent.traceSinks;\n      debugSinks = this.debugSinks = parent.debugSinks;\n      infoSinks = this.infoSinks = parent.infoSinks;\n      warnSinks = this.warnSinks = parent.warnSinks;\n      errorSinks = this.errorSinks = parent.errorSinks;\n      fatalSinks = this.fatalSinks = parent.fatalSinks;\n    }\n  }\n\n  /**\n   * Write to TRC output, if the configured `LogLevel` is set to `trace`.\n   *\n   * Intended for the most detailed information about internal app state.\n   *\n   * @param getMessage - A function to build the message to pass to the `ILogEventFactory`.\n   * Only called if the configured `LogLevel` dictates that these messages be emitted.\n   * Use this when creating the log message is potentially expensive and should only be done if the log is actually emitted.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public trace(getMessage: () => unknown, ...optionalParams: unknown[]): void;\n  /**\n   * Write to TRC output, if the configured `LogLevel` is set to `trace`.\n   *\n   * Intended for the most detailed information about internal app state.\n   *\n   * @param message - The message to pass to the `ILogEventFactory`.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public trace(message: unknown, ...optionalParams: unknown[]): void;\n  @bound\n  public trace(messageOrGetMessage: unknown, ...optionalParams: unknown[]): void {\n    if (this.config.level <= LogLevel.trace) {\n      this.emit(this.traceSinks, LogLevel.trace, messageOrGetMessage, optionalParams);\n    }\n  }\n\n  /**\n   * Write to DBG output, if the configured `LogLevel` is set to `debug` or lower.\n   *\n   * Intended for information that is useful for debugging during development and has no long-term value.\n   *\n   * @param getMessage - A function to build the message to pass to the `ILogEventFactory`.\n   * Only called if the configured `LogLevel` dictates that these messages be emitted.\n   * Use this when creating the log message is potentially expensive and should only be done if the log is actually emitted.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public debug(getMessage: () => unknown, ...optionalParams: unknown[]): void;\n  /**\n   * Write to DBG output, if the configured `LogLevel` is set to `debug` or lower.\n   *\n   * Intended for information that is useful for debugging during development and has no long-term value.\n   *\n   * @param message - The message to pass to the `ILogEventFactory`.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public debug(message: unknown, ...optionalParams: unknown[]): void;\n  @bound\n  public debug(messageOrGetMessage: unknown, ...optionalParams: unknown[]): void {\n    if (this.config.level <= LogLevel.debug) {\n      this.emit(this.debugSinks, LogLevel.debug, messageOrGetMessage, optionalParams);\n    }\n  }\n\n  /**\n   * Write to trace UBF, if the configured `LogLevel` is set to `info` or lower.\n   *\n   * Intended for information about the general flow of the application that has long-term value.\n   *\n   * @param getMessage - A function to build the message to pass to the `ILogEventFactory`.\n   * Only called if the configured `LogLevel` dictates that these messages be emitted.\n   * Use this when creating the log message is potentially expensive and should only be done if the log is actually emitted.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public info(getMessage: () => unknown, ...optionalParams: unknown[]): void;\n  /**\n   * Write to trace UBF, if the configured `LogLevel` is set to `info` or lower.\n   *\n   * Intended for information about the general flow of the application that has long-term value.\n   *\n   * @param message - The message to pass to the `ILogEventFactory`.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public info(message: unknown, ...optionalParams: unknown[]): void;\n  @bound\n  public info(messageOrGetMessage: unknown, ...optionalParams: unknown[]): void {\n    if (this.config.level <= LogLevel.info) {\n      this.emit(this.infoSinks, LogLevel.info, messageOrGetMessage, optionalParams);\n    }\n  }\n\n  /**\n   * Write to WRN output, if the configured `LogLevel` is set to `warn` or lower.\n   *\n   * Intended for unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n   *\n   * @param getMessage - A function to build the message to pass to the `ILogEventFactory`.\n   * Only called if the configured `LogLevel` dictates that these messages be emitted.\n   * Use this when creating the log message is potentially expensive and should only be done if the log is actually emitted.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public warn(getMessage: () => unknown, ...optionalParams: unknown[]): void;\n  /**\n   * Write to WRN output, if the configured `LogLevel` is set to `warn` or lower.\n   *\n   * Intended for unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n   *\n   * @param message - The message to pass to the `ILogEventFactory`.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public warn(message: unknown, ...optionalParams: unknown[]): void;\n  @bound\n  public warn(messageOrGetMessage: unknown, ...optionalParams: unknown[]): void {\n    if (this.config.level <= LogLevel.warn) {\n      this.emit(this.warnSinks, LogLevel.warn, messageOrGetMessage, optionalParams);\n    }\n  }\n\n  /**\n   * Write to ERR output, if the configured `LogLevel` is set to `error` or lower.\n   *\n   * Intended for unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n   *\n   * @param getMessage - A function to build the message to pass to the `ILogEventFactory`.\n   * Only called if the configured `LogLevel` dictates that these messages be emitted.\n   * Use this when creating the log message is potentially expensive and should only be done if the log is actually emitted.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public error(getMessage: () => unknown, ...optionalParams: unknown[]): void;\n  /**\n   * Write to ERR output, if the configured `LogLevel` is set to `error` or lower.\n   *\n   * Intended for unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n   *\n   * @param message - The message to pass to the `ILogEventFactory`.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public error(message: unknown, ...optionalParams: unknown[]): void;\n  @bound\n  public error(messageOrGetMessage: unknown, ...optionalParams: unknown[]): void {\n    if (this.config.level <= LogLevel.error) {\n      this.emit(this.errorSinks, LogLevel.error, messageOrGetMessage, optionalParams);\n    }\n  }\n\n  /**\n   * Write to FTL output, if the configured `LogLevel` is set to `fatal` or lower.\n   *\n   * Intended for unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n   *\n   * @param getMessage - A function to build the message to pass to the `ILogEventFactory`.\n   * Only called if the configured `LogLevel` dictates that these messages be emitted.\n   * Use this when creating the log message is potentially expensive and should only be done if the log is actually emitted.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public fatal(getMessage: () => unknown, ...optionalParams: unknown[]): void;\n  /**\n   * Write to FTL output, if the configured `LogLevel` is set to `fatal` or lower.\n   *\n   * Intended for unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n   *\n   * @param message - The message to pass to the `ILogEventFactory`.\n   * @param optionalParams - Any additional, optional params that should be passed to the `ILogEventFactory`\n   */\n  public fatal(message: unknown, ...optionalParams: unknown[]): void;\n  @bound\n  public fatal(messageOrGetMessage: unknown, ...optionalParams: unknown[]): void {\n    if (this.config.level <= LogLevel.fatal) {\n      this.emit(this.fatalSinks, LogLevel.fatal, messageOrGetMessage, optionalParams);\n    }\n  }\n\n  /**\n   * Create a new logger with an additional permanent prefix added to the logging outputs.\n   * When chained, multiple scopes are separated by a dot.\n   *\n   * This is preliminary API and subject to change before alpha release.\n   *\n   * @example\n   *\n   * ```ts\n   * export class MyComponent {\n   *   constructor(@ILogger private logger: ILogger) {\n   *     this.logger.debug('before scoping');\n   *     // console output: '[DBG] before scoping'\n   *     this.logger = logger.scopeTo('MyComponent');\n   *     this.logger.debug('after scoping');\n   *     // console output: '[DBG MyComponent] after scoping'\n   *   }\n   *\n   *   public doStuff(): void {\n   *     const logger = this.logger.scopeTo('doStuff()');\n   *     logger.debug('doing stuff');\n   *     // console output: '[DBG MyComponent.doStuff()] doing stuff'\n   *   }\n   * }\n   * ```\n   */\n  public scopeTo(name: string): ILogger {\n    const scopedLoggers = this.scopedLoggers;\n    let scopedLogger = scopedLoggers[name];\n    if (scopedLogger === void 0) {\n      scopedLogger = scopedLoggers[name] = new DefaultLogger(this.config, this.factory, (void 0)!, this.scope.concat(name), this);\n    }\n    return scopedLogger;\n  }\n\n  private emit(sinks: ISink[], level: LogLevel, msgOrGetMsg: unknown, optionalParams: unknown[]): void {\n    const message = (isFunction(msgOrGetMsg) ? msgOrGetMsg() : msgOrGetMsg) as string;\n    const event = this.factory.createLogEvent(this, level, message, optionalParams);\n    for (let i = 0, ii = sinks.length; i < ii; ++i) {\n      sinks[i].handleEvent(event);\n    }\n  }\n}\n\n/**\n * A basic `ILogger` configuration that configures a single `console` sink based on provided options.\n *\n * NOTE: You *must* register the return value of `.create` with the container / au instance, not this `LoggerConfiguration` object itself.\n *\n * @example\n * ```ts\n * container.register(LoggerConfiguration.create());\n *\n * container.register(LoggerConfiguration.create({sinks: [ConsoleSink]}))\n *\n * container.register(LoggerConfiguration.create({sinks: [ConsoleSink], level: LogLevel.debug}))\n *\n * ```\n */\nexport const LoggerConfiguration = toLookup({\n  /**\n   * @param $console - The `console` object to use. Can be the native `window.console` / `global.console`, but can also be a wrapper or mock that implements the same interface.\n   * @param level - The global `LogLevel` to configure. Defaults to `warn` or higher.\n   * @param colorOptions - Whether to use colors or not. Defaults to `noColors`. Colors are especially nice in nodejs environments but don't necessarily work (well) in all environments, such as browsers.\n   */\n  create(\n    {\n      level = LogLevel.warn,\n      colorOptions = ColorOptions.noColors,\n      sinks = [],\n    }: Partial<ILoggingConfigurationOptions> = {}\n  ): IRegistry {\n    return toLookup({\n      register(container: IContainer): IContainer {\n        container.register(\n          Registration.instance(ILogConfig, new LogConfig(colorOptions, level)),\n        );\n        for (const $sink of sinks) {\n          if (isFunction($sink)) {\n            container.register(Registration.singleton(ISink, $sink));\n          } else {\n            container.register($sink);\n          }\n        }\n        return container;\n      },\n    });\n  },\n});\n","import { DI } from './di.js';\nimport { emptyArray } from './platform.js';\nimport { Protocol } from './resource.js';\nimport { isFunction } from './utilities.js';\n\nimport type { IRegistry } from './di.js';\nimport type { Constructable, IDisposable, IIndexable } from './interfaces.js';\nimport type { ResourceDefinition } from './resource.js';\n\nexport interface IModule {\n  [key: string]: unknown;\n  default?: unknown;\n}\n\nexport interface IModuleLoader extends ModuleLoader {}\nexport const IModuleLoader = DI.createInterface<IModuleLoader>(x => x.singleton(ModuleLoader));\n\nfunction noTransform<TRet = AnalyzedModule>(m: AnalyzedModule): TRet {\n  return m as unknown as TRet;\n}\n\ntype TransformFn<TMod extends IModule = IModule, TRet = AnalyzedModule<TMod>> = (m: AnalyzedModule<TMod>) => TRet | Promise<TRet>;\n\nclass ModuleTransformer<TMod extends IModule = IModule, TRet = AnalyzedModule<TMod>> {\n  private readonly _promiseCache: Map<Promise<IModule>, unknown> = new Map<Promise<IModule>, unknown>();\n  private readonly _objectCache: Map<IModule, unknown> = new Map<IModule, unknown>();\n\n  public constructor(\n    private readonly $transform: TransformFn<TMod, TRet>,\n  ) {}\n\n  public transform(objOrPromise: TMod | Promise<TMod>): Promise<TRet> | TRet {\n    if (objOrPromise instanceof Promise) {\n      return this._transformPromise(objOrPromise);\n    } else if (typeof objOrPromise === 'object' && objOrPromise !== null) {\n      return this._transformObject(objOrPromise);\n    } else {\n      throw new Error(`Invalid input: ${String(objOrPromise)}. Expected Promise or Object.`);\n    }\n  }\n\n  private _transformPromise(promise: Promise<TMod>): TRet | Promise<TRet> {\n    if (this._promiseCache.has(promise)) {\n      return this._promiseCache.get(promise) as TRet | Promise<TRet>;\n    }\n\n    const ret = promise.then(obj => {\n      return this._transformObject(obj);\n    });\n    this._promiseCache.set(promise, ret);\n    void ret.then(value => {\n      // make it synchronous for future requests\n      this._promiseCache.set(promise, value);\n    });\n    return ret;\n  }\n\n  private _transformObject(obj: TMod): TRet | Promise<TRet> {\n    if (this._objectCache.has(obj)) {\n      return this._objectCache.get(obj) as TRet | Promise<TRet>;\n    }\n\n    const ret = this.$transform(this._analyze(obj));\n    this._objectCache.set(obj, ret);\n    if (ret instanceof Promise) {\n      void ret.then(value => {\n        // make it synchronous for future requests\n        this._objectCache.set(obj, value);\n      });\n    }\n    return ret;\n  }\n\n  private _analyze(m: TMod): AnalyzedModule<TMod> {\n    let value: unknown;\n    let isRegistry: boolean;\n    let isConstructable: boolean;\n    let definitions: readonly ResourceDefinition[];\n    const items: ModuleItem[] = [];\n\n    for (const key in m) {\n      switch (typeof (value = m[key])) {\n        case 'object':\n          if (value === null) {\n            continue;\n          }\n          isRegistry = isFunction((value as IIndexable).register);\n          isConstructable = false;\n          definitions = emptyArray;\n          break;\n        case 'function':\n          isRegistry = isFunction((value as Constructable & IIndexable).register);\n          isConstructable = (value as Constructable).prototype !== void 0;\n          definitions = Protocol.resource.getAll(value as Constructable);\n          break;\n        default:\n          continue;\n      }\n\n      items.push(new ModuleItem(\n        key,\n        value,\n        isRegistry,\n        isConstructable,\n        definitions,\n      ));\n    }\n\n    return new AnalyzedModule(m, items as ITypedModuleItem_T[]);\n  }\n}\n\nexport class ModuleLoader implements IDisposable {\n  private readonly transformers: Map<TransformFn, ModuleTransformer> = new Map<TransformFn, ModuleTransformer>();\n\n  /**\n   * Await a module promise and then analyzes and transforms it. The result is cached, using the transform function + promise as the cache key.\n   *\n   * @param promise - A promise (returning a module, or an object resembling a module), e.g. the return value of a dynamic `import()` or `require()` call.\n   * @param transform - A transform function, e.g. to select the appropriate default or first non-default resource export.\n   * Note: The return value of `transform` is cached, so it is recommended to perform any processing here that is intended to happen only once per unique module promise.\n   *\n   * @returns The (cached) transformed result. On subsequent calls, if the original promise resolved, the resolved result will be returned (rather than a promise).\n   */\n  public load<TMod extends IModule = IModule, TRet = AnalyzedModule<TMod>>(promise: Promise<TMod>, transform: (m: AnalyzedModule<TMod>) => TRet | Promise<TRet>): Promise<TRet> | TRet;\n  /**\n   * Await a module promise and then analyzes it. The result is cached, using the transform function + promise as the cache key.\n   *\n   * @param promise - A promise (returning a module, or an object resembling a module), e.g. the return value of a dynamic `import()` or `require()` call.\n   *\n   * @returns The analyzed module. On subsequent calls, if the original promise resolved, the resolved result will be returned (rather than a promise).\n   */\n  public load<TMod extends IModule = IModule>(promise: Promise<TMod>): Promise<AnalyzedModule<TMod>> | AnalyzedModule<TMod>;\n  /**\n   * Analyzes and transforms a module-like object. The result is cached, using the transform function + object as the cache key.\n   *\n   * @param promise - A module-like object, e.g. the awaited return value of a dynamic `import()` or `require()` call, or a statically imported module such as `import * as Module from './my-module';`.\n   * @param transform - A transform function, e.g. to select the appropriate default or first non-default resource export.\n   * Note: The return value of `transform` is cached, so it is recommended to perform any processing here that is intended to happen only once per unique module promise.\n   *\n   * @returns The (cached) transformed result. On subsequent calls, if the original promise resolved, the resolved result will be returned (rather than a promise).\n   */\n  public load<TMod extends IModule = IModule, TRet = AnalyzedModule<TMod>>(obj: TMod, transform: (m: AnalyzedModule<TMod>) => TRet | Promise<TRet>): Promise<TRet> | TRet;\n  /**\n   * Analyzes a module-like object. The result is cached, using the transform function + object as the cache key.\n   *\n   * @param promise - A module-like object, e.g. the awaited return value of a dynamic `import()` or `require()` call, or a statically imported module such as `import * as Module from './my-module';`.\n   *\n   * @returns The analyzed module. On subsequent calls, if the original promise resolved, the resolved result will be returned (rather than a promise).\n   */\n  public load<TMod extends IModule = IModule>(obj: TMod): AnalyzedModule<TMod>;\n  /**\n   * Analyzes and transforms a module-like object or a promise thereof. The result is cached, using the transform function + object as the cache key.\n   *\n   * @param promise - A module-like object or a promise thereof, e.g. the (awaited) return value of a dynamic `import()` or `require()` call, or a statically imported module such as `import * as Module from './my-module';`.\n   * @param transform - A transform function, e.g. to select the appropriate default or first non-default resource export.\n   * Note: The return value of `transform` is cached, so it is recommended to perform any processing here that is intended to happen only once per unique module promise.\n   *\n   * @returns The (cached) transformed result. On subsequent calls, if the original promise resolved, the resolved result will be returned (rather than a promise).\n   */\n  public load<TMod extends IModule = IModule, TRet = AnalyzedModule<TMod>>(objOrPromise: TMod | Promise<TMod>, transform?: (m: AnalyzedModule<TMod>) => TRet | Promise<TRet>): Promise<TRet> | TRet;\n  public load<TMod extends IModule = IModule, TRet = AnalyzedModule<TMod>>(objOrPromise: TMod | Promise<TMod>, transform: (m: AnalyzedModule<TMod>) => TRet | Promise<TRet> = noTransform): Promise<TRet> | TRet {\n    const transformers = this.transformers as Map<TransformFn, ModuleTransformer> & Map<TransformFn<TMod, TRet>, ModuleTransformer<TMod, TRet>>;\n    let transformer = transformers.get(transform);\n    if (transformer === void 0) {\n      transformers.set(transform, transformer = new ModuleTransformer(transform));\n    }\n\n    return transformer.transform(objOrPromise);\n  }\n\n  public dispose(): void {\n    this.transformers.clear();\n  }\n}\n\nexport class AnalyzedModule<TMod extends IModule = IModule> {\n  public constructor(\n    public readonly raw: TMod,\n    public readonly items: readonly ITypedModuleItem_T[],\n  ) {}\n}\n\nexport interface ITypedModuleItem<\n  TisRegistry extends boolean,\n  TisConstructable extends boolean,\n  TValue\n> {\n  readonly key: string;\n  readonly value: TValue;\n  readonly isRegistry: TisRegistry;\n  readonly isConstructable: TisConstructable;\n  readonly definitions: readonly ResourceDefinition[];\n}\nexport interface ITypedModuleItem_Unknown extends ITypedModuleItem<false, false, unknown> {}\nexport interface ITypedModuleItem_Registry extends ITypedModuleItem<true, false, IRegistry> {}\nexport interface ITypedModuleItem_Constructable extends ITypedModuleItem<false, true, Constructable> {}\nexport interface ITypedModuleItem_ConstructableRegistry extends ITypedModuleItem<true, true, Constructable & IRegistry> {}\nexport type ITypedModuleItem_T = (\n  ITypedModuleItem_Unknown |\n  ITypedModuleItem_Registry |\n  ITypedModuleItem_Constructable |\n  ITypedModuleItem_ConstructableRegistry\n);\nexport class ModuleItem {\n  public constructor(\n    public readonly key: string,\n    public readonly value: unknown,\n    public readonly isRegistry: boolean,\n    public readonly isConstructable: boolean,\n    public readonly definitions: readonly ResourceDefinition[],\n  ) {}\n}\n","import { DI } from './di.js';\nimport { Constructable, IDisposable } from './interfaces.js';\nimport { isString } from './utilities.js';\n\n/**\n * Represents a handler for an EventAggregator event.\n */\nclass Handler<T extends Constructable> {\n  public constructor(\n    public readonly messageType: T,\n    public readonly callback: (message: InstanceType<T>) => void,\n  ) {}\n\n  public handle(message: InstanceType<T>): void {\n    if (message instanceof this.messageType) {\n      this.callback.call(null, message);\n    }\n  }\n}\n\nexport const IEventAggregator = DI.createInterface<IEventAggregator>('IEventAggregator', x => x.singleton(EventAggregator));\nexport interface IEventAggregator extends EventAggregator {}\n\n/**\n * Enables loosely coupled publish/subscribe messaging.\n */\nexport class EventAggregator {\n  /** @internal */\n  public readonly eventLookup: Record<string, ((message: unknown, channel: string) => void)[]> = {};\n  /** @internal */\n  public readonly messageHandlers: Handler<Constructable>[] = [];\n\n  /**\n   * Publishes a message.\n   *\n   * @param channel - The channel to publish to.\n   * @param message - The message to publish on the channel.\n   */\n  public publish<T, C extends string>(\n    channel: C,\n    message: T,\n  ): void;\n  /**\n   * Publishes a message.\n   *\n   * @param instance - The instance to publish.\n   */\n  public publish<T extends Constructable>(\n    instance: InstanceType<T>,\n  ): void;\n  public publish<T extends Constructable | string>(\n    channelOrInstance: T extends Constructable ? InstanceType<T> : T,\n    message?: unknown,\n  ): void {\n    // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n    if (!channelOrInstance) {\n      throw new Error(`Invalid channel name or instance: ${channelOrInstance}.`);\n    }\n\n    if (isString(channelOrInstance)) {\n      let subscribers = this.eventLookup[channelOrInstance];\n      if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n        let i = subscribers.length;\n\n        while (i-- > 0) {\n          subscribers[i](message, channelOrInstance);\n        }\n      }\n    } else {\n      const subscribers = this.messageHandlers.slice();\n      let i = subscribers.length;\n\n      while (i-- > 0) {\n        subscribers[i].handle(channelOrInstance);\n      }\n    }\n  }\n\n  /**\n   * Subscribes to a message channel.\n   *\n   * @param channel - The event channel.\n   * @param callback - The callback to be invoked when the specified message is published.\n   */\n  public subscribe<T, C extends string>(\n    channel: C,\n    callback: (message: T, channel: C) => void,\n  ): IDisposable;\n  /**\n   * Subscribes to a message type.\n   *\n   * @param type - The event message type.\n   * @param callback - The callback to be invoked when the specified message is published.\n   */\n  public subscribe<T extends Constructable>(\n    type: T,\n    callback: (message: InstanceType<T>) => void,\n  ): IDisposable;\n  public subscribe(\n    channelOrType: string | Constructable,\n    callback: (...args: unknown[]) => void,\n  ): IDisposable {\n    // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n    if (!channelOrType) {\n      throw new Error(`Invalid channel name or type: ${channelOrType}.`);\n    }\n\n    let handler: unknown;\n    let subscribers: unknown[];\n\n    if (isString(channelOrType)) {\n      if (this.eventLookup[channelOrType] === void 0) {\n        this.eventLookup[channelOrType] = [];\n      }\n      handler = callback;\n      subscribers = this.eventLookup[channelOrType];\n    } else {\n      handler = new Handler(channelOrType, callback);\n\n      subscribers = this.messageHandlers;\n    }\n\n    subscribers.push(handler);\n\n    return {\n      dispose(): void {\n        const idx = subscribers.indexOf(handler);\n        if (idx !== -1) {\n          subscribers.splice(idx, 1);\n        }\n      }\n    };\n  }\n\n  /**\n   * Subscribes to a message channel, then disposes the subscription automatically after the first message is received.\n   *\n   * @param channel - The event channel.\n   * @param callback - The callback to be invoked when the specified message is published.\n   */\n  public subscribeOnce<T, C extends string>(\n    channel: C,\n    callback: (message: T, channel: C) => void,\n  ): IDisposable;\n  /**\n   * Subscribes to a message type, then disposes the subscription automatically after the first message is received.\n   *\n   * @param type - The event message type.\n   * @param callback - The callback to be invoked when the specified message is published.\n   */\n  public subscribeOnce<T extends Constructable>(\n    type: T,\n    callback: (message: InstanceType<T>) => void,\n  ): IDisposable;\n  public subscribeOnce(\n    channelOrType: string | Constructable,\n    callback: (...args: unknown[]) => void,\n  ): IDisposable {\n    const sub = this.subscribe(channelOrType as string, function (message, event) {\n      sub.dispose();\n      callback(message, event);\n    });\n\n    return sub;\n  }\n}\n","/**\n * Determine whether a value is an object.\n *\n * Uses `typeof` to guarantee this works cross-realm, which is where `instanceof Object` might fail.\n *\n * Some environments where these issues are known to arise:\n * - same-origin iframes (accessing the other realm via `window.top`)\n * - `jest`.\n *\n * The exact test is:\n * ```ts\n * typeof value === 'object' && value !== null || typeof value === 'function'\n * ```\n *\n * @param value - The value to test.\n * @returns `true` if the value is an object, otherwise `false`.\n * Also performs a type assertion that defaults to `value is Object | Function` which, if the input type is a union with an object type, will infer the correct type.\n * This can be overridden with the generic type argument.\n *\n * @example\n *\n * ```ts\n * class Foo {\n *   bar = 42;\n * }\n *\n * function doStuff(input?: Foo | null) {\n *   input.bar; // Object is possibly 'null' or 'undefined'\n *\n *   // input has an object type in its union (Foo) so that type will be extracted for the 'true' condition\n *   if (isObject(input)) {\n *     input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n *\n * function doOtherStuff(input: unknown) {\n *   input.bar; // Object is of type 'unknown'\n *\n *   // input is 'unknown' so there is no union type to match and it will default to 'Object | Function'\n *   if (isObject(input)) {\n *     input.bar; // Property 'bar' does not exist on type 'Object | Function'\n *   }\n *\n *   // if we know for sure that, if input is an object, it must be a specific type, we can explicitly tell the function to assert that for us\n *   if (isObject<Foo>(input)) {\n *    input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n * ```\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isObject<T extends object = Object | Function>(value: unknown): value is T {\n  return typeof value === 'object' && value !== null || typeof value === 'function';\n}\n\n/**\n * Determine whether a value is `null` or `undefined`.\n *\n * @param value - The value to test.\n * @returns `true` if the value is `null` or `undefined`, otherwise `false`.\n * Also performs a type assertion that ensures TypeScript treats the value appropriately in the `if` and `else` branches after this check.\n */\nexport function isNullOrUndefined(value: unknown): value is null | undefined {\n  return value === null || value === void 0;\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\n\nconst metadataInternalSlot = new WeakMap<any, Map<string | symbol | undefined, Map<any, any>>>();\n\nfunction $typeError(operation: string, args: unknown[], paramName: string, actualValue: unknown, expectedType: string): TypeError {\n  return new TypeError(`${operation}(${args.map(String).join(',')}) - Expected '${paramName}' to be of type ${expectedType}, but got: ${Object.prototype.toString.call(actualValue)} (${String(actualValue)})`);\n}\n\nfunction toPropertyKeyOrUndefined(propertyKey: any): undefined | string | symbol {\n  switch (typeof propertyKey) {\n    case 'undefined':\n    case 'string':\n    case 'symbol':\n      return propertyKey;\n    default:\n      return `${propertyKey}`;\n  }\n}\n\nfunction toPropertyKey(propertyKey: any): string | symbol {\n  switch (typeof propertyKey) {\n    case 'string':\n    case 'symbol':\n      return propertyKey;\n    default:\n      return `${propertyKey}`;\n  }\n}\n\nfunction ensurePropertyKeyOrUndefined(propertyKey: any): undefined | string | symbol {\n  switch (typeof propertyKey) {\n    case 'undefined':\n    case 'string':\n    case 'symbol':\n      return propertyKey;\n    default:\n      throw new TypeError(`Invalid metadata propertyKey: ${propertyKey}.`);\n  }\n}\n\n// 2.1.1 GetOrCreateMetadataMap(O, P, Create)\n// https://rbuckton.github.io/reflect-metadata/#getorcreatemetadatamap\nfunction GetOrCreateMetadataMap(O: any, P: string | symbol | undefined, Create: true): Map<any, any>;\nfunction GetOrCreateMetadataMap(O: any, P: string | symbol | undefined, Create: false): Map<any, any> | undefined;\nfunction GetOrCreateMetadataMap(O: any, P: string | symbol | undefined, Create: boolean): Map<any, any> | undefined {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let targetMetadata be the value of O's [[Metadata]] internal slot.\n  let targetMetadata = metadataInternalSlot.get(O);\n\n  // 3. If targetMetadata is undefined, then\n  if (targetMetadata === void 0) {\n    // 3. a. If Create is false, return undefined.\n    if (!Create) {\n      return void 0;\n    }\n\n    // 3. b. Set targetMetadata to be a newly created Map object.\n    targetMetadata = new Map<string | symbol | undefined, Map<any, any>>();\n\n    // 3. c. Set the [[Metadata]] internal slot of O to targetMetadata.\n    metadataInternalSlot.set(O, targetMetadata);\n  }\n\n  // 4. Let metadataMap be ? Invoke(targetMetadata, \"get\", P).\n  let metadataMap = targetMetadata.get(P);\n\n  // 5. If metadataMap is undefined, then\n  if (metadataMap === void 0) {\n    // 5. a. If Create is false, return undefined.\n    if (!Create) {\n      return void 0;\n    }\n\n    // 5. b. Set metadataMap to be a newly created Map object.\n    metadataMap = new Map<any, any>();\n\n    // 5. c. Perform ? Invoke(targetMetadata, \"set\", P, metadataMap).\n    targetMetadata.set(P, metadataMap);\n  }\n\n  // 6. Return metadataMap.\n  return metadataMap;\n}\n\n// 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\nfunction OrdinaryHasOwnMetadata(MetadataKey: any, O: any, P: string | symbol | undefined): boolean {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n  const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n\n  // 3. If metadataMap is undefined, return false.\n  if (metadataMap === void 0) {\n    return false;\n  }\n\n  // 4. Return ? ToBoolean(? Invoke(metadataMap, \"has\", MetadataKey)).\n  return metadataMap.has(MetadataKey);\n}\n\n// 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\nfunction OrdinaryHasMetadata(MetadataKey: any, O: any, P: string | symbol | undefined): boolean {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n  // 3. If hasOwn is true, return true.\n  if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n    return true;\n  }\n\n  // 4. Let parent be ? O.[[GetPrototypeOf]]().\n  const parent = Object.getPrototypeOf(O);\n\n  // 5. If parent is not null, Return ? parent.[[HasMetadata]](MetadataKey, P).\n  if (parent !== null) {\n    return OrdinaryHasMetadata(MetadataKey, parent, P);\n  }\n\n  // 6. Return false.\n  return false;\n}\n\n// 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\nfunction OrdinaryGetOwnMetadata(MetadataKey: any, O: any, P: string | symbol | undefined): any {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n  const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n\n  // 3. If metadataMap is undefined, return undefined.\n  if (metadataMap === void 0) {\n    return void 0;\n  }\n\n  // 4. Return ? Invoke(metadataMap, \"get\", MetadataKey).\n  return metadataMap.get(MetadataKey);\n}\n\n// 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\nfunction OrdinaryGetMetadata(MetadataKey: any, O: any, P: string | symbol | undefined): any {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n  // 3. If hasOwn is true, return ? OrdinaryGetOwnMetadata(MetadataKey, O, P).\n  if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n    return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n  }\n\n  // 4. Let parent be ? O.[[GetPrototypeOf]]().\n  const parent = Object.getPrototypeOf(O);\n\n  // 5. If parent is not null, return ? parent.[[GetMetadata]](MetadataKey, P).\n  if (parent !== null) {\n    return OrdinaryGetMetadata(MetadataKey, parent, P);\n  }\n\n  // 6. Return undefined.\n  return void 0;\n}\n\n// 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\nfunction OrdinaryDefineOwnMetadata(MetadataKey: any, MetadataValue: any, O: any, P: string | symbol | undefined): void {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, true).\n  const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ true);\n\n  // 3. Return ? Invoke(metadataMap, \"set\", MetadataKey, MetadataValue).\n  metadataMap.set(MetadataKey, MetadataValue);\n}\n\n// 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\nfunction OrdinaryOwnMetadataKeys(O: any, P: string | symbol | undefined): any[] {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let keys be ? ArrayCreate(0).\n  const keys: any[] = [];\n\n  // 3. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n  const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n\n  // 4. If metadataMap is undefined, return keys.\n  if (metadataMap === void 0) {\n    return keys;\n  }\n\n  // 5. Let keysObj be ? Invoke(metadataMap, \"keys\").\n  const keysObj = metadataMap.keys();\n\n  // 6. Let iterator be ? GetIterator(keysObj).\n\n  // 7. Let k be 0.\n  let k = 0;\n\n  // 8. Repeat\n  for (const key of keysObj) {\n    // 8. a. Let Pk be ! ToString(k).\n    // 8. b. Let next be ? IteratorStep(iterator).\n    // 8. c. If next is false, then\n    // 8. c. i. Let setStatus be ? Set(keys, \"length\", k, true).\n    // 8. c. ii. Assert: setStatus is true.\n    // 8. c. iii. Return keys.\n    // 8. d. Let nextValue be ? IteratorValue(next).\n\n    // 8. e. Let defineStatus be CreateDataPropertyOrThrow(keys, Pk, nextValue).\n    keys[k] = key;\n\n    // 8. f. If defineStatus is an abrupt completion, return ? IteratorClose(iterator, defineStatus).\n\n    // 8. g. Increase k by 1.\n    ++k;\n  }\n\n  return keys;\n}\n\n// 3.1.6.1 OrdinaryMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\nfunction OrdinaryMetadataKeys(O: any, P: string | symbol | undefined): any[] {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let ownKeys be ? OrdinaryOwnMetadataKeys(O, P).\n  const ownKeys = OrdinaryOwnMetadataKeys(O, P);\n\n  // 3. Let parent be ? O.[[GetPrototypeOf]]().\n  const parent = Object.getPrototypeOf(O);\n\n  // 4. If parent is null, then return ownKeys.\n  if (parent === null) {\n    return ownKeys;\n  }\n\n  // 5. Let parentKeys be ? O.[[OrdinaryMetadataKeys]](P).\n  const parentKeys = OrdinaryMetadataKeys(parent, P);\n\n  // 6. Let ownKeysLen = ? Get(ownKeys, \"length\").\n  const ownKeysLen = ownKeys.length;\n\n  // 7. If ownKeysLen is 0, return parentKeys.\n  if (ownKeysLen === 0) {\n    return parentKeys;\n  }\n\n  // 8. Let parentKeysLen = ? Get(parentKeys, \"length\").\n  const parentKeysLen = parentKeys.length;\n\n  // 9. If parentKeysLen is 0, return ownKeys.\n  if (parentKeysLen === 0) {\n    return ownKeys;\n  }\n\n  // 10. Let set be a newly created Set object.\n  const set = new Set<any>();\n\n  // 11. Let keys be ? ArrayCreate(0).\n  const keys: any[] = [];\n\n  // 12. Let k be 0.\n  let k = 0;\n\n  // 13. For each element key of ownKeys\n  let key: any;\n  for (let i = 0; i < ownKeysLen; ++i) {\n    key = ownKeys[i];\n\n    // 13. a. Let hasKey be ? Invoke(set, \"has\", key).\n    // 13. b. If hasKey is false, then\n    if (!set.has(key)) {\n      // 13. b. i. Let Pk be ! ToString(k).\n      // 13. b. ii. Perform ? Invoke(set, \"add\", key).\n      set.add(key);\n\n      // 13. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n      // 13. b. iv. Assert: defineStatus is true.\n      keys[k] = key;\n\n      // 13. b. v. Increase k by 1.\n      ++k;\n    }\n  }\n\n  // 14. For each element key of parentKeys\n  for (let i = 0; i < parentKeysLen; ++i) {\n    key = parentKeys[i];\n\n    // 14. a. Let hasKey be ? Invoke(set, \"has\", key).\n    // 14. b. If hasKey is false, then\n    if (!set.has(key)) {\n      // 14. b. i. Let Pk be ! ToString(k).\n      // 14. b. ii. Perform ? Invoke(set, \"add\", key).\n      set.add(key);\n\n      // 14. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n      // 14. b. iv. Assert: defineStatus is true.\n      keys[k] = key;\n\n      // 14. b. v. Increase k by 1.\n      ++k;\n    }\n  }\n\n  // 15. Perform ? Set(keys, \"length\", k).\n\n  // 16. return keys.\n  return keys;\n}\n\n// 3.1.8 DeleteMetadata(MetadataKey, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots-deletemetadata\nfunction OrdinaryDeleteMetadata(O: any, MetadataKey: any, P: string | symbol | undefined): boolean {\n  // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n\n  // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n  const metadataMap = GetOrCreateMetadataMap(O, P, false);\n\n  // 3. If metadataMap is undefined, return false.\n  if (metadataMap === void 0) {\n    return false;\n  }\n\n  // 4. Return ? Invoke(metadataMap, \"delete\", MetadataKey).\n  return metadataMap.delete(MetadataKey);\n}\n\n// 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n// https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n\n/**\n * A default metadata decorator factory that can be used on a class, class member, or parameter.\n *\n * @param metadataKey - The key for the metadata entry.\n * If `metadataKey` is already defined for the target and target key, the\n * metadataValue for that key will be overwritten.\n * @param metadataValue - The value for the metadata entry.\n * @returns A decorator function.\n */\nexport function metadata(metadataKey: any, metadataValue: any) {\n  function decorator(target: Function): void;\n  function decorator(target: any, propertyKey: string | symbol): void;\n  function decorator(target: any, propertyKey?: string | symbol): void {\n    // 1. Assert: F has a [[MetadataKey]] internal slot whose value is an ECMAScript language value, or undefined.\n    // 2. Assert: F has a [[MetadataValue]] internal slot whose value is an ECMAScript language value, or undefined.\n    // 3. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n      throw $typeError('@metadata', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 4. If key is not undefined and IsPropertyKey(key) is false, throw a TypeError exception.\n    // 5. Let metadataKey be the value of F's [[MetadataKey]] internal slot.\n    // 6. Let metadataValue be the value of F's [[MetadataValue]] internal slot.\n    // 7. Perform ? target.[[DefineMetadata]](metadataKey, metadataValue, target, key).\n\n    OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, ensurePropertyKeyOrUndefined(propertyKey));\n\n    // 8. Return undefined.\n  }\n\n  return decorator;\n}\n\nfunction decorate(\n  decorators: (ClassDecorator | PropertyDecorator | MethodDecorator)[],\n  target: any,\n  propertyKey?: string | symbol,\n  attributes?: PropertyDescriptor | null,\n): PropertyDescriptor | Function | undefined {\n  if (propertyKey !== void 0) {\n    if (!Array.isArray(decorators)) {\n      throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n    }\n    if (!isObject(target)) {\n      throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Object or Function');\n    }\n    if (!isObject(attributes) && !isNullOrUndefined(attributes)) {\n      throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'attributes', attributes, 'Object, Function, null, or undefined');\n    }\n    if (attributes === null) {\n      attributes = void 0;\n    }\n    propertyKey = toPropertyKey(propertyKey);\n    return DecorateProperty(decorators as (MethodDecorator | PropertyDecorator)[], target, propertyKey, attributes);\n  } else {\n    if (!Array.isArray(decorators)) {\n      throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n    }\n    if (typeof target !== 'function') {\n      throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Function');\n    }\n    return DecorateConstructor(decorators as ClassDecorator[], target as Function);\n  }\n}\n\nfunction DecorateConstructor(\n  decorators: ClassDecorator[],\n  target: Function,\n): Function {\n  for (let i = decorators.length - 1; i >= 0; --i) {\n    const decorator = decorators[i];\n    const decorated = decorator(target);\n    if (!isNullOrUndefined(decorated)) {\n      if (typeof decorated !== 'function') {\n        throw $typeError('DecorateConstructor', [decorators, target], 'decorated', decorated, 'Function, null, or undefined');\n      }\n      target = decorated;\n    }\n  }\n  return target;\n}\n\nfunction DecorateProperty(\n  decorators: (MethodDecorator | PropertyDecorator)[],\n  target: any,\n  propertyKey: string | symbol,\n  descriptor: PropertyDescriptor | undefined,\n): PropertyDescriptor | undefined {\n  for (let i = decorators.length - 1; i >= 0; --i) {\n    const decorator = decorators[i];\n    const decorated = decorator(target as object, propertyKey, descriptor!);\n    if (!isNullOrUndefined(decorated)) {\n      if (!isObject(decorated)) {\n        throw $typeError('DecorateProperty', [decorators, target, propertyKey, descriptor], 'decorated', decorated, 'Object, Function, null, or undefined');\n      }\n      descriptor = decorated;\n    }\n  }\n  return descriptor;\n}\n\n// 4.1.3 Reflect.defineMetadata(metadataKey, metadataValue, target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect.definemetadata\n/**\n * Define a unique metadata entry on the target.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param metadataValue - A value that contains attached metadata.\n * @param target - The target object on which to define metadata.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     Metadata.define(\"custom:annotation\", options, Example);\n *\n *     // decorator factory as metadata-producing annotation.\n *     function MyAnnotation(options): ClassDecorator {\n *         return target => Metadata.define(\"custom:annotation\", options, target);\n *     }\n *\n */\nfunction $define(metadataKey: any, metadataValue: any, target: any): void;\n/**\n * Define a unique metadata entry on the target.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param metadataValue - A value that contains attached metadata.\n * @param target - The target object on which to define metadata.\n * @param propertyKey - The property key for the target.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     Metadata.define(\"custom:annotation\", Number, Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     Metadata.define(\"custom:annotation\", Number, Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     Metadata.define(\"custom:annotation\", Number, Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     Metadata.define(\"custom:annotation\", Number, Example.prototype, \"method\");\n *\n *     // decorator factory as metadata-producing annotation.\n *     function MyAnnotation(options): PropertyDecorator {\n *         return (target, key) => Metadata.define(\"custom:annotation\", options, target, key);\n *     }\n *\n */\nfunction $define(metadataKey: any, metadataValue: any, target: any, propertyKey: string | symbol): void;\nfunction $define(metadataKey: any, metadataValue: any, target: any, propertyKey?: string | symbol): void {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.define', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[DefineMetadata]](metadataKey, metadataValue, propertyKey).\n  return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, toPropertyKeyOrUndefined(propertyKey));\n}\n\n// 4.1.4 Reflect.hasMetadata(metadataKey, target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect.hasmetadata\n\n/**\n * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     result = Metadata.has(\"custom:annotation\", Example);\n *\n */\nfunction $has(metadataKey: any, target: any): boolean;\n/**\n * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @param propertyKey - The property key for the target.\n * @returns `true` - if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     result = Metadata.has(\"custom:annotation\", Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     result = Metadata.has(\"custom:annotation\", Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     result = Metadata.has(\"custom:annotation\", Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     result = Metadata.has(\"custom:annotation\", Example.prototype, \"method\");\n *\n */\nfunction $has(metadataKey: any, target: any, propertyKey: string | symbol): boolean;\nfunction $has(metadataKey: any, target: any, propertyKey?: string | symbol): boolean {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.has', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[HasMetadata]](metadataKey, propertyKey).\n  return OrdinaryHasMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\n\n// 4.1.5 Reflect.hasOwnMetadata(metadataKey, target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect-hasownmetadata\n\n/**\n * Gets a value indicating whether the target object has the provided metadata key defined.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     result = Metadata.hasOwn(\"custom:annotation\", Example);\n *\n */\nfunction $hasOwn(metadataKey: any, target: any): boolean;\n/**\n * Gets a value indicating whether the target object has the provided metadata key defined.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @param propertyKey - The property key for the target.\n * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     result = Metadata.hasOwn(\"custom:annotation\", Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     result = Metadata.hasOwn(\"custom:annotation\", Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     result = Metadata.hasOwn(\"custom:annotation\", Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     result = Metadata.hasOwn(\"custom:annotation\", Example.prototype, \"method\");\n *\n */\nfunction $hasOwn(metadataKey: any, target: any, propertyKey: string | symbol): boolean;\nfunction $hasOwn(metadataKey: any, target: any, propertyKey?: string | symbol): boolean {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.hasOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[HasOwn]](metadataKey, propertyKey).\n  return OrdinaryHasOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\n\n// 4.1.6 Reflect.getMetadata(metadataKey, target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect-getmetadata\n\n/**\n * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     result = Metadata.get(\"custom:annotation\", Example);\n *\n */\nfunction $get(metadataKey: any, target: any): any;\n/**\n * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @param propertyKey - The property key for the target.\n * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     result = Metadata.get(\"custom:annotation\", Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     result = Metadata.get(\"custom:annotation\", Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     result = Metadata.get(\"custom:annotation\", Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     result = Metadata.get(\"custom:annotation\", Example.prototype, \"method\");\n *\n */\nfunction $get(metadataKey: any, target: any, propertyKey: string | symbol): any;\nfunction $get(metadataKey: any, target: any, propertyKey?: string | symbol): any {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.get', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[GetMetadata]](metadataKey, propertyKey).\n  return OrdinaryGetMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\n\n// 4.1.7 Reflect.getOwnMetadata(metadataKey, target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect-getownmetadata\n\n/**\n * Gets the metadata value for the provided metadata key on the target object.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     result = Metadata.getOwn(\"custom:annotation\", Example);\n *\n */\nfunction $getOwn(metadataKey: any, target: any): any;\n/**\n * Gets the metadata value for the provided metadata key on the target object.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @param propertyKey - The property key for the target.\n * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     result = Metadata.getOwn(\"custom:annotation\", Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     result = Metadata.getOwn(\"custom:annotation\", Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     result = Metadata.getOwn(\"custom:annotation\", Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     result = Metadata.getOwn(\"custom:annotation\", Example.prototype, \"method\");\n *\n */\nfunction $getOwn(metadataKey: any, target: any, propertyKey: string | symbol): any;\nfunction $getOwn(metadataKey: any, target: any, propertyKey?: string | symbol): any {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.getOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[GetOwnMetadata]](metadataKey, propertyKey).\n  return OrdinaryGetOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\n\n// 4.1.8 Reflect.getMetadataKeys(target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect-getmetadatakeys\n\n/**\n * Gets the metadata keys defined on the target object or its prototype chain.\n *\n * @param target - The target object on which the metadata is defined.\n * @returns An array of unique metadata keys.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     result = Metadata.getKeys(Example);\n *\n */\nfunction $getKeys(target: any): any[];\n/**\n * Gets the metadata keys defined on the target object or its prototype chain.\n *\n * @param target - The target object on which the metadata is defined.\n * @param propertyKey - The property key for the target.\n * @returns An array of unique metadata keys.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     result = Metadata.getKeys(Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     result = Metadata.getKeys(Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     result = Metadata.getKeys(Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     result = Metadata.getKeys(Example.prototype, \"method\");\n *\n */\nfunction $getKeys(target: any, propertyKey: string | symbol): any[];\nfunction $getKeys(target: any, propertyKey?: string | symbol): any[] {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.getKeys', [target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[GetMetadataKeys]](propertyKey).\n  return OrdinaryMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\n\n// 4.1.9 Reflect.getOwnMetadataKeys(target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect-getownmetadata\n\n/**\n * Gets the unique metadata keys defined on the target object.\n *\n * @param target - The target object on which the metadata is defined.\n * @returns An array of unique metadata keys.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     result = Metadata.getOwnKeys(Example);\n *\n */\nfunction $getOwnKeys(target: any): any[];\n/**\n * Gets the unique metadata keys defined on the target object.\n *\n * @param target - The target object on which the metadata is defined.\n * @param propertyKey - The property key for the target.\n * @returns An array of unique metadata keys.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     result = Metadata.getOwnKeys(Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     result = Metadata.getOwnKeys(Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     result = Metadata.getOwnKeys(Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     result = Metadata.getOwnKeys(Example.prototype, \"method\");\n *\n */\nfunction $getOwnKeys(target: any, propertyKey: string | symbol): any[];\nfunction $getOwnKeys(target: any, propertyKey?: string | symbol): any[] {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.getOwnKeys', [target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[GetOwnMetadataKeys]](propertyKey).\n  return OrdinaryOwnMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\n\n// 4.1.10 Reflect.deleteMetadata(metadataKey, target [, propertyKey])\n// https://rbuckton.github.io/reflect-metadata/#reflect-deletemetadata\n\n/**\n * Deletes the metadata entry from the target object with the provided key.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n * @example\n *\n *     class Example {\n *     }\n *\n *     // constructor\n *     result = Metadata.delete(\"custom:annotation\", Example);\n *\n */\nfunction $delete(metadataKey: any, target: any): boolean;\n/**\n * Deletes the metadata entry from the target object with the provided key.\n *\n * @param metadataKey - A key used to store and retrieve metadata.\n * @param target - The target object on which the metadata is defined.\n * @param propertyKey - The property key for the target.\n * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n * @example\n *\n *     class Example {\n *         // property declarations are not part of ES6, though they are valid in TypeScript:\n *         // static staticProperty;\n *         // property;\n *\n *         static staticMethod(p) { }\n *         method(p) { }\n *     }\n *\n *     // property (on constructor)\n *     result = Metadata.delete(\"custom:annotation\", Example, \"staticProperty\");\n *\n *     // property (on prototype)\n *     result = Metadata.delete(\"custom:annotation\", Example.prototype, \"property\");\n *\n *     // method (on constructor)\n *     result = Metadata.delete(\"custom:annotation\", Example, \"staticMethod\");\n *\n *     // method (on prototype)\n *     result = Metadata.delete(\"custom:annotation\", Example.prototype, \"method\");\n *\n */\nfunction $delete(metadataKey: any, target: any, propertyKey: string | symbol): boolean;\nfunction $delete(metadataKey: any, target: any, propertyKey?: string | symbol): boolean {\n  // 1. If Type(target) is not Object, throw a TypeError exception.\n  if (!isObject(target)) {\n    throw $typeError('Metadata.delete', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n  }\n  // 2. Return ? target.[[DeleteMetadata]](metadataKey, propertyKey).\n  return OrdinaryDeleteMetadata(target, metadataKey, toPropertyKeyOrUndefined(propertyKey));\n}\n\nexport const Metadata = {\n  define: $define,\n  has: $has,\n  hasOwn: $hasOwn,\n  get: $get,\n  getOwn: $getOwn,\n  getKeys: $getKeys,\n  getOwnKeys: $getOwnKeys,\n  delete: $delete,\n};\n\nfunction def(\n  obj: object,\n  key: string,\n  value: unknown,\n  writable: boolean,\n  configurable: boolean,\n): void {\n  if (!Reflect.defineProperty(obj, key, {\n    writable,\n    enumerable: false,\n    configurable,\n    value,\n  })) {\n    throw new Error(`Unable to apply metadata polyfill: could not add property '${key}' to the global Reflect object`);\n  }\n}\n\nconst internalSlotName = '[[$au]]';\nfunction hasInternalSlot(reflect: typeof Reflect): reflect is typeof Reflect & { [internalSlotName]: typeof metadataInternalSlot } {\n  return internalSlotName in reflect;\n}\n\nfunction $applyMetadataPolyfill(\n  reflect: typeof Reflect,\n  writable: boolean,\n  configurable: boolean,\n): void {\n  def(reflect, internalSlotName, metadataInternalSlot, writable, configurable);\n\n  def(reflect, 'metadata', metadata, writable, configurable);\n  def(reflect, 'decorate', decorate, writable, configurable);\n  def(reflect, 'defineMetadata', $define, writable, configurable);\n  def(reflect, 'hasMetadata', $has, writable, configurable);\n  def(reflect, 'hasOwnMetadata', $hasOwn, writable, configurable);\n  def(reflect, 'getMetadata', $get, writable, configurable);\n  def(reflect, 'getOwnMetadata', $getOwn, writable, configurable);\n  def(reflect, 'getMetadataKeys', $getKeys, writable, configurable);\n  def(reflect, 'getOwnMetadataKeys', $getOwnKeys, writable, configurable);\n  def(reflect, 'deleteMetadata', $delete, writable, configurable);\n}\n\nexport function applyMetadataPolyfill(\n  reflect: typeof Reflect,\n  throwIfConflict: boolean = true,\n  forceOverwrite: boolean = false,\n  writable: boolean = true,\n  configurable: boolean = true,\n): void {\n  if (hasInternalSlot(reflect)) {\n    if (reflect[internalSlotName] === metadataInternalSlot) {\n      return;\n    }\n    throw new Error(`Conflicting @aurelia/metadata module import detected. Please make sure you have the same version of all Aurelia packages in your dependency tree.`);\n  }\n\n  const presentProps = [\n    'metadata',\n    'decorate',\n    'defineMetadata',\n    'hasMetadata',\n    'hasOwnMetadata',\n    'getMetadata',\n    'getOwnMetadata',\n    'getMetadataKeys',\n    'getOwnMetadataKeys',\n    'deleteMetadata',\n  ].filter(function (p) {\n    return p in Reflect;\n  });\n\n  if (presentProps.length > 0) {\n    if (throwIfConflict) {\n      const implementationSummary = presentProps.map(function (p) {\n        const impl = `${(Reflect as { [k: string]: Function })[p].toString().slice(0, 100)}...`;\n        return `${p}:\\n${impl}`;\n      }).join('\\n\\n');\n      throw new Error(`Conflicting reflect.metadata polyfill found. If you have 'reflect-metadata' or any other reflect polyfill imported, please remove it, if not (or if you must use a specific polyfill) please file an issue at https://github.com/aurelia/aurelia/issues so that we can look into compatibility options for this scenario. Implementation summary:\\n\\n${implementationSummary}`);\n    } else if (forceOverwrite) {\n      $applyMetadataPolyfill(reflect, writable, configurable);\n    }\n  } else {\n    $applyMetadataPolyfill(reflect, writable, configurable);\n  }\n}\n","import { Platform, TaskQueue } from '@aurelia/platform';\n\nconst lookup = new Map<object, BrowserPlatform>();\n\nfunction notImplemented(name: string): (...args: any[]) => any {\n  return function notImplemented() {\n    throw new Error(`The PLATFORM did not receive a valid reference to the global function '${name}'.`); // TODO: link to docs describing how to fix this issue\n  };\n}\n\nexport class BrowserPlatform<TGlobal extends typeof globalThis = typeof globalThis> extends Platform<TGlobal> {\n  public readonly Node!: TGlobal['Node'];\n  public readonly Element!: TGlobal['Element'];\n  public readonly HTMLElement!: TGlobal['HTMLElement'];\n  public readonly CustomEvent!: TGlobal['CustomEvent'];\n  public readonly CSSStyleSheet!: TGlobal['CSSStyleSheet'];\n  public readonly ShadowRoot!: TGlobal['ShadowRoot'];\n  public readonly MutationObserver!: TGlobal['MutationObserver'];\n\n  public readonly window!: TGlobal['window'];\n  public readonly document!: TGlobal['document'];\n  public readonly location!: TGlobal['location'];\n  public readonly history!: TGlobal['history'];\n  public readonly navigator!: TGlobal['navigator'];\n  public readonly customElements!: TGlobal['customElements'];\n\n  public readonly fetch!: TGlobal['window']['fetch'];\n  public readonly requestAnimationFrame!: TGlobal['requestAnimationFrame'];\n  public readonly cancelAnimationFrame!: TGlobal['cancelAnimationFrame'];\n\n  // In environments with nodejs types, the node globalThis for some reason overwrites that of the DOM, changing the signature\n  // of setTimeout etc to those of node.\n  // So, re-declaring these based on the Window type to ensure they have the DOM-based signature.\n  public readonly clearInterval!: TGlobal['window']['clearInterval'];\n  public readonly clearTimeout!: TGlobal['window']['clearTimeout'];\n  public readonly setInterval!: TGlobal['window']['setInterval'];\n  public readonly setTimeout!: TGlobal['window']['setTimeout'];\n  public readonly domWriteQueue: TaskQueue;\n  public readonly domReadQueue: TaskQueue;\n\n  public constructor(g: TGlobal, overrides: Partial<Exclude<BrowserPlatform, 'globalThis'>> = {}) {\n    super(g, overrides);\n\n    ('Node,Element,HTMLElement,CustomEvent,CSSStyleSheet,ShadowRoot,MutationObserver,'\n    + 'window,document,location,history,navigator,customElements')\n      .split(',')\n      .forEach(prop => {\n        (this as any)[prop] = prop in overrides ? (overrides as any)[prop] : (g as any)[prop];\n      });\n\n    'fetch,requestAnimationFrame,cancelAnimationFrame'.split(',').forEach(prop => {\n      (this as any)[prop] = prop in overrides ? (overrides as any)[prop] : ((g as any)[prop]?.bind(g) ?? notImplemented(prop));\n    });\n\n    this.flushDomRead = this.flushDomRead.bind(this);\n    this.flushDomWrite = this.flushDomWrite.bind(this);\n    this.domReadQueue = new TaskQueue(this, this.requestDomRead.bind(this), this.cancelDomRead.bind(this));\n    this.domWriteQueue = new TaskQueue(this, this.requestDomWrite.bind(this), this.cancelDomWrite.bind(this));\n    /* eslint-enable @typescript-eslint/no-unnecessary-type-assertion */\n  }\n\n  public static getOrCreate<TGlobal extends typeof globalThis = typeof globalThis>(\n    g: TGlobal,\n    overrides: Partial<Exclude<BrowserPlatform, 'globalThis'>> = {},\n  ): BrowserPlatform<TGlobal> {\n    let platform = lookup.get(g);\n    if (platform === void 0) {\n      lookup.set(g, platform = new BrowserPlatform(g, overrides));\n    }\n    return platform as BrowserPlatform<TGlobal>;\n  }\n\n  public static set(g: typeof globalThis, platform: BrowserPlatform): void {\n    lookup.set(g, platform);\n  }\n\n  /** @internal */ private _domReadRequested: boolean = false;\n  /** @internal */ private _domReadHandle: number = -1;\n  protected requestDomRead(): void {\n    this._domReadRequested = true;\n    // Yes, this is intentional: the timing of the read can only be \"found\" by doing a write first.\n    // The flushDomWrite queues the read.\n    // If/when requestPostAnimationFrame is implemented in browsers, we can use that instead.\n    if (this._domWriteHandle === -1) {\n      this._domWriteHandle = this.requestAnimationFrame(this.flushDomWrite);\n    }\n  }\n  protected cancelDomRead(): void {\n    this._domReadRequested = false;\n    if (this._domReadHandle > -1) {\n      this.clearTimeout(this._domReadHandle);\n      this._domReadHandle = -1;\n    }\n    if (this._domWriteRequested === false && this._domWriteHandle > -1) {\n      this.cancelAnimationFrame(this._domWriteHandle);\n      this._domWriteHandle = -1;\n    }\n  }\n  protected flushDomRead(): void {\n    this._domReadHandle = -1;\n    if (this._domReadRequested === true) {\n      this._domReadRequested = false;\n      this.domReadQueue.flush();\n    }\n  }\n\n  /** @internal */ private _domWriteRequested: boolean = false;\n  /** @internal */ private _domWriteHandle: number = -1;\n  protected requestDomWrite(): void {\n    this._domWriteRequested = true;\n    if (this._domWriteHandle === -1) {\n      this._domWriteHandle = this.requestAnimationFrame(this.flushDomWrite);\n    }\n  }\n  protected cancelDomWrite(): void {\n    this._domWriteRequested = false;\n    if (\n      this._domWriteHandle > -1 &&\n      // if dom read is requested and there is no readHandle yet, we need the rAF to proceed regardless.\n      // The domWriteRequested=false will prevent the read flush from happening.\n      (this._domReadRequested === false || this._domReadHandle > -1)\n    ) {\n      this.cancelAnimationFrame(this._domWriteHandle);\n      this._domWriteHandle = -1;\n    }\n  }\n  protected flushDomWrite(): void {\n    this._domWriteHandle = -1;\n    if (this._domWriteRequested === true) {\n      this._domWriteRequested = false;\n      this.domWriteQueue.flush();\n    }\n    if (this._domReadRequested === true && this._domReadHandle === -1) {\n      this._domReadHandle = this.setTimeout(this.flushDomRead, 0);\n    }\n  }\n}\n","const lookup = new Map<object, Platform>();\n\nfunction notImplemented(name: string): (...args: any[]) => any {\n  return function notImplemented() {\n    throw new Error(`The PLATFORM did not receive a valid reference to the global function '${name}'.`); // TODO: link to docs describing how to fix this issue\n  };\n}\n\nexport class Platform<TGlobal extends typeof globalThis = typeof globalThis> {\n  // http://www.ecma-international.org/ecma-262/#sec-value-properties-of-the-global-object\n  public readonly globalThis: TGlobal;\n\n  // http://www.ecma-international.org/ecma-262/#sec-function-properties-of-the-global-object\n  public readonly decodeURI: TGlobal['decodeURI'];\n  public readonly decodeURIComponent: TGlobal['decodeURIComponent'];\n  public readonly encodeURI: TGlobal['encodeURI'];\n  public readonly encodeURIComponent: TGlobal['encodeURIComponent'];\n\n  // http://www.ecma-international.org/ecma-262/#sec-constructor-properties-of-the-global-object\n  public readonly Date: TGlobal['Date'];\n\n  // http://www.ecma-international.org/ecma-262/#sec-other-properties-of-the-global-object\n  public readonly Reflect: TGlobal['Reflect'];\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope\n  // Note: we're essentially assuming that all of these are available, even if we aren't even\n  // in a browser environment. They are available in major envs as well (NodeJS, NativeScript, etc),\n  // or can otherwise be mocked fairly easily. If not, things probably won't work anyway.\n  public readonly clearInterval: TGlobal['clearInterval'];\n  public readonly clearTimeout: TGlobal['clearTimeout'];\n  public readonly queueMicrotask: TGlobal['queueMicrotask'];\n  public readonly setInterval: TGlobal['setInterval'];\n  public readonly setTimeout: TGlobal['setTimeout'];\n  public readonly console: TGlobal['console'];\n\n  public readonly performanceNow: () => number;\n\n  public readonly taskQueue: TaskQueue;\n\n  public constructor(g: TGlobal, overrides: Partial<Exclude<Platform, 'globalThis'>> = {}) {\n    this.globalThis = g;\n    this.decodeURI = 'decodeURI' in overrides ? overrides.decodeURI! : g.decodeURI;\n    this.decodeURIComponent = 'decodeURIComponent' in overrides ? overrides.decodeURIComponent! : g.decodeURIComponent;\n    this.encodeURI = 'encodeURI' in overrides ? overrides.encodeURI! : g.encodeURI;\n    this.encodeURIComponent = 'encodeURIComponent' in overrides ? overrides.encodeURIComponent! : g.encodeURIComponent;\n\n    this.Date = 'Date' in overrides ? overrides.Date! : g.Date;\n\n    this.Reflect = 'Reflect' in overrides ? overrides.Reflect! : g.Reflect;\n\n    this.clearInterval = 'clearInterval' in overrides ? overrides.clearInterval! : g.clearInterval?.bind(g) ?? notImplemented('clearInterval');\n    this.clearTimeout = 'clearTimeout' in overrides ? overrides.clearTimeout! : g.clearTimeout?.bind(g) ?? notImplemented('clearTimeout');\n    this.queueMicrotask = 'queueMicrotask' in overrides ? overrides.queueMicrotask! : g.queueMicrotask?.bind(g) ?? notImplemented('queueMicrotask');\n    this.setInterval = 'setInterval' in overrides ? overrides.setInterval! : g.setInterval?.bind(g) ?? notImplemented('setInterval');\n    this.setTimeout = 'setTimeout' in overrides ? overrides.setTimeout! : g.setTimeout?.bind(g) ?? notImplemented('setTimeout');\n    this.console = 'console' in overrides ? overrides.console! : g.console;\n\n    this.performanceNow = 'performanceNow' in overrides ? overrides.performanceNow! : g.performance?.now?.bind(g.performance) ?? notImplemented('performance.now');\n\n    this.flushMacroTask = this.flushMacroTask.bind(this);\n    this.taskQueue = new TaskQueue(this, this.requestMacroTask.bind(this), this.cancelMacroTask.bind(this));\n  }\n\n  public static getOrCreate<TGlobal extends typeof globalThis = typeof globalThis>(\n    g: TGlobal,\n    overrides: Partial<Exclude<Platform, 'globalThis'>> = {},\n  ): Platform<TGlobal> {\n    let platform = lookup.get(g);\n    if (platform === void 0) {\n      lookup.set(g, platform = new Platform(g, overrides));\n    }\n    return platform as Platform<TGlobal>;\n  }\n\n  public static set(g: typeof globalThis, platform: Platform): void {\n    lookup.set(g, platform);\n  }\n\n  protected macroTaskRequested: boolean = false;\n  protected macroTaskHandle: number = -1;\n  protected requestMacroTask(): void {\n    this.macroTaskRequested = true;\n    if (this.macroTaskHandle === -1) {\n      this.macroTaskHandle = this.setTimeout(this.flushMacroTask, 0);\n    }\n  }\n  protected cancelMacroTask(): void {\n    this.macroTaskRequested = false;\n    if (this.macroTaskHandle > -1) {\n      this.clearTimeout(this.macroTaskHandle);\n      this.macroTaskHandle = -1;\n    }\n  }\n  protected flushMacroTask(): void {\n    this.macroTaskHandle = -1;\n    if (this.macroTaskRequested === true) {\n      this.macroTaskRequested = false;\n      this.taskQueue.flush();\n    }\n  }\n}\n\ntype TaskCallback<T = any> = (delta: number) => T;\n\nfunction isPersistent(task: Task): boolean {\n  return task.persistent;\n}\nexport class TaskQueue {\n\n  /** @internal */ public _suspenderTask: Task | undefined = void 0;\n  /** @internal */ public _pendingAsyncCount: number = 0;\n\n  private processing: Task[] = [];\n  private pending: Task[] = [];\n  private delayed: Task[] = [];\n\n  private flushRequested: boolean = false;\n  private _yieldPromise: ExposedPromise | undefined = void 0;\n\n  private readonly taskPool: Task[] = [];\n  private _taskPoolSize: number = 0;\n  private _lastRequest: number = 0;\n  private _lastFlush: number = 0;\n\n  public get isEmpty(): boolean {\n    return (\n      this._pendingAsyncCount === 0 &&\n      this.processing.length === 0 &&\n      this.pending.length === 0 &&\n      this.delayed.length === 0\n    );\n  }\n\n  /**\n   * Persistent tasks will re-queue themselves indefinitely until they are explicitly canceled,\n   * so we consider them 'infinite work' whereas non-persistent (one-off) tasks are 'finite work'.\n   *\n   * This `hasNoMoreFiniteWork` getters returns true if either all remaining tasks are persistent, or if there are no more tasks.\n   *\n   * If that is the case, we can resolve the promise that was created when `yield()` is called.\n   *\n   * @internal\n   */\n  private get _hasNoMoreFiniteWork(): boolean {\n    return (\n      this._pendingAsyncCount === 0 &&\n      this.processing.every(isPersistent) &&\n      this.pending.every(isPersistent) &&\n      this.delayed.every(isPersistent)\n    );\n  }\n\n  /** @internal */ private readonly _tracer: Tracer;\n  public constructor(\n    public readonly platform: Platform,\n    private readonly $request: () => void,\n    private readonly $cancel: () => void,\n  ) {\n    this._tracer = new Tracer(platform.console);\n  }\n\n  public flush(time: number = this.platform.performanceNow()): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'flush'); }\n\n    this.flushRequested = false;\n    this._lastFlush = time;\n\n    // Only process normally if we are *not* currently waiting for an async task to finish\n    if (this._suspenderTask === void 0) {\n      if (this.pending.length > 0) {\n        this.processing.push(...this.pending);\n        this.pending.length = 0;\n      }\n      if (this.delayed.length > 0) {\n        let i = -1;\n        while (++i < this.delayed.length && this.delayed[i].queueTime <= time) { /* do nothing */ }\n        this.processing.push(...this.delayed.splice(0, i));\n      }\n\n      let cur: Task;\n      while (this.processing.length > 0) {\n        (cur = this.processing.shift()!).run();\n        // If it's still running, it can only be an async task\n        if (cur.status === TaskStatus.running) {\n          if (cur.suspend === true) {\n            this._suspenderTask = cur;\n            this._requestFlush();\n\n            if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'flush early async'); }\n\n            return;\n          } else {\n            ++this._pendingAsyncCount;\n          }\n        }\n      }\n\n      if (this.pending.length > 0) {\n        this.processing.push(...this.pending);\n        this.pending.length = 0;\n      }\n      if (this.delayed.length > 0) {\n        let i = -1;\n        while (++i < this.delayed.length && this.delayed[i].queueTime <= time) { /* do nothing */ }\n        this.processing.push(...this.delayed.splice(0, i));\n      }\n\n      if (this.processing.length > 0 || this.delayed.length > 0 || this._pendingAsyncCount > 0) {\n        this._requestFlush();\n      }\n\n      if (\n        this._yieldPromise !== void 0 &&\n        this._hasNoMoreFiniteWork\n      ) {\n        const p = this._yieldPromise;\n        this._yieldPromise = void 0;\n        p.resolve();\n      }\n    } else {\n      // If we are still waiting for an async task to finish, just schedule the next flush and do nothing else.\n      // Should the task finish before the next flush is invoked,\n      // the callback to `completeAsyncTask` will have reset `this.suspenderTask` back to undefined so processing can return back to normal next flush.\n      this._requestFlush();\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'flush full'); }\n  }\n\n  /**\n   * Cancel the next flush cycle (and/or the macrotask that schedules the next flush cycle, in case this is a microtask queue), if it was requested.\n   *\n   * This operation is idempotent and will do nothing if no flush is scheduled.\n   */\n  public cancel(): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'cancel'); }\n\n    if (this.flushRequested) {\n      this.$cancel();\n      this.flushRequested = false;\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'cancel'); }\n  }\n\n  /**\n   * Returns a promise that, when awaited, resolves when:\n   * - all *non*-persistent (including async) tasks have finished;\n   * - the last-added persistent task has run exactly once;\n   *\n   * This operation is idempotent: the same promise will be returned until it resolves.\n   *\n   * If `yield()` is called multiple times in a row when there are one or more persistent tasks in the queue, each call will await exactly one cycle of those tasks.\n   */\n  public async yield(): Promise<void> {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'yield'); }\n\n    if (this.isEmpty) {\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'yield empty'); }\n    } else {\n      if (this._yieldPromise === void 0) {\n        if (__DEV__ && this._tracer.enabled) { this._tracer.trace(this, 'yield - creating promise'); }\n        this._yieldPromise = createExposedPromise();\n      }\n\n      await this._yieldPromise;\n\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'yield task'); }\n    }\n  }\n\n  public queueTask<T = any>(callback: TaskCallback<T>, opts?: QueueTaskOptions): Task<T> {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'queueTask'); }\n\n    const { delay, preempt, persistent, reusable, suspend } = { ...defaultQueueTaskOptions, ...opts };\n\n    if (preempt) {\n      if (delay > 0) {\n        throw new Error(`Invalid arguments: preempt cannot be combined with a greater-than-zero delay`);\n      }\n      if (persistent) {\n        throw new Error(`Invalid arguments: preempt cannot be combined with persistent`);\n      }\n    }\n\n    if (this.processing.length === 0) {\n      this._requestFlush();\n    }\n\n    const time = this.platform.performanceNow();\n\n    let task: Task<T>;\n    if (reusable) {\n      const taskPool = this.taskPool;\n      const index = this._taskPoolSize - 1;\n      if (index >= 0) {\n        task = taskPool[index] as Task<T>;\n        taskPool[index] = (void 0)!;\n        this._taskPoolSize = index;\n\n        task.reuse(time, delay, preempt, persistent, suspend, callback);\n      } else {\n        task = new Task(this._tracer, this, time, time + delay, preempt, persistent, suspend, reusable, callback);\n      }\n    } else {\n      task = new Task(this._tracer, this, time, time + delay, preempt, persistent, suspend, reusable, callback);\n    }\n\n    if (preempt) {\n      this.processing[this.processing.length] = task;\n    } else if (delay === 0) {\n      this.pending[this.pending.length] = task;\n    } else {\n      this.delayed[this.delayed.length] = task;\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'queueTask'); }\n\n    return task;\n  }\n\n  /**\n   * Remove the task from this queue.\n   */\n  public remove<T = any>(task: Task<T>): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'remove'); }\n\n    let idx = this.processing.indexOf(task);\n    if (idx > -1) {\n      this.processing.splice(idx, 1);\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'remove processing'); }\n      return;\n    }\n    idx = this.pending.indexOf(task);\n    if (idx > -1) {\n      this.pending.splice(idx, 1);\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'remove pending'); }\n      return;\n    }\n    idx = this.delayed.indexOf(task);\n    if (idx > -1) {\n      this.delayed.splice(idx, 1);\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'remove delayed'); }\n      return;\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'remove error'); }\n\n    throw new Error(`Task #${task.id} could not be found`);\n  }\n\n  /**\n   * Return a reusable task to the shared task pool.\n   * The next queued callback will reuse this task object instead of creating a new one, to save overhead of creating additional objects.\n   */\n  private returnToPool(task: Task): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.trace(this, 'returnToPool'); }\n\n    this.taskPool[this._taskPoolSize++] = task;\n  }\n\n  /**\n   * Reset the persistent task back to its pending state, preparing it for being invoked again on the next flush.\n   */\n  private resetPersistentTask(task: Task): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'resetPersistentTask'); }\n\n    task.reset(this.platform.performanceNow());\n\n    if (task.createdTime === task.queueTime) {\n      this.pending[this.pending.length] = task;\n    } else {\n      this.delayed[this.delayed.length] = task;\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'resetPersistentTask'); }\n  }\n\n  /**\n   * Notify the queue that this async task has had its promise resolved, so that the queue can proceed with consecutive tasks on the next flush.\n   */\n  private completeAsyncTask(task: Task): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'completeAsyncTask'); }\n\n    if (task.suspend === true) {\n      if (this._suspenderTask !== task) {\n        if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'completeAsyncTask error'); }\n\n        throw new Error(`Async task completion mismatch: suspenderTask=${this._suspenderTask?.id}, task=${task.id}`);\n      }\n\n      this._suspenderTask = void 0;\n    } else {\n      --this._pendingAsyncCount;\n    }\n\n    if (\n      this._yieldPromise !== void 0 &&\n      this._hasNoMoreFiniteWork\n    ) {\n      const p = this._yieldPromise;\n      this._yieldPromise = void 0;\n      p.resolve();\n    }\n\n    if (this.isEmpty) {\n      this.cancel();\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'completeAsyncTask'); }\n  }\n\n  private readonly _requestFlush: () => void = () => {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'requestFlush'); }\n\n    if (!this.flushRequested) {\n      this.flushRequested = true;\n      this._lastRequest = this.platform.performanceNow();\n      this.$request();\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'requestFlush'); }\n  };\n}\n\nexport class TaskAbortError<T = any> extends Error {\n  public constructor(public task: Task<T>) {\n    super('Task was canceled.');\n  }\n}\n\nlet id: number = 0;\n\nexport const enum TaskStatus {\n  pending = 0,\n  running = 1,\n  completed = 2,\n  canceled = 3,\n}\n\ntype UnwrapPromise<T> = T extends Promise<infer R> ? R : T;\n\nexport interface ITask<T = any> {\n  readonly result: Promise<UnwrapPromise<T>>;\n  readonly status: TaskStatus;\n  run(): void;\n  cancel(): boolean;\n}\n\nexport class Task<T = any> implements ITask {\n  public readonly id: number = ++id;\n\n  /** @internal */ private _resolve: PResolve<UnwrapPromise<T>> | undefined = void 0;\n  /** @internal */ private _reject: PReject<TaskAbortError<T>> | undefined = void 0;\n\n  /** @internal */\n  private _result: Promise<UnwrapPromise<T>> | undefined = void 0;\n  public get result(): Promise<UnwrapPromise<T>> {\n    const result = this._result;\n    if (result === void 0) {\n      switch (this._status) {\n        case TaskStatus.pending: {\n          const promise = this._result = createExposedPromise();\n          this._resolve = promise.resolve;\n          this._reject = promise.reject;\n          return promise;\n        }\n        case TaskStatus.running:\n          throw new Error('Trying to await task from within task will cause a deadlock.');\n        case TaskStatus.completed:\n          return this._result = Promise.resolve() as unknown as Promise<UnwrapPromise<T>>;\n        case TaskStatus.canceled:\n          return this._result = Promise.reject(new TaskAbortError(this));\n      }\n    }\n    return result;\n  }\n\n  /** @internal */\n  private _status: TaskStatus = TaskStatus.pending;\n  public get status(): TaskStatus {\n    return this._status;\n  }\n\n  /** @internal */\n  private readonly _tracer: Tracer;\n\n  public constructor(\n    tracer: Tracer,\n    public readonly taskQueue: TaskQueue,\n    public createdTime: number,\n    public queueTime: number,\n    public preempt: boolean,\n    public persistent: boolean,\n    public suspend: boolean,\n    public readonly reusable: boolean,\n    public callback: TaskCallback<T>,\n  ) {\n    this._tracer = tracer;\n  }\n\n  public run(time: number = this.taskQueue.platform.performanceNow()): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'run'); }\n\n    if (this._status !== TaskStatus.pending) {\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'run error'); }\n\n      throw new Error(`Cannot run task in ${this._status} state`);\n    }\n\n    // this.persistent could be changed while the task is running (this can only be done by the task itself if canceled, and is a valid way of stopping a loop)\n    // so we deliberately reference this.persistent instead of the local variable, but we keep it around to know whether the task *was* persistent before running it,\n    // so we can set the correct cancelation state.\n    const {\n      persistent,\n      reusable,\n      taskQueue,\n      callback,\n      _resolve: resolve,\n      _reject: reject,\n      createdTime,\n    } = this;\n    let ret: unknown | Promise<unknown>;\n\n    this._status = TaskStatus.running;\n\n    try {\n      ret = callback(time - createdTime);\n      if (ret instanceof Promise) {\n        ret.then($ret => {\n          if (this.persistent) {\n            taskQueue['resetPersistentTask'](this);\n          } else {\n            if (persistent) {\n              // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n              this._status = TaskStatus.canceled;\n            } else {\n              this._status = TaskStatus.completed;\n            }\n\n            this.dispose();\n          }\n\n          taskQueue['completeAsyncTask'](this);\n\n          if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'run async then'); }\n\n          if (resolve !== void 0) {\n            resolve($ret as UnwrapPromise<T>);\n          }\n\n          if (!this.persistent && reusable) {\n            taskQueue['returnToPool'](this);\n          }\n        })\n        .catch((err: TaskAbortError<T>) => {\n          if (!this.persistent) {\n            this.dispose();\n          }\n\n          taskQueue['completeAsyncTask'](this);\n\n          if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'run async catch'); }\n\n          if (reject !== void 0) {\n            reject(err);\n          } else {\n            throw err;\n          }\n        });\n      } else {\n        if (this.persistent) {\n          taskQueue['resetPersistentTask'](this);\n        } else {\n          if (persistent) {\n            // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n            this._status = TaskStatus.canceled;\n          } else {\n            this._status = TaskStatus.completed;\n          }\n\n          this.dispose();\n        }\n\n        if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'run sync success'); }\n\n        if (resolve !== void 0) {\n          resolve(ret as UnwrapPromise<T>);\n        }\n\n        if (!this.persistent && reusable) {\n          taskQueue['returnToPool'](this);\n        }\n      }\n    } catch (err) {\n      if (!this.persistent) {\n        this.dispose();\n      }\n\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'run sync error'); }\n\n      if (reject !== void 0) {\n        reject(err as TaskAbortError<T>);\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  public cancel(): boolean {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'cancel'); }\n\n    if (this._status === TaskStatus.pending) {\n      const taskQueue = this.taskQueue;\n      const reusable = this.reusable;\n      const reject = this._reject;\n\n      taskQueue.remove(this);\n\n      if (taskQueue.isEmpty) {\n        taskQueue.cancel();\n      }\n\n      this._status = TaskStatus.canceled;\n\n      this.dispose();\n\n      if (reusable) {\n        taskQueue['returnToPool'](this);\n      }\n\n      if (reject !== void 0) {\n        reject(new TaskAbortError(this));\n      }\n\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'cancel true =pending'); }\n\n      return true;\n    } else if (this._status === TaskStatus.running && this.persistent) {\n      this.persistent = false;\n\n      if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'cancel true =running+persistent'); }\n\n      return true;\n    }\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'cancel false'); }\n\n    return false;\n  }\n\n  public reset(time: number): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'reset'); }\n\n    const delay = this.queueTime - this.createdTime;\n    this.createdTime = time;\n    this.queueTime = time + delay;\n    this._status = TaskStatus.pending;\n\n    this._resolve = void 0;\n    this._reject = void 0;\n    this._result = void 0;\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'reset'); }\n  }\n\n  public reuse(\n    time: number,\n    delay: number,\n    preempt: boolean,\n    persistent: boolean,\n    suspend: boolean,\n    callback: TaskCallback<T>,\n  ): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.enter(this, 'reuse'); }\n\n    this.createdTime = time;\n    this.queueTime = time + delay;\n    this.preempt = preempt;\n    this.persistent = persistent;\n    this.suspend = suspend;\n    this.callback = callback;\n    this._status = TaskStatus.pending;\n\n    if (__DEV__ && this._tracer.enabled) { this._tracer.leave(this, 'reuse'); }\n  }\n\n  public dispose(): void {\n    if (__DEV__ && this._tracer.enabled) { this._tracer.trace(this, 'dispose'); }\n\n    this.callback = (void 0)!;\n    this._resolve = void 0;\n    this._reject = void 0;\n    this._result = void 0;\n  }\n}\n\nfunction taskStatus(status: TaskStatus): 'pending' | 'running' | 'canceled' | 'completed' {\n  switch (status) {\n    case TaskStatus.pending: return 'pending';\n    case TaskStatus.running: return 'running';\n    case TaskStatus.canceled: return 'canceled';\n    case TaskStatus.completed: return 'completed';\n  }\n}\n\nclass Tracer {\n  public enabled: boolean = false;\n  private depth: number = 0;\n  public constructor(private readonly console: Platform['console']) {}\n\n  public enter(obj: TaskQueue | Task, method: string): void {\n    this.log(`${'  '.repeat(this.depth++)}> `, obj, method);\n  }\n  public leave(obj: TaskQueue | Task, method: string): void {\n    this.log(`${'  '.repeat(--this.depth)}< `, obj, method);\n  }\n  public trace(obj: TaskQueue | Task, method: string): void {\n    this.log(`${'  '.repeat(this.depth)}- `, obj, method);\n  }\n\n  private log(prefix: string, obj: TaskQueue | Task, method: string): void {\n    if (obj instanceof TaskQueue) {\n      const processing = obj['processing'].length;\n      const pending = obj['pending'].length;\n      const delayed = obj['delayed'].length;\n      const flushReq = obj['flushRequested'];\n      const susTask = !!obj._suspenderTask;\n\n      const info = `processing=${processing} pending=${pending} delayed=${delayed} flushReq=${flushReq} susTask=${susTask}`;\n      this.console.log(`${prefix}[Q.${method}] ${info}`);\n    } else {\n      const id = obj['id'];\n      const created = Math.round(obj['createdTime'] * 10) / 10;\n      const queue = Math.round(obj['queueTime'] * 10) / 10;\n      const preempt = obj['preempt'];\n      const reusable = obj['reusable'];\n      const persistent = obj['persistent'];\n      const suspend = obj['suspend'];\n      const status = taskStatus(obj['_status']);\n\n      const info = `id=${id} created=${created} queue=${queue} preempt=${preempt} persistent=${persistent} reusable=${reusable} status=${status} suspend=${suspend}`;\n      this.console.log(`${prefix}[T.${method}] ${info}`);\n    }\n  }\n}\nexport const enum TaskQueuePriority {\n  render     = 0,\n  macroTask  = 1,\n  postRender = 2,\n}\n\nexport type QueueTaskOptions = {\n  /**\n   * The number of milliseconds to wait before queueing the task.\n   *\n   * NOTE: just like `setTimeout`, there is no guarantee that the task will actually run\n   * after the specified delay. It is merely a *minimum* delay.\n   *\n   * Defaults to `0`\n   */\n  delay?: number;\n  /**\n   * If `true`, the task will be run synchronously if it is the same priority as the\n   * `TaskQueue` that is currently flushing. Otherwise, it will be run on the next tick.\n   *\n   * Defaults to `false`\n   */\n  preempt?: boolean;\n  /**\n   * If `true`, the task will be added back onto the queue after it finished running, indefinitely, until manually canceled.\n   *\n   * Defaults to `false`\n   */\n  persistent?: boolean;\n  /**\n   * If `true`, the task will be kept in-memory after finishing, so that it can be reused for future tasks for efficiency.\n   *\n   * Defaults to `true`\n   */\n  reusable?: boolean;\n  /**\n   * If `true`, and the task callback returns a promise, that promise will be awaited before consecutive tasks are run.\n   *\n   * Defaults to `false`.\n   */\n  suspend?: boolean;\n};\n\nconst defaultQueueTaskOptions: Required<QueueTaskOptions> = {\n  delay: 0,\n  preempt: false,\n  persistent: false,\n  reusable: true,\n  suspend: false,\n};\n\ntype PResolve<T> = (value: T | PromiseLike<T>) => void;\ntype PReject<T = any> = (reason?: T) => void;\nlet $resolve: PResolve<any>;\nlet $reject: PReject;\nfunction executor<T>(resolve: PResolve<T>, reject: PReject): void {\n  $resolve = resolve;\n  $reject = reject;\n}\n\ntype ExposedPromise<T = void> = Promise<T> & {\n  resolve: PResolve<T>;\n  reject: PReject;\n};\n\n/**\n * Efficiently create a promise where the `resolve` and `reject` functions are stored as properties on the prommise itself.\n */\nfunction createExposedPromise<T>(): ExposedPromise<T> {\n  const p = new Promise<T>(executor) as ExposedPromise<T>;\n  p.resolve = $resolve;\n  p.reject = $reject;\n  return p;\n}\n","import { Metadata, Protocol } from '@aurelia/kernel';\n\n/** @internal */ export const getOwnMetadata = Metadata.getOwn;\n/** @internal */ export const hasOwnMetadata = Metadata.hasOwn;\n/** @internal */ export const defineMetadata = Metadata.define;\n\nconst { annotation, resource } = Protocol;\n/** @internal */ export const getAnnotationKeyFor = annotation.keyFor;\n/** @internal */ export const getResourceKeyFor = resource.keyFor;\n/** @internal */ export const appendResourceKey = resource.appendTo;\n/** @internal */ export const appendAnnotationKey = annotation.appendTo;\n/** @internal */ export const getAllAnnotations = annotation.getKeys;\n","import type { ISVGAnalyzer } from './observation/svg-analyzer';\n\n/** @internal */ export const createLookup = <T = unknown>() => Object.create(null) as Record<string, T>;\n\n/** @internal */ export const hasOwnProperty = Object.prototype.hasOwnProperty;\n\nconst IsDataAttribute: Record<string, boolean> = createLookup();\n\n/** @internal */ export const isDataAttribute = (obj: Node, key: PropertyKey, svgAnalyzer: ISVGAnalyzer): boolean => {\n  if (IsDataAttribute[key as string] === true) {\n    return true;\n  }\n  if (!isString(key)) {\n    return false;\n  }\n  const prefix = key.slice(0, 5);\n  // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n  // https://html.spec.whatwg.org/multipage/dom.html#custom-data-attribute\n  return IsDataAttribute[key] =\n    prefix === 'aria-' ||\n    prefix === 'data-' ||\n    svgAnalyzer.isStandardSvgAttribute(obj, key);\n};\n\n/** @internal */ export const isPromise = <T>(v: unknown): v is Promise<T> => v instanceof Promise;\n\n// eslint-disable-next-line @typescript-eslint/ban-types\n/** @internal */ export const isFunction = <T, K extends Function>(v: unknown): v is K => typeof v === 'function';\n\n/** @internal */ export const isString = (v: unknown): v is string => typeof v === 'string';\n","import { kebabCase, firstDefined, getPrototypeChain, noop, Class } from '@aurelia/kernel';\nimport { BindingMode, ICoercionConfiguration } from '@aurelia/runtime';\nimport { appendAnnotationKey, defineMetadata, getAllAnnotations, getAnnotationKeyFor, getOwnMetadata, hasOwnMetadata } from './shared.js';\nimport { isString } from './utilities.js';\n\nimport type { Constructable, Writable } from '@aurelia/kernel';\nimport type { InterceptorFunc } from '@aurelia/runtime';\n\ntype PropertyType = typeof Number | typeof String | typeof Boolean | typeof BigInt | { coercer: InterceptorFunc } | Class<unknown>;\n\nexport type PartialBindableDefinition = {\n  mode?: BindingMode;\n  callback?: string;\n  attribute?: string;\n  property?: string;\n  primary?: boolean;\n  set?: InterceptorFunc;\n  type?: PropertyType;\n\n  /**\n   * When set to `false` and automatic type-coercion is enabled, `null` and `undefined` will be coerced into target type.\n   *\n   * @default true\n   */\n  nullable?: boolean;\n};\n\ntype PartialBindableDefinitionPropertyRequired = PartialBindableDefinition & {\n  property: string;\n};\n\ntype PartialBindableDefinitionPropertyOmitted = Omit<PartialBindableDefinition, 'property'>;\n\n/**\n * Decorator: Specifies custom behavior for a bindable property.\n *\n * @param config - The overrides\n */\nexport function bindable(config?: PartialBindableDefinitionPropertyOmitted): (target: {}, property: string) => void;\n/**\n * Decorator: Specifies a bindable property on a class.\n *\n * @param prop - The property name\n */\nexport function bindable(prop: string): (target: Constructable) => void;\n/**\n * Decorator: Specifies a bindable property on a class.\n *\n * @param target - The class\n * @param prop - The property name\n */\nexport function bindable(target: {}, prop: string): void;\nexport function bindable(configOrTarget?: PartialBindableDefinition | {}, prop?: string): void | ((target: {}, property: string) => void) | ((target: Constructable) => void) {\n  let config: PartialBindableDefinition;\n\n  function decorator($target: {}, $prop: string): void {\n    if (arguments.length > 1) {\n      // Non invocation:\n      // - @bindable\n      // Invocation with or w/o opts:\n      // - @bindable()\n      // - @bindable({...opts})\n      config.property = $prop;\n    }\n\n    defineMetadata(baseName, BindableDefinition.create($prop, $target as Constructable, config), $target.constructor, $prop);\n    appendAnnotationKey($target.constructor as Constructable, Bindable.keyFrom($prop));\n  }\n\n  if (arguments.length > 1) {\n    // Non invocation:\n    // - @bindable\n    config = {};\n    decorator(configOrTarget!, prop!);\n    return;\n  } else if (isString(configOrTarget)) {\n    // ClassDecorator\n    // - @bindable('bar')\n    // Direct call:\n    // - @bindable('bar')(Foo)\n    config = {};\n    return decorator;\n  }\n\n  // Invocation with or w/o opts:\n  // - @bindable()\n  // - @bindable({...opts})\n  config = configOrTarget === void 0 ? {} : configOrTarget;\n  return decorator;\n}\n\nfunction isBindableAnnotation(key: string): boolean {\n  return key.startsWith(baseName);\n}\n\ntype BFluent = {\n  add(config: PartialBindableDefinitionPropertyRequired): BFluent;\n  add(property: string): BFluent & B12345;\n};\n\ntype B1<T = {}> = {\n  mode(mode: BindingMode): BFluent & T;\n};\n\ntype B2<T = {}> = {\n  callback(callback: string): BFluent & T;\n};\n\ntype B3<T = {}> = {\n  attribute(attribute: string): BFluent & T;\n};\n\ntype B4<T = {}> = {\n  primary(): BFluent & T;\n};\n\ntype B5<T = {}> = {\n  set(setterFn: InterceptorFunc): BFluent & T;\n};\n\n// An important self-imposed limitation for this to be viable (e.g. avoid exponential combination growth),\n// is to keep the fluent API invocation order in a single direction.\ntype B45 = B5 & B4<B5>;\ntype B345 = B45 & B3<B45>;\ntype B2345 = B345 & B2<B345>;\ntype B12345 = B2345 & B1<B2345>;\n\nconst baseName = getAnnotationKeyFor('bindable');\n\nexport const Bindable = Object.freeze({\n  name: baseName,\n  keyFrom: (name: string): string => `${baseName}:${name}`,\n  from(type: Constructable, ...bindableLists: readonly (BindableDefinition | Record<string, PartialBindableDefinition> | readonly string[] | undefined)[]): Record<string, BindableDefinition> {\n    const bindables: Record<string, BindableDefinition> = {};\n\n    const isArray = Array.isArray as <T>(arg: unknown) => arg is readonly T[];\n\n    function addName(name: string): void {\n      bindables[name] = BindableDefinition.create(name, type);\n    }\n\n    function addDescription(name: string, def: PartialBindableDefinition): void {\n      bindables[name] = def instanceof BindableDefinition ? def : BindableDefinition.create(name, type, def);\n    }\n\n    function addList(maybeList: BindableDefinition | Record<string, PartialBindableDefinition> | readonly string[] | undefined): void {\n      if (isArray(maybeList)) {\n        maybeList.forEach(addName);\n      } else if (maybeList instanceof BindableDefinition) {\n        bindables[maybeList.property] = maybeList;\n      } else if (maybeList !== void 0) {\n        Object.keys(maybeList).forEach(name => addDescription(name, maybeList[name]));\n      }\n    }\n\n    bindableLists.forEach(addList);\n\n    return bindables;\n  },\n  for(Type: Constructable): BFluent {\n    let def: Writable<BindableDefinition>;\n\n    const builder: BFluent & B12345 = {\n      add(configOrProp: string | PartialBindableDefinitionPropertyRequired): BFluent & B12345 {\n        let prop: string;\n        let config: PartialBindableDefinitionPropertyRequired;\n        if (isString(configOrProp)) {\n          prop = configOrProp;\n          config = { property: prop };\n        } else {\n          prop = configOrProp.property;\n          config = configOrProp;\n        }\n\n        def = BindableDefinition.create(prop, Type, config) as Writable<BindableDefinition>;\n        if (!hasOwnMetadata(baseName, Type, prop)) {\n          appendAnnotationKey(Type, Bindable.keyFrom(prop));\n        }\n        defineMetadata(baseName, def, Type, prop);\n\n        return builder;\n      },\n      mode(mode: BindingMode): BFluent & B12345 {\n        def.mode = mode;\n\n        return builder;\n      },\n      callback(callback: string): BFluent & B12345 {\n        def.callback = callback;\n\n        return builder;\n      },\n      attribute(attribute: string): BFluent & B12345 {\n        def.attribute = attribute;\n\n        return builder;\n      },\n      primary(): BFluent & B12345 {\n        def.primary = true;\n\n        return builder;\n      },\n      set(setInterpreter: InterceptorFunc): BFluent & B12345 {\n        def.set = setInterpreter;\n\n        return builder;\n      }\n    };\n\n    return builder;\n  },\n  getAll(Type: Constructable): readonly BindableDefinition[] {\n    const propStart = baseName.length + 1;\n    const defs: BindableDefinition[] = [];\n    const prototypeChain = getPrototypeChain(Type);\n\n    let iProto = prototypeChain.length;\n    let iDefs = 0;\n    let keys: string[];\n    let keysLen: number;\n    let Class: Constructable;\n    let i: number;\n    while (--iProto >= 0) {\n      Class = prototypeChain[iProto];\n      keys = getAllAnnotations(Class).filter(isBindableAnnotation);\n      keysLen = keys.length;\n      for (i = 0; i < keysLen; ++i) {\n        defs[iDefs++] = getOwnMetadata(baseName, Class, keys[i].slice(propStart)) as BindableDefinition;\n      }\n    }\n    return defs;\n  },\n});\n\nexport class BindableDefinition {\n  private constructor(\n    public readonly attribute: string,\n    public readonly callback: string,\n    public readonly mode: BindingMode,\n    public readonly primary: boolean,\n    public readonly property: string,\n    public readonly set: InterceptorFunc,\n  ) { }\n\n  public static create(prop: string, target: Constructable<unknown>, def: PartialBindableDefinition = {}): BindableDefinition {\n    return new BindableDefinition(\n      firstDefined(def.attribute, kebabCase(prop)),\n      firstDefined(def.callback, `${prop}Changed`),\n      firstDefined(def.mode, BindingMode.toView),\n      firstDefined(def.primary, false),\n      firstDefined(def.property, prop),\n      firstDefined(def.set, getInterceptor(prop, target, def)),\n    );\n  }\n}\n\n/* eslint-disable @typescript-eslint/no-unused-vars,spaced-comment */\n/**\n * This function serves two purposes:\n * - A playground for contributors to try their changes to the APIs.\n * - Cause the API surface to be properly type-checked and protected against accidental type regressions.\n *\n * It will be automatically removed by dead code elimination.\n */\nfunction apiTypeCheck() {\n\n  @bindable('prop')\n  // > expected error - class decorator only accepts a string\n  //@bindable({})\n  class Foo {\n    @bindable\n    @bindable()\n    @bindable({})\n    // > expected error - 'property' does not exist on decorator input object\n    //@bindable({ property: 'prop' })\n    @bindable({ mode: BindingMode.twoWay })\n    @bindable({ callback: 'propChanged' })\n    @bindable({ attribute: 'prop' })\n    @bindable({ primary: true })\n    @bindable({ set: value => String(value) })\n    @bindable({ set: value => Number(value) })\n    @bindable({\n      mode: BindingMode.twoWay,\n      callback: 'propChanged',\n      attribute: 'prop',\n      primary: true,\n      set: value => String(value)\n    })\n    public prop: unknown;\n  }\n\n  Bindable.for(Foo)\n    // > expected error - there is no add() function with only optional params on the fluent api\n    //.add()\n    // > expected error - 'property' is a required property on the fluent api\n    //.add({})\n    .add({ property: 'prop' })\n    .add({ property: 'prop', mode: BindingMode.twoWay })\n    .add({ property: 'prop', callback: 'propChanged' })\n    .add({ property: 'prop', attribute: 'prop' })\n    .add({ property: 'prop', primary: true })\n    .add({ property: 'prop', mode: BindingMode.twoWay, callback: 'propChanged', attribute: 'prop', primary: true })\n    .add('prop')\n    // > expected error - the add() method that accepts an object literal does not return a fluent api\n    //.add({ property: 'prop' }).mode(BindingMode.twoWay)\n    //.add({ property: 'prop' }).callback('propChanged')\n    //.add({ property: 'prop' }).attribute('prop')\n    //.add({ property: 'prop' }).primary()\n    // > expected error - fluent api methods can only be invoked once per bindable\n    //.add('prop').mode(BindingMode.twoWay).mode(BindingMode.twoWay)\n    //.add('prop').mode(BindingMode.twoWay).callback('propChanged').mode(BindingMode.twoWay)\n    //.add('prop').mode(BindingMode.twoWay).callback('propChanged').callback('propChanged') // etc\n    // > expected error - wrong invocation order\n    //.add('prop').callback('propChanged').mode(BindingMode.twoWay)\n    //.add('prop').primary().mode(BindingMode.twoWay)  // etc\n    .add('prop').mode(BindingMode.twoWay)\n    .add('prop').mode(BindingMode.twoWay).callback('propChanged')\n    .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop')\n    .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop').primary()\n    .add('prop').mode(BindingMode.twoWay).set((value: unknown) => Number(value))\n    .add('prop').mode(BindingMode.twoWay).callback('propChanged').set(value => Number(value))\n    .add('prop').callback('propChanged')\n    .add('prop').callback('propChanged').attribute('prop')\n    .add('prop').callback('propChanged').attribute('prop').primary()\n    .add('prop').attribute('prop')\n    .add('prop').attribute('prop').primary()\n    .add('prop').primary();\n}\n/* eslint-enable @typescript-eslint/no-unused-vars,spaced-comment */\n\n/** @internal */\n// eslint-disable-next-line @typescript-eslint/no-namespace\ndeclare namespace Reflect {\n  function getMetadata(metadataKey: any, target: any, propertyKey?: string | symbol): any;\n}\n\nexport function coercer(target: Constructable<unknown>, property: string, _descriptor: PropertyDescriptor): void {\n  Coercer.define(target, property);\n}\n\nconst Coercer = {\n  key: getAnnotationKeyFor('coercer'),\n  define(target: Constructable<unknown>, property: string) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n    defineMetadata(Coercer.key, ((target as any)[property] as InterceptorFunc).bind(target), target);\n  },\n  for(target: Constructable<unknown>) {\n    return getOwnMetadata(Coercer.key, target) as InterceptorFunc;\n  }\n};\n\nfunction getInterceptor(prop: string, target: Constructable<unknown>, def: PartialBindableDefinition = {}) {\n  const type: PropertyType | null = def.type ?? Reflect.getMetadata('design:type', target, prop) ?? null;\n  if (type == null) { return noop; }\n  let coercer: InterceptorFunc;\n  switch (type) {\n    case Number:\n    case Boolean:\n    case String:\n    case BigInt:\n      coercer = type as InterceptorFunc;\n      break;\n    default: {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n      const $coercer: InterceptorFunc = (type as any).coerce as InterceptorFunc;\n      coercer = typeof $coercer === 'function'\n        ? $coercer.bind(type)\n        : (Coercer.for(type as Constructable) ?? noop);\n      break;\n    }\n  }\n  return coercer === noop\n    ? coercer\n    : createCoercer(coercer, def.nullable);\n}\n\nfunction createCoercer<TInput, TOutput>(coercer: InterceptorFunc<TInput, TOutput>, nullable: boolean | undefined): InterceptorFunc<TInput, TOutput> {\n  return function (value: TInput, coercionConfiguration: ICoercionConfiguration | null): TOutput {\n    if (!coercionConfiguration?.enableCoercion) return value as unknown as TOutput;\n    return ((nullable ?? ((coercionConfiguration?.coerceNullish ?? false) ? false : true)) && value == null)\n      ? value as unknown as TOutput\n      : coercer(value, coercionConfiguration);\n  };\n}\n","import { noop } from '@aurelia/kernel';\nimport { subscriberCollection, AccessorType, LifecycleFlags, withFlushQueue, ICoercionConfiguration } from '@aurelia/runtime';\nimport { isFunction } from '../utilities.js';\n\nimport type { IIndexable } from '@aurelia/kernel';\nimport type {\n  InterceptorFunc,\n  IObserver,\n  ISubscriber,\n  ISubscriberCollection,\n  IFlushable,\n  IWithFlushQueue,\n  FlushQueue,\n} from '@aurelia/runtime';\nimport type { IController } from '../templating/controller';\n\nexport interface BindableObserver extends IObserver, ISubscriberCollection {}\n\ninterface IMayHavePropertyChangedCallback {\n  propertyChanged?(name: string, newValue: unknown, oldValue: unknown, flags: LifecycleFlags): void;\n}\n\ntype HasPropertyChangedCallback = Required<IMayHavePropertyChangedCallback>;\n\nexport class BindableObserver implements IFlushable, IWithFlushQueue {\n  public get type(): AccessorType { return AccessorType.Observer; }\n\n  /** @internal */\n  private _value: unknown = void 0;\n  /** @internal */\n  private _oldValue: unknown = void 0;\n\n  public queue!: FlushQueue;\n\n  /** @internal */\n  private _observing: boolean;\n\n  /** @internal */\n  private readonly cb: (newValue: unknown, oldValue: unknown, flags: LifecycleFlags) => void;\n\n  /** @internal */\n  private readonly _cbAll: HasPropertyChangedCallback['propertyChanged'];\n\n  /** @internal */\n  private readonly _hasCb: boolean;\n\n  /** @internal */\n  private readonly _hasCbAll: boolean;\n\n  /** @internal */\n  private readonly _hasSetter: boolean;\n\n  /** @internal */\n  private f: LifecycleFlags = LifecycleFlags.none;\n\n  /** @internal */\n  private readonly _obj: IIndexable;\n\n  /** @internal */\n  private readonly _key: string;\n\n  public constructor(\n    obj: IIndexable,\n    key: string,\n    cbName: string,\n    private readonly set: InterceptorFunc,\n    // todo: a future feature where the observer is not instantiated via a controller\n    // this observer can become more static, as in immediately available when used\n    // in the form of a decorator\n    public readonly $controller: IController | null,\n    private readonly _coercionConfig: ICoercionConfiguration | null,\n  ) {\n    const cb = obj[cbName] as typeof BindableObserver.prototype.cb;\n    const cbAll = (obj as IMayHavePropertyChangedCallback).propertyChanged!;\n    const hasCb = this._hasCb = isFunction(cb);\n    const hasCbAll = this._hasCbAll = isFunction(cbAll);\n    const hasSetter = this._hasSetter = set !== noop;\n    let val: unknown;\n\n    this._obj = obj;\n    this._key = key;\n    this.cb = hasCb ? cb : noop;\n    this._cbAll = hasCbAll ? cbAll : noop;\n    // when user declare @bindable({ set })\n    // it's expected to work from the start,\n    // regardless where the assignment comes from: either direct view model assignment or from binding during render\n    // so if either getter/setter config is present, alter the accessor straight await\n    if (this.cb === void 0 && !hasCbAll && !hasSetter) {\n      this._observing = false;\n    } else {\n      this._observing = true;\n\n      val = obj[key];\n      this._value = hasSetter && val !== void 0 ? set(val, this._coercionConfig) : val;\n      this._createGetterSetter();\n    }\n  }\n\n  public getValue(): unknown {\n    return this._value;\n  }\n\n  public setValue(newValue: unknown, flags: LifecycleFlags): void {\n    if (this._hasSetter) {\n      newValue = this.set(newValue, this._coercionConfig);\n    }\n\n    const currentValue = this._value;\n    if (this._observing) {\n      if (Object.is(newValue, currentValue)) {\n        return;\n      }\n      this._value = newValue;\n      this._oldValue = currentValue;\n      this.f = flags;\n      // todo: controller (if any) state should determine the invocation instead\n      if (/* either not instantiated via a controller */this.$controller == null\n        /* or the controller instantiating this is bound */|| this.$controller.isBound\n      ) {\n        if (this._hasCb) {\n          this.cb.call(this._obj, newValue, currentValue, flags);\n        }\n        if (this._hasCbAll) {\n          this._cbAll.call(this._obj, this._key, newValue, currentValue, flags);\n        }\n      }\n      this.queue.add(this);\n      // this.subs.notify(newValue, currentValue, flags);\n    } else {\n      // See SetterObserver.setValue for explanation\n      this._obj[this._key] = newValue;\n    }\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (!this._observing === false) {\n      this._observing = true;\n      this._value = this._hasSetter\n        ? this.set(this._obj[this._key], this._coercionConfig)\n        : this._obj[this._key];\n      this._createGetterSetter();\n    }\n\n    this.subs.add(subscriber);\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, this.f);\n  }\n\n  /** @internal */\n  private _createGetterSetter(): void {\n    Reflect.defineProperty(\n      this._obj,\n      this._key,\n      {\n        enumerable: true,\n        configurable: true,\n        get: (/* Bindable Observer */) => this._value,\n        set: (/* Bindable Observer */value: unknown) => {\n          this.setValue(value, LifecycleFlags.none);\n        }\n      }\n    );\n  }\n}\n\nsubscriberCollection(BindableObserver);\nwithFlushQueue(BindableObserver);\n\n// a reusable variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n","import { DI, emptyArray, Protocol, Registration, all } from '@aurelia/kernel';\nimport { appendAnnotationKey, appendResourceKey, defineMetadata, getResourceKeyFor } from '../shared.js';\nimport type { Class, Constructable, IContainer, ResourceDefinition, ResourceType } from '@aurelia/kernel';\n\nexport interface AttributePatternDefinition {\n  pattern: string;\n  symbols: string;\n}\n\nexport interface ICharSpec {\n  chars: string;\n  repeat: boolean;\n  isSymbol: boolean;\n  isInverted: boolean;\n  has(char: string): boolean;\n  equals(other: ICharSpec): boolean;\n}\n\nexport class CharSpec implements ICharSpec {\n  public has: (char: string) => boolean;\n\n  public constructor(\n    public chars: string,\n    public repeat: boolean,\n    public isSymbol: boolean,\n    public isInverted: boolean,\n  ) {\n    if (isInverted) {\n      switch (chars.length) {\n        case 0:\n          this.has = this._hasOfNoneInverse;\n          break;\n        case 1:\n          this.has = this._hasOfSingleInverse;\n          break;\n        default:\n          this.has = this._hasOfMultipleInverse;\n      }\n    } else {\n      switch (chars.length) {\n        case 0:\n          this.has = this._hasOfNone;\n          break;\n        case 1:\n          this.has = this._hasOfSingle;\n          break;\n        default:\n          this.has = this._hasOfMultiple;\n      }\n    }\n  }\n\n  public equals(other: ICharSpec): boolean {\n    return this.chars === other.chars\n      && this.repeat === other.repeat\n      && this.isSymbol === other.isSymbol\n      && this.isInverted === other.isInverted;\n  }\n\n  private _hasOfMultiple(char: string): boolean {\n    return this.chars.includes(char);\n  }\n\n  private _hasOfSingle(char: string): boolean {\n    return this.chars === char;\n  }\n\n  private _hasOfNone(_char: string): boolean {\n    return false;\n  }\n\n  private _hasOfMultipleInverse(char: string): boolean {\n    return !this.chars.includes(char);\n  }\n\n  private _hasOfSingleInverse(char: string): boolean {\n    return this.chars !== char;\n  }\n\n  private _hasOfNoneInverse(_char: string): boolean {\n    return true;\n  }\n}\n\nexport class Interpretation {\n  public parts: readonly string[] = emptyArray;\n  public get pattern(): string | null {\n    const value = this._pattern;\n    if (value === '') {\n      return null;\n    } else {\n      return value;\n    }\n  }\n  public set pattern(value: string | null) {\n    if (value == null) {\n      this._pattern = '';\n      this.parts = emptyArray;\n    } else {\n      this._pattern = value;\n      this.parts = this._partsRecord[value];\n    }\n  }\n  /** @internal */\n  private _pattern: string = '';\n  /** @internal */\n  private readonly _currentRecord: Record<string, string> = {};\n  /** @internal */\n  private readonly _partsRecord: Record<string, string[]> = {};\n\n  public append(pattern: string, ch: string): void {\n    const currentRecord = this._currentRecord;\n    if (currentRecord[pattern] === undefined) {\n      currentRecord[pattern] = ch;\n    } else {\n      currentRecord[pattern] += ch;\n    }\n  }\n\n  public next(pattern: string): void {\n    const currentRecord = this._currentRecord;\n    let partsRecord: Interpretation['_partsRecord'];\n\n    if (currentRecord[pattern] !== undefined) {\n      partsRecord = this._partsRecord;\n      if (partsRecord[pattern] === undefined) {\n        partsRecord[pattern] = [currentRecord[pattern]];\n      } else {\n        partsRecord[pattern].push(currentRecord[pattern]);\n      }\n      currentRecord[pattern] = undefined!;\n    }\n  }\n}\n\nexport class State {\n  public nextStates: State[] = [];\n  public types: SegmentTypes | null = null;\n  public patterns: string[];\n  public isEndpoint: boolean = false;\n  public get pattern(): string | null {\n    return this.isEndpoint ? this.patterns[0] : null;\n  }\n\n  public constructor(\n    public charSpec: ICharSpec,\n    ...patterns: string[]\n  ) {\n    this.patterns = patterns;\n  }\n\n  public findChild(charSpec: ICharSpec): State {\n    const nextStates = this.nextStates;\n    const len = nextStates.length;\n    let child: State = null!;\n    let i = 0;\n    for (; i < len; ++i) {\n      child = nextStates[i];\n      if (charSpec.equals(child.charSpec)) {\n        return child;\n      }\n    }\n    return null!;\n  }\n\n  public append(charSpec: ICharSpec, pattern: string): State {\n    const patterns = this.patterns;\n    if (!patterns.includes(pattern)) {\n      patterns.push(pattern);\n    }\n    let state = this.findChild(charSpec);\n    if (state == null) {\n      state = new State(charSpec, pattern);\n      this.nextStates.push(state);\n      if (charSpec.repeat) {\n        state.nextStates.push(state);\n      }\n    }\n    return state;\n  }\n\n  public findMatches(ch: string, interpretation: Interpretation): State[] {\n    // TODO: reuse preallocated arrays\n    const results = [];\n    const nextStates = this.nextStates;\n    const len = nextStates.length;\n    let childLen = 0;\n    let child: State = null!;\n    let i = 0;\n    let j = 0;\n    for (; i < len; ++i) {\n      child = nextStates[i];\n      if (child.charSpec.has(ch)) {\n        results.push(child);\n        childLen = child.patterns.length;\n        j = 0;\n        if (child.charSpec.isSymbol) {\n          for (; j < childLen; ++j) {\n            interpretation.next(child.patterns[j]);\n          }\n        } else {\n          for (; j < childLen; ++j) {\n            interpretation.append(child.patterns[j], ch);\n          }\n        }\n      }\n    }\n    return results;\n  }\n}\n\n/** @internal */\nexport interface ISegment {\n  text: string;\n  eachChar(callback: (spec: CharSpec) => void): void;\n}\n\n/** @internal */\nexport class StaticSegment implements ISegment {\n  private readonly len: number;\n  private readonly specs: CharSpec[];\n\n  public constructor(\n    public text: string,\n  ) {\n    const len = this.len = text.length;\n    const specs = this.specs = [] as CharSpec[];\n    let i = 0;\n    for (; len > i; ++i) {\n      specs.push(new CharSpec(text[i], false, false, false));\n    }\n  }\n\n  public eachChar(callback: (spec: CharSpec) => void): void {\n    const len = this.len;\n    const specs = this.specs;\n    let i = 0;\n    for (; len > i; ++i) {\n      callback(specs[i]);\n    }\n  }\n}\n\n/** @internal */\nexport class DynamicSegment implements ISegment {\n  public text: string = 'PART';\n  private readonly spec: CharSpec;\n\n  public constructor(symbols: string) {\n    this.spec = new CharSpec(symbols, true, false, true);\n  }\n\n  public eachChar(callback: (spec: CharSpec) => void): void {\n    callback(this.spec);\n  }\n}\n\n/** @internal */\nexport class SymbolSegment implements ISegment {\n  private readonly spec: CharSpec;\n\n  public constructor(\n    public text: string,\n  ) {\n    this.spec = new CharSpec(text, false, true, false);\n  }\n\n  public eachChar(callback: (spec: CharSpec) => void): void {\n    callback(this.spec);\n  }\n}\n\nexport class SegmentTypes {\n  public statics: number = 0;\n  public dynamics: number = 0;\n  public symbols: number = 0;\n}\n\nexport interface ISyntaxInterpreter extends SyntaxInterpreter {}\nexport const ISyntaxInterpreter = DI.createInterface<ISyntaxInterpreter>('ISyntaxInterpreter', x => x.singleton(SyntaxInterpreter));\n\nexport class SyntaxInterpreter {\n  public rootState: State = new State(null!);\n  private readonly initialStates: State[] = [this.rootState];\n\n  // todo: this only works if this method is ever called only once\n  public add(defs: AttributePatternDefinition[]): void {\n    defs = defs.slice(0).sort((d1, d2) => d1.pattern > d2.pattern ? 1 : -1);\n    const ii = defs.length;\n    let currentState: State;\n    let def: AttributePatternDefinition;\n    let pattern: string;\n    let types: SegmentTypes;\n    let segments: ISegment[];\n    let len: number;\n    let charSpecCb: (ch: ICharSpec) => void;\n    let i = 0;\n    let j: number;\n    while (ii > i) {\n      currentState = this.rootState;\n      def = defs[i];\n      pattern = def.pattern;\n      types = new SegmentTypes();\n      segments = this.parse(def, types);\n      len = segments.length;\n      charSpecCb = (ch: ICharSpec) => {\n        currentState = currentState.append(ch, pattern);\n      };\n      for (j = 0; len > j; ++j) {\n        segments[j].eachChar(charSpecCb);\n      }\n      currentState.types = types;\n      currentState.isEndpoint = true;\n      ++i;\n    }\n  }\n\n  public interpret(name: string): Interpretation {\n    const interpretation = new Interpretation();\n    const len = name.length;\n    let states = this.initialStates;\n    let i = 0;\n    let state: State;\n    for (; i < len; ++i) {\n      states = this.getNextStates(states, name.charAt(i), interpretation);\n      if (states.length === 0) {\n        break;\n      }\n    }\n\n    states = states.filter(isEndpoint);\n\n    if (states.length > 0) {\n      states.sort(sortEndpoint);\n      state = states[0];\n      if (!state.charSpec.isSymbol) {\n        interpretation.next(state.pattern!);\n      }\n      interpretation.pattern = state.pattern;\n    }\n    return interpretation;\n  }\n\n  public getNextStates(states: State[], ch: string, interpretation: Interpretation): State[] {\n    // TODO: reuse preallocated arrays\n    const nextStates: State[] = [];\n    let state: State = null!;\n    const len = states.length;\n    let i = 0;\n    for (; i < len; ++i) {\n      state = states[i];\n      nextStates.push(...state.findMatches(ch, interpretation));\n    }\n\n    return nextStates;\n  }\n\n  private parse(def: AttributePatternDefinition, types: SegmentTypes): ISegment[] {\n    const result = [];\n    const pattern = def.pattern;\n    const len = pattern.length;\n    const symbols = def.symbols;\n    let i = 0;\n    let start = 0;\n    let c = '';\n\n    while (i < len) {\n      c = pattern.charAt(i);\n      if (symbols.length === 0 || !symbols.includes(c)) {\n        if (i === start) {\n          if (c === 'P' && pattern.slice(i, i + 4) === 'PART') {\n            start = i = (i + 4);\n            result.push(new DynamicSegment(symbols));\n            ++types.dynamics;\n          } else {\n            ++i;\n          }\n        } else {\n          ++i;\n        }\n      } else if (i !== start) {\n        result.push(new StaticSegment(pattern.slice(start, i)));\n        ++types.statics;\n        start = i;\n      } else {\n        result.push(new SymbolSegment(pattern.slice(start, i + 1)));\n        ++types.symbols;\n        start = ++i;\n      }\n    }\n    if (start !== i) {\n      result.push(new StaticSegment(pattern.slice(start, i)));\n      ++types.statics;\n    }\n\n    return result;\n  }\n}\n\nfunction isEndpoint(a: State) {\n  return a.isEndpoint;\n}\n\nfunction sortEndpoint(a: State, b: State) {\n  // both a and b are endpoints\n  // compare them based on the number of static, then dynamic & symbol fragments\n  const aTypes = a.types!;\n  const bTypes = b.types!;\n  if (aTypes.statics !== bTypes.statics) {\n    return bTypes.statics - aTypes.statics;\n  }\n  if (aTypes.dynamics !== bTypes.dynamics) {\n    return bTypes.dynamics - aTypes.dynamics;\n  }\n  if (aTypes.symbols !== bTypes.symbols) {\n    return bTypes.symbols - aTypes.symbols;\n  }\n  return 0;\n}\n\nexport class AttrSyntax {\n  public constructor(\n    public rawName: string,\n    public rawValue: string,\n    public target: string,\n    public command: string | null,\n  ) {}\n}\n\nexport interface IAttributePattern {\n  [pattern: string]: (rawName: string, rawValue: string, parts: readonly string[]) => AttrSyntax;\n}\n\nexport const IAttributePattern = DI.createInterface<IAttributePattern>('IAttributePattern');\n\nexport interface IAttributeParser extends AttributeParser {}\nexport const IAttributeParser = DI.createInterface<IAttributeParser>('IAttributeParser', x => x.singleton(AttributeParser));\n\nexport class AttributeParser {\n  /** @internal */\n  protected static inject = [ISyntaxInterpreter, all(IAttributePattern)];\n\n  /** @internal */ private readonly _cache: Record<string, Interpretation> = {};\n  /**\n   * A 2 level record with the same key on both levels.\n   * Just a trick to maintain `this` + have simple lookup + support multi patterns per class definition\n   *\n   * @internal\n   */\n  private readonly _patterns: Record<string, IAttributePattern>;\n  /** @internal */ private readonly _interpreter: ISyntaxInterpreter;\n\n  public constructor(\n    interpreter: ISyntaxInterpreter,\n    attrPatterns: IAttributePattern[],\n  ) {\n    this._interpreter = interpreter;\n    const patterns: AttributeParser['_patterns'] = this._patterns = {};\n    const allDefs = attrPatterns.reduce<AttributePatternDefinition[]>(\n      (allDefs, attrPattern) => {\n        const patternDefs = getAllPatternDefinitions(attrPattern.constructor as Constructable);\n        patternDefs.forEach(def => patterns[def.pattern] = attrPattern);\n        return allDefs.concat(patternDefs);\n      },\n      emptyArray as AttributePatternDefinition[]\n    );\n    interpreter.add(allDefs);\n  }\n\n  public parse(name: string, value: string): AttrSyntax {\n    let interpretation = this._cache[name];\n    if (interpretation == null) {\n      interpretation = this._cache[name] = this._interpreter.interpret(name);\n    }\n    const pattern = interpretation.pattern;\n    if (pattern == null) {\n      return new AttrSyntax(name, value, name, null);\n    } else {\n      return this._patterns[pattern][pattern](name, value, interpretation.parts);\n    }\n  }\n}\n\ntype DecoratableAttributePattern<TProto, TClass> = Class<TProto & Partial<{} | IAttributePattern>, TClass>;\ntype DecoratedAttributePattern<TProto, TClass> = Class<TProto & IAttributePattern, TClass>;\n\ntype AttributePatternDecorator = <TProto, TClass>(target: DecoratableAttributePattern<TProto, TClass>) => DecoratedAttributePattern<TProto, TClass>;\n\nexport interface AttributePattern {\n  readonly name: string;\n  readonly definitionAnnotationKey: string;\n  define<TProto, TClass>(patternDefs: AttributePatternDefinition[], Type: DecoratableAttributePattern<TProto, TClass>): DecoratedAttributePattern<TProto, TClass>;\n  getPatternDefinitions<TProto, TClass>(Type: DecoratedAttributePattern<TProto, TClass>): AttributePatternDefinition[];\n}\n\nexport function attributePattern(...patternDefs: AttributePatternDefinition[]): AttributePatternDecorator {\n  return function decorator<TProto, TClass>(target: DecoratableAttributePattern<TProto, TClass>): DecoratedAttributePattern<TProto, TClass> {\n    return AttributePattern.define(patternDefs, target);\n  } as AttributePatternDecorator;\n}\n\nexport class AttributePatternResourceDefinition implements ResourceDefinition<Constructable, IAttributePattern> {\n  public name: string = (void 0)!;\n\n  public constructor(\n    public Type: ResourceType<Constructable, Partial<IAttributePattern>>,\n  ) { }\n\n  public register(container: IContainer): void {\n    Registration.singleton(IAttributePattern, this.Type).register(container);\n  }\n}\n\nconst apBaseName = getResourceKeyFor('attribute-pattern');\nconst annotationKey = 'attribute-pattern-definitions';\nconst getAllPatternDefinitions = <TProto, TClass>(Type: DecoratedAttributePattern<TProto, TClass>) =>\n  Protocol.annotation.get(Type, annotationKey) as AttributePatternDefinition[];\n\nexport const AttributePattern = Object.freeze<AttributePattern>({\n  name: apBaseName,\n  definitionAnnotationKey: annotationKey,\n  define<TProto, TClass>(\n    patternDefs: AttributePatternDefinition[],\n    Type: DecoratableAttributePattern<TProto, TClass>,\n  ) {\n    const definition = new AttributePatternResourceDefinition(Type);\n    defineMetadata(apBaseName, definition, Type);\n    appendResourceKey(Type, apBaseName);\n\n    Protocol.annotation.set(Type, annotationKey, patternDefs);\n    appendAnnotationKey(Type, annotationKey);\n\n    return Type as DecoratedAttributePattern<TProto, TClass>;\n  },\n  getPatternDefinitions: getAllPatternDefinitions,\n});\n\n@attributePattern(\n  { pattern: 'PART.PART', symbols: '.' },\n  { pattern: 'PART.PART.PART', symbols: '.' }\n)\nexport class DotSeparatedAttributePattern {\n  public 'PART.PART'(rawName: string, rawValue: string, parts: string[]): AttrSyntax {\n    return new AttrSyntax(rawName, rawValue, parts[0], parts[1]);\n  }\n\n  public 'PART.PART.PART'(rawName: string, rawValue: string, parts: string[]): AttrSyntax {\n    return new AttrSyntax(rawName, rawValue, parts[0], parts[2]);\n  }\n}\n\n@attributePattern(\n  { pattern: 'ref', symbols: '' },\n  { pattern: 'PART.ref', symbols: '.' }\n)\nexport class RefAttributePattern {\n  public 'ref'(rawName: string, rawValue: string, _parts: string[]): AttrSyntax {\n    return new AttrSyntax(rawName, rawValue, 'element', 'ref');\n  }\n\n  public 'PART.ref'(rawName: string, rawValue: string, parts: string[]): AttrSyntax {\n    return new AttrSyntax(rawName, rawValue, parts[0], 'ref');\n  }\n}\n\n@attributePattern({ pattern: ':PART', symbols: ':' })\nexport class ColonPrefixedBindAttributePattern {\n  public ':PART'(rawName: string, rawValue: string, parts: string[]): AttrSyntax {\n    return new AttrSyntax(rawName, rawValue, parts[0], 'bind');\n  }\n}\n\n@attributePattern({ pattern: '@PART', symbols: '@' })\nexport class AtPrefixedTriggerAttributePattern {\n  public '@PART'(rawName: string, rawValue: string, parts: string[]): AttrSyntax {\n    return new AttrSyntax(rawName, rawValue, parts[0], 'trigger');\n  }\n}\n\n@attributePattern({ pattern: '...$attrs', symbols: '' })\nexport class SpreadAttributePattern {\n  public '...$attrs'(rawName: string, rawValue: string, _parts: string[]): AttrSyntax {\n    return new AttrSyntax(rawName, rawValue, '', '...$attrs');\n  }\n}\n","import { BrowserPlatform } from '@aurelia/platform-browser';\nimport { InterfaceSymbol, IPlatform as $IPlatform } from '@aurelia/kernel';\n\nexport interface IPlatform extends BrowserPlatform {}\nexport const IPlatform = $IPlatform as InterfaceSymbol<IPlatform>;\n","import { DI, Registration } from '@aurelia/kernel';\nimport { IPlatform } from '../platform.js';\nimport { createLookup } from '../utilities.js';\n\nimport type { IContainer, IResolver } from '@aurelia/kernel';\nimport type { INode } from '../dom.js';\n\nexport interface ISVGAnalyzer extends NoopSVGAnalyzer {}\nexport const ISVGAnalyzer = DI.createInterface<ISVGAnalyzer>('ISVGAnalyzer', x => x.singleton(NoopSVGAnalyzer));\n\nexport class NoopSVGAnalyzer {\n  public isStandardSvgAttribute(_node: INode, _attributeName: string): boolean {\n    return false;\n  }\n}\n\nfunction o(keys: string[]): Record<string, true | undefined> {\n  const lookup = createLookup<true | undefined>();\n  let key: string;\n  for (key of keys) {\n    lookup[key] = true;\n  }\n  return lookup;\n}\n\nexport class SVGAnalyzer {\n  /**\n   * @internal\n   */\n  public static inject = [IPlatform];\n  public static register(container: IContainer): IResolver<ISVGAnalyzer> {\n    return Registration.singleton(ISVGAnalyzer, this).register(container);\n  }\n\n  /** @internal */\n  private readonly _svgElements: Record<string, Record<string, true | undefined> | undefined> = Object.assign(createLookup<Record<string, true | undefined> | undefined>(), {\n    'a': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'target', 'transform', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'altGlyph': o(['class', 'dx', 'dy', 'externalResourcesRequired', 'format', 'glyphRef', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'altglyph': createLookup<true | undefined>(),\n    'altGlyphDef': o(['id', 'xml:base', 'xml:lang', 'xml:space']),\n    'altglyphdef': createLookup<true | undefined>(),\n    'altGlyphItem': o(['id', 'xml:base', 'xml:lang', 'xml:space']),\n    'altglyphitem': createLookup<true | undefined>(),\n    'animate': o(['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'animateColor': o(['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'animateMotion': o(['accumulate', 'additive', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keyPoints', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'origin', 'path', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'rotate', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'animateTransform': o(['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'type', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'circle': o(['class', 'cx', 'cy', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'r', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'clipPath': o(['class', 'clipPathUnits', 'externalResourcesRequired', 'id', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'color-profile': o(['id', 'local', 'name', 'rendering-intent', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'cursor': o(['externalResourcesRequired', 'id', 'requiredExtensions', 'requiredFeatures', 'systemLanguage', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'defs': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'desc': o(['class', 'id', 'style', 'xml:base', 'xml:lang', 'xml:space']),\n    'ellipse': o(['class', 'cx', 'cy', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rx', 'ry', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'feBlend': o(['class', 'height', 'id', 'in', 'in2', 'mode', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feColorMatrix': o(['class', 'height', 'id', 'in', 'result', 'style', 'type', 'values', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feComponentTransfer': o(['class', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feComposite': o(['class', 'height', 'id', 'in', 'in2', 'k1', 'k2', 'k3', 'k4', 'operator', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feConvolveMatrix': o(['bias', 'class', 'divisor', 'edgeMode', 'height', 'id', 'in', 'kernelMatrix', 'kernelUnitLength', 'order', 'preserveAlpha', 'result', 'style', 'targetX', 'targetY', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feDiffuseLighting': o(['class', 'diffuseConstant', 'height', 'id', 'in', 'kernelUnitLength', 'result', 'style', 'surfaceScale', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feDisplacementMap': o(['class', 'height', 'id', 'in', 'in2', 'result', 'scale', 'style', 'width', 'x', 'xChannelSelector', 'xml:base', 'xml:lang', 'xml:space', 'y', 'yChannelSelector']),\n    'feDistantLight': o(['azimuth', 'elevation', 'id', 'xml:base', 'xml:lang', 'xml:space']),\n    'feFlood': o(['class', 'height', 'id', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feFuncA': o(['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space']),\n    'feFuncB': o(['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space']),\n    'feFuncG': o(['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space']),\n    'feFuncR': o(['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space']),\n    'feGaussianBlur': o(['class', 'height', 'id', 'in', 'result', 'stdDeviation', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feImage': o(['class', 'externalResourcesRequired', 'height', 'id', 'preserveAspectRatio', 'result', 'style', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feMerge': o(['class', 'height', 'id', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feMergeNode': o(['id', 'xml:base', 'xml:lang', 'xml:space']),\n    'feMorphology': o(['class', 'height', 'id', 'in', 'operator', 'radius', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feOffset': o(['class', 'dx', 'dy', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'fePointLight': o(['id', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'z']),\n    'feSpecularLighting': o(['class', 'height', 'id', 'in', 'kernelUnitLength', 'result', 'specularConstant', 'specularExponent', 'style', 'surfaceScale', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feSpotLight': o(['id', 'limitingConeAngle', 'pointsAtX', 'pointsAtY', 'pointsAtZ', 'specularExponent', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'z']),\n    'feTile': o(['class', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'feTurbulence': o(['baseFrequency', 'class', 'height', 'id', 'numOctaves', 'result', 'seed', 'stitchTiles', 'style', 'type', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'filter': o(['class', 'externalResourcesRequired', 'filterRes', 'filterUnits', 'height', 'id', 'primitiveUnits', 'style', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'font': o(['class', 'externalResourcesRequired', 'horiz-adv-x', 'horiz-origin-x', 'horiz-origin-y', 'id', 'style', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space']),\n    'font-face': o(['accent-height', 'alphabetic', 'ascent', 'bbox', 'cap-height', 'descent', 'font-family', 'font-size', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'hanging', 'id', 'ideographic', 'mathematical', 'overline-position', 'overline-thickness', 'panose-1', 'slope', 'stemh', 'stemv', 'strikethrough-position', 'strikethrough-thickness', 'underline-position', 'underline-thickness', 'unicode-range', 'units-per-em', 'v-alphabetic', 'v-hanging', 'v-ideographic', 'v-mathematical', 'widths', 'x-height', 'xml:base', 'xml:lang', 'xml:space']),\n    'font-face-format': o(['id', 'string', 'xml:base', 'xml:lang', 'xml:space']),\n    'font-face-name': o(['id', 'name', 'xml:base', 'xml:lang', 'xml:space']),\n    'font-face-src': o(['id', 'xml:base', 'xml:lang', 'xml:space']),\n    'font-face-uri': o(['id', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'foreignObject': o(['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'g': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'glyph': o(['arabic-form', 'class', 'd', 'glyph-name', 'horiz-adv-x', 'id', 'lang', 'orientation', 'style', 'unicode', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space']),\n    'glyphRef': o(['class', 'dx', 'dy', 'format', 'glyphRef', 'id', 'style', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'glyphref': createLookup<true | undefined>(),\n    'hkern': o(['g1', 'g2', 'id', 'k', 'u1', 'u2', 'xml:base', 'xml:lang', 'xml:space']),\n    'image': o(['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'line': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'x1', 'x2', 'xml:base', 'xml:lang', 'xml:space', 'y1', 'y2']),\n    'linearGradient': o(['class', 'externalResourcesRequired', 'gradientTransform', 'gradientUnits', 'id', 'spreadMethod', 'style', 'x1', 'x2', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y1', 'y2']),\n    'marker': o(['class', 'externalResourcesRequired', 'id', 'markerHeight', 'markerUnits', 'markerWidth', 'orient', 'preserveAspectRatio', 'refX', 'refY', 'style', 'viewBox', 'xml:base', 'xml:lang', 'xml:space']),\n    'mask': o(['class', 'externalResourcesRequired', 'height', 'id', 'maskContentUnits', 'maskUnits', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'metadata': o(['id', 'xml:base', 'xml:lang', 'xml:space']),\n    'missing-glyph': o(['class', 'd', 'horiz-adv-x', 'id', 'style', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space']),\n    'mpath': o(['externalResourcesRequired', 'id', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'path': o(['class', 'd', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'pathLength', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'pattern': o(['class', 'externalResourcesRequired', 'height', 'id', 'patternContentUnits', 'patternTransform', 'patternUnits', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'viewBox', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'polygon': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'points', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'polyline': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'points', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'radialGradient': o(['class', 'cx', 'cy', 'externalResourcesRequired', 'fx', 'fy', 'gradientTransform', 'gradientUnits', 'id', 'r', 'spreadMethod', 'style', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'rect': o(['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rx', 'ry', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'script': o(['externalResourcesRequired', 'id', 'type', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'set': o(['attributeName', 'attributeType', 'begin', 'dur', 'end', 'externalResourcesRequired', 'fill', 'id', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'stop': o(['class', 'id', 'offset', 'style', 'xml:base', 'xml:lang', 'xml:space']),\n    'style': o(['id', 'media', 'title', 'type', 'xml:base', 'xml:lang', 'xml:space']),\n    'svg': o(['baseProfile', 'class', 'contentScriptType', 'contentStyleType', 'externalResourcesRequired', 'height', 'id', 'onabort', 'onactivate', 'onclick', 'onerror', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'onresize', 'onscroll', 'onunload', 'onzoom', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'version', 'viewBox', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'zoomAndPan']),\n    'switch': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space']),\n    'symbol': o(['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'preserveAspectRatio', 'style', 'viewBox', 'xml:base', 'xml:lang', 'xml:space']),\n    'text': o(['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'transform', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'textPath': o(['class', 'externalResourcesRequired', 'id', 'lengthAdjust', 'method', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'spacing', 'startOffset', 'style', 'systemLanguage', 'textLength', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space']),\n    'title': o(['class', 'id', 'style', 'xml:base', 'xml:lang', 'xml:space']),\n    'tref': o(['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'x', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'tspan': o(['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'use': o(['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y']),\n    'view': o(['externalResourcesRequired', 'id', 'preserveAspectRatio', 'viewBox', 'viewTarget', 'xml:base', 'xml:lang', 'xml:space', 'zoomAndPan']),\n    'vkern': o(['g1', 'g2', 'id', 'k', 'u1', 'u2', 'xml:base', 'xml:lang', 'xml:space']),\n  });\n\n  /** @internal */\n  private readonly _svgPresentationElements = o([\n    'a',\n    'altGlyph',\n    'animate',\n    'animateColor',\n    'circle',\n    'clipPath',\n    'defs',\n    'ellipse',\n    'feBlend',\n    'feColorMatrix',\n    'feComponentTransfer',\n    'feComposite',\n    'feConvolveMatrix',\n    'feDiffuseLighting',\n    'feDisplacementMap',\n    'feFlood',\n    'feGaussianBlur',\n    'feImage',\n    'feMerge',\n    'feMorphology',\n    'feOffset',\n    'feSpecularLighting',\n    'feTile',\n    'feTurbulence',\n    'filter',\n    'font',\n    'foreignObject',\n    'g',\n    'glyph',\n    'glyphRef',\n    'image',\n    'line',\n    'linearGradient',\n    'marker',\n    'mask',\n    'missing-glyph',\n    'path',\n    'pattern',\n    'polygon',\n    'polyline',\n    'radialGradient',\n    'rect',\n    'stop',\n    'svg',\n    'switch',\n    'symbol',\n    'text',\n    'textPath',\n    'tref',\n    'tspan',\n    'use',\n  ]);\n\n  /** @internal */\n  private readonly _svgPresentationAttributes = o([\n    'alignment-baseline',\n    'baseline-shift',\n    'clip-path',\n    'clip-rule',\n    'clip',\n    'color-interpolation-filters',\n    'color-interpolation',\n    'color-profile',\n    'color-rendering',\n    'color',\n    'cursor',\n    'direction',\n    'display',\n    'dominant-baseline',\n    'enable-background',\n    'fill-opacity',\n    'fill-rule',\n    'fill',\n    'filter',\n    'flood-color',\n    'flood-opacity',\n    'font-family',\n    'font-size-adjust',\n    'font-size',\n    'font-stretch',\n    'font-style',\n    'font-variant',\n    'font-weight',\n    'glyph-orientation-horizontal',\n    'glyph-orientation-vertical',\n    'image-rendering',\n    'kerning',\n    'letter-spacing',\n    'lighting-color',\n    'marker-end',\n    'marker-mid',\n    'marker-start',\n    'mask',\n    'opacity',\n    'overflow',\n    'pointer-events',\n    'shape-rendering',\n    'stop-color',\n    'stop-opacity',\n    'stroke-dasharray',\n    'stroke-dashoffset',\n    'stroke-linecap',\n    'stroke-linejoin',\n    'stroke-miterlimit',\n    'stroke-opacity',\n    'stroke-width',\n    'stroke',\n    'text-anchor',\n    'text-decoration',\n    'text-rendering',\n    'unicode-bidi',\n    'visibility',\n    'word-spacing',\n    'writing-mode',\n  ]);\n\n  private readonly SVGElement: typeof SVGElement;\n  public constructor(platform: IPlatform) {\n    this.SVGElement = platform.globalThis.SVGElement;\n\n    const div = platform.document.createElement('div');\n    div.innerHTML = '<svg><altGlyph /></svg>';\n    if (div.firstElementChild!.nodeName === 'altglyph') {\n      // handle chrome casing inconsistencies.\n      const svg = this._svgElements;\n      let tmp = svg.altGlyph;\n      svg.altGlyph = svg.altglyph;\n      svg.altglyph = tmp;\n      tmp = svg.altGlyphDef;\n      svg.altGlyphDef = svg.altglyphdef;\n      svg.altglyphdef = tmp;\n      tmp = svg.altGlyphItem;\n      svg.altGlyphItem = svg.altglyphitem;\n      svg.altglyphitem = tmp;\n      tmp = svg.glyphRef;\n      svg.glyphRef = svg.glyphref;\n      svg.glyphref = tmp;\n    }\n  }\n\n  public isStandardSvgAttribute(node: INode, attributeName: string): boolean {\n    if (!(node instanceof this.SVGElement)) {\n      return false;\n    }\n\n    return (\n      this._svgPresentationElements[node.nodeName] === true && this._svgPresentationAttributes[attributeName] === true ||\n      this._svgElements[node.nodeName]?.[attributeName] === true\n    );\n  }\n}\n","import { DI } from '@aurelia/kernel';\nimport { createLookup, isDataAttribute } from './utilities.js';\nimport { ISVGAnalyzer } from './observation/svg-analyzer.js';\n\nexport interface IAttrMapper extends AttrMapper {}\nexport const IAttrMapper = DI\n  .createInterface<IAttrMapper>('IAttrMapper', x => x.singleton(AttrMapper));\n\ntype IsTwoWayPredicate = (element: Element, attribute: string) => boolean;\n\nexport class AttrMapper {\n  /** @internal */ public static get inject(): unknown[] { return [ISVGAnalyzer]; }\n  /** @internal */ private readonly fns: IsTwoWayPredicate[] = [];\n  /** @internal */ private readonly _tagAttrMap: Record<string, Record<string, PropertyKey>> = createLookup();\n  /** @internal */ private readonly _globalAttrMap: Record<string, PropertyKey> = createLookup();\n\n  public constructor(\n    private readonly svg: ISVGAnalyzer,\n  ) {\n    this.useMapping({\n      LABEL: { for: 'htmlFor' },\n      IMG: { usemap: 'useMap' },\n      INPUT: {\n        maxlength: 'maxLength',\n        minlength: 'minLength',\n        formaction: 'formAction',\n        formenctype: 'formEncType',\n        formmethod: 'formMethod',\n        formnovalidate: 'formNoValidate',\n        formtarget: 'formTarget',\n        inputmode: 'inputMode',\n      },\n      TEXTAREA: { maxlength: 'maxLength' },\n      TD: { rowspan: 'rowSpan', colspan: 'colSpan' },\n      TH: { rowspan: 'rowSpan', colspan: 'colSpan' },\n    });\n    this.useGlobalMapping({\n      accesskey: 'accessKey',\n      contenteditable: 'contentEditable',\n      tabindex: 'tabIndex',\n      textcontent: 'textContent',\n      innerhtml: 'innerHTML',\n      scrolltop: 'scrollTop',\n      scrollleft: 'scrollLeft',\n      readonly: 'readOnly',\n    });\n  }\n\n  /**\n   * Allow application to teach Aurelia how to define how to map attributes to properties\n   * based on element tagName\n   */\n  public useMapping(config: Record<string, Record<string, PropertyKey>>): void {\n    let newAttrMapping: Record<string, PropertyKey>;\n    let targetAttrMapping: Record<string, PropertyKey>;\n    let tagName: string;\n    let attr: string;\n    for (tagName in config) {\n      newAttrMapping = config[tagName];\n      targetAttrMapping = this._tagAttrMap[tagName] ??= createLookup();\n      for (attr in newAttrMapping) {\n        if (targetAttrMapping[attr] !== void 0) {\n          throw createMappedError(attr, tagName);\n        }\n        targetAttrMapping[attr] = newAttrMapping[attr];\n      }\n    }\n  }\n\n  /**\n   * Allow applications to teach Aurelia how to define how to map attributes to properties\n   * for all elements\n   */\n  public useGlobalMapping(config: Record<string, PropertyKey>): void {\n    const mapper = this._globalAttrMap;\n    for (const attr in config) {\n      if (mapper[attr] !== void 0) {\n        throw createMappedError(attr, '*');\n      }\n      mapper[attr] = config[attr];\n    }\n  }\n\n  /**\n   * Add a given function to a list of fns that will be used\n   * to check if `'bind'` command can be understood as `'two-way'` command.\n   */\n  public useTwoWay(fn: IsTwoWayPredicate): void {\n    this.fns.push(fn);\n  }\n\n  /**\n   * Returns true if an attribute should be two way bound based on an element\n   */\n  public isTwoWay(node: Element, attrName: string): boolean {\n    return shouldDefaultToTwoWay(node, attrName)\n      || this.fns.length > 0 && this.fns.some(fn => fn(node, attrName));\n  }\n\n  /**\n   * Retrieves the mapping information this mapper have for an attribute on an element\n   */\n  public map(node: Element, attr: string): string | null {\n    return this._tagAttrMap[node.nodeName]?.[attr] as string\n      ?? this._globalAttrMap[attr]\n      ?? (isDataAttribute(node, attr, this.svg)\n        ? attr\n        : null);\n  }\n}\n\nfunction shouldDefaultToTwoWay(element: Element, attr: string): boolean {\n  switch (element.nodeName) {\n    case 'INPUT':\n      switch ((element as HTMLInputElement).type) {\n        case 'checkbox':\n        case 'radio':\n          return attr === 'checked';\n        // note:\n        // ideally, it should check for corresponding input type first\n        // as 'files' shouldn't be two way on a number input, for example\n        // but doing it this way is acceptable-ish, as the common user expectations,\n        // and the behavior of the control for these properties are the same,\n        // regardless the type of the <input>\n        default:\n          return attr === 'value' || attr === 'files' || attr === 'value-as-number' || attr === 'value-as-date';\n      }\n    case 'TEXTAREA':\n    case 'SELECT':\n      return attr === 'value';\n    default:\n      switch (attr) {\n        case 'textcontent':\n        case 'innerhtml':\n          return element.hasAttribute('contenteditable');\n        case 'scrolltop':\n        case 'scrollleft':\n          return true;\n        default:\n          return false;\n      }\n  }\n}\n\nfunction createMappedError(attr: string, tagName: string) {\n  return new Error(`Attribute ${attr} has been already registered for ${tagName === '*' ? 'all elements' : `<${tagName}/>`}`);\n}\n","import { LifecycleFlags } from '@aurelia/runtime';\n\nimport type { IServiceLocator } from '@aurelia/kernel';\nimport type { IAccessor, IObserverLocator, IsBindingBehavior, Scope } from '@aurelia/runtime';\nimport type { IAstBasedBinding } from './interfaces-bindings.js';\n\nexport interface CallBinding extends IAstBasedBinding {}\nexport class CallBinding {\n  public interceptor: this = this;\n\n  public isBound: boolean = false;\n  public $scope?: Scope;\n\n  public targetObserver: IAccessor;\n\n  public constructor(\n    public sourceExpression: IsBindingBehavior,\n    public readonly target: object,\n    public readonly targetProperty: string,\n    observerLocator: IObserverLocator,\n    public locator: IServiceLocator,\n  ) {\n    this.targetObserver = observerLocator.getAccessor(target, targetProperty);\n  }\n\n  public callSource(args: object): unknown {\n    const overrideContext = this.$scope!.overrideContext;\n    overrideContext.$event = args;\n    const result = this.sourceExpression.evaluate(LifecycleFlags.mustEvaluate, this.$scope!, this.locator, null);\n    Reflect.deleteProperty(overrideContext, '$event');\n\n    return result;\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n\n      this.interceptor.$unbind(flags | LifecycleFlags.fromBind);\n    }\n\n    this.$scope = scope;\n\n    if (this.sourceExpression.hasBind) {\n      this.sourceExpression.bind(flags, scope, this.interceptor);\n    }\n\n    this.targetObserver.setValue(($args: object) => this.interceptor.callSource($args), flags, this.target, this.targetProperty);\n\n    // add isBound flag and remove isBinding flag\n    this.isBound = true;\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    if (this.sourceExpression.hasUnbind) {\n      this.sourceExpression.unbind(flags, this.$scope!, this.interceptor);\n    }\n\n    this.$scope = void 0;\n    this.targetObserver.setValue(null, flags, this.target, this.targetProperty);\n\n    this.isBound = false;\n  }\n\n  public observe(obj: object, propertyName: string): void {\n    return;\n  }\n\n  public handleChange(newValue: unknown, previousValue: unknown, flags: LifecycleFlags): void {\n    return;\n  }\n}\n","import { LifecycleFlags, subscriberCollection, AccessorType, withFlushQueue } from '@aurelia/runtime';\nimport { isString } from '../utilities.js';\n\nimport type {\n  IObserver,\n  ISubscriber,\n  ISubscriberCollection,\n  IFlushable,\n  IWithFlushQueue,\n  FlushQueue,\n} from '@aurelia/runtime';\n\nexport interface AttributeObserver extends\n  IObserver,\n  ISubscriber,\n  ISubscriberCollection { }\n\n/**\n * Observer for handling two-way binding with attributes\n * Has different strategy for class/style and normal attributes\n * TODO: handle SVG/attributes with namespace\n */\nexport class AttributeObserver implements AttributeObserver, ElementMutationSubscriber, IWithFlushQueue, IFlushable {\n  // layout is not certain, depends on the attribute being flushed to owner element\n  // but for simple start, always treat as such\n  public type: AccessorType = AccessorType.Node | AccessorType.Observer | AccessorType.Layout;\n  public readonly queue!: FlushQueue;\n\n  /** @internal */\n  private readonly _obj: HTMLElement;\n\n  /** @internal */\n  private _value: unknown = null;\n\n  /** @internal */\n  private _oldValue: unknown = null;\n\n  /** @internal */\n  private _hasChanges: boolean = false;\n\n  /** @internal */\n  private readonly _prop: string;\n\n  /** @internal */\n  private readonly _attr: string;\n\n  /** @internal */\n  private f: LifecycleFlags = LifecycleFlags.none;\n\n  public constructor(\n    obj: HTMLElement,\n    // todo: rename to attr and sub-attr\n    prop: string,\n    attr: string,\n  ) {\n    this._obj = obj;\n    this._prop = prop;\n    this._attr = attr;\n  }\n\n  public getValue(): unknown {\n    // is it safe to assume the observer has the latest value?\n    // todo: ability to turn on/off cache based on type\n    return this._value;\n  }\n\n  public setValue(value: unknown, flags: LifecycleFlags): void {\n    this._value = value;\n    this._hasChanges = value !== this._oldValue;\n    if ((flags & LifecycleFlags.noFlush) === 0) {\n      this._flushChanges();\n    }\n  }\n\n  /** @internal */\n  private _flushChanges(): void {\n    if (this._hasChanges) {\n      this._hasChanges = false;\n      this._oldValue = this._value;\n      switch (this._attr) {\n        case 'class': {\n          // Why does class attribute observer setValue look different with class attribute accessor?\n          // ==============\n          // For class list\n          // newValue is simply checked if truthy or falsy\n          // and toggle the class accordingly\n          // -- the rule of this is quite different to normal attribute\n          //\n          // for class attribute, observer is different in a way that it only observes one class at a time\n          // this also comes from syntax, where it would typically be my-class.class=\"someProperty\"\n          //\n          // so there is no need for separating class by space and add all of them like class accessor\n          this._obj.classList.toggle(this._prop, !!this._value);\n          break;\n        }\n        case 'style': {\n          let priority = '';\n          let newValue = this._value as string;\n          if (isString(newValue) && newValue.includes('!important')) {\n            priority = 'important';\n            newValue = newValue.replace('!important', '');\n          }\n          this._obj.style.setProperty(this._prop, newValue, priority);\n          break;\n        }\n        default: {\n          if (this._value == null) {\n            this._obj.removeAttribute(this._attr);\n          } else {\n            this._obj.setAttribute(this._attr, String(this._value));\n          }\n        }\n      }\n    }\n  }\n\n  public handleMutation(mutationRecords: MutationRecord[]): void {\n    let shouldProcess = false;\n    for (let i = 0, ii = mutationRecords.length; ii > i; ++i) {\n      const record = mutationRecords[i];\n      if (record.type === 'attributes' && record.attributeName === this._prop) {\n        shouldProcess = true;\n        break;\n      }\n    }\n\n    if (shouldProcess) {\n      let newValue;\n      switch (this._attr) {\n        case 'class':\n          newValue = this._obj.classList.contains(this._prop);\n          break;\n        case 'style':\n          newValue = this._obj.style.getPropertyValue(this._prop);\n          break;\n        default:\n          if (__DEV__)\n            throw new Error(`Unsupported observation of attribute: ${this._attr}`);\n          else\n            throw new Error(`AUR0651:${this._attr}`);\n      }\n\n      if (newValue !== this._value) {\n        this._oldValue = this._value;\n        this._value = newValue;\n        this._hasChanges = false;\n        this.f = LifecycleFlags.none;\n        this.queue.add(this);\n      }\n    }\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (this.subs.add(subscriber) && this.subs.count === 1) {\n      this._value = this._oldValue = this._obj.getAttribute(this._prop);\n      startObservation(this._obj.ownerDocument.defaultView!.MutationObserver, this._obj as IHtmlElement, this);\n    }\n  }\n\n  public unsubscribe(subscriber: ISubscriber): void {\n    if (this.subs.remove(subscriber) && this.subs.count === 0) {\n      stopObservation(this._obj as IHtmlElement, this);\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, this.f);\n  }\n}\n\nsubscriberCollection(AttributeObserver);\nwithFlushQueue(AttributeObserver);\n\ninterface IHtmlElement extends HTMLElement {\n  $mObs: MutationObserver;\n  $eMObs: Set<ElementMutationSubscriber>;\n}\n\ninterface ElementMutationSubscriber {\n  handleMutation(mutationRecords: MutationRecord[]): void;\n}\n\nconst startObservation = ($MutationObserver: typeof MutationObserver, element: IHtmlElement, subscriber: ElementMutationSubscriber): void => {\n  if (element.$eMObs === undefined) {\n    element.$eMObs = new Set();\n  }\n  if (element.$mObs === undefined) {\n    (element.$mObs = new $MutationObserver(handleMutation)).observe(element, { attributes: true });\n  }\n  element.$eMObs.add(subscriber);\n};\n\nconst stopObservation = (element: IHtmlElement, subscriber: ElementMutationSubscriber): boolean => {\n  const $eMObservers = element.$eMObs;\n  if ($eMObservers && $eMObservers.delete(subscriber)) {\n    if ($eMObservers.size === 0) {\n      element.$mObs.disconnect();\n      element.$mObs = undefined!;\n    }\n    return true;\n  }\n  return false;\n};\n\nconst handleMutation = (mutationRecords: MutationRecord[]): void => {\n  (mutationRecords[0].target as IHtmlElement).$eMObs.forEach(invokeHandleMutation, mutationRecords);\n};\n\nfunction invokeHandleMutation(this: MutationRecord[], s: ElementMutationSubscriber): void {\n  s.handleMutation(this);\n}\n\n// a reusable variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n","import type { ISubscriber, LifecycleFlags } from '@aurelia/runtime';\nimport type { IAstBasedBinding } from './interfaces-bindings.js';\n\ninterface ITwoWayBindingImpl extends IAstBasedBinding {\n  updateSource(value: unknown, flags: LifecycleFlags): void;\n}\n\n/**\n * A subscriber that is used for subcribing to target observer & invoking `updateSource` on a binding\n */\nexport class BindingTargetSubscriber implements ISubscriber {\n  public constructor(\n    private readonly b: ITwoWayBindingImpl,\n  ) { }\n\n  // deepscan-disable-next-line\n  public handleChange(value: unknown, _: unknown, flags: LifecycleFlags): void {\n    const b = this.b;\n    if (value !== b.sourceExpression.evaluate(flags, b.$scope!, b.locator, null)) {\n      b.updateSource(value, flags);\n    }\n  }\n}\n","import { IServiceLocator } from '@aurelia/kernel';\nimport {\n  BindingMode,\n  connectable,\n  ExpressionKind,\n  LifecycleFlags,\n  AccessorType,\n  IObserver,\n} from '@aurelia/runtime';\n\nimport { AttributeObserver } from '../observation/element-attribute-observer.js';\nimport { IPlatform } from '../platform.js';\nimport { BindingTargetSubscriber } from './binding-utils.js';\n\nimport type {\n  ForOfStatement,\n  IObserverLocator,\n  IsBindingBehavior,\n  ITask,\n  QueueTaskOptions,\n  Scope,\n} from '@aurelia/runtime';\nimport type { INode } from '../dom.js';\nimport type { IAstBasedBinding } from './interfaces-bindings.js';\n\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\n\nconst taskOptions: QueueTaskOptions = {\n  reusable: false,\n  preempt: true,\n};\n\nexport interface AttributeBinding extends IAstBasedBinding {}\n\n/**\n * Attribute binding. Handle attribute binding betwen view/view model. Understand Html special attributes\n */\nexport class AttributeBinding implements IAstBasedBinding {\n  public interceptor: this = this;\n\n  public isBound: boolean = false;\n  public p: IPlatform;\n  public $scope: Scope = null!;\n  public task: ITask | null = null;\n  private targetSubscriber: BindingTargetSubscriber | null = null;\n\n  /**\n   * Target key. In case Attr has inner structure, such as class -> classList, style -> CSSStyleDeclaration\n   */\n  public targetObserver!: IObserver;\n\n  public persistentFlags: LifecycleFlags = LifecycleFlags.none;\n\n  public target: Element;\n  public value: unknown = void 0;\n\n  /**\n   * A semi-private property used by connectable mixin\n   */\n  public oL: IObserverLocator;\n\n  public constructor(\n    public sourceExpression: IsBindingBehavior | ForOfStatement,\n    target: INode,\n    // some attributes may have inner structure\n    // such as class -> collection of class names\n    // such as style -> collection of style rules\n    //\n    // for normal attributes, targetAttribute and targetProperty are the same and can be ignore\n    public targetAttribute: string,\n    public targetProperty: string,\n    public mode: BindingMode,\n    observerLocator: IObserverLocator,\n    public locator: IServiceLocator,\n  ) {\n    this.target = target as Element;\n    this.p = locator.get(IPlatform);\n    this.oL = observerLocator;\n  }\n\n  public updateTarget(value: unknown, flags: LifecycleFlags): void {\n    flags |= this.persistentFlags;\n    this.targetObserver.setValue(value, flags, this.target, this.targetProperty);\n  }\n\n  public updateSource(value: unknown, flags: LifecycleFlags): void {\n    flags |= this.persistentFlags;\n    this.sourceExpression.assign(flags, this.$scope, this.locator, value);\n  }\n\n  public handleChange(newValue: unknown, _previousValue: unknown, flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    flags |= this.persistentFlags;\n\n    const mode = this.mode;\n    const interceptor = this.interceptor;\n    const sourceExpression = this.sourceExpression;\n    const $scope = this.$scope;\n    const locator = this.locator;\n    const targetObserver = this.targetObserver;\n    // Alpha: during bind a simple strategy for bind is always flush immediately\n    // todo:\n    //  (1). determine whether this should be the behavior\n    //  (2). if not, then fix tests to reflect the changes/platform to properly yield all with aurelia.start()\n    const shouldQueueFlush = (flags & LifecycleFlags.fromBind) === 0 && (targetObserver.type & AccessorType.Layout) > 0;\n    let shouldConnect: boolean = false;\n    let task: ITask | null;\n    if (sourceExpression.$kind !== ExpressionKind.AccessScope || this.obs.count > 1) {\n      shouldConnect = (mode & oneTime) === 0;\n      if (shouldConnect) {\n        this.obs.version++;\n      }\n      newValue = sourceExpression.evaluate(flags, $scope, locator, interceptor);\n      if (shouldConnect) {\n        this.obs.clear();\n      }\n    }\n\n    if (newValue !== this.value) {\n      this.value = newValue;\n      if (shouldQueueFlush) {\n        // Queue the new one before canceling the old one, to prevent early yield\n        task = this.task;\n        this.task = this.p.domWriteQueue.queueTask(() => {\n          this.task = null;\n          interceptor.updateTarget(newValue, flags);\n        }, taskOptions);\n        task?.cancel();\n      } else {\n        interceptor.updateTarget(newValue, flags);\n      }\n    }\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n      this.interceptor.$unbind(flags | LifecycleFlags.fromBind);\n    }\n\n    // Store flags which we can only receive during $bind and need to pass on\n    // to the AST during evaluate/connect/assign\n    this.persistentFlags = flags & LifecycleFlags.persistentBindingFlags;\n\n    this.$scope = scope;\n\n    let sourceExpression = this.sourceExpression;\n    if (sourceExpression.hasBind) {\n      sourceExpression.bind(flags, scope, this.interceptor);\n    }\n\n    let targetObserver = this.targetObserver;\n    if (!targetObserver) {\n      targetObserver = this.targetObserver = new AttributeObserver(\n        this.target as HTMLElement,\n        this.targetProperty,\n        this.targetAttribute,\n      );\n    }\n\n    // during bind, binding behavior might have changed sourceExpression\n    sourceExpression = this.sourceExpression;\n    const $mode = this.mode;\n    const interceptor = this.interceptor;\n    let shouldConnect: boolean = false;\n\n    if ($mode & toViewOrOneTime) {\n      shouldConnect = ($mode & toView) > 0;\n      interceptor.updateTarget(\n        this.value = sourceExpression.evaluate(flags, scope, this.locator, shouldConnect ? interceptor : null),\n        flags\n      );\n    }\n    if ($mode & fromView) {\n      targetObserver.subscribe(this.targetSubscriber ??= new BindingTargetSubscriber(interceptor));\n    }\n\n    this.isBound = true;\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    // clear persistent flags\n    this.persistentFlags = LifecycleFlags.none;\n\n    if (this.sourceExpression.hasUnbind) {\n      this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n    }\n    this.$scope = null!;\n    this.value = void 0;\n\n    if (this.targetSubscriber) {\n      this.targetObserver.unsubscribe(this.targetSubscriber);\n    }\n\n    this.task?.cancel();\n    this.task = null;\n    this.obs.clearAll();\n\n    // remove isBound and isUnbinding flags\n    this.isBound = false;\n  }\n}\n\nconnectable(AttributeBinding);\n","import {\n  AccessorOrObserver,\n  AccessorType,\n  BindingMode,\n  ExpressionKind,\n  LifecycleFlags,\n  connectable,\n} from '@aurelia/runtime';\n\nimport type { IIndexable, IServiceLocator, ITask, QueueTaskOptions, TaskQueue } from '@aurelia/kernel';\nimport type {\n  ICollectionSubscriber,\n  IndexMap,\n  Interpolation,\n  IObserverLocator,\n  IsExpression,\n  IBinding,\n  Scope,\n} from '@aurelia/runtime';\nimport type { IPlatform } from '../platform';\nimport type { IAstBasedBinding } from './interfaces-bindings';\n\nconst { toView } = BindingMode;\nconst queueTaskOptions: QueueTaskOptions = {\n  reusable: false,\n  preempt: true,\n};\n\n// a pseudo binding to manage multiple InterpolationBinding s\n// ========\n// Note: the child expressions of an Interpolation expression are full Aurelia expressions, meaning they may include\n// value converters and binding behaviors.\n// Each expression represents one ${interpolation}, and for each we create a child TextBinding unless there is only one,\n// in which case the renderer will create the TextBinding directly\nexport class InterpolationBinding implements IBinding {\n  public interceptor: this = this;\n\n  public isBound: boolean = false;\n  public $scope?: Scope = void 0;\n\n  public partBindings: InterpolationPartBinding[];\n\n  private readonly targetObserver: AccessorOrObserver;\n  private task: ITask | null = null;\n\n  /**\n   * A semi-private property used by connectable mixin\n   */\n  public readonly oL: IObserverLocator;\n\n  public constructor(\n    observerLocator: IObserverLocator,\n    public interpolation: Interpolation,\n    public target: object,\n    public targetProperty: string,\n    public mode: BindingMode,\n    public locator: IServiceLocator,\n    private readonly taskQueue: TaskQueue,\n  ) {\n    this.oL = observerLocator;\n    this.targetObserver = observerLocator.getAccessor(target, targetProperty);\n    const expressions = interpolation.expressions;\n    const partBindings = this.partBindings = Array(expressions.length);\n    const ii = expressions.length;\n    let i = 0;\n    for (; ii > i; ++i) {\n      partBindings[i] = new InterpolationPartBinding(expressions[i], target, targetProperty, locator, observerLocator, this);\n    }\n  }\n\n  public updateTarget(value: unknown, flags: LifecycleFlags): void {\n    const partBindings = this.partBindings;\n    const staticParts = this.interpolation.parts;\n    const ii = partBindings.length;\n    let result = '';\n    let i = 0;\n    if (ii === 1) {\n      result = staticParts[0] + partBindings[0].value + staticParts[1];\n    } else {\n      result = staticParts[0];\n      for (; ii > i; ++i) {\n        result += partBindings[i].value + staticParts[i + 1];\n      }\n    }\n\n    const targetObserver = this.targetObserver;\n    // Alpha: during bind a simple strategy for bind is always flush immediately\n    // todo:\n    //  (1). determine whether this should be the behavior\n    //  (2). if not, then fix tests to reflect the changes/platform to properly yield all with aurelia.start().wait()\n    const shouldQueueFlush = (flags & LifecycleFlags.fromBind) === 0 && (targetObserver.type & AccessorType.Layout) > 0;\n    let task: ITask | null;\n    if (shouldQueueFlush) {\n      // Queue the new one before canceling the old one, to prevent early yield\n      task = this.task;\n      this.task = this.taskQueue.queueTask(() => {\n        this.task = null;\n        targetObserver.setValue(result, flags, this.target, this.targetProperty);\n      }, queueTaskOptions);\n      task?.cancel();\n      task = null;\n    } else {\n      targetObserver.setValue(result, flags, this.target, this.targetProperty);\n    }\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n      this.interceptor.$unbind(flags);\n    }\n    this.isBound = true;\n    this.$scope = scope;\n    const partBindings = this.partBindings;\n    const ii = partBindings.length;\n    let i = 0;\n    for (; ii > i; ++i) {\n      partBindings[i].$bind(flags, scope);\n    }\n    this.updateTarget(void 0, flags);\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    this.$scope = void 0;\n    const partBindings = this.partBindings;\n    const ii = partBindings.length;\n    let i = 0;\n    for (; ii > i; ++i) {\n      partBindings[i].interceptor.$unbind(flags);\n    }\n    this.task?.cancel();\n    this.task = null;\n  }\n}\n\n// a pseudo binding, part of a larger interpolation binding\n// employed to support full expression per expression part of an interpolation\nexport interface InterpolationPartBinding extends IAstBasedBinding {}\n\nexport class InterpolationPartBinding implements IAstBasedBinding, ICollectionSubscriber {\n  public interceptor: this = this;\n\n  // at runtime, mode may be overriden by binding behavior\n  // but it wouldn't matter here, just start with something for later check\n  public readonly mode: BindingMode = BindingMode.toView;\n  public value: unknown = '';\n  public $scope?: Scope;\n  public task: ITask | null = null;\n  public isBound: boolean = false;\n\n  /**\n   * A semi-private property used by connectable mixin\n   */\n  public readonly oL: IObserverLocator;\n\n  public constructor(\n    public readonly sourceExpression: IsExpression,\n    public readonly target: object,\n    public readonly targetProperty: string,\n    public readonly locator: IServiceLocator,\n    observerLocator: IObserverLocator,\n    public readonly owner: InterpolationBinding,\n  ) {\n    this.oL = observerLocator;\n  }\n\n  public handleChange(newValue: unknown, oldValue: unknown, flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n    const sourceExpression = this.sourceExpression;\n    const obsRecord = this.obs;\n    const canOptimize = sourceExpression.$kind === ExpressionKind.AccessScope && obsRecord.count === 1;\n    let shouldConnect: boolean = false;\n    if (!canOptimize) {\n      shouldConnect = (this.mode & toView) > 0;\n      if (shouldConnect) {\n        obsRecord.version++;\n      }\n      newValue = sourceExpression.evaluate(flags, this.$scope!, this.locator, shouldConnect ? this.interceptor : null);\n      if (shouldConnect) {\n        obsRecord.clear();\n      }\n    }\n    if (newValue != this.value) {\n      this.value = newValue;\n      if (newValue instanceof Array) {\n        this.observeCollection(newValue);\n      }\n      this.owner.updateTarget(newValue, flags);\n    }\n  }\n\n  public handleCollectionChange(indexMap: IndexMap, flags: LifecycleFlags): void {\n    this.owner.updateTarget(void 0, flags);\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n      this.interceptor.$unbind(flags);\n    }\n\n    this.isBound = true;\n    this.$scope = scope;\n\n    if (this.sourceExpression.hasBind) {\n      this.sourceExpression.bind(flags, scope, this.interceptor as IIndexable & this);\n    }\n\n    this.value = this.sourceExpression.evaluate(\n      flags,\n      scope,\n      this.locator,\n      (this.mode & toView) > 0 ?  this.interceptor : null,\n    );\n    if (this.value instanceof Array) {\n      this.observeCollection(this.value);\n    }\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n\n    if (this.sourceExpression.hasUnbind) {\n      this.sourceExpression.unbind(flags, this.$scope!, this.interceptor);\n    }\n\n    this.$scope = void 0;\n    this.obs.clearAll();\n  }\n}\n\nconnectable(InterpolationPartBinding);\n\nexport interface ContentBinding extends IAstBasedBinding {}\n\n/**\n * A binding for handling the element content interpolation\n */\nexport class ContentBinding implements IAstBasedBinding, ICollectionSubscriber {\n  public interceptor: this = this;\n\n  // at runtime, mode may be overriden by binding behavior\n  // but it wouldn't matter here, just start with something for later check\n  public readonly mode: BindingMode = BindingMode.toView;\n  public value: unknown = '';\n  public $scope?: Scope;\n  public task: ITask | null = null;\n  public isBound: boolean = false;\n\n  /**\n   * A semi-private property used by connectable mixin\n   */\n  public readonly oL: IObserverLocator;\n\n  public constructor(\n    public readonly sourceExpression: IsExpression,\n    public readonly target: Text,\n    public readonly locator: IServiceLocator,\n    observerLocator: IObserverLocator,\n    private readonly p: IPlatform,\n    private readonly strict: boolean,\n  ) {\n    this.oL = observerLocator;\n  }\n\n  public updateTarget(value: unknown, flags: LifecycleFlags): void {\n    const target = this.target;\n    const NodeCtor = this.p.Node;\n    const oldValue = this.value;\n    this.value = value;\n    if (oldValue instanceof NodeCtor) {\n      oldValue.parentNode?.removeChild(oldValue);\n    }\n    if (value instanceof NodeCtor) {\n      target.textContent = '';\n      target.parentNode?.insertBefore(value, target);\n    } else {\n      target.textContent = String(value);\n    }\n  }\n\n  public handleChange(newValue: unknown, oldValue: unknown, flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n    const sourceExpression = this.sourceExpression;\n    const obsRecord = this.obs;\n    const canOptimize = sourceExpression.$kind === ExpressionKind.AccessScope && obsRecord.count === 1;\n    let shouldConnect: boolean = false;\n    if (!canOptimize) {\n      shouldConnect = (this.mode & toView) > 0;\n      if (shouldConnect) {\n        obsRecord.version++;\n      }\n      flags |= this.strict ? LifecycleFlags.isStrictBindingStrategy : 0;\n      newValue = sourceExpression.evaluate(flags, this.$scope!, this.locator, shouldConnect ? this.interceptor : null);\n      if (shouldConnect) {\n        obsRecord.clear();\n      }\n    }\n    if (newValue === this.value) {\n      // in a frequent update, e.g collection mutation in a loop\n      // value could be changing frequently and previous update task may be stale at this point\n      // cancel if any task going on because the latest value is already the same\n      this.task?.cancel();\n      this.task = null;\n      return;\n    }\n    // Alpha: during bind a simple strategy for bind is always flush immediately\n    // todo:\n    //  (1). determine whether this should be the behavior\n    //  (2). if not, then fix tests to reflect the changes/platform to properly yield all with aurelia.start().wait()\n    const shouldQueueFlush = (flags & LifecycleFlags.fromBind) === 0;\n    if (shouldQueueFlush) {\n      this.queueUpdate(newValue, flags);\n    } else {\n      this.updateTarget(newValue, flags);\n    }\n  }\n\n  public handleCollectionChange(): void {\n    this.queueUpdate(this.value, LifecycleFlags.none);\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n      this.interceptor.$unbind(flags);\n    }\n\n    this.isBound = true;\n    this.$scope = scope;\n\n    if (this.sourceExpression.hasBind) {\n      this.sourceExpression.bind(flags, scope, this.interceptor as IIndexable & this);\n    }\n\n    flags |= this.strict ? LifecycleFlags.isStrictBindingStrategy : 0;\n\n    const v = this.value = this.sourceExpression.evaluate(\n      flags,\n      scope,\n      this.locator,\n      (this.mode & toView) > 0 ?  this.interceptor : null,\n    );\n    if (v instanceof Array) {\n      this.observeCollection(v);\n    }\n    this.updateTarget(v, flags);\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n\n    if (this.sourceExpression.hasUnbind) {\n      this.sourceExpression.unbind(flags, this.$scope!, this.interceptor);\n    }\n\n    // TODO: should existing value (either connected node, or a string)\n    // be removed when this binding is unbound?\n    // this.updateTarget('', flags);\n    this.$scope = void 0;\n    this.obs.clearAll();\n    this.task?.cancel();\n    this.task = null;\n  }\n\n  // queue a force update\n  private queueUpdate(newValue: unknown, flags: LifecycleFlags): void {\n    const task = this.task;\n    this.task = this.p.domWriteQueue.queueTask(() => {\n      this.task = null;\n      this.updateTarget(newValue, flags);\n    }, queueTaskOptions);\n    task?.cancel();\n  }\n}\n\nconnectable(ContentBinding);\n","import { connectable, LifecycleFlags } from '@aurelia/runtime';\n\nimport type { ITask } from '@aurelia/platform';\nimport type { IIndexable, IServiceLocator } from '@aurelia/kernel';\nimport type {\n  IObservable,\n  IObserverLocator,\n  IsExpression,\n  Scope,\n} from '@aurelia/runtime';\nimport type { IAstBasedBinding } from './interfaces-bindings';\n\nexport interface LetBinding extends IAstBasedBinding {}\n\nexport class LetBinding implements IAstBasedBinding {\n  public interceptor: this = this;\n\n  public isBound: boolean = false;\n  public $scope?: Scope = void 0;\n  public task: ITask | null = null;\n\n  public target: (IObservable & IIndexable) | null = null;\n  /** @internal */\n  private readonly _toBindingContext: boolean;\n  /**\n   * A semi-private property used by connectable mixin\n   *\n   * @internal\n   */\n  public readonly oL: IObserverLocator;\n\n  public constructor(\n    public sourceExpression: IsExpression,\n    public targetProperty: string,\n    observerLocator: IObserverLocator,\n    public locator: IServiceLocator,\n    toBindingContext: boolean = false,\n  ) {\n    this.oL = observerLocator;\n    this._toBindingContext = toBindingContext;\n  }\n\n  public handleChange(newValue: unknown, _previousValue: unknown, flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    const target = this.target as IIndexable;\n    const targetProperty = this.targetProperty;\n    const previousValue: unknown = target[targetProperty];\n    this.obs.version++;\n    newValue = this.sourceExpression.evaluate(flags, this.$scope!, this.locator, this.interceptor);\n    this.obs.clear();\n    if (newValue !== previousValue) {\n      target[targetProperty] = newValue;\n    }\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n      this.interceptor.$unbind(flags | LifecycleFlags.fromBind);\n    }\n\n    this.$scope = scope;\n    this.target = (this._toBindingContext ? scope.bindingContext : scope.overrideContext) as IIndexable;\n\n    const sourceExpression = this.sourceExpression;\n    if (sourceExpression.hasBind) {\n      sourceExpression.bind(flags, scope, this.interceptor);\n    }\n    // sourceExpression might have been changed during bind\n    this.target[this.targetProperty]\n      = this.sourceExpression.evaluate(flags | LifecycleFlags.fromBind, scope, this.locator, this.interceptor);\n\n    // add isBound flag and remove isBinding flag\n    this.isBound = true;\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    const sourceExpression = this.sourceExpression;\n    if (sourceExpression.hasUnbind) {\n      sourceExpression.unbind(flags, this.$scope!, this.interceptor);\n    }\n    this.$scope = void 0;\n    this.obs.clearAll();\n\n    // remove isBound and isUnbinding flags\n    this.isBound = false;\n  }\n}\n\nconnectable(LetBinding);\n","import { AccessorType, BindingMode, connectable, ExpressionKind, LifecycleFlags } from '@aurelia/runtime';\nimport { BindingTargetSubscriber } from './binding-utils.js';\n\nimport type { IServiceLocator, ITask, QueueTaskOptions, TaskQueue } from '@aurelia/kernel';\nimport type {\n  AccessorOrObserver,\n  ForOfStatement,\n  IObserver,\n  IObserverLocator,\n  IsBindingBehavior,\n  Scope,\n} from '@aurelia/runtime';\nimport type { IAstBasedBinding } from './interfaces-bindings.js';\n\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\nconst updateTaskOpts: QueueTaskOptions = {\n  reusable: false,\n  preempt: true,\n};\n\nexport interface PropertyBinding extends IAstBasedBinding {}\n\nexport class PropertyBinding implements IAstBasedBinding {\n  public interceptor: this = this;\n\n  public isBound: boolean = false;\n  public $scope?: Scope = void 0;\n\n  public targetObserver?: AccessorOrObserver = void 0;\n\n  public persistentFlags: LifecycleFlags = LifecycleFlags.none;\n\n  private task: ITask | null = null;\n  private targetSubscriber: BindingTargetSubscriber | null = null;\n\n  /**\n   * A semi-private property used by connectable mixin\n   *\n   * @internal\n   */\n  public readonly oL: IObserverLocator;\n\n  public constructor(\n    public sourceExpression: IsBindingBehavior | ForOfStatement,\n    public target: object,\n    public targetProperty: string,\n    public mode: BindingMode,\n    observerLocator: IObserverLocator,\n    public locator: IServiceLocator,\n    private readonly taskQueue: TaskQueue,\n  ) {\n    this.oL = observerLocator;\n  }\n\n  public updateTarget(value: unknown, flags: LifecycleFlags): void {\n    flags |= this.persistentFlags;\n    this.targetObserver!.setValue(value, flags, this.target, this.targetProperty);\n  }\n\n  public updateSource(value: unknown, flags: LifecycleFlags): void {\n    flags |= this.persistentFlags;\n    this.sourceExpression.assign(flags, this.$scope!, this.locator, value);\n  }\n\n  public handleChange(newValue: unknown, _previousValue: unknown, flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    flags |= this.persistentFlags;\n\n    // Alpha: during bind a simple strategy for bind is always flush immediately\n    // todo:\n    //  (1). determine whether this should be the behavior\n    //  (2). if not, then fix tests to reflect the changes/platform to properly yield all with aurelia.start()\n    const shouldQueueFlush = (flags & LifecycleFlags.fromBind) === 0 && (this.targetObserver!.type & AccessorType.Layout) > 0;\n    const obsRecord = this.obs;\n    let shouldConnect: boolean = false;\n\n    // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n    if (this.sourceExpression.$kind !== ExpressionKind.AccessScope || obsRecord.count > 1) {\n      // todo: in VC expressions, from view also requires connect\n      shouldConnect = this.mode > oneTime;\n      if (shouldConnect) {\n        obsRecord.version++;\n      }\n      newValue = this.sourceExpression.evaluate(flags, this.$scope!, this.locator, this.interceptor);\n      if (shouldConnect) {\n        obsRecord.clear();\n      }\n    }\n\n    if (shouldQueueFlush) {\n      // Queue the new one before canceling the old one, to prevent early yield\n      task = this.task;\n      this.task = this.taskQueue.queueTask(() => {\n        this.interceptor.updateTarget(newValue, flags);\n        this.task = null;\n      }, updateTaskOpts);\n      task?.cancel();\n      task = null;\n    } else {\n      this.interceptor.updateTarget(newValue, flags);\n    }\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n      this.interceptor.$unbind(flags | LifecycleFlags.fromBind);\n    }\n    // Force property binding to always be strict\n    flags |= LifecycleFlags.isStrictBindingStrategy;\n\n    // Store flags which we can only receive during $bind and need to pass on\n    // to the AST during evaluate/connect/assign\n    this.persistentFlags = flags & LifecycleFlags.persistentBindingFlags;\n\n    this.$scope = scope;\n\n    let sourceExpression = this.sourceExpression;\n    if (sourceExpression.hasBind) {\n      sourceExpression.bind(flags, scope, this.interceptor);\n    }\n\n    const observerLocator = this.oL;\n    const $mode = this.mode;\n    let targetObserver = this.targetObserver;\n    if (!targetObserver) {\n      if ($mode & fromView) {\n        targetObserver = observerLocator.getObserver(this.target, this.targetProperty);\n      } else {\n        targetObserver = observerLocator.getAccessor(this.target, this.targetProperty);\n      }\n      this.targetObserver = targetObserver;\n    }\n\n    // during bind, binding behavior might have changed sourceExpression\n    // deepscan-disable-next-line\n    sourceExpression = this.sourceExpression;\n    const interceptor = this.interceptor;\n    const shouldConnect = ($mode & toView) > 0;\n\n    if ($mode & toViewOrOneTime) {\n      interceptor.updateTarget(\n        sourceExpression.evaluate(flags, scope, this.locator, shouldConnect ? interceptor : null),\n        flags,\n      );\n    }\n    if ($mode & fromView) {\n      (targetObserver as IObserver).subscribe(this.targetSubscriber ??= new BindingTargetSubscriber(interceptor));\n      if (!shouldConnect) {\n        interceptor.updateSource(targetObserver.getValue(this.target, this.targetProperty), flags);\n      }\n    }\n\n    this.isBound = true;\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    this.persistentFlags = LifecycleFlags.none;\n\n    if (this.sourceExpression.hasUnbind) {\n      this.sourceExpression.unbind(flags, this.$scope!, this.interceptor);\n    }\n\n    this.$scope = void 0;\n\n    task = this.task;\n    if (this.targetSubscriber) {\n      (this.targetObserver as IObserver).unsubscribe(this.targetSubscriber);\n    }\n    if (task != null) {\n      task.cancel();\n      task = this.task = null;\n    }\n    this.obs.clearAll();\n\n    this.isBound = false;\n  }\n}\n\nconnectable(PropertyBinding);\n\nlet task: ITask | null = null;\n","import { LifecycleFlags } from '@aurelia/runtime';\n\nimport type { IIndexable, IServiceLocator } from '@aurelia/kernel';\nimport type { IsBindingBehavior, Scope } from '@aurelia/runtime';\nimport type { IAstBasedBinding } from './interfaces-bindings.js';\n\nexport interface RefBinding extends IAstBasedBinding {}\nexport class RefBinding implements IAstBasedBinding {\n  public interceptor: this = this;\n\n  public isBound: boolean = false;\n  public $scope?: Scope = void 0;\n\n  public constructor(\n    public sourceExpression: IsBindingBehavior,\n    public target: object,\n    public locator: IServiceLocator,\n  ) {}\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n\n      this.interceptor.$unbind(flags | LifecycleFlags.fromBind);\n    }\n\n    this.$scope = scope;\n\n    if (this.sourceExpression.hasBind) {\n      this.sourceExpression.bind(flags, scope, this);\n    }\n\n    this.sourceExpression.assign(flags, this.$scope, this.locator, this.target);\n\n    // add isBound flag and remove isBinding flag\n    this.isBound = true;\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    let sourceExpression = this.sourceExpression;\n    if (sourceExpression.evaluate(flags, this.$scope!, this.locator, null) === this.target) {\n      sourceExpression.assign(flags, this.$scope!, this.locator, null);\n    }\n\n    // source expression might have been modified durring assign, via a BB\n    // deepscan-disable-next-line\n    sourceExpression = this.sourceExpression;\n    if (sourceExpression.hasUnbind) {\n      sourceExpression.unbind(flags, this.$scope!, this.interceptor);\n    }\n\n    this.$scope = void 0;\n\n    this.isBound = false;\n  }\n\n  public observe(_obj: IIndexable, _propertyName: string): void {\n    return;\n  }\n\n  public handleChange(_newValue: unknown, _previousValue: unknown, _flags: LifecycleFlags): void {\n    return;\n  }\n}\n","import { DI, Registration } from '@aurelia/kernel';\nimport type { IContainer, IRegistry, Key, Resolved } from '@aurelia/kernel';\nimport { isFunction } from './utilities.js';\n\nexport type TaskSlot = (\n  'beforeCreate' |\n  'hydrating' |\n  'hydrated' |\n  'beforeActivate' |\n  'afterActivate' |\n  'beforeDeactivate' |\n  'afterDeactivate'\n);\n\nexport const IAppTask = DI.createInterface<IAppTask>('IAppTask');\nexport interface IAppTask extends Pick<\n  $AppTask,\n  'slot' |\n  'run' |\n  'register'\n> {}\n\nclass $AppTask<K extends Key = Key> {\n  public readonly slot: TaskSlot;\n  /** @internal */\n  private c: IContainer = (void 0)!;\n  /** @internal */\n  private readonly k: K | null;\n  /** @internal */\n  private readonly cb: AppTaskCallback<K> | AppTaskCallbackNoArg;\n\n  public constructor(\n    slot: TaskSlot,\n    key: K | null,\n    cb: AppTaskCallback<K> | AppTaskCallbackNoArg,\n  ) {\n    this.slot = slot;\n    this.k = key;\n    this.cb = cb;\n  }\n\n  public register(container: IContainer): IContainer {\n    return this.c = container.register(Registration.instance(IAppTask, this));\n  }\n\n  public run(): void | Promise<void> {\n    const key = this.k;\n    const cb = this.cb;\n    return key === null\n      ? (cb as AppTaskCallbackNoArg)()\n      : cb(this.c.get(key));\n  }\n}\n\nexport const AppTask = Object.freeze({\n  beforeCreate: createAppTaskSlotHook('beforeCreate'),\n  hydrating: createAppTaskSlotHook('hydrating'),\n  hydrated: createAppTaskSlotHook('hydrated'),\n  beforeActivate: createAppTaskSlotHook('beforeActivate'),\n  afterActivate: createAppTaskSlotHook('afterActivate'),\n  beforeDeactivate: createAppTaskSlotHook('beforeDeactivate'),\n  afterDeactivate: createAppTaskSlotHook('afterDeactivate'),\n});\n\nexport type AppTaskCallbackNoArg = () => void | Promise<void>;\nexport type AppTaskCallback<T> = (arg: Resolved<T>) => void | Promise<void>;\n\nfunction createAppTaskSlotHook(slotName: TaskSlot) {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  function appTaskFactory<T extends Key = Key>(callback: AppTaskCallbackNoArg): IRegistry;\n  function appTaskFactory<T extends Key = Key>(key: T, callback: AppTaskCallback<T>): IRegistry;\n  function appTaskFactory<T extends Key = Key>(keyOrCallback: T | AppTaskCallback<T> | AppTaskCallbackNoArg, callback?: AppTaskCallback<T>): IRegistry {\n    if (isFunction(callback)) {\n      return new $AppTask(slotName, keyOrCallback as T, callback);\n    }\n    return new $AppTask(slotName, null, keyOrCallback as Exclude<typeof keyOrCallback, T>);\n  }\n  return appTaskFactory;\n}\n","import { firstDefined, getPrototypeChain, emptyArray } from '@aurelia/kernel';\nimport { LifecycleFlags, subscriberCollection } from '@aurelia/runtime';\nimport { CustomElement } from '../resources/custom-element.js';\nimport { appendAnnotationKey, defineMetadata, getAllAnnotations, getAnnotationKeyFor, getOwnMetadata } from '../shared.js';\nimport { isString } from '../utilities.js';\n\nimport type { IIndexable, Constructable } from '@aurelia/kernel';\nimport type { ISubscriberCollection, IAccessor, ISubscribable, IObserver } from '@aurelia/runtime';\nimport type { INode } from '../dom.js';\nimport type { ICustomElementViewModel, ICustomElementController } from './controller.js';\n\nexport type PartialChildrenDefinition = {\n  callback?: string;\n  property?: string;\n  options?: MutationObserverInit;\n  query?: (controller: ICustomElementController) => ArrayLike<Node>;\n  filter?: (node: Node, controller?: ICustomElementController | null, viewModel?: ICustomElementViewModel) => boolean;\n  map?: (node: Node, controller?: ICustomElementController | null, viewModel?: ICustomElementViewModel) => unknown;\n};\n\n/**\n * Decorator: Specifies custom behavior for an array children property that synchronizes its items with child content nodes of the element.\n *\n * @param config - The overrides\n */\nexport function children(config?: PartialChildrenDefinition): PropertyDecorator;\n/**\n * Decorator: Specifies an array property on a class that synchronizes its items with child content nodes of the element.\n *\n * @param prop - The property name\n */\nexport function children(prop: string): ClassDecorator;\n/**\n * Decorator: Decorator: Specifies an array property that synchronizes its items with child content nodes of the element.\n *\n * @param target - The class\n * @param prop - The property name\n */\nexport function children(target: {}, prop: string): void;\nexport function children(configOrTarget?: PartialChildrenDefinition | {}, prop?: string): void | PropertyDecorator | ClassDecorator {\n  let config: PartialChildrenDefinition;\n\n  function decorator($target: {}, $prop: symbol | string): void {\n    if (arguments.length > 1) {\n      // Non invocation:\n      // - @children\n      // Invocation with or w/o opts:\n      // - @children()\n      // - @children({...opts})\n      config.property = $prop as string;\n    }\n\n    defineMetadata(baseName, ChildrenDefinition.create($prop as string, config), $target.constructor, $prop);\n    appendAnnotationKey($target.constructor as Constructable, Children.keyFrom($prop as string));\n  }\n\n  if (arguments.length > 1) {\n    // Non invocation:\n    // - @children\n    config = {};\n    decorator(configOrTarget!, prop!);\n    return;\n  } else if (isString(configOrTarget)) {\n    // ClassDecorator\n    // - @children('bar')\n    // Direct call:\n    // - @children('bar')(Foo)\n    config = {};\n    return decorator;\n  }\n\n  // Invocation with or w/o opts:\n  // - @children()\n  // - @children({...opts})\n  config = configOrTarget === void 0 ? {} : configOrTarget;\n  return decorator;\n}\n\nfunction isChildrenObserverAnnotation(key: string): boolean {\n  return key.startsWith(baseName);\n}\n\nconst baseName = getAnnotationKeyFor('children-observer');\nexport const Children = Object.freeze({\n  name: baseName,\n  keyFrom: (name: string): string =>`${baseName}:${name}`,\n  from(...childrenObserverLists: readonly (ChildrenDefinition | Record<string, PartialChildrenDefinition> | readonly string[] | undefined)[]): Record<string, ChildrenDefinition> {\n    const childrenObservers: Record<string, ChildrenDefinition> = {};\n\n    const isArray = Array.isArray as <T>(arg: unknown) => arg is readonly T[];\n\n    function addName(name: string): void {\n      childrenObservers[name] = ChildrenDefinition.create(name);\n    }\n\n    function addDescription(name: string, def: PartialChildrenDefinition): void {\n      childrenObservers[name] = ChildrenDefinition.create(name, def);\n    }\n\n    function addList(maybeList: ChildrenDefinition | Record<string, PartialChildrenDefinition> | readonly string[] | undefined): void {\n      if (isArray(maybeList)) {\n        maybeList.forEach(addName);\n      } else if (maybeList instanceof ChildrenDefinition) {\n        childrenObservers[maybeList.property] = maybeList;\n      } else if (maybeList !== void 0) {\n        Object.keys(maybeList).forEach(name => addDescription(name, maybeList));\n      }\n    }\n\n    childrenObserverLists.forEach(addList);\n\n    return childrenObservers;\n  },\n  getAll(Type: Constructable): readonly ChildrenDefinition[] {\n    const propStart = baseName.length + 1;\n    const defs: ChildrenDefinition[] = [];\n    const prototypeChain = getPrototypeChain(Type);\n\n    let iProto = prototypeChain.length;\n    let iDefs = 0;\n    let keys: string[];\n    let keysLen: number;\n    let Class: Constructable;\n    while (--iProto >= 0) {\n      Class = prototypeChain[iProto];\n      keys = getAllAnnotations(Class).filter(isChildrenObserverAnnotation);\n      keysLen = keys.length;\n      for (let i = 0; i < keysLen; ++i) {\n        defs[iDefs++] = getOwnMetadata(baseName, Class, keys[i].slice(propStart));\n      }\n    }\n    return defs;\n  },\n});\n\nconst childObserverOptions = { childList: true };\nexport class ChildrenDefinition {\n  private constructor(\n    public readonly callback: string,\n    public readonly property: string,\n    public readonly options?: MutationObserverInit,\n    public readonly query?: (controller: ICustomElementController) => ArrayLike<Node>,\n    public readonly filter?: (node: Node, controller?: ICustomElementController | null, viewModel?: ICustomElementViewModel) => boolean,\n    public readonly map?: (node: Node, controller?: ICustomElementController | null, viewModel?: ICustomElementViewModel) => unknown,\n  ) {}\n\n  public static create(prop: string, def: PartialChildrenDefinition = {}): ChildrenDefinition {\n    return new ChildrenDefinition(\n      firstDefined(def.callback, `${prop}Changed`),\n      firstDefined(def.property, prop),\n      def.options ?? childObserverOptions,\n      def.query,\n      def.filter,\n      def.map,\n    );\n  }\n}\n\nexport interface ChildrenObserver extends\n  IAccessor,\n  ISubscribable,\n  ISubscriberCollection,\n  IObserver { }\n\n/**\n * A special observer for observing the children of a custom element. Unlike other observer that starts/stops\n * based on the changes in the subscriber addition/removal, this is a controlled observers.\n *\n * The controller of a custom element should totally control when this observer starts/stops.\n *\n * @internal\n */\nexport class ChildrenObserver {\n  public observing: boolean = false;\n\n  private readonly callback: () => void;\n  private children: unknown[] = (void 0)!;\n  private observer: MutationObserver | undefined = void 0;\n\n  public constructor(\n    private readonly controller: ICustomElementController,\n    public readonly obj: IIndexable,\n    public readonly propertyKey: string,\n    cbName: string,\n    private readonly query = defaultChildQuery,\n    private readonly filter = defaultChildFilter,\n    private readonly map = defaultChildMap,\n    private readonly options?: MutationObserverInit\n  ) {\n    this.callback = obj[cbName] as typeof ChildrenObserver.prototype.callback;\n    Reflect.defineProperty(\n      this.obj,\n      this.propertyKey,\n      {\n        enumerable: true,\n        configurable: true,\n        get: () => this.getValue(),\n        set: () => { return; },\n      }\n    );\n  }\n\n  public getValue(): unknown[] {\n    return this.observing ? this.children : this.get();\n  }\n\n  public setValue(_value: unknown): void { /* do nothing */ }\n\n  public start(): void {\n    if (!this.observing) {\n      this.observing = true;\n      this.children = this.get();\n      (this.observer ??= new this.controller.host.ownerDocument.defaultView!.MutationObserver(() => { this._onChildrenChanged(); }))\n        .observe(this.controller.host, this.options);\n    }\n  }\n\n  public stop(): void {\n    if (this.observing) {\n      this.observing = false;\n      this.observer!.disconnect();\n      this.children = emptyArray;\n    }\n  }\n\n  private _onChildrenChanged(): void {\n    this.children = this.get();\n\n    if (this.callback !== void 0) {\n      this.callback.call(this.obj);\n    }\n\n    this.subs.notify(this.children, undefined, LifecycleFlags.none);\n  }\n\n  // freshly retrieve the children everytime\n  // in case this observer is not observing\n  private get() {\n    return filterChildren(this.controller, this.query, this.filter, this.map);\n  }\n}\n\nsubscriberCollection()(ChildrenObserver);\n\nfunction defaultChildQuery(controller: ICustomElementController): ArrayLike<INode> {\n  return controller.host.childNodes;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction defaultChildFilter(node: INode, controller?: ICustomElementController | null, viewModel?: any): boolean {\n  return !!viewModel;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction defaultChildMap(node: INode, controller?: ICustomElementController | null, viewModel?: any): any {\n  return viewModel;\n}\n\nconst forOpts = { optional: true } as const;\n\n/** @internal */\nexport function filterChildren(\n  controller: ICustomElementController,\n  query: typeof defaultChildQuery,\n  filter: typeof defaultChildFilter,\n  map: typeof defaultChildMap\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n): any[] {\n  const nodes = query(controller);\n  const ii = nodes.length;\n  const children = [];\n\n  let node: INode;\n  let $controller: ICustomElementController | null;\n  let viewModel: ICustomElementViewModel | null;\n  let i = 0;\n  for (; i < ii; ++i) {\n    node = nodes[i];\n    $controller = CustomElement.for(node, forOpts);\n    viewModel = $controller?.viewModel ?? null;\n\n    if (filter(node, $controller, viewModel)) {\n      children.push(map(node, $controller, viewModel));\n    }\n  }\n\n  return children;\n}\n","import { Registration, mergeArrays, firstDefined } from '@aurelia/kernel';\nimport { BindingMode, registerAliases } from '@aurelia/runtime';\nimport { Bindable } from '../bindable.js';\nimport { Watch } from '../watch.js';\nimport { getRef } from '../dom.js';\nimport { DefinitionType } from './resources-shared.js';\nimport { appendResourceKey, defineMetadata, getAnnotationKeyFor, getOwnMetadata, getResourceKeyFor, hasOwnMetadata } from '../shared.js';\nimport { isFunction, isString } from '../utilities.js';\n\nimport type {\n  Constructable,\n  IContainer,\n  IResourceKind,\n  ResourceDefinition,\n  PartialResourceDefinition,\n  ResourceType,\n} from '@aurelia/kernel';\nimport type { BindableDefinition, PartialBindableDefinition } from '../bindable.js';\nimport type { ICustomAttributeViewModel, ICustomAttributeController } from '../templating/controller.js';\nimport type { IWatchDefinition } from '../watch.js';\n\ndeclare module '@aurelia/kernel' {\n  interface IContainer {\n    find<T extends ICustomAttributeViewModel>(kind: typeof CustomAttribute, name: string): CustomAttributeDefinition<Constructable<T>> | null;\n  }\n}\n\nexport type PartialCustomAttributeDefinition = PartialResourceDefinition<{\n  readonly defaultBindingMode?: BindingMode;\n  readonly isTemplateController?: boolean;\n  readonly bindables?: Record<string, PartialBindableDefinition> | readonly string[];\n  /**\n   * A config that can be used by template compliler to change attr value parsing mode\n   * `true` to always parse as a single value, mostly will be string in URL scenario\n   * Example:\n   * ```html\n   * <div goto=\"http://bla.bla.com\">\n   * ```\n   * With `noMultiBinding: true`, user does not need to escape the `:` with `\\`\n   * or use binding command to escape it.\n   *\n   * With `noMultiBinding: false (default)`, the above will be parsed as it's binding\n   * to a property name `http`, with value equal to literal string `//bla.bla.com`\n   */\n  readonly noMultiBindings?: boolean;\n  readonly watches?: IWatchDefinition[];\n}>;\n\nexport type CustomAttributeType<T extends Constructable = Constructable> = ResourceType<T, ICustomAttributeViewModel, PartialCustomAttributeDefinition>;\nexport type CustomAttributeKind = IResourceKind<CustomAttributeType, CustomAttributeDefinition> & {\n  for<C extends ICustomAttributeViewModel = ICustomAttributeViewModel>(node: Node, name: string): ICustomAttributeController<C> | undefined;\n  isType<T>(value: T): value is (T extends Constructable ? CustomAttributeType<T> : never);\n  define<T extends Constructable>(name: string, Type: T): CustomAttributeType<T>;\n  define<T extends Constructable>(def: PartialCustomAttributeDefinition, Type: T): CustomAttributeType<T>;\n  define<T extends Constructable>(nameOrDef: string | PartialCustomAttributeDefinition, Type: T): CustomAttributeType<T>;\n  getDefinition<T extends Constructable>(Type: T): CustomAttributeDefinition<T>;\n  // eslint-disable-next-line\n  getDefinition<T extends Constructable>(Type: Function): CustomAttributeDefinition<T>;\n  annotate<K extends keyof PartialCustomAttributeDefinition>(Type: Constructable, prop: K, value: PartialCustomAttributeDefinition[K]): void;\n  getAnnotation<K extends keyof PartialCustomAttributeDefinition>(Type: Constructable, prop: K): PartialCustomAttributeDefinition[K];\n};\n\nexport type CustomAttributeDecorator = <T extends Constructable>(Type: T) => CustomAttributeType<T>;\n\n/**\n * Decorator: Indicates that the decorated class is a custom attribute.\n */\nexport function customAttribute(definition: PartialCustomAttributeDefinition): CustomAttributeDecorator;\nexport function customAttribute(name: string): CustomAttributeDecorator;\nexport function customAttribute(nameOrDef: string | PartialCustomAttributeDefinition): CustomAttributeDecorator;\nexport function customAttribute(nameOrDef: string | PartialCustomAttributeDefinition): CustomAttributeDecorator {\n  return function (target) {\n    return CustomAttribute.define(nameOrDef, target);\n  };\n}\n\n/**\n * Decorator: Applied to custom attributes. Indicates that whatever element the\n * attribute is placed on should be converted into a template and that this\n * attribute controls the instantiation of the template.\n */\nexport function templateController(definition: Omit<PartialCustomAttributeDefinition, 'isTemplateController'>): CustomAttributeDecorator;\nexport function templateController(name: string): CustomAttributeDecorator;\nexport function templateController(nameOrDef: string | Omit<PartialCustomAttributeDefinition, 'isTemplateController'>): CustomAttributeDecorator;\nexport function templateController(nameOrDef: string | Omit<PartialCustomAttributeDefinition, 'isTemplateController'>): CustomAttributeDecorator {\n  return function (target) {\n    return CustomAttribute.define(\n      isString(nameOrDef)\n        ? { isTemplateController: true, name: nameOrDef }\n        : { isTemplateController: true, ...nameOrDef },\n      target\n    );\n  };\n}\n\nexport class CustomAttributeDefinition<T extends Constructable = Constructable> implements ResourceDefinition<T, ICustomAttributeViewModel, PartialCustomAttributeDefinition> {\n  // a simple marker to distinguish between Custom Element definition & Custom attribute definition\n  public get type(): DefinitionType.Attribute { return DefinitionType.Attribute; }\n\n  private constructor(\n    public readonly Type: CustomAttributeType<T>,\n    public readonly name: string,\n    public readonly aliases: readonly string[],\n    public readonly key: string,\n    public readonly defaultBindingMode: BindingMode,\n    public readonly isTemplateController: boolean,\n    public readonly bindables: Record<string, BindableDefinition>,\n    public readonly noMultiBindings: boolean,\n    public readonly watches: IWatchDefinition[],\n  ) {}\n\n  public static create<T extends Constructable = Constructable>(\n    nameOrDef: string | PartialCustomAttributeDefinition,\n    Type: CustomAttributeType<T>,\n  ): CustomAttributeDefinition<T> {\n    let name: string;\n    let def: PartialCustomAttributeDefinition;\n    if (isString(nameOrDef)) {\n      name = nameOrDef;\n      def = { name };\n    } else {\n      name = nameOrDef.name;\n      def = nameOrDef;\n    }\n\n    return new CustomAttributeDefinition(\n      Type,\n      firstDefined(getAttributeAnnotation(Type, 'name'), name),\n      mergeArrays(getAttributeAnnotation(Type, 'aliases'), def.aliases, Type.aliases),\n      CustomAttribute.keyFrom(name),\n      firstDefined(getAttributeAnnotation(Type, 'defaultBindingMode'), def.defaultBindingMode, Type.defaultBindingMode, BindingMode.toView),\n      firstDefined(getAttributeAnnotation(Type, 'isTemplateController'), def.isTemplateController, Type.isTemplateController, false),\n      Bindable.from(Type, ...Bindable.getAll(Type), getAttributeAnnotation(Type, 'bindables'), Type.bindables, def.bindables),\n      firstDefined(getAttributeAnnotation(Type, 'noMultiBindings'), def.noMultiBindings, Type.noMultiBindings, false),\n      mergeArrays(Watch.getAnnotation(Type), Type.watches),\n    );\n  }\n\n  public register(container: IContainer): void {\n    const { Type, key, aliases } = this;\n    Registration.transient(key, Type).register(container);\n    Registration.aliasTo(key, Type).register(container);\n    registerAliases(aliases, CustomAttribute, key, container);\n  }\n}\n\nconst caBaseName = getResourceKeyFor('custom-attribute');\nconst getAttributeKeyFrom = (name: string): string => `${caBaseName}:${name}`;\nconst getAttributeAnnotation = <K extends keyof PartialCustomAttributeDefinition>(\n  Type: Constructable,\n  prop: K,\n): PartialCustomAttributeDefinition[K] =>getOwnMetadata(getAnnotationKeyFor(prop), Type);\n\nexport const CustomAttribute = Object.freeze<CustomAttributeKind>({\n  name: caBaseName,\n  keyFrom: getAttributeKeyFrom,\n  isType<T>(value: T): value is (T extends Constructable ? CustomAttributeType<T> : never) {\n    return isFunction(value) && hasOwnMetadata(caBaseName, value);\n  },\n  for<C extends ICustomAttributeViewModel = ICustomAttributeViewModel>(node: Node, name: string): ICustomAttributeController<C> | undefined {\n    return (getRef(node, getAttributeKeyFrom(name)) ?? void 0) as ICustomAttributeController<C> | undefined;\n  },\n  define<T extends Constructable>(nameOrDef: string | PartialCustomAttributeDefinition, Type: T): CustomAttributeType<T> {\n    const definition = CustomAttributeDefinition.create(nameOrDef, Type as Constructable);\n    defineMetadata(caBaseName, definition, definition.Type);\n    defineMetadata(caBaseName, definition, definition);\n    appendResourceKey(Type, caBaseName);\n\n    return definition.Type as CustomAttributeType<T>;\n  },\n  getDefinition<T extends Constructable>(Type: T): CustomAttributeDefinition<T> {\n    const def = getOwnMetadata(caBaseName, Type) as CustomAttributeDefinition<T>;\n    if (def === void 0) {\n      if (__DEV__)\n        throw new Error(`No definition found for type ${Type.name}`);\n      else\n        throw new Error(`AUR0759:${Type.name}`);\n    }\n\n    return def;\n  },\n  annotate<K extends keyof PartialCustomAttributeDefinition>(Type: Constructable, prop: K, value: PartialCustomAttributeDefinition[K]): void {\n    defineMetadata(getAnnotationKeyFor(prop), value, Type);\n  },\n  getAnnotation: getAttributeAnnotation,\n});\n","import { emptyArray } from '@aurelia/kernel';\nimport { CustomAttribute } from './resources/custom-attribute.js';\nimport { CustomElement } from './resources/custom-element.js';\nimport { defineMetadata, getAnnotationKeyFor, getOwnMetadata } from './shared.js';\nimport { isFunction } from './utilities.js';\n\nimport type { Constructable } from '@aurelia/kernel';\nimport type { IConnectable } from '@aurelia/runtime';\n\nexport type IDepCollectionFn<TType extends object, TReturn = unknown> = (vm: TType, watcher: IConnectable) => TReturn;\nexport type IWatcherCallback<TType extends object, TValue = unknown>\n  = (this: TType, newValue: TValue, oldValue: TValue, vm: TType) => unknown;\n\nexport interface IWatchDefinition<T extends object = object> {\n  expression: PropertyKey | IDepCollectionFn<T>;\n  callback: keyof T | IWatcherCallback<T>;\n}\n\ntype AnyMethod<R = unknown> = (...args: unknown[]) => R;\ntype WatchClassDecorator<T extends object> = <K extends Constructable<T>>(target: K) => void;\ntype WatchMethodDecorator<T> = <R, K extends AnyMethod<R> = AnyMethod<R>>(target: T, key: string | symbol, descriptor: PropertyDescriptor) => PropertyDescriptor;\ntype MethodsOf<Type> = {\n  [Key in keyof Type]: Type[Key] extends AnyMethod ? Key : never\n}[keyof Type];\n\n// for\n//    @watch('some.expression', (v) => ...)\n//    @watch('some.expression', 'method')\n//    @watch(Symbol, (v) => ...)\n//    @watch(Symbol, 'method')\n//    @watch(a => ..., 'method')\n//    @watch(a => ..., v => ...)\n//    class A {\n//      method() {...}\n//    }\nexport function watch<T extends object, D = unknown>(\n  expressionOrPropertyAccessFn: PropertyKey,\n  changeHandlerOrCallback: MethodsOf<T> | IWatcherCallback<T, D>,\n): WatchClassDecorator<T>;\n\nexport function watch<T extends object, D = unknown>(\n  expressionOrPropertyAccessFn: IDepCollectionFn<T, D>,\n  changeHandlerOrCallback: MethodsOf<T> | IWatcherCallback<T, D>,\n): WatchClassDecorator<T>;\n\n// for\n// class A {\n//    @watch('some.expression')\n//    @watch(Symbol)\n//    @watch(a => ...)\n//    method() {...}\n// }\nexport function watch<T extends object = object, D = unknown>(\n  expressionOrPropertyAccessFn: PropertyKey | IDepCollectionFn<T, D>\n): WatchMethodDecorator<T>;\n\nexport function watch<T extends object = object>(\n  expressionOrPropertyAccessFn: PropertyKey | IDepCollectionFn<object>,\n  changeHandlerOrCallback?: PropertyKey | IWatcherCallback<T>,\n): WatchClassDecorator<T> | WatchMethodDecorator<T> {\n  if (!expressionOrPropertyAccessFn) {\n    if (__DEV__)\n      throw new Error('Invalid watch config. Expected an expression or a fn');\n    else\n      throw new Error('AUR0772');\n  }\n\n  return function decorator(\n    target: Constructable<T> | Constructable<T>['prototype'],\n    key?: PropertyKey,\n    descriptor?: PropertyDescriptor,\n  ): void {\n    const isClassDecorator = key == null;\n    const Type = isClassDecorator ? target : target.constructor;\n    const watchDef = new WatchDefinition<T>(\n      expressionOrPropertyAccessFn,\n      isClassDecorator ? changeHandlerOrCallback : descriptor!.value\n    );\n\n    // basic validation\n    if (isClassDecorator) {\n      if (!isFunction(changeHandlerOrCallback)\n        && (changeHandlerOrCallback == null || !(changeHandlerOrCallback in Type.prototype))\n      ) {\n        if (__DEV__)\n          throw new Error(`Invalid change handler config. Method \"${String(changeHandlerOrCallback)}\" not found in class ${Type.name}`);\n        else\n          throw new Error(`AUR0773:${String(changeHandlerOrCallback)}@${Type.name}}`);\n      }\n    } else if (!isFunction(descriptor?.value)) {\n      if (__DEV__)\n        throw new Error(`decorated target ${String(key)} is not a class method.`);\n      else\n        throw new Error(`AUR0774:${String(key)}`);\n    }\n\n    Watch.add(Type, watchDef as IWatchDefinition);\n\n    // if the code looks like this:\n    // @watch(...)\n    // @customAttribute(...)\n    // class Abc {}\n    //\n    // then @watch is called after @customAttribute\n    // which means the attribute definition won't have the watch definition\n    //\n    // temporarily works around this order sensitivity by manually add the watch def\n    // manual\n    if (CustomAttribute.isType(Type)) {\n      CustomAttribute.getDefinition(Type).watches.push(watchDef as IWatchDefinition);\n    }\n    if (CustomElement.isType(Type)) {\n      CustomElement.getDefinition(Type).watches.push(watchDef as IWatchDefinition);\n    }\n  };\n}\n\nclass WatchDefinition<T extends object> implements IWatchDefinition<T> {\n  public constructor(\n    public expression: PropertyKey | IDepCollectionFn<T>,\n    public callback: IWatcherCallback<T>,\n  ) {}\n}\n\nconst noDefinitions: IWatchDefinition[] = emptyArray;\nconst watchBaseName = getAnnotationKeyFor('watch');\n\nexport const Watch = Object.freeze({\n  name: watchBaseName,\n  add(Type: Constructable, definition: IWatchDefinition): void {\n    let watchDefinitions: IWatchDefinition[] = getOwnMetadata(watchBaseName, Type);\n    if (watchDefinitions == null) {\n      defineMetadata(watchBaseName, watchDefinitions = [], Type);\n    }\n    watchDefinitions.push(definition);\n  },\n  getAnnotation(Type: Constructable): IWatchDefinition[] {\n    return getOwnMetadata(watchBaseName, Type) ?? noDefinitions;\n  },\n});\n","import {\n  DI,\n  Registration,\n  mergeArrays,\n  fromDefinitionOrDefault,\n  pascalCase,\n  fromAnnotationOrTypeOrDefault,\n  fromAnnotationOrDefinitionOrTypeOrDefault,\n  emptyArray,\n} from '@aurelia/kernel';\nimport { registerAliases } from '@aurelia/runtime';\nimport { Bindable } from '../bindable.js';\nimport { getEffectiveParentNode, getRef } from '../dom.js';\nimport { Children } from '../templating/children.js';\nimport { Watch } from '../watch.js';\nimport { DefinitionType } from './resources-shared.js';\nimport { appendResourceKey, defineMetadata, getAnnotationKeyFor, getOwnMetadata, getResourceKeyFor, hasOwnMetadata } from '../shared.js';\nimport { isFunction, isString } from '../utilities.js';\n\nimport type {\n  Constructable,\n  IContainer,\n  IResourceKind,\n  ResourceType,\n  PartialResourceDefinition,\n  Key,\n  ResourceDefinition,\n  Injectable,\n  IResolver,\n  Writable,\n} from '@aurelia/kernel';\nimport type { BindableDefinition, PartialBindableDefinition } from '../bindable.js';\nimport type { INode } from '../dom.js';\nimport type { PartialChildrenDefinition, ChildrenDefinition } from '../templating/children.js';\nimport type { Controller, ICustomElementViewModel, ICustomElementController } from '../templating/controller.js';\nimport type { IPlatform } from '../platform.js';\nimport type { IInstruction } from '../renderer.js';\nimport type { IWatchDefinition } from '../watch.js';\n\ndeclare module '@aurelia/kernel' {\n  interface IContainer {\n    find<T extends ICustomElementViewModel>(kind: CustomElementKind, name: string): CustomElementDefinition<Constructable<T>> | null;\n  }\n}\n\nexport type PartialCustomElementDefinition = PartialResourceDefinition<{\n  readonly cache?: '*' | number;\n  readonly capture?: boolean;\n  readonly template?: null | string | Node;\n  readonly instructions?: readonly (readonly IInstruction[])[];\n  readonly dependencies?: readonly Key[];\n  readonly injectable?: InjectableToken | null;\n  readonly needsCompile?: boolean;\n  readonly surrogates?: readonly IInstruction[];\n  readonly bindables?: Record<string, PartialBindableDefinition> | readonly string[];\n  readonly childrenObservers?: Record<string, PartialChildrenDefinition>;\n  readonly containerless?: boolean;\n  readonly isStrictBinding?: boolean;\n  readonly shadowOptions?: { mode: 'open' | 'closed' } | null;\n  readonly hasSlots?: boolean;\n  readonly enhance?: boolean;\n  readonly watches?: IWatchDefinition[];\n  readonly processContent?: ProcessContentHook | null;\n}>;\n\nexport type CustomElementType<C extends Constructable = Constructable> = ResourceType<C, ICustomElementViewModel & (C extends Constructable<infer P> ? P : {}), PartialCustomElementDefinition>;\nexport type CustomElementKind = IResourceKind<CustomElementType, CustomElementDefinition> & {\n  /**\n   * Returns the closest controller that is associated with either this node (if it is a custom element) or the first\n   * parent node (including containerless) that is a custom element.\n   *\n   * As long as the provided node was directly or indirectly created by Aurelia, this method is guaranteed to return a controller.\n   *\n   * @param node - The node relative to which to get the closest controller.\n   * @param searchParents - Also search the parent nodes (including containerless).\n   * @returns The closest controller relative to the provided node.\n   * @throws - If neither the node or any of its effective parent nodes host a custom element, an error will be thrown.\n   */\n  for<C extends ICustomElementViewModel = ICustomElementViewModel>(node: Node, opts: { searchParents: true }): ICustomElementController<C>;\n  /**\n   * Returns the controller that is associated with this node, if it is a custom element with the provided name.\n   *\n   * @param node - The node to retrieve the controller for, if it is a custom element with the provided name.\n   * @returns The controller associated with the provided node, if it is a custom element with the provided name, or otherwise `undefined`.\n   * @throws - If the node does not host a custom element, an error will be thrown.\n   */\n  for<C extends ICustomElementViewModel = ICustomElementViewModel>(node: Node, opts: { name: string }): ICustomElementController<C> | undefined;\n  /**\n   * Returns the closest controller that is associated with either this node (if it is a custom element) or the first\n   * parent node (including containerless) that is a custom element with the provided name.\n   *\n   * @param node - The node relative to which to get the closest controller of a custom element with the provided name.\n   * @param searchParents - Also search the parent nodes (including containerless).\n   * @returns The closest controller of a custom element with the provided name, relative to the provided node, if one can be found, or otherwise `undefined`.\n   * @throws - If neither the node or any of its effective parent nodes host a custom element, an error will be thrown.\n   */\n  for<C extends ICustomElementViewModel = ICustomElementViewModel>(node: Node, opts: { name: string; searchParents: true }): ICustomElementController<C> | undefined;\n  /**\n   * Returns the controller that is associated with this node, if it is a custom element.\n   *\n   * @param node - The node to retrieve the controller for, if it is a custom element.\n   * @param optional - If `true`, do not throw if the provided node is not a custom element.\n   * @returns The controller associated with the provided node, if it is a custom element\n   * @throws - If the node does not host a custom element, an error will be thrown.\n   */\n  for<C extends ICustomElementViewModel = ICustomElementViewModel>(node: Node): ICustomElementController<C>;\n  /**\n   * Returns the controller that is associated with this node, if it is a custom element.\n   *\n   * @param node - The node to retrieve the controller for, if it is a custom element.\n   * @param optional - If `true`, do not throw if the provided node is not a custom element.\n   * @returns The controller associated with the provided node, if it is a custom element, otherwise `null`\n   */\n  for<C extends ICustomElementViewModel = ICustomElementViewModel>(node: Node, opts: { optional: true }): ICustomElementController<C> | null;\n  isType<C>(value: C): value is (C extends Constructable ? CustomElementType<C> : never);\n  define<C extends Constructable >(name: string, Type: C): CustomElementType<C>;\n  define<C extends Constructable >(def: PartialCustomElementDefinition, Type: C): CustomElementType<C>;\n  define<C extends Constructable >(def: PartialCustomElementDefinition, Type?: null): CustomElementType<C>;\n  define<C extends Constructable >(nameOrDef: string | PartialCustomElementDefinition, Type: C): CustomElementType<C>;\n  getDefinition<C extends Constructable>(Type: C): CustomElementDefinition<C>;\n  // eslint-disable-next-line\n  getDefinition<C extends Constructable>(Type: Function): CustomElementDefinition<C>;\n  annotate<K extends keyof PartialCustomElementDefinition>(Type: Constructable, prop: K, value: PartialCustomElementDefinition[K]): void;\n  getAnnotation<K extends keyof PartialCustomElementDefinition>(Type: Constructable, prop: K): PartialCustomElementDefinition[K];\n  generateName(): string;\n  createInjectable<T extends Key = Key>(): InjectableToken<T>;\n  generateType<P extends {} = {}>(\n    name: string,\n    proto?: P,\n  ): CustomElementType<Constructable<P>>;\n};\n\nexport type CustomElementDecorator = <T extends Constructable>(Type: T) => CustomElementType<T>;\n\n/**\n * Decorator: Indicates that the decorated class is a custom element.\n */\nexport function customElement(definition: PartialCustomElementDefinition): CustomElementDecorator;\nexport function customElement(name: string): CustomElementDecorator;\nexport function customElement(nameOrDef: string | PartialCustomElementDefinition): CustomElementDecorator;\nexport function customElement(nameOrDef: string | PartialCustomElementDefinition): CustomElementDecorator {\n  return function (target) {\n    return CustomElement.define(nameOrDef, target);\n  };\n}\n\ntype ShadowOptions = Pick<PartialCustomElementDefinition, 'shadowOptions'>['shadowOptions'];\n\n/**\n * Decorator: Indicates that the custom element should render its view in ShadowDOM.\n */\nexport function useShadowDOM(options?: ShadowOptions): (target: Constructable) => void;\n/**\n * Decorator: Indicates that the custom element should render its view in ShadowDOM.\n */\nexport function useShadowDOM(target: Constructable): void;\nexport function useShadowDOM(targetOrOptions?: Constructable | ShadowOptions): void | ((target: Constructable) => void) {\n  if (targetOrOptions === void 0) {\n    return function ($target: Constructable) {\n      annotateElementMetadata($target, 'shadowOptions', { mode: 'open' });\n    };\n  }\n\n  if (!isFunction(targetOrOptions)) {\n    return function ($target: Constructable) {\n      annotateElementMetadata($target, 'shadowOptions', targetOrOptions);\n    };\n  }\n\n  annotateElementMetadata(targetOrOptions, 'shadowOptions', { mode: 'open' });\n}\n\n/**\n * Decorator: Indicates that the custom element should be rendered without its element container.\n */\nexport function containerless(target: Constructable): void;\n/**\n * Decorator: Indicates that the custom element should be rendered without its element container.\n */\nexport function containerless(): (target: Constructable) => void;\nexport function containerless(target?: Constructable): void | ((target: Constructable) => void) {\n  if (target === void 0) {\n    return function ($target: Constructable) {\n      annotateElementMetadata($target, 'containerless', true);\n    };\n  }\n\n  annotateElementMetadata(target, 'containerless', true);\n}\n\n/**\n * Decorator: Indicates that the custom element should be rendered with the strict binding option. undefined/null -> 0 or '' based on type\n */\nexport function strict(target: Constructable): void;\n/**\n * Decorator: Indicates that the custom element should be rendered with the strict binding option. undefined/null -> 0 or '' based on type\n */\nexport function strict(): (target: Constructable) => void;\nexport function strict(target?: Constructable): void | ((target: Constructable) => void) {\n  if (target === void 0) {\n    return function ($target: Constructable) {\n      annotateElementMetadata($target, 'isStrictBinding', true);\n    };\n  }\n\n  annotateElementMetadata(target, 'isStrictBinding', true);\n}\n\nconst definitionLookup = new WeakMap<PartialCustomElementDefinition, CustomElementDefinition>();\n\nexport class CustomElementDefinition<C extends Constructable = Constructable> implements ResourceDefinition<C, ICustomElementViewModel, PartialCustomElementDefinition> {\n  public get type(): DefinitionType.Element { return DefinitionType.Element; }\n  private constructor(\n    public readonly Type: CustomElementType<C>,\n    public readonly name: string,\n    public readonly aliases: string[],\n    public readonly key: string,\n    public readonly cache: '*' | number,\n    public readonly capture: boolean,\n    public readonly template: null | string | Node,\n    public readonly instructions: readonly (readonly IInstruction[])[],\n    public readonly dependencies: readonly Key[],\n    public readonly injectable: InjectableToken<C> | null,\n    public readonly needsCompile: boolean,\n    public readonly surrogates: readonly IInstruction[],\n    public readonly bindables: Record<string, BindableDefinition>,\n    public readonly childrenObservers: Record<string, ChildrenDefinition>,\n    public readonly containerless: boolean,\n    public readonly isStrictBinding: boolean,\n    public readonly shadowOptions: { mode: 'open' | 'closed' } | null,\n    public readonly hasSlots: boolean,\n    public readonly enhance: boolean,\n    public readonly watches: IWatchDefinition[],\n    public readonly processContent: ProcessContentHook | null,\n  ) {}\n\n  public static create(\n    def: PartialCustomElementDefinition,\n    Type?: null,\n  ): CustomElementDefinition;\n  public static create(\n    name: string,\n    Type: CustomElementType,\n  ): CustomElementDefinition;\n  public static create<T extends Constructable = Constructable>(\n    nameOrDef: string | PartialCustomElementDefinition,\n    Type?: CustomElementType<T> | null,\n  ): CustomElementDefinition<T>;\n  public static create(\n    nameOrDef: string | PartialCustomElementDefinition,\n    Type: CustomElementType | null = null,\n  ): CustomElementDefinition {\n    if (Type === null) {\n      const def = nameOrDef;\n      if (isString(def)) {\n        if (__DEV__)\n          throw new Error(`Cannot create a custom element definition with only a name and no type: ${nameOrDef}`);\n        else\n          throw new Error(`AUR0761:${nameOrDef}`);\n      }\n\n      const name = fromDefinitionOrDefault('name', def, generateElementName);\n      if (isFunction((def as CustomElementDefinition).Type)) {\n        // This needs to be a clone (it will usually be the compiler calling this signature)\n\n        // TODO: we need to make sure it's documented that passing in the type via the definition (while passing in null\n        // as the \"Type\" parameter) effectively skips type analysis, so it should only be used this way for cloning purposes.\n        Type = (def as CustomElementDefinition).Type;\n      } else {\n        Type = CustomElement.generateType(pascalCase(name));\n      }\n\n      return new CustomElementDefinition(\n        Type,\n        name,\n        mergeArrays(def.aliases),\n        fromDefinitionOrDefault('key', def as CustomElementDefinition, () => CustomElement.keyFrom(name)),\n        fromDefinitionOrDefault('cache', def, returnZero),\n        fromDefinitionOrDefault('capture', def, returnFalse),\n        fromDefinitionOrDefault('template', def, returnNull),\n        mergeArrays(def.instructions),\n        mergeArrays(def.dependencies),\n        fromDefinitionOrDefault('injectable', def, returnNull),\n        fromDefinitionOrDefault('needsCompile', def, returnTrue),\n        mergeArrays(def.surrogates),\n        Bindable.from(Type, def.bindables),\n        Children.from(def.childrenObservers),\n        fromDefinitionOrDefault('containerless', def, returnFalse),\n        fromDefinitionOrDefault('isStrictBinding', def, returnFalse),\n        fromDefinitionOrDefault('shadowOptions', def, returnNull),\n        fromDefinitionOrDefault('hasSlots', def, returnFalse),\n        fromDefinitionOrDefault('enhance', def, returnFalse),\n        fromDefinitionOrDefault('watches', def as CustomElementDefinition, returnEmptyArray),\n        fromAnnotationOrTypeOrDefault('processContent', Type, returnNull as () => ProcessContentHook | null),\n      );\n    }\n\n    // If a type is passed in, we ignore the Type property on the definition if it exists.\n    // TODO: document this behavior\n\n    if (isString(nameOrDef)) {\n      return new CustomElementDefinition(\n        Type,\n        nameOrDef,\n        mergeArrays(getElementAnnotation(Type, 'aliases'), Type.aliases),\n        CustomElement.keyFrom(nameOrDef),\n        fromAnnotationOrTypeOrDefault('cache', Type, returnZero),\n        fromAnnotationOrTypeOrDefault('capture', Type, returnFalse),\n        fromAnnotationOrTypeOrDefault('template', Type, returnNull as () => string | Node | null),\n        mergeArrays(getElementAnnotation(Type, 'instructions'), Type.instructions),\n        mergeArrays(getElementAnnotation(Type, 'dependencies'), Type.dependencies),\n        fromAnnotationOrTypeOrDefault('injectable', Type, returnNull as () => InjectableToken | null),\n        fromAnnotationOrTypeOrDefault('needsCompile', Type, returnTrue),\n        mergeArrays(getElementAnnotation(Type, 'surrogates'), Type.surrogates),\n        Bindable.from(\n          Type,\n          ...Bindable.getAll(Type),\n          getElementAnnotation(Type, 'bindables'),\n          Type.bindables,\n        ),\n        Children.from(\n          ...Children.getAll(Type),\n          getElementAnnotation(Type, 'childrenObservers'),\n          Type.childrenObservers,\n        ),\n        fromAnnotationOrTypeOrDefault('containerless', Type, returnFalse),\n        fromAnnotationOrTypeOrDefault('isStrictBinding', Type, returnFalse),\n        fromAnnotationOrTypeOrDefault('shadowOptions', Type, returnNull as () => { mode: 'open' | 'closed' } | null),\n        fromAnnotationOrTypeOrDefault('hasSlots', Type, returnFalse),\n        fromAnnotationOrTypeOrDefault('enhance', Type, returnFalse),\n        mergeArrays(Watch.getAnnotation(Type), Type.watches),\n        fromAnnotationOrTypeOrDefault('processContent', Type, returnNull as () => ProcessContentHook | null),\n      );\n    }\n\n    // This is the typical default behavior, e.g. from regular CustomElement.define invocations or from @customElement deco\n    // The ViewValueConverter also uses this signature and passes in a definition where everything except for the 'hooks'\n    // property needs to be copied. So we have that exception for 'hooks', but we may need to revisit that default behavior\n    // if this turns out to be too opinionated.\n\n    const name = fromDefinitionOrDefault('name', nameOrDef, generateElementName);\n    return new CustomElementDefinition(\n      Type,\n      name,\n      mergeArrays(getElementAnnotation(Type, 'aliases'), nameOrDef.aliases, Type.aliases),\n      CustomElement.keyFrom(name),\n      fromAnnotationOrDefinitionOrTypeOrDefault('cache', nameOrDef, Type, returnZero),\n      fromAnnotationOrDefinitionOrTypeOrDefault('capture', nameOrDef, Type, returnFalse),\n      fromAnnotationOrDefinitionOrTypeOrDefault('template', nameOrDef, Type, returnNull),\n      mergeArrays(getElementAnnotation(Type, 'instructions'), nameOrDef.instructions, Type.instructions),\n      mergeArrays(getElementAnnotation(Type, 'dependencies'), nameOrDef.dependencies, Type.dependencies),\n      fromAnnotationOrDefinitionOrTypeOrDefault('injectable', nameOrDef, Type, returnNull),\n      fromAnnotationOrDefinitionOrTypeOrDefault('needsCompile', nameOrDef, Type, returnTrue),\n      mergeArrays(getElementAnnotation(Type, 'surrogates'), nameOrDef.surrogates, Type.surrogates),\n      Bindable.from(\n        Type,\n        ...Bindable.getAll(Type),\n        getElementAnnotation(Type, 'bindables'),\n        Type.bindables,\n        nameOrDef.bindables,\n      ),\n      Children.from(\n        ...Children.getAll(Type),\n        getElementAnnotation(Type, 'childrenObservers'),\n        Type.childrenObservers,\n        nameOrDef.childrenObservers,\n      ),\n      fromAnnotationOrDefinitionOrTypeOrDefault('containerless', nameOrDef, Type, returnFalse),\n      fromAnnotationOrDefinitionOrTypeOrDefault('isStrictBinding', nameOrDef, Type, returnFalse),\n      fromAnnotationOrDefinitionOrTypeOrDefault('shadowOptions', nameOrDef, Type, returnNull),\n      fromAnnotationOrDefinitionOrTypeOrDefault('hasSlots', nameOrDef, Type, returnFalse),\n      fromAnnotationOrDefinitionOrTypeOrDefault('enhance', nameOrDef, Type, returnFalse),\n      mergeArrays(nameOrDef.watches, Watch.getAnnotation(Type), Type.watches),\n      fromAnnotationOrDefinitionOrTypeOrDefault('processContent', nameOrDef, Type, returnNull),\n    );\n  }\n\n  public static getOrCreate(partialDefinition: PartialCustomElementDefinition): CustomElementDefinition {\n    if (partialDefinition instanceof CustomElementDefinition) {\n      return partialDefinition;\n    }\n\n    if (definitionLookup.has(partialDefinition)) {\n      return definitionLookup.get(partialDefinition)!;\n    }\n\n    const definition = CustomElementDefinition.create(partialDefinition);\n    definitionLookup.set(partialDefinition, definition);\n    // Make sure the full definition can be retrieved from dynamically created classes as well\n    defineMetadata(ceBaseName, definition, definition.Type);\n    return definition;\n  }\n\n  public register(container: IContainer): void {\n    const { Type, key, aliases } = this;\n    if (!container.has(key, false)) {\n      Registration.transient(key, Type).register(container);\n      Registration.aliasTo(key, Type).register(container);\n      registerAliases(aliases, CustomElement, key, container);\n    }\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type InjectableToken<K = any> = (target: Injectable<K>, property: string, index: number) => void;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype InternalInjectableToken<K = any> = InjectableToken<K> & {\n  register?(container: IContainer): IResolver<K>;\n};\n\ntype ForOpts = {\n  name?: string;\n  searchParents?: boolean;\n  optional?: boolean;\n};\nconst defaultForOpts: ForOpts = {\n  name: undefined,\n  searchParents: false,\n  optional: false,\n};\nconst returnZero = () => 0;\nconst returnNull = <T>(): T | null => null;\nconst returnFalse = () => false;\nconst returnTrue = () => true;\nconst returnEmptyArray = () => emptyArray;\n\nconst ceBaseName = getResourceKeyFor('custom-element');\nconst getElementKeyFrom = (name: string): string => `${ceBaseName}:${name}`;\nconst generateElementName = (() => {\n  let id = 0;\n\n  return () => `unnamed-${++id}`;\n})();\nconst annotateElementMetadata = <K extends keyof PartialCustomElementDefinition>(Type: Constructable, prop: K, value: PartialCustomElementDefinition[K]): void => {\n  defineMetadata(getAnnotationKeyFor(prop), value, Type);\n};\nconst getElementAnnotation = <K extends keyof PartialCustomElementDefinition>(\n  Type: Constructable,\n  prop: K\n): PartialCustomElementDefinition[K] => getOwnMetadata(getAnnotationKeyFor(prop), Type);\n\nexport const CustomElement = Object.freeze<CustomElementKind>({\n  name: ceBaseName,\n  keyFrom: getElementKeyFrom,\n  isType<C>(value: C): value is (C extends Constructable ? CustomElementType<C> : never) {\n    return isFunction(value) && hasOwnMetadata(ceBaseName, value);\n  },\n  for<C extends ICustomElementViewModel = ICustomElementViewModel>(node: Node, opts: ForOpts = defaultForOpts): ICustomElementController<C> {\n    if (opts.name === void 0 && opts.searchParents !== true) {\n      const controller = getRef(node, ceBaseName) as Controller<C> | null;\n      if (controller === null) {\n        if (opts.optional === true) {\n          return null!;\n        }\n        if (__DEV__)\n          throw new Error(`The provided node is not a custom element or containerless host.`);\n        else\n          throw new Error('AUR0762');\n      }\n      return controller as unknown as ICustomElementController<C>;\n    }\n    if (opts.name !== void 0) {\n      if (opts.searchParents !== true) {\n        const controller = getRef(node, ceBaseName) as Controller<C> | null;\n        if (controller === null) {\n          if (__DEV__)\n            throw new Error(`The provided node is not a custom element or containerless host.`);\n          else\n            throw new Error('AUR0763');\n        }\n\n        if (controller.is(opts.name)) {\n          return controller as unknown as ICustomElementController<C>;\n        }\n\n        return (void 0)!;\n      }\n\n      let cur = node as INode | null;\n      let foundAController = false;\n      while (cur !== null) {\n        const controller = getRef(cur, ceBaseName) as Controller<C> | null;\n        if (controller !== null) {\n          foundAController = true;\n          if (controller.is(opts.name)) {\n            return controller as unknown as ICustomElementController<C>;\n          }\n        }\n\n        cur = getEffectiveParentNode(cur);\n      }\n\n      if (foundAController) {\n        return (void 0)!;\n      }\n\n      if (__DEV__)\n        throw new Error(`The provided node does does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.`);\n      else\n        throw new Error('AUR0764');\n    }\n\n    let cur = node as INode | null;\n    while (cur !== null) {\n      const controller = getRef(cur, ceBaseName) as Controller<C> | null;\n      if (controller !== null) {\n        return controller as unknown as ICustomElementController<C>;\n      }\n\n      cur = getEffectiveParentNode(cur);\n    }\n\n    if (__DEV__)\n      throw new Error(`The provided node does does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.`);\n    else\n      throw new Error('AUR0765');\n  },\n  define<C extends Constructable>(nameOrDef: string | PartialCustomElementDefinition, Type?: C | null): CustomElementType<C> {\n    const definition = CustomElementDefinition.create(nameOrDef, Type as Constructable | null);\n    defineMetadata(ceBaseName, definition, definition.Type);\n    defineMetadata(ceBaseName, definition, definition);\n    appendResourceKey(definition.Type, ceBaseName);\n\n    return definition.Type as CustomElementType<C>;\n  },\n  getDefinition<C extends Constructable>(Type: C): CustomElementDefinition<C> {\n    const def = getOwnMetadata(ceBaseName, Type) as CustomElementDefinition<C>;\n    if (def === void 0) {\n      if (__DEV__)\n        throw new Error(`No definition found for type ${Type.name}`);\n      else\n        throw new Error(`AUR0760:${Type.name}`);\n    }\n\n    return def;\n  },\n  annotate: annotateElementMetadata,\n  getAnnotation: getElementAnnotation,\n  generateName: generateElementName,\n  createInjectable<K extends Key = Key>(): InjectableToken<K> {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const $injectable: InternalInjectableToken<K> = function (target, property, index): any {\n      const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n      annotationParamtypes[index] = $injectable;\n      return target;\n    };\n\n    $injectable.register = function (_container) {\n      // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n      return {\n        resolve(container, requestor) {\n          if (requestor.has($injectable, true)) {\n            return requestor.get($injectable);\n          } else {\n            return null;\n          }\n        },\n      } as IResolver;\n    };\n\n    return $injectable;\n  },\n  generateType: (function () {\n    const nameDescriptor: PropertyDescriptor = {\n      value: '',\n      writable: false,\n      enumerable: false,\n      configurable: true,\n    };\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const defaultProto = {} as any;\n\n    return function <P extends {} = {}> (\n      name: string,\n      proto: P = defaultProto,\n    ): CustomElementType<Constructable<P>> {\n      // Anonymous class ensures that minification cannot cause unintended side-effects, and keeps the class\n      // looking similarly from the outside (when inspected via debugger, etc).\n      const Type = class {} as CustomElementType<Constructable<P>>;\n\n      // Define the name property so that Type.name can be used by end users / plugin authors if they really need to,\n      // even when minified.\n      nameDescriptor.value = name;\n      Reflect.defineProperty(Type, 'name', nameDescriptor);\n\n      // Assign anything from the prototype that was passed in\n      if (proto !== defaultProto) {\n        Object.assign(Type.prototype, proto);\n      }\n\n      return Type;\n    };\n  })(),\n});\n\ntype DecoratorFactoryMethod<TClass> = (target: Constructable<TClass>, propertyKey: string, descriptor: PropertyDescriptor) => void;\ntype ProcessContentHook = (node: INode, platform: IPlatform) => boolean | void;\n\nconst pcHookMetadataProperty = getAnnotationKeyFor('processContent');\nexport function processContent(hook: ProcessContentHook): CustomElementDecorator;\nexport function processContent<TClass>(): DecoratorFactoryMethod<TClass>;\nexport function processContent<TClass>(hook?: ProcessContentHook): CustomElementDecorator | DecoratorFactoryMethod<TClass> {\n  return hook === void 0\n    ? function (target: Constructable<TClass>, propertyKey: string, _descriptor: PropertyDescriptor) {\n      defineMetadata(pcHookMetadataProperty, ensureHook(target, propertyKey), target);\n    }\n    : function (target: Constructable<TClass>) {\n      hook = ensureHook(target, hook!);\n      const def = getOwnMetadata(ceBaseName, target) as CustomElementDefinition<Constructable<TClass>>;\n      if (def !== void 0) {\n        (def as Writable<CustomElementDefinition<Constructable<TClass>>>).processContent = hook;\n      } else {\n        defineMetadata(pcHookMetadataProperty, hook, target);\n      }\n      return target;\n    };\n}\n\nfunction ensureHook<TClass>(target: Constructable<TClass>, hook: string | ProcessContentHook): ProcessContentHook {\n  if (isString(hook)) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-explicit-any\n    hook = (target as any)[hook] as ProcessContentHook;\n  }\n\n  if (!isFunction(hook)) {\n    if (__DEV__)\n      throw new Error(`Invalid @processContent hook. Expected the hook to be a function (when defined in a class, it needs to be a static function) but got a ${typeof hook}.`);\n    else\n      throw new Error(`AUR0766:${typeof hook}`);\n  }\n  return hook;\n}\n","import { emptyArray } from '@aurelia/kernel';\nimport { AccessorType, LifecycleFlags } from '@aurelia/runtime';\nimport { hasOwnProperty, isString } from '../utilities.js';\n\nimport type { IAccessor } from '@aurelia/runtime';\n\nexport class ClassAttributeAccessor implements IAccessor {\n  public get doNotCache(): true { return true; }\n  public type: AccessorType = AccessorType.Node | AccessorType.Layout;\n\n  public value: unknown = '';\n  /** @internal */\n  private _oldValue: unknown = '';\n\n  /** @internal */\n  private _nameIndex: Record<string, number> = {};\n  /** @internal */\n  private _version: number = 0;\n\n  /** @internal */\n  private _hasChanges: boolean = false;\n\n  public constructor(\n    public readonly obj: HTMLElement,\n  ) {\n  }\n\n  public getValue(): unknown {\n    // is it safe to assume the observer has the latest value?\n    // todo: ability to turn on/off cache based on type\n    return this.value;\n  }\n\n  public setValue(newValue: unknown, flags: LifecycleFlags): void {\n    this.value = newValue;\n    this._hasChanges = newValue !== this._oldValue;\n    if ((flags & LifecycleFlags.noFlush) === 0) {\n      this._flushChanges();\n    }\n  }\n\n  /** @internal */\n  private _flushChanges(): void {\n    if (this._hasChanges) {\n      this._hasChanges = false;\n      const currentValue = this.value;\n      const nameIndex = this._nameIndex;\n      const classesToAdd = getClassesToAdd(currentValue as string | Record<string, unknown> | []);\n      let version = this._version;\n      this._oldValue = currentValue;\n\n      // Get strings split on a space not including empties\n      if (classesToAdd.length > 0) {\n        this._addClassesAndUpdateIndex(classesToAdd);\n      }\n\n      this._version += 1;\n\n      // First call to setValue?  We're done.\n      if (version === 0) {\n        return;\n      }\n\n      // Remove classes from previous version.\n      version -= 1;\n      for (const name in nameIndex) {\n        if (!hasOwnProperty.call(nameIndex, name) || nameIndex[name] !== version) {\n          continue;\n        }\n\n        // TODO: this has the side-effect that classes already present which are added again,\n        // will be removed if they're not present in the next update.\n        // Better would be do have some configurability for this behavior, allowing the user to\n        // decide whether initial classes always need to be kept, always removed, or something in between\n        this.obj.classList.remove(name);\n      }\n    }\n  }\n\n  /** @internal */\n  private _addClassesAndUpdateIndex(classes: string[]) {\n    const node = this.obj;\n    const ii = classes.length;\n    let i = 0;\n    let className: string;\n    for (; i < ii; i++) {\n      className = classes[i];\n      if (className.length === 0) {\n        continue;\n      }\n      this._nameIndex[className] = this._version;\n      node.classList.add(className);\n    }\n  }\n}\n\nexport function getClassesToAdd(object: Record<string, unknown> | [] | string): string[] {\n  if (isString(object)) {\n    return splitClassString(object);\n  }\n  if (typeof object !== 'object') {\n    return emptyArray;\n  }\n\n  if (object instanceof Array) {\n    const len = object.length;\n    if (len > 0) {\n      const classes: string[] = [];\n      let i = 0;\n      for (; len > i; ++i) {\n        classes.push(...getClassesToAdd(object[i]));\n      }\n      return classes;\n    } else {\n      return emptyArray;\n    }\n  }\n\n  const classes: string[] = [];\n  let property: string;\n  for (property in object) {\n    // Let non typical values also evaluate true so disable bool check\n    // eslint-disable-next-line no-extra-boolean-cast\n    if (Boolean(object[property])) {\n      // We must do this in case object property has a space in the name which results in two classes\n      if (property.includes(' ')) {\n        classes.push(...splitClassString(property));\n      } else {\n        classes.push(property);\n      }\n    }\n  }\n  return classes;\n}\n\nfunction splitClassString(classString: string): string[] {\n  const matches = classString.match(/\\S+/g);\n  if (matches === null) {\n    return emptyArray;\n  }\n  return matches;\n}\n","import { IContainer, Registration, DI, noop } from '@aurelia/kernel';\nimport { AppTask } from '../app-task.js';\nimport { INode } from '../dom.js';\nimport { getClassesToAdd } from '../observation/class-attribute-accessor.js';\nimport { IPlatform } from '../platform.js';\nimport { CustomAttribute } from '../resources/custom-attribute.js';\n\nimport type { IRegistry } from '@aurelia/kernel';\n\nexport function cssModules(...modules: (Record<string, string>)[]): CSSModulesProcessorRegistry {\n  return new CSSModulesProcessorRegistry(modules);\n}\n\nexport class CSSModulesProcessorRegistry implements IRegistry {\n  public constructor(\n    private readonly modules: Record<string, string>[],\n  ) {}\n\n  public register(container: IContainer): void {\n    const classLookup = Object.assign({}, ...this.modules) as Record<string, string>;\n    const ClassCustomAttribute = CustomAttribute.define({\n      name: 'class',\n      bindables: ['value'],\n      noMultiBindings: true,\n    }, class CustomAttributeClass {\n      public static inject: unknown[] = [INode];\n\n      public value!: string;\n      public constructor(\n        private readonly element: INode<HTMLElement>,\n      ) {}\n\n      public binding() {\n        this.valueChanged();\n      }\n\n      public valueChanged() {\n        if (!this.value) {\n          this.element.className = '';\n          return;\n        }\n\n        this.element.className = getClassesToAdd(this.value).map(x => classLookup[x] || x).join(' ');\n      }\n    });\n\n    container.register(ClassCustomAttribute);\n  }\n}\n\nexport function shadowCSS(...css: (string | CSSStyleSheet)[]): ShadowDOMRegistry {\n  return new ShadowDOMRegistry(css);\n}\n\nexport interface IShadowDOMStyleFactory {\n  createStyles(localStyles: (string | CSSStyleSheet)[], sharedStyles: IShadowDOMStyles | null): IShadowDOMStyles;\n}\n\nexport const IShadowDOMStyleFactory = DI.createInterface<IShadowDOMStyleFactory>('IShadowDOMStyleFactory', x => x.cachedCallback(handler => {\n  if (AdoptedStyleSheetsStyles.supported(handler.get(IPlatform))) {\n    return handler.get(AdoptedStyleSheetsStylesFactory);\n  }\n  return handler.get(StyleElementStylesFactory);\n}));\n\nexport class ShadowDOMRegistry implements IRegistry {\n  public constructor(\n    private readonly css: (string | CSSStyleSheet)[],\n  ) { }\n\n  public register(container: IContainer): void {\n    const sharedStyles = container.get(IShadowDOMGlobalStyles);\n    const factory = container.get(IShadowDOMStyleFactory);\n    container.register(Registration.instance(IShadowDOMStyles, factory.createStyles(this.css, sharedStyles)));\n  }\n}\n\nclass AdoptedStyleSheetsStylesFactory {\n  public static inject = [IPlatform];\n  private readonly cache = new Map<string, CSSStyleSheet>();\n\n  public constructor(private readonly p: IPlatform) {}\n\n  public createStyles(localStyles: (string | CSSStyleSheet)[], sharedStyles: IShadowDOMStyles | null): IShadowDOMStyles {\n    return new AdoptedStyleSheetsStyles(this.p, localStyles, this.cache, sharedStyles);\n  }\n}\n\nclass StyleElementStylesFactory {\n  public static inject = [IPlatform];\n  public constructor(private readonly p: IPlatform) {}\n\n  public createStyles(localStyles: string[], sharedStyles: IShadowDOMStyles | null): IShadowDOMStyles {\n    return new StyleElementStyles(this.p, localStyles, sharedStyles);\n  }\n}\n\ntype HasAdoptedStyleSheets = ShadowRoot & {\n  adoptedStyleSheets: CSSStyleSheet[];\n};\n\nexport interface IShadowDOMStyles {\n  applyTo(shadowRoot: ShadowRoot): void;\n}\n\nexport const IShadowDOMStyles = DI.createInterface<IShadowDOMStyles>('IShadowDOMStyles');\nexport const IShadowDOMGlobalStyles = DI.createInterface<IShadowDOMStyles>('IShadowDOMGlobalStyles', x => x.instance({ applyTo: noop }));\n\nexport class AdoptedStyleSheetsStyles implements IShadowDOMStyles {\n  private readonly styleSheets: CSSStyleSheet[];\n\n  public constructor(\n    p: IPlatform,\n    localStyles: (string | CSSStyleSheet)[],\n    styleSheetCache: Map<string, CSSStyleSheet>,\n    private readonly sharedStyles: IShadowDOMStyles | null = null\n  ) {\n    this.styleSheets = localStyles.map(x => {\n      let sheet: CSSStyleSheet | undefined;\n\n      if (x instanceof p.CSSStyleSheet) {\n        sheet = x;\n      } else {\n        sheet = styleSheetCache.get(x);\n\n        if (sheet === void 0) {\n          sheet = new p.CSSStyleSheet();\n          // eslint-disable-next-line\n          (sheet as any).replaceSync(x);\n          styleSheetCache.set(x, sheet);\n        }\n      }\n\n      return sheet;\n    });\n  }\n\n  public static supported(p: IPlatform): boolean {\n    return 'adoptedStyleSheets' in p.ShadowRoot.prototype;\n  }\n\n  public applyTo(shadowRoot: HasAdoptedStyleSheets): void {\n    if (this.sharedStyles !== null) {\n      this.sharedStyles.applyTo(shadowRoot);\n    }\n\n    // https://wicg.github.io/construct-stylesheets/\n    // https://developers.google.com/web/updates/2019/02/constructable-stylesheets\n    shadowRoot.adoptedStyleSheets = [\n      ...shadowRoot.adoptedStyleSheets,\n      ...this.styleSheets\n    ];\n  }\n}\n\nexport class StyleElementStyles implements IShadowDOMStyles {\n  public constructor(\n    private readonly p: IPlatform,\n    private readonly localStyles: string[],\n    private readonly sharedStyles: IShadowDOMStyles | null = null\n  ) { }\n\n  public applyTo(shadowRoot: ShadowRoot): void {\n    const styles = this.localStyles;\n    const p = this.p;\n\n    for (let i = styles.length - 1; i > -1; --i) {\n      const element = p.document.createElement('style');\n      element.innerHTML = styles[i];\n      shadowRoot.prepend(element);\n    }\n\n    if (this.sharedStyles !== null) {\n      this.sharedStyles.applyTo(shadowRoot);\n    }\n  }\n}\n\nexport interface IShadowDOMConfiguration {\n  sharedStyles?: (string | CSSStyleSheet)[];\n}\n\nexport const StyleConfiguration = {\n  shadowDOM(config: IShadowDOMConfiguration): IRegistry {\n    return AppTask.beforeCreate(IContainer, container => {\n      if (config.sharedStyles != null) {\n        const factory = container.get(IShadowDOMStyleFactory);\n        container.register(Registration.instance(IShadowDOMGlobalStyles, factory.createStyles(config.sharedStyles, null)));\n      }\n    });\n  }\n};\n","import {\n  connectable,\n  ConnectableSwitcher,\n  ExpressionKind,\n  LifecycleFlags,\n  ProxyObservable,\n} from '@aurelia/runtime';\nimport type { IServiceLocator } from '@aurelia/kernel';\nimport type {\n  ICollectionSubscriber,\n  IConnectable,\n  IConnectableBinding,\n  IObservable,\n  IObserverLocator,\n  IsBindingBehavior,\n  ISubscriber,\n  Scope,\n} from '@aurelia/runtime';\nimport type { IWatcherCallback } from '../watch.js';\n\nconst { enter, exit } = ConnectableSwitcher;\nconst { wrap, unwrap } = ProxyObservable;\n\n// watchers (Computed & Expression) are basically binding,\n// they are treated as special and setup before all other bindings\n\nexport interface ComputedWatcher extends IConnectableBinding { }\n\nexport class ComputedWatcher implements IConnectableBinding, ISubscriber, ICollectionSubscriber {\n  public interceptor = this;\n\n  public value: unknown = void 0;\n  public isBound: boolean = false;\n\n  // todo: maybe use a counter allow recursive call to a certain level\n  private running: boolean = false;\n\n  /**\n   * A semi-private property used by connectable mixin\n   *\n   * @internal\n   */\n  public readonly oL: IObserverLocator;\n\n  public constructor(\n    public readonly obj: IObservable,\n    observerLocator: IObserverLocator,\n    public readonly get: (obj: object, watcher: IConnectable) => unknown,\n    private readonly cb: IWatcherCallback<object>,\n    public readonly useProxy: boolean,\n  ) {\n    this.oL = observerLocator;\n  }\n\n  public handleChange(): void {\n    this.run();\n  }\n\n  public handleCollectionChange(): void {\n    this.run();\n  }\n\n  public $bind(): void {\n    if (this.isBound) {\n      return;\n    }\n    this.isBound = true;\n    this.compute();\n  }\n\n  public $unbind(): void {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    this.obs.clearAll();\n  }\n\n  private run(): void {\n    if (!this.isBound || this.running) {\n      return;\n    }\n    const obj = this.obj;\n    const oldValue = this.value;\n    const newValue = this.compute();\n\n    if (!Object.is(newValue, oldValue)) {\n      // should optionally queue\n      this.cb.call(obj, newValue, oldValue, obj);\n    }\n  }\n\n  private compute(): unknown {\n    this.running = true;\n    this.obs.version++;\n    try {\n      enter(this);\n      return this.value = unwrap(this.get.call(void 0, this.useProxy ? wrap(this.obj) : this.obj, this));\n    } finally {\n      this.obs.clear();\n      this.running = false;\n      exit(this);\n    }\n  }\n}\n\nexport interface ExpressionWatcher extends IConnectableBinding { }\n\nexport class ExpressionWatcher implements IConnectableBinding {\n  public interceptor = this;\n  /**\n   * @internal\n   */\n  private readonly obj: object;\n\n  public value: unknown;\n  public isBound: boolean = false;\n\n  public constructor(\n    public scope: Scope,\n    public locator: IServiceLocator,\n    public oL: IObserverLocator,\n    private readonly expression: IsBindingBehavior,\n    private readonly callback: IWatcherCallback<object>,\n  ) {\n    this.obj = scope.bindingContext;\n  }\n\n  public handleChange(value: unknown): void {\n    const expr = this.expression;\n    const obj = this.obj;\n    const oldValue = this.value;\n    const canOptimize = expr.$kind === ExpressionKind.AccessScope && this.obs.count === 1;\n    if (!canOptimize) {\n      this.obs.version++;\n      value = expr.evaluate(0, this.scope, this.locator, this);\n      this.obs.clear();\n    }\n    if (!Object.is(value, oldValue)) {\n      this.value = value;\n      // should optionally queue for batch synchronous\n      this.callback.call(obj, value, oldValue, obj);\n    }\n  }\n\n  public $bind(): void {\n    if (this.isBound) {\n      return;\n    }\n    this.isBound = true;\n    this.obs.version++;\n    this.value = this.expression.evaluate(LifecycleFlags.none, this.scope, this.locator, this);\n    this.obs.clear();\n  }\n\n  public $unbind(): void {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    this.obs.clearAll();\n    this.value = void 0;\n  }\n}\n\nconnectable(ComputedWatcher);\nconnectable(ExpressionWatcher);\n","import { DI, Registration } from '@aurelia/kernel';\nimport { appendResourceKey, defineMetadata, getAnnotationKeyFor, getOwnMetadata } from '../shared.js';\nimport type { Constructable, IContainer } from '@aurelia/kernel';\n\ntype FuncPropNames<T> = {\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  [K in keyof T]: K extends 'constructor' ? never : Required<T>[K] extends Function ? K : never;\n}[keyof T];\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nexport type LifecycleHook<TViewModel, TKey extends FuncPropNames<TViewModel>> = (vm: TViewModel, ...args: Parameters<Required<TViewModel>[TKey]>) => ReturnType<Required<TViewModel>[TKey]>;\n\nexport type ILifecycleHooks<TViewModel = {}, TKey extends FuncPropNames<TViewModel> = FuncPropNames<TViewModel>> = { [K in TKey]: LifecycleHook<TViewModel, K>; };\nexport const ILifecycleHooks = DI.createInterface<ILifecycleHooks>('ILifecycleHooks');\n\nexport type LifecycleHooksLookup<TViewModel = {}> = {\n  [K in FuncPropNames<TViewModel>]?: readonly LifecycleHooksEntry<TViewModel, K>[];\n};\nexport class LifecycleHooksEntry<TViewModel = {}, TKey extends FuncPropNames<TViewModel> = FuncPropNames<TViewModel>, THooks extends Constructable = Constructable> {\n  public constructor(\n    public readonly definition: LifecycleHooksDefinition<THooks>,\n    public readonly instance: ILifecycleHooks<TViewModel, TKey>,\n  ) {}\n}\n\n/**\n * This definition has no specific properties yet other than the type, but is in place for future extensions.\n *\n * See: https://github.com/aurelia/aurelia/issues/1044\n */\nexport class LifecycleHooksDefinition<T extends Constructable = Constructable> {\n  private constructor(\n    public readonly Type: T,\n    public readonly propertyNames: ReadonlySet<string>,\n  ) {}\n\n  /**\n   * @param def - Placeholder for future extensions. Currently always an empty object.\n   */\n  public static create<T extends Constructable>(def: {}, Type: T): LifecycleHooksDefinition<T> {\n    const propertyNames = new Set<string>();\n    let proto = Type.prototype;\n    while (proto !== Object.prototype) {\n      for (const name of Object.getOwnPropertyNames(proto)) {\n        // This is the only check we will do for now. Filtering on e.g. function types might not always work properly when decorators come into play. This would need more testing first.\n        if (name !== 'constructor') {\n          propertyNames.add(name);\n        }\n      }\n      proto = Object.getPrototypeOf(proto);\n    }\n\n    return new LifecycleHooksDefinition(Type, propertyNames);\n  }\n\n  public register(container: IContainer): void {\n    Registration.singleton(ILifecycleHooks, this.Type).register(container);\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst containerLookup = new WeakMap<IContainer, LifecycleHooksLookup<any>>();\n\nconst lhBaseName = getAnnotationKeyFor('lifecycle-hooks');\n\nexport const LifecycleHooks = Object.freeze({\n  name: lhBaseName,\n  /**\n   * @param def - Placeholder for future extensions. Currently always an empty object.\n   */\n  define<T extends Constructable>(def: {}, Type: T): T {\n    const definition = LifecycleHooksDefinition.create(def, Type);\n    defineMetadata(lhBaseName, definition, Type);\n    appendResourceKey(Type, lhBaseName);\n    return definition.Type;\n  },\n  resolve(ctx: IContainer): LifecycleHooksLookup {\n    let lookup = containerLookup.get(ctx);\n    if (lookup === void 0) {\n      lookup = new LifecycleHooksLookupImpl();\n      const root = ctx.root;\n      const instances = root.id === ctx.id\n        ? ctx.getAll(ILifecycleHooks)\n        // if it's not root, only resolve it from the current context when it has the resolver\n        // to maintain resources semantic: current -> root\n        : ctx.has(ILifecycleHooks, false)\n          ? [...root.getAll(ILifecycleHooks), ...ctx.getAll(ILifecycleHooks)]\n          : root.getAll(ILifecycleHooks);\n\n      let instance: ILifecycleHooks;\n      let definition: LifecycleHooksDefinition;\n      let entry: LifecycleHooksEntry;\n      let name: string;\n      let entries: LifecycleHooksEntry[];\n\n      for (instance of instances) {\n        definition = getOwnMetadata(lhBaseName, instance.constructor) as LifecycleHooksDefinition;\n        entry = new LifecycleHooksEntry(definition, instance);\n        for (name of definition.propertyNames) {\n          entries = lookup[name] as LifecycleHooksEntry[];\n          if (entries === void 0) {\n            lookup[name] = [entry];\n          } else {\n            entries.push(entry);\n          }\n        }\n      }\n    }\n    return lookup;\n  },\n});\n\nclass LifecycleHooksLookupImpl implements LifecycleHooksLookup {}\n\n/**\n * Decorator: Indicates that the decorated class is a custom element.\n */\nexport function lifecycleHooks(): <T extends Constructable>(target: T) => T {\n  return function decorator<T extends Constructable>(target: T): T {\n    return LifecycleHooks.define({}, target);\n  };\n}\n","import { DI } from '@aurelia/kernel';\nimport { Scope } from '@aurelia/runtime';\nimport { CustomElement, CustomElementDefinition } from '../resources/custom-element.js';\nimport { Controller } from './controller.js';\nimport { defineMetadata, getOwnMetadata, getResourceKeyFor, hasOwnMetadata } from '../shared.js';\nimport { isFunction, isString } from '../utilities.js';\n\nimport type { Constructable, ConstructableClass, IContainer } from '@aurelia/kernel';\nimport type { LifecycleFlags } from '@aurelia/runtime';\nimport type {\n  ICustomElementViewModel,\n  ISyntheticView,\n  IDryCustomElementController,\n  IContextualCustomElementController,\n  ICompiledCustomElementController,\n  ICustomElementController,\n  ICustomAttributeController,\n  IHydratedController,\n  IHydratedParentController,\n  IHydrationContext,\n} from './controller.js';\nimport type { PartialCustomElementDefinition } from '../resources/custom-element.js';\n\nexport interface IViewFactory extends ViewFactory {}\nexport const IViewFactory = DI.createInterface<IViewFactory>('IViewFactory');\nexport class ViewFactory implements IViewFactory {\n  public static maxCacheSize: number = 0xFFFF;\n\n  public name: string;\n  public readonly container: IContainer;\n  public def: PartialCustomElementDefinition;\n  public isCaching: boolean = false;\n\n  private cache: ISyntheticView[] = null!;\n  private cacheSize: number = -1;\n\n  public constructor(\n    container: IContainer,\n    def: CustomElementDefinition,\n  ) {\n    this.name = def.name;\n    this.container = container;\n    this.def = def;\n  }\n\n  public setCacheSize(size: number | '*', doNotOverrideIfAlreadySet: boolean): void {\n    if (size) {\n      if (size === '*') {\n        size = ViewFactory.maxCacheSize;\n      } else if (isString(size)) {\n        size = parseInt(size, 10);\n      }\n\n      if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n        this.cacheSize = size;\n      }\n    }\n\n    if (this.cacheSize > 0) {\n      this.cache = [];\n    } else {\n      this.cache = null!;\n    }\n\n    this.isCaching = this.cacheSize > 0;\n  }\n\n  public canReturnToCache(_controller: ISyntheticView): boolean {\n    return this.cache != null && this.cache.length < this.cacheSize;\n  }\n\n  public tryReturnToCache(controller: ISyntheticView): boolean {\n    if (this.canReturnToCache(controller)) {\n      this.cache.push(controller);\n      return true;\n    }\n\n    return false;\n  }\n\n  public create(\n    parentController?: ISyntheticView | ICustomElementController | ICustomAttributeController | undefined,\n  ): ISyntheticView {\n    const cache = this.cache;\n    let controller: ISyntheticView;\n\n    if (cache != null && cache.length > 0) {\n      controller = cache.pop()!;\n      return controller;\n    }\n\n    controller = Controller.$view(this, parentController);\n    return controller;\n  }\n}\n\nconst seenViews = new WeakSet();\nfunction notYetSeen($view: PartialCustomElementDefinition): boolean {\n  return !seenViews.has($view);\n}\nfunction toCustomElementDefinition($view: PartialCustomElementDefinition): CustomElementDefinition {\n  seenViews.add($view);\n  return CustomElementDefinition.create($view);\n}\n\nconst viewsBaseName = getResourceKeyFor('views');\n\nexport const Views = Object.freeze({\n  name: viewsBaseName,\n  has(value: object): boolean {\n    return isFunction(value) && (hasOwnMetadata(viewsBaseName, value) || '$views' in value);\n  },\n  get(value: object | Constructable): readonly CustomElementDefinition[] {\n    if (isFunction(value) && '$views' in value) {\n      // TODO: a `get` operation with side effects is not a good thing. Should refactor this to a proper resource kind.\n      const $views = (value as { $views: PartialCustomElementDefinition[] }).$views;\n      const definitions = $views.filter(notYetSeen).map(toCustomElementDefinition);\n      for (const def of definitions) {\n        Views.add(value, def);\n      }\n    }\n    let views = getOwnMetadata(viewsBaseName, value) as CustomElementDefinition[] | undefined;\n    if (views === void 0) {\n      defineMetadata(viewsBaseName, views = [], value);\n    }\n    return views;\n  },\n  add<T extends Constructable>(Type: T, partialDefinition: PartialCustomElementDefinition): readonly CustomElementDefinition[] {\n    const definition = CustomElementDefinition.create(partialDefinition);\n    let views = getOwnMetadata(viewsBaseName, Type) as CustomElementDefinition[] | undefined;\n    if (views === void 0) {\n      defineMetadata(viewsBaseName, views = [definition], Type);\n    } else {\n      views.push(definition);\n    }\n    return views;\n  },\n});\n\nexport function view(v: PartialCustomElementDefinition) {\n  return function<T extends Constructable> (target: T) {\n    Views.add(target, v);\n  };\n}\n\nexport type ClassInstance<T> = T & {\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  readonly constructor: Function;\n};\n\nexport type ViewSelector = (object: ICustomElementViewModel, views: readonly PartialCustomElementDefinition[]) => string;\nexport type ComposableObjectComponentType<T extends ICustomElementViewModel>\n  = ConstructableClass<{ viewModel: T } & ICustomElementViewModel>;\n\nexport const IViewLocator = DI.createInterface<IViewLocator>('IViewLocator', x => x.singleton(ViewLocator));\nexport interface IViewLocator extends ViewLocator {}\n\nexport class ViewLocator {\n  /** @internal */\n  private readonly _modelInstanceToBoundComponent: WeakMap<object, Record<string, ComposableObjectComponentType<ICustomElementViewModel>>> = new WeakMap();\n  /** @internal */\n  private readonly _modelTypeToUnboundComponent: Map<object, Record<string, ComposableObjectComponentType<ICustomElementViewModel>>> = new Map();\n\n  public getViewComponentForObject<T extends ClassInstance<ICustomElementViewModel>>(\n    object: T | null | undefined,\n    viewNameOrSelector?: string | ViewSelector\n  ): ComposableObjectComponentType<T> | null {\n    if (object) {\n      const availableViews = Views.has(object.constructor) ? Views.get(object.constructor) : [];\n      const resolvedViewName = isFunction(viewNameOrSelector)\n        ? viewNameOrSelector(object, availableViews)\n        : this._getViewName(availableViews, viewNameOrSelector);\n\n      return this._getOrCreateBoundComponent(\n        object,\n        availableViews,\n        resolvedViewName\n      );\n    }\n\n    return null;\n  }\n\n  /** @internal */\n  private _getOrCreateBoundComponent<T extends ClassInstance<ICustomElementViewModel>>(\n    object: T,\n    availableViews: readonly CustomElementDefinition[],\n    resolvedViewName: string\n  ): ComposableObjectComponentType<T> {\n    let lookup = this._modelInstanceToBoundComponent.get(object);\n    let BoundComponent: ComposableObjectComponentType<T> | undefined;\n\n    if (lookup === void 0) {\n      lookup = {};\n      this._modelInstanceToBoundComponent.set(object, lookup);\n    } else {\n      BoundComponent = lookup[resolvedViewName] as ComposableObjectComponentType<T>;\n    }\n\n    if (BoundComponent === void 0) {\n      const UnboundComponent = this._getOrCreateUnboundComponent(\n        object,\n        availableViews,\n        resolvedViewName\n      );\n\n      BoundComponent = CustomElement.define<ComposableObjectComponentType<T>>(\n        CustomElement.getDefinition(UnboundComponent),\n        class extends UnboundComponent {\n          public constructor() {\n            super(object);\n          }\n        }\n      );\n\n      lookup[resolvedViewName] = BoundComponent;\n    }\n\n    return BoundComponent;\n  }\n\n  /** @internal */\n  private _getOrCreateUnboundComponent<T extends ClassInstance<ICustomElementViewModel>>(\n    object: T,\n    availableViews: readonly CustomElementDefinition[],\n    resolvedViewName: string\n  ): ComposableObjectComponentType<T> {\n    let lookup = this._modelTypeToUnboundComponent.get(object.constructor);\n    let UnboundComponent: ComposableObjectComponentType<T> | undefined;\n\n    if (lookup === void 0) {\n      lookup = {};\n      this._modelTypeToUnboundComponent.set(object.constructor, lookup);\n    } else {\n      UnboundComponent = lookup[resolvedViewName] as ComposableObjectComponentType<T>;\n    }\n\n    if (UnboundComponent === void 0) {\n      UnboundComponent = CustomElement.define<ComposableObjectComponentType<T>>(\n        this._getView(availableViews, resolvedViewName),\n        class {\n          public constructor(public viewModel: T) {}\n\n          public define(\n            controller: IDryCustomElementController<T>,\n            hydrationContext: IHydrationContext,\n            definition: CustomElementDefinition,\n          ): PartialCustomElementDefinition | void {\n            const vm = this.viewModel;\n            controller.scope = Scope.fromParent(controller.scope, vm);\n\n            if (vm.define !== void 0) {\n              return vm.define(controller, hydrationContext, definition);\n            }\n          }\n        }\n      );\n\n      const proto = UnboundComponent.prototype;\n\n      if ('hydrating' in object) {\n        proto.hydrating = function hydrating(\n          controller: IContextualCustomElementController,\n        ): void {\n          this.viewModel.hydrating!(controller as IContextualCustomElementController<T>);\n        };\n      }\n      if ('hydrated' in object) {\n        proto.hydrated = function hydrated(\n          controller: ICompiledCustomElementController,\n        ): void {\n          this.viewModel.hydrated!(controller as ICompiledCustomElementController<T>);\n        };\n      }\n      if ('created' in object) {\n        proto.created = function created(\n          controller: ICustomElementController,\n        ): void {\n          this.viewModel.created!(controller as ICustomElementController<T>);\n        };\n      }\n\n      if ('binding' in object) {\n        proto.binding = function binding(\n          initiator: IHydratedController,\n          parent: IHydratedParentController | null,\n          flags: LifecycleFlags,\n        ): void | Promise<void> {\n          return this.viewModel.binding!(initiator, parent, flags);\n        };\n      }\n      if ('bound' in object) {\n        proto.bound = function bound(\n          initiator: IHydratedController,\n          parent: IHydratedParentController | null,\n          flags: LifecycleFlags,\n        ): void | Promise<void> {\n          return this.viewModel.bound!(initiator, parent, flags);\n        };\n      }\n      if ('attaching' in object) {\n        proto.attaching = function attaching(\n          initiator: IHydratedController,\n          parent: IHydratedParentController | null,\n          flags: LifecycleFlags,\n        ): void | Promise<void> {\n          return this.viewModel.attaching!(initiator, parent, flags);\n        };\n      }\n      if ('attached' in object) {\n        proto.attached = function attached(\n          initiator: IHydratedController,\n          flags: LifecycleFlags,\n        ): void | Promise<void> {\n          return this.viewModel.attached!(initiator, flags);\n        };\n      }\n\n      if ('detaching' in object) {\n        proto.detaching = function detaching(\n          initiator: IHydratedController,\n          parent: IHydratedParentController | null,\n          flags: LifecycleFlags,\n        ): void | Promise<void> {\n          return this.viewModel.detaching!(initiator, parent, flags);\n        };\n      }\n      if ('unbinding' in object) {\n        proto.unbinding = function unbinding(\n          initiator: IHydratedController,\n          parent: IHydratedParentController | null,\n          flags: LifecycleFlags,\n        ): void | Promise<void> {\n          return this.viewModel.unbinding!(initiator, parent, flags);\n        };\n      }\n\n      if ('dispose' in object) {\n        proto.dispose = function dispose(): void {\n          this.viewModel.dispose!();\n        };\n      }\n\n      lookup[resolvedViewName] = UnboundComponent;\n    }\n\n    return UnboundComponent;\n  }\n\n  /** @internal */\n  private _getViewName(views: readonly CustomElementDefinition[], requestedName?: string) {\n    if (requestedName) {\n      return requestedName;\n    }\n\n    if (views.length === 1) {\n      return views[0].name;\n    }\n\n    return 'default-view';\n  }\n\n  /** @internal */\n  private _getView(views: readonly CustomElementDefinition[], name: string): CustomElementDefinition {\n    const v = views.find(x => x.name === name);\n\n    if (v === void 0) {\n      throw new Error(`Could not find view: ${name}`);\n    }\n\n    return v;\n  }\n}\n","import { DI, IContainer } from '@aurelia/kernel';\n\nimport { FragmentNodeSequence, INode, INodeSequence } from '../dom.js';\nimport { IPlatform } from '../platform.js';\nimport { ICompliationInstruction, IInstruction, IRenderer, ITemplateCompiler } from '../renderer.js';\nimport { CustomElementDefinition, PartialCustomElementDefinition } from '../resources/custom-element.js';\nimport { createLookup, isString } from '../utilities.js';\nimport { IViewFactory, ViewFactory } from './view.js';\nimport type { IHydratableController } from './controller.js';\n\nexport const IRendering = DI.createInterface<IRendering>('IRendering', x => x.singleton(Rendering));\nexport interface IRendering extends Rendering { }\n\nexport class Rendering {\n  /** @internal */\n  protected static inject: unknown[] = [IContainer];\n  /** @internal */\n  private readonly _ctn: IContainer;\n  private rs: Record<string, IRenderer> | undefined;\n  /** @internal */\n  private readonly _p: IPlatform;\n  /** @internal */\n  private readonly _compilationCache: WeakMap<PartialCustomElementDefinition, CustomElementDefinition> = new WeakMap();\n  /** @internal */\n  private readonly _fragmentCache: WeakMap<CustomElementDefinition, DocumentFragment | null> = new WeakMap();\n  /** @internal */\n  private readonly _empty: INodeSequence;\n\n  public get renderers(): Record<string, IRenderer> {\n    return this.rs == null\n      ? (this.rs = this._ctn.getAll(IRenderer, false).reduce((all, r) => {\n          all[r.instructionType!] = r;\n          return all;\n        }, createLookup<IRenderer>()))\n      : this.rs;\n  }\n\n  public constructor(container: IContainer) {\n    this._p = (this._ctn = container.root).get(IPlatform);\n    this._empty = new FragmentNodeSequence(this._p, this._p.document.createDocumentFragment());\n  }\n\n  public compile(\n    definition: PartialCustomElementDefinition,\n    container: IContainer,\n    compilationInstruction: ICompliationInstruction | null,\n  ): CustomElementDefinition {\n    if (definition.needsCompile !== false) {\n      const compiledMap = this._compilationCache;\n      const compiler = container.get(ITemplateCompiler);\n      let compiled = compiledMap.get(definition);\n      if (compiled == null) {\n        compiledMap.set(definition, compiled = compiler.compile(definition, container, compilationInstruction));\n      } else {\n        // todo:\n        // should only register if the compiled def resolution is string\n        // instead of direct resources\n        container.register(...compiled.dependencies);\n      }\n      return compiled;\n    }\n\n    return definition as CustomElementDefinition;\n  }\n\n  public getViewFactory(definition: PartialCustomElementDefinition, container: IContainer): IViewFactory {\n    return new ViewFactory(container, CustomElementDefinition.getOrCreate(definition));\n  }\n\n  public createNodes(definition: CustomElementDefinition): INodeSequence {\n    if (definition.enhance === true) {\n      return new FragmentNodeSequence(this._p, definition.template as DocumentFragment);\n    }\n    let fragment: DocumentFragment | null | undefined;\n    const cache = this._fragmentCache;\n    if (cache.has(definition)) {\n      fragment = cache.get(definition);\n    } else {\n      const p = this._p;\n      const doc = p.document;\n      const template = definition.template;\n      let tpl: HTMLTemplateElement;\n      if (template === null) {\n        fragment = null;\n      } else if (template instanceof p.Node) {\n        if (template.nodeName === 'TEMPLATE') {\n          fragment = doc.adoptNode((template as HTMLTemplateElement).content);\n        } else {\n          (fragment = doc.adoptNode(doc.createDocumentFragment())).appendChild(template.cloneNode(true));\n        }\n      } else {\n        tpl = doc.createElement('template');\n        if (isString(template)) {\n          tpl.innerHTML = template;\n        }\n        doc.adoptNode(fragment = tpl.content);\n      }\n      cache.set(definition, fragment);\n    }\n    return fragment == null\n      ? this._empty\n      : new FragmentNodeSequence(this._p, fragment.cloneNode(true) as DocumentFragment);\n  }\n\n  public render(\n    controller: IHydratableController,\n    targets: ArrayLike<INode>,\n    definition: CustomElementDefinition,\n    host: INode | null | undefined,\n  ): void {\n    const rows = definition.instructions;\n    const renderers = this.renderers;\n    const ii = targets.length;\n    if (targets.length !== rows.length) {\n      if (__DEV__)\n        throw new Error(`The compiled template is not aligned with the render instructions. There are ${ii} targets and ${rows.length} instructions.`);\n      else\n        throw new Error(`AUR0757:${ii}<>${rows.length}`);\n    }\n\n    let i = 0;\n    let j = 0;\n    let jj = 0;\n    let row: readonly IInstruction[];\n    let instruction: IInstruction;\n    let target: INode;\n\n    if (ii > 0) {\n      while (ii > i) {\n        row = rows[i];\n        target = targets[i];\n        j = 0;\n        jj = row.length;\n        while (jj > j) {\n          instruction = row[j];\n          renderers[instruction.type].render(controller, target, instruction);\n          ++j;\n        }\n        ++i;\n      }\n    }\n\n    if (host !== void 0 && host !== null) {\n      row = definition.surrogates;\n      if ((jj = row.length) > 0) {\n        j = 0;\n        while (jj > j) {\n          instruction = row[j];\n          renderers[instruction.type].render(controller, host, instruction);\n          ++j;\n        }\n      }\n    }\n  }\n}\n","/* eslint-disable @typescript-eslint/no-unnecessary-type-assertion */\nimport {\n  nextId,\n  isObject,\n  ILogger,\n  LogLevel,\n  DI,\n  emptyArray,\n  InstanceProvider,\n  optional,\n} from '@aurelia/kernel';\nimport {\n  AccessScopeExpression,\n  ExpressionType,\n  Scope,\n  LifecycleFlags,\n  IObserverLocator,\n  IExpressionParser,\n  ICoercionConfiguration,\n} from '@aurelia/runtime';\nimport { BindableObserver } from '../observation/bindable-observer.js';\nimport { convertToRenderLocation, setRef } from '../dom.js';\nimport { CustomElementDefinition, CustomElement } from '../resources/custom-element.js';\nimport { CustomAttributeDefinition, CustomAttribute } from '../resources/custom-attribute.js';\nimport { ChildrenDefinition, ChildrenObserver } from './children.js';\nimport { IPlatform } from '../platform.js';\nimport { IShadowDOMGlobalStyles, IShadowDOMStyles } from './styles.js';\nimport { ComputedWatcher, ExpressionWatcher } from './watchers.js';\nimport { LifecycleHooks } from './lifecycle-hooks.js';\nimport { IRendering } from './rendering.js';\nimport { isFunction, isString } from '../utilities.js';\n\nimport type {\n  IContainer,\n  IIndexable,\n  Writable,\n  Constructable,\n  IDisposable,\n  IServiceLocator,\n} from '@aurelia/kernel';\nimport type {\n  IBinding,\n  IObservable,\n  IsBindingBehavior,\n} from '@aurelia/runtime';\nimport type { AttrSyntax } from '../resources/attribute-pattern.js';\nimport type { IProjections } from '../resources/slot-injectables.js';\nimport type { BindableDefinition } from '../bindable.js';\nimport type { LifecycleHooksLookup } from './lifecycle-hooks.js';\nimport type { INode, INodeSequence, IRenderLocation } from '../dom.js';\nimport type { IViewFactory } from './view.js';\nimport type { IInstruction } from '../renderer.js';\nimport type { IWatchDefinition, IWatcherCallback } from '../watch.js';\nimport type { PartialCustomElementDefinition } from '../resources/custom-element.js';\n\ntype BindingContext<C extends IViewModel> = Required<ICompileHooks> & Required<IActivationHooks<IHydratedController | null>> & C;\n\nexport const enum MountTarget {\n  none = 0,\n  host = 1,\n  shadowRoot = 2,\n  location = 3,\n}\n\nconst optionalCeFind = { optional: true } as const;\n\nconst controllerLookup: WeakMap<object, Controller> = new WeakMap();\nexport class Controller<C extends IViewModel = IViewModel> implements IController<C> {\n  public readonly id: number = nextId('au$component');\n\n  public head: IHydratedController | null = null;\n  public tail: IHydratedController | null = null;\n  public next: IHydratedController | null = null;\n\n  public parent: IHydratedController | null = null;\n  public bindings: IBinding[] | null = null;\n  public children: Controller[] | null = null;\n\n  public hasLockedScope: boolean = false;\n\n  public isStrictBinding: boolean = false;\n\n  public scope: Scope | null = null;\n  public isBound: boolean = false;\n\n  // If a host from another custom element was passed in, then this will be the controller for that custom element (could be `au-viewport` for example).\n  // In that case, this controller will create a new host node (with the definition's name) and use that as the target host for the nodes instead.\n  // That host node is separately mounted to the host controller's original host node.\n  public hostController: Controller | null = null;\n  public mountTarget: MountTarget = MountTarget.none;\n  public shadowRoot: ShadowRoot | null = null;\n  public nodes: INodeSequence | null = null;\n  public location: IRenderLocation | null = null;\n  public lifecycleHooks: LifecycleHooksLookup | null = null;\n\n  public state: State = State.none;\n  public get isActive(): boolean {\n    return (this.state & (State.activating | State.activated)) > 0 && (this.state & State.deactivating) === 0;\n  }\n\n  public get name(): string {\n    if (this.parent === null) {\n      switch (this.vmKind) {\n        case ViewModelKind.customAttribute:\n          return `[${this.definition!.name}]`;\n        case ViewModelKind.customElement:\n          return this.definition!.name;\n        case ViewModelKind.synthetic:\n          return this.viewFactory!.name;\n      }\n    }\n    switch (this.vmKind) {\n      case ViewModelKind.customAttribute:\n        return `${(this.parent as Controller).name}>[${this.definition!.name}]`;\n      case ViewModelKind.customElement:\n        return `${(this.parent as Controller).name}>${this.definition!.name}`;\n      case ViewModelKind.synthetic:\n        return this.viewFactory!.name === this.parent.definition?.name\n          ? `${(this.parent as Controller).name}[view]`\n          : `${(this.parent as Controller).name}[view:${this.viewFactory!.name}]`;\n    }\n  }\n\n  /** @internal */\n  private _compiledDef: CustomElementDefinition | undefined;\n  private logger!: ILogger;\n  private debug!: boolean;\n  /** @internal */\n  private _fullyNamed: boolean = false;\n  /** @internal */\n  private _childrenObs: ChildrenObserver[] = emptyArray;\n  /** @internal */\n  private readonly _rendering: IRendering;\n\n  public readonly hooks: HooksDefinition;\n  public flags: LifecycleFlags = LifecycleFlags.none;\n\n  public constructor(\n    public container: IContainer,\n    public readonly vmKind: ViewModelKind,\n    public readonly definition: CustomElementDefinition | CustomAttributeDefinition | null,\n    /**\n     * The viewFactory. Only present for synthetic views.\n     */\n    public viewFactory: IViewFactory | null,\n    /**\n     * The backing viewModel. Only present for custom attributes and elements.\n     */\n    public viewModel: BindingContext<C> | null,\n    /**\n     * The physical host dom node.\n     *\n     * For containerless elements, this node will be removed from the DOM and replaced by a comment, which is assigned to the `location` property.\n     *\n     * For ShadowDOM elements, this will be the original declaring element, NOT the shadow root (the shadow root is stored on the `shadowRoot` property)\n     */\n    public host: HTMLElement | null,\n  ) {\n    if (__DEV__) {\n      this.logger = null!;\n      this.debug = false;\n    }\n    this._rendering = container.root.get(IRendering);\n    switch (vmKind) {\n      case ViewModelKind.customAttribute:\n      case ViewModelKind.customElement:\n        // todo: cache-able based on constructor type\n        this.hooks = new HooksDefinition(viewModel!);\n        break;\n      case ViewModelKind.synthetic:\n        this.hooks = HooksDefinition.none;\n        break;\n    }\n  }\n\n  public static getCached<C extends ICustomElementViewModel = ICustomElementViewModel>(viewModel: C): ICustomElementController<C> | undefined {\n    return controllerLookup.get(viewModel) as ICustomElementController<C> | undefined;\n  }\n\n  public static getCachedOrThrow<C extends ICustomElementViewModel = ICustomElementViewModel>(viewModel: C): ICustomElementController<C> {\n    const $el = Controller.getCached(viewModel);\n    if ($el === void 0) {\n      if (__DEV__)\n        throw new Error(`There is no cached controller for the provided ViewModel: ${viewModel}`);\n      else\n        throw new Error(`AUR0500:${viewModel}`);\n    }\n    return $el as ICustomElementController<C>;\n  }\n\n  /**\n   * Create a controller for a custom element based on a given set of parameters\n   *\n   * @param ctn - The own container of the custom element\n   * @param viewModel - The view model object (can be any object if a definition is specified)\n   *\n   * Semi private API\n   */\n  public static $el<C extends ICustomElementViewModel = ICustomElementViewModel>(\n    ctn: IContainer,\n    viewModel: C,\n    host: HTMLElement,\n    hydrationInst: IControllerElementHydrationInstruction | null,\n    // Use this when `instance.constructor` is not a custom element type\n    // to pass on the CustomElement definition\n    definition: CustomElementDefinition | undefined = void 0,\n  ): ICustomElementController<C> {\n    if (controllerLookup.has(viewModel)) {\n      return controllerLookup.get(viewModel) as unknown as ICustomElementController<C>;\n    }\n\n    definition = definition ?? CustomElement.getDefinition(viewModel.constructor as Constructable);\n\n    const controller = new Controller<C>(\n      /* container      */ctn,\n      /* vmKind         */ViewModelKind.customElement,\n      /* definition     */definition,\n      /* viewFactory    */null,\n      /* viewModel      */viewModel as BindingContext<C>,\n      /* host           */host,\n    );\n    // the hydration context this controller is provided with\n    const hydrationContext = ctn.get(optional(IHydrationContext)) as IHydrationContext;\n\n    if (definition.dependencies.length > 0) {\n      ctn.register(...definition.dependencies);\n    }\n    // each CE controller provides its own hydration context for its internal template\n    ctn.registerResolver(IHydrationContext, new InstanceProvider(\n      'IHydrationContext',\n      new HydrationContext(\n        controller,\n        hydrationInst,\n        hydrationContext,\n      )\n    ));\n    controllerLookup.set(viewModel, controller as Controller);\n\n    if (hydrationInst == null || hydrationInst.hydrate !== false) {\n      controller._hydrateCustomElement(hydrationInst, hydrationContext);\n    }\n\n    return controller as ICustomElementController<C>;\n  }\n\n  /**\n   * Create a controller for a custom attribute based on a given set of parameters\n   *\n   * @param ctn - own container associated with the custom attribute object\n   * @param viewModel - the view model object\n   * @param host - host element where this custom attribute is used\n   * @param flags - todo(comment)\n   * @param definition - the definition of the custom attribute,\n   * will be used to override the definition associated with the view model object contructor if given\n   */\n  public static $attr<C extends ICustomAttributeViewModel = ICustomAttributeViewModel>(\n    ctn: IContainer,\n    viewModel: C,\n    host: HTMLElement,\n    /**\n     * The definition that will be used to hydrate the custom attribute view model\n     *\n     * If not given, will be the one associated with the constructor of the attribute view model given.\n     */\n    definition?: CustomAttributeDefinition,\n  ): ICustomAttributeController<C> {\n    if (controllerLookup.has(viewModel)) {\n      return controllerLookup.get(viewModel) as unknown as ICustomAttributeController<C>;\n    }\n\n    definition = definition ?? CustomAttribute.getDefinition(viewModel.constructor as Constructable);\n\n    const controller = new Controller<C>(\n      /* own ct         */ctn,\n      /* vmKind         */ViewModelKind.customAttribute,\n      /* definition     */definition,\n      /* viewFactory    */null,\n      /* viewModel      */viewModel as BindingContext<C>,\n      /* host           */host\n    );\n\n    controllerLookup.set(viewModel, controller as Controller);\n\n    controller._hydrateCustomAttribute();\n\n    return controller as unknown as ICustomAttributeController<C>;\n  }\n\n  /**\n   * Create a synthetic view (controller) for a given factory\n   *\n   * @param viewFactory - todo(comment)\n   * @param flags - todo(comment)\n   * @param parentController - the parent controller to connect the created view with. Used in activation\n   *\n   * Semi private API\n   */\n  public static $view(\n    viewFactory: IViewFactory,\n    parentController: ISyntheticView | ICustomElementController | ICustomAttributeController | undefined = void 0,\n  ): ISyntheticView {\n    const controller = new Controller(\n      /* container      */viewFactory.container,\n      /* vmKind         */ViewModelKind.synthetic,\n      /* definition     */null,\n      /* viewFactory    */viewFactory,\n      /* viewModel      */null,\n      /* host           */null,\n    );\n    controller.parent = parentController ?? null;\n\n    controller._hydrateSynthetic(/* context */);\n\n    return controller as unknown as ISyntheticView;\n  }\n\n  /** @internal */\n  public _hydrateCustomElement(\n    hydrationInst: IControllerElementHydrationInstruction | null,\n    /**\n     * The context where this custom element is hydrated.\n     *\n     * This is the context controller creating this this controller\n     */\n    hydrationContext: IHydrationContext | null,\n  ): void {\n    if (__DEV__) {\n      this.logger = this.container.get(ILogger).root;\n      this.debug = this.logger.config.level <= LogLevel.debug;\n      if (__DEV__ && this.debug) {\n        this.logger = this.logger.scopeTo(this.name);\n      }\n    }\n\n    const container = this.container;\n    const flags = this.flags;\n    const instance = this.viewModel as BindingContext<C>;\n    let definition = this.definition as CustomElementDefinition;\n\n    this.scope = Scope.create(instance, null, true);\n\n    if (definition.watches.length > 0) {\n      createWatchers(this, container, definition, instance);\n    }\n    createObservers(this, definition, flags, instance);\n    this._childrenObs = createChildrenObservers(this as Controller, definition, instance);\n\n    if (this.hooks.hasDefine) {\n      if (__DEV__ && this.debug) { this.logger.trace(`invoking define() hook`); }\n      const result = instance.define(\n        /* controller      */this as ICustomElementController,\n        /* parentContainer */hydrationContext,\n        /* definition      */definition,\n      );\n      if (result !== void 0 && result !== definition) {\n        definition = CustomElementDefinition.getOrCreate(result);\n      }\n    }\n\n    this.lifecycleHooks = LifecycleHooks.resolve(container);\n    // Support Recursive Components by adding self to own context\n    definition.register(container);\n\n    if (definition.injectable !== null) {\n      container.registerResolver(\n        definition.injectable,\n        new InstanceProvider('definition.injectable', instance as ICustomElementViewModel),\n      );\n    }\n\n    // If this is the root controller, then the AppRoot will invoke things in the following order:\n    // - Controller.hydrateCustomElement\n    // - runAppTasks('hydrating') // may return a promise\n    // - Controller.compile\n    // - runAppTasks('hydrated') // may return a promise\n    // - Controller.compileChildren\n    // This keeps hydration synchronous while still allowing the composition root compile hooks to do async work.\n    if (hydrationInst == null || hydrationInst.hydrate !== false) {\n      this._hydrate(hydrationInst);\n      this._hydrateChildren();\n    }\n  }\n\n  /** @internal */\n  public _hydrate(hydrationInst: IControllerElementHydrationInstruction | null): void {\n    if (this.hooks.hasHydrating) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`invoking hydrating() hook`); }\n      (this.viewModel as BindingContext<C>).hydrating(this as ICustomElementController);\n    }\n\n    const compiledDef = this._compiledDef = this._rendering.compile(this.definition as CustomElementDefinition, this.container, hydrationInst);\n    const { shadowOptions, isStrictBinding, hasSlots, containerless } = compiledDef;\n\n    this.isStrictBinding = isStrictBinding;\n\n    if ((this.hostController = CustomElement.for(this.host!, optionalCeFind) as Controller | null) !== null) {\n      this.host = this.container.root.get(IPlatform).document.createElement(this.definition!.name);\n    }\n\n    setRef(this.host!, CustomElement.name, this as IHydratedController);\n    setRef(this.host!, this.definition!.key, this as IHydratedController);\n    if (shadowOptions !== null || hasSlots) {\n      if (containerless) {\n        if (__DEV__)\n          throw new Error('You cannot combine the containerless custom element option with Shadow DOM.');\n        else\n          throw new Error('AUR0501');\n      }\n      setRef(this.shadowRoot = this.host!.attachShadow(shadowOptions ?? defaultShadowOptions), CustomElement.name, this as IHydratedController);\n      setRef(this.shadowRoot!, this.definition!.key, this as IHydratedController);\n      this.mountTarget = MountTarget.shadowRoot;\n    } else if (containerless) {\n      setRef(this.location = convertToRenderLocation(this.host!), CustomElement.name, this as IHydratedController);\n      setRef(this.location!, this.definition!.key, this as IHydratedController);\n      this.mountTarget = MountTarget.location;\n    } else {\n      this.mountTarget = MountTarget.host;\n    }\n\n    (this.viewModel as Writable<C>).$controller = this;\n    this.nodes = this._rendering.createNodes(compiledDef);\n\n    if (this.hooks.hasHydrated) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`invoking hydrated() hook`); }\n      (this.viewModel as BindingContext<C>).hydrated(this as ICustomElementController);\n    }\n  }\n\n  /** @internal */\n  public _hydrateChildren(): void {\n    this._rendering.render(\n      /* controller */this as ICustomElementController,\n      /* targets    */this.nodes!.findTargets(),\n      /* definition */this._compiledDef!,\n      /* host       */this.host,\n    );\n\n    if (this.hooks.hasCreated) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`invoking created() hook`); }\n      (this.viewModel as BindingContext<C>).created(this as ICustomElementController);\n    }\n  }\n\n  /** @internal */\n  private _hydrateCustomAttribute(): void {\n    const definition = this.definition as CustomAttributeDefinition;\n    const instance = this.viewModel!;\n\n    if (definition.watches.length > 0) {\n      createWatchers(this, this.container, definition, instance);\n    }\n    createObservers(this, definition, this.flags, instance);\n\n    (instance as Writable<C>).$controller = this;\n    this.lifecycleHooks = LifecycleHooks.resolve(this.container);\n\n    if (this.hooks.hasCreated) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`invoking created() hook`); }\n      (this.viewModel as BindingContext<C>).created(this as ICustomAttributeController);\n    }\n  }\n\n  /** @internal */\n  private _hydrateSynthetic(): void {\n    this._compiledDef = this._rendering.compile(this.viewFactory!.def!, this.container, null);\n    this.isStrictBinding = this._compiledDef.isStrictBinding;\n    this._rendering.render(\n      /* controller */this as ISyntheticView,\n      /* targets    */(this.nodes = this._rendering.createNodes(this._compiledDef)).findTargets(),\n      /* definition */this._compiledDef,\n      /* host       */void 0,\n    );\n  }\n\n  private $initiator: IHydratedController = null!;\n  private $flags: LifecycleFlags = LifecycleFlags.none;\n  public activate(\n    initiator: IHydratedController,\n    parent: IHydratedController | null,\n    flags: LifecycleFlags,\n    scope?: Scope | null,\n  ): void | Promise<void> {\n    switch (this.state) {\n      case State.none:\n      case State.deactivated:\n        if (!(parent === null || parent.isActive)) {\n          // If this is not the root, and the parent is either:\n          // 1. Not activated, or activating children OR\n          // 2. Deactivating itself\n          // abort.\n          return;\n        }\n        // Otherwise, proceed normally.\n        // 'deactivated' and 'none' are treated the same because, from an activation perspective, they mean the same thing.\n        this.state = State.activating;\n        break;\n      case State.activated:\n        // If we're already activated, no need to do anything.\n        return;\n      case State.disposed:\n        if (__DEV__)\n          throw new Error(`${this.name} trying to activate a controller that is disposed.`);\n        else\n          throw new Error(`AUR0502:${this.name}`);\n      default:\n        if (__DEV__)\n          throw new Error(`${this.name} unexpected state: ${stringifyState(this.state)}.`);\n        else\n          throw new Error(`AUR0503:${this.name} ${stringifyState(this.state)}`);\n    }\n\n    this.parent = parent;\n    if (__DEV__ && this.debug && !this._fullyNamed) {\n      this._fullyNamed = true;\n      (this.logger ??= this.container.get(ILogger).root.scopeTo(this.name)).trace(`activate()`);\n    }\n    flags |= LifecycleFlags.fromBind;\n\n    switch (this.vmKind) {\n      case ViewModelKind.customElement:\n        // Custom element scope is created and assigned during hydration\n        (this.scope as Writable<Scope>).parentScope = scope ?? null;\n        break;\n      case ViewModelKind.customAttribute:\n        this.scope = scope ?? null;\n        break;\n      case ViewModelKind.synthetic:\n        // maybe only check when there's not already a scope\n        if (scope === void 0 || scope === null) {\n          if (__DEV__)\n            throw new Error(`Scope is null or undefined`);\n          else\n            throw new Error('AUR0504');\n        }\n\n        if (!this.hasLockedScope) {\n          this.scope = scope;\n        }\n        break;\n    }\n\n    if (this.isStrictBinding) {\n      flags |= LifecycleFlags.isStrictBindingStrategy;\n    }\n\n    this.$initiator = initiator;\n    this.$flags = flags;\n\n    // opposing leave is called in attach() (which will trigger attached())\n    this._enterActivating();\n\n    if (this.hooks.hasBinding) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`binding()`); }\n\n      const ret = this.viewModel!.binding(this.$initiator, this.parent, this.$flags);\n      if (ret instanceof Promise) {\n        this._ensurePromise();\n        ret.then(() => {\n          this.bind();\n        }).catch((err: Error) => {\n          this._reject(err);\n        });\n        return this.$promise;\n      }\n    }\n\n    this.bind();\n    return this.$promise;\n  }\n\n  private bind(): void {\n    if (__DEV__ && this.debug) { this.logger!.trace(`bind()`); }\n\n    let i = 0;\n    let ii = this._childrenObs.length;\n    let ret: void | Promise<void>;\n    // timing: after binding, before bound\n    // reason: needs to start observing before all the bindings finish their $bind phase,\n    //         so that changes in one binding can be reflected into the other, regardless the index of the binding\n    //\n    // todo: is this timing appropriate?\n    if (ii > 0) {\n      while (ii > i) {\n        this._childrenObs[i].start();\n        ++i;\n      }\n    }\n\n    if (this.bindings !== null) {\n      i = 0;\n      ii = this.bindings.length;\n      while (ii > i) {\n        this.bindings[i].$bind(this.$flags, this.scope!);\n        ++i;\n      }\n    }\n\n    if (this.hooks.hasBound) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`bound()`); }\n\n      ret = this.viewModel!.bound(this.$initiator, this.parent, this.$flags);\n      if (ret instanceof Promise) {\n        this._ensurePromise();\n        ret.then(() => {\n          this.isBound = true;\n          this._attach();\n        }).catch((err: Error) => {\n          this._reject(err);\n        });\n        return;\n      }\n    }\n\n    this.isBound = true;\n    this._attach();\n  }\n\n  /** @internal */\n  private _append(...nodes: Node[]): void {\n    switch (this.mountTarget) {\n      case MountTarget.host:\n        this.host!.append(...nodes);\n        break;\n      case MountTarget.shadowRoot:\n        this.shadowRoot!.append(...nodes);\n        break;\n      case MountTarget.location: {\n        let i = 0;\n        for (; i < nodes.length; ++i) {\n          this.location!.parentNode!.insertBefore(nodes[i], this.location);\n        }\n        break;\n      }\n    }\n  }\n\n  /** @internal */\n  private _attach(): void {\n    if (__DEV__ && this.debug) { this.logger!.trace(`attach()`); }\n\n    if (this.hostController !== null) {\n      switch (this.mountTarget) {\n        case MountTarget.host:\n        case MountTarget.shadowRoot:\n          this.hostController._append(this.host!);\n          break;\n        case MountTarget.location:\n          this.hostController._append(this.location!.$start!, this.location!);\n          break;\n      }\n    }\n\n    switch (this.mountTarget) {\n      case MountTarget.host:\n        this.nodes!.appendTo(this.host!, this.definition != null && (this.definition as CustomElementDefinition).enhance);\n        break;\n      case MountTarget.shadowRoot: {\n        const container = this.container;\n        const styles = container.has(IShadowDOMStyles, false)\n          ? container.get(IShadowDOMStyles)\n          : container.get(IShadowDOMGlobalStyles);\n        styles.applyTo(this.shadowRoot!);\n        this.nodes!.appendTo(this.shadowRoot!);\n        break;\n      }\n      case MountTarget.location:\n        this.nodes!.insertBefore(this.location!);\n        break;\n    }\n\n    if (this.hooks.hasAttaching) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`attaching()`); }\n\n      const ret = this.viewModel!.attaching(this.$initiator, this.parent, this.$flags);\n      if (ret instanceof Promise) {\n        this._ensurePromise();\n        this._enterActivating();\n        ret.then(() => {\n          this._leaveActivating();\n        }).catch((err: Error) => {\n          this._reject(err);\n        });\n      }\n    }\n\n    // attaching() and child activation run in parallel, and attached() is called when both are finished\n    if (this.children !== null) {\n      let i = 0;\n      for (; i < this.children.length; ++i) {\n        // Any promises returned from child activation are cumulatively awaited before this.$promise resolves\n        void this.children[i].activate(this.$initiator, this as IHydratedController, this.$flags, this.scope);\n      }\n    }\n\n    // attached() is invoked by Controller#leaveActivating when `activatingStack` reaches 0\n    this._leaveActivating();\n  }\n\n  public deactivate(\n    initiator: IHydratedController,\n    parent: IHydratedController | null,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    switch ((this.state & ~State.released)) {\n      case State.activated:\n        // We're fully activated, so proceed with normal deactivation.\n        this.state = State.deactivating;\n        break;\n      case State.none:\n      case State.deactivated:\n      case State.disposed:\n      case State.deactivated | State.disposed:\n        // If we're already deactivated (or even disposed), or never activated in the first place, no need to do anything.\n        return;\n      default:\n        if (__DEV__)\n          throw new Error(`${this.name} unexpected state: ${stringifyState(this.state)}.`);\n        else\n          throw new Error(`AUR0505:${this.name} ${stringifyState(this.state)}`);\n    }\n\n    if (__DEV__ && this.debug) { this.logger!.trace(`deactivate()`); }\n\n    this.$initiator = initiator;\n    this.$flags = flags;\n\n    if (initiator === this) {\n      this._enterDetaching();\n    }\n\n    let i = 0;\n    // timing: before deactiving\n    // reason: avoid queueing a callback from the mutation observer, caused by the changes of nodes by repeat/if etc...\n    // todo: is this appropriate timing?\n    if (this._childrenObs.length) {\n      for (; i < this._childrenObs.length; ++i) {\n        this._childrenObs[i].stop();\n      }\n    }\n\n    if (this.children !== null) {\n      for (i = 0; i < this.children.length; ++i) {\n        // Child promise results are tracked by enter/leave combo's\n        void this.children[i].deactivate(initiator, this as IHydratedController, flags);\n      }\n    }\n\n    if (this.hooks.hasDetaching) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`detaching()`); }\n\n      const ret = this.viewModel!.detaching(this.$initiator, this.parent, this.$flags);\n      if (ret instanceof Promise) {\n        this._ensurePromise();\n        (initiator as Controller)._enterDetaching();\n        ret.then(() => {\n          (initiator as Controller)._leaveDetaching();\n        }).catch((err: Error) => {\n          (initiator as Controller)._reject(err);\n        });\n      }\n    }\n\n    // Note: if a 3rd party plugin happens to do any async stuff in a template controller before calling deactivate on its view,\n    // then the linking will become out of order.\n    // For framework components, this shouldn't cause issues.\n    // We can only prevent that by linking up after awaiting the detaching promise, which would add an extra tick + a fair bit of\n    // overhead on this hot path, so it's (for now) a deliberate choice to not account for such situation.\n    // Just leaving the note here so that we know to look here if a weird detaching-related timing issue is ever reported.\n    if (initiator.head === null) {\n      initiator.head = this as IHydratedController;\n    } else {\n      initiator.tail!.next = this as IHydratedController;\n    }\n    initiator.tail = this as IHydratedController;\n\n    if (initiator !== this) {\n      // Only detaching is called + the linked list is built when any controller that is not the initiator, is deactivated.\n      // The rest is handled by the initiator.\n      // This means that descendant controllers have to make sure to await the initiator's promise before doing any subsequent\n      // controller api calls, or race conditions might occur.\n      return;\n    }\n\n    this._leaveDetaching();\n    return this.$promise;\n  }\n\n  private removeNodes(): void {\n    switch (this.vmKind) {\n      case ViewModelKind.customElement:\n      case ViewModelKind.synthetic:\n        this.nodes!.remove();\n        this.nodes!.unlink();\n    }\n\n    if (this.hostController !== null) {\n      switch (this.mountTarget) {\n        case MountTarget.host:\n        case MountTarget.shadowRoot:\n          this.host!.remove();\n          break;\n        case MountTarget.location:\n          this.location!.$start!.remove();\n          this.location!.remove();\n          break;\n      }\n    }\n  }\n\n  private unbind(): void {\n    if (__DEV__ && this.debug) { this.logger!.trace(`unbind()`); }\n\n    const flags = this.$flags | LifecycleFlags.fromUnbind;\n    let i = 0;\n\n    if (this.bindings !== null) {\n      for (; i < this.bindings.length; ++i) {\n        this.bindings[i].$unbind(flags);\n      }\n    }\n\n    this.parent = null;\n\n    switch (this.vmKind) {\n      case ViewModelKind.customAttribute:\n        this.scope = null;\n        break;\n      case ViewModelKind.synthetic:\n        if (!this.hasLockedScope) {\n          this.scope = null;\n        }\n\n        if (\n          (this.state & State.released) === State.released &&\n          !this.viewFactory!.tryReturnToCache(this as ISyntheticView) &&\n          this.$initiator === this\n        ) {\n          this.dispose();\n        }\n        break;\n      case ViewModelKind.customElement:\n        (this.scope as Writable<Scope>).parentScope = null;\n        break;\n    }\n\n    if ((flags & LifecycleFlags.dispose) === LifecycleFlags.dispose && this.$initiator === this) {\n      this.dispose();\n    }\n    this.state = (this.state & State.disposed) | State.deactivated;\n    this.$initiator = null!;\n    this._resolve();\n  }\n\n  private $resolve: (() => void) | undefined = void 0;\n  private $reject: ((err: unknown) => void) | undefined = void 0;\n  private $promise: Promise<void> | undefined = void 0;\n\n  /** @internal */\n  private _ensurePromise(): void {\n    if (this.$promise === void 0) {\n      this.$promise = new Promise((resolve, reject) => {\n        this.$resolve = resolve;\n        this.$reject = reject;\n      });\n      if (this.$initiator !== this) {\n        (this.parent as Controller)._ensurePromise();\n      }\n    }\n  }\n\n  /** @internal */\n  private _resolve(): void {\n    if (this.$promise !== void 0) {\n      _resolve = this.$resolve!;\n      this.$resolve = this.$reject = this.$promise = void 0;\n      _resolve();\n      _resolve = void 0;\n    }\n  }\n\n  /** @internal */\n  private _reject(err: Error): void {\n    if (this.$promise !== void 0) {\n      _reject = this.$reject!;\n      this.$resolve = this.$reject = this.$promise = void 0;\n      _reject(err);\n      _reject = void 0;\n    }\n    if (this.$initiator !== this) {\n      (this.parent as Controller)._reject(err);\n    }\n  }\n\n  /** @internal */\n  private _activatingStack: number = 0;\n  /** @internal */\n  private _enterActivating(): void {\n    ++this._activatingStack;\n    if (this.$initiator !== this) {\n      (this.parent as Controller)._enterActivating();\n    }\n  }\n  /** @internal */\n  private _leaveActivating(): void {\n    if (--this._activatingStack === 0) {\n      if (this.hooks.hasAttached) {\n        if (__DEV__ && this.debug) { this.logger!.trace(`attached()`); }\n\n        _retPromise = this.viewModel!.attached!(this.$initiator, this.$flags);\n        if (_retPromise instanceof Promise) {\n          this._ensurePromise();\n          _retPromise.then(() => {\n            this.state = State.activated;\n            // Resolve this.$promise, signaling that activation is done (path 1 of 2)\n            this._resolve();\n            if (this.$initiator !== this) {\n              (this.parent as Controller)._leaveActivating();\n            }\n          }).catch((err: Error) => {\n            this._reject(err);\n          });\n          _retPromise = void 0;\n          return;\n        }\n        _retPromise = void 0;\n      }\n\n      this.state = State.activated;\n      // Resolve this.$promise (if present), signaling that activation is done (path 2 of 2)\n      this._resolve();\n    }\n    if (this.$initiator !== this) {\n      (this.parent as Controller)._leaveActivating();\n    }\n  }\n\n  /** @internal */\n  private _detachingStack: number = 0;\n  /** @internal */\n  private _enterDetaching(): void {\n    ++this._detachingStack;\n  }\n  /** @internal */\n  private _leaveDetaching(): void {\n    if (--this._detachingStack === 0) {\n      // Note: this controller is the initiator (detach is only ever called on the initiator)\n      if (__DEV__ && this.debug) { this.logger!.trace(`detach()`); }\n\n      this._enterUnbinding();\n      this.removeNodes();\n\n      let cur = this.$initiator.head as Controller | null;\n      while (cur !== null) {\n        if (cur !== this) {\n          if (cur.debug) { cur.logger!.trace(`detach()`); }\n\n          cur.removeNodes();\n        }\n\n        if (cur.hooks.hasUnbinding) {\n          if (cur.debug) { cur.logger!.trace('unbinding()'); }\n\n          _retPromise = cur.viewModel!.unbinding(cur.$initiator, cur.parent, cur.$flags);\n          if (_retPromise instanceof Promise) {\n            this._ensurePromise();\n            this._enterUnbinding();\n            _retPromise.then(() => {\n              this._leaveUnbinding();\n            }).catch((err: Error) => {\n              this._reject(err);\n            });\n          }\n          _retPromise = void 0;\n        }\n\n        cur = cur.next as Controller;\n      }\n\n      this._leaveUnbinding();\n    }\n  }\n\n  /** @internal */\n  private _unbindingStack: number = 0;\n  /** @internal */\n  private _enterUnbinding(): void {\n    ++this._unbindingStack;\n  }\n  /** @internal */\n  private _leaveUnbinding(): void {\n    if (--this._unbindingStack === 0) {\n      if (__DEV__ && this.debug) { this.logger!.trace(`unbind()`); }\n\n      let cur = this.$initiator.head as Controller | null;\n      let next: Controller | null = null;\n      while (cur !== null) {\n        if (cur !== this) {\n          cur.isBound = false;\n          cur.unbind();\n        }\n        next = cur.next as Controller;\n        cur.next = null;\n        cur = next;\n      }\n\n      this.head = this.tail = null;\n      this.isBound = false;\n      this.unbind();\n    }\n  }\n\n  public addBinding(binding: IBinding): void {\n    if (this.bindings === null) {\n      this.bindings = [binding];\n    } else {\n      this.bindings[this.bindings.length] = binding;\n    }\n  }\n\n  public addChild(controller: Controller): void {\n    if (this.children === null) {\n      this.children = [controller];\n    } else {\n      this.children[this.children.length] = controller;\n    }\n  }\n\n  public is(name: string): boolean {\n    switch (this.vmKind) {\n      case ViewModelKind.customAttribute: {\n        return CustomAttribute.getDefinition(this.viewModel!.constructor).name === name;\n      }\n      case ViewModelKind.customElement: {\n        return CustomElement.getDefinition(this.viewModel!.constructor).name === name;\n      }\n      case ViewModelKind.synthetic:\n        return this.viewFactory!.name === name;\n    }\n  }\n\n  public lockScope(scope: Writable<Scope>): void {\n    this.scope = scope;\n    this.hasLockedScope = true;\n  }\n\n  public setHost(host: HTMLElement): this {\n    if (this.vmKind === ViewModelKind.customElement) {\n      setRef(host, CustomElement.name, this as IHydratedController);\n      setRef(host, this.definition!.key, this as IHydratedController);\n    }\n    this.host = host;\n    this.mountTarget = MountTarget.host;\n    return this;\n  }\n\n  public setShadowRoot(shadowRoot: ShadowRoot): this {\n    if (this.vmKind === ViewModelKind.customElement) {\n      setRef(shadowRoot, CustomElement.name, this as IHydratedController);\n      setRef(shadowRoot, this.definition!.key, this as IHydratedController);\n    }\n    this.shadowRoot = shadowRoot;\n    this.mountTarget = MountTarget.shadowRoot;\n    return this;\n  }\n\n  public setLocation(location: IRenderLocation): this {\n    if (this.vmKind === ViewModelKind.customElement) {\n      setRef(location, CustomElement.name, this as IHydratedController);\n      setRef(location, this.definition!.key, this as IHydratedController);\n    }\n    this.location = location;\n    this.mountTarget = MountTarget.location;\n    return this;\n  }\n\n  public release(): void {\n    this.state |= State.released;\n  }\n\n  public dispose(): void {\n    if (__DEV__ && this.debug) { this.logger!.trace(`dispose()`); }\n\n    if ((this.state & State.disposed) === State.disposed) {\n      return;\n    }\n    this.state |= State.disposed;\n\n    if (this.hooks.hasDispose) {\n      this.viewModel!.dispose();\n    }\n\n    if (this.children !== null) {\n      this.children.forEach(callDispose);\n      this.children = null;\n    }\n\n    this.hostController = null;\n    this.scope = null;\n\n    this.nodes = null;\n    this.location = null;\n\n    this.viewFactory = null;\n    if (this.viewModel !== null) {\n      controllerLookup.delete(this.viewModel);\n      this.viewModel = null;\n    }\n    this.viewModel = null;\n    this.host = null;\n    this.shadowRoot = null;\n    this.container.disposeResolvers();\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (visitor(this as IHydratedController) === true) {\n      return true;\n    }\n\n    if (this.hooks.hasAccept && this.viewModel!.accept(visitor) === true) {\n      return true;\n    }\n\n    if (this.children !== null) {\n      const { children } = this;\n      for (let i = 0, ii = children.length; i < ii; ++i) {\n        if (children[i].accept(visitor) === true) {\n          return true;\n        }\n      }\n    }\n  }\n}\n\nfunction getLookup(instance: IIndexable): Record<string, BindableObserver | ChildrenObserver> {\n  let lookup = instance.$observers;\n  if (lookup === void 0) {\n    Reflect.defineProperty(\n      instance,\n      '$observers',\n      {\n        enumerable: false,\n        value: lookup = {},\n      },\n    );\n  }\n  return lookup as Record<string, BindableObserver | ChildrenObserver>;\n}\n\nfunction createObservers(\n  controller: Controller,\n  definition: CustomElementDefinition | CustomAttributeDefinition,\n  // deepscan-disable-next-line\n  _flags: LifecycleFlags,\n  instance: object,\n): void {\n  const bindables = definition.bindables;\n  const observableNames = Object.getOwnPropertyNames(bindables);\n  const length = observableNames.length;\n  if (length > 0) {\n    let name: string;\n    let bindable: BindableDefinition;\n    let i = 0;\n    const observers = getLookup(instance as IIndexable);\n    const container = controller.container;\n    const coercionConfiguration = container.has(ICoercionConfiguration, true) ? container.get(ICoercionConfiguration) : null;\n\n    for (; i < length; ++i) {\n      name = observableNames[i];\n\n      if (observers[name] === void 0) {\n        bindable = bindables[name];\n\n        observers[name] = new BindableObserver(\n          instance as IIndexable,\n          name,\n          bindable.callback,\n          bindable.set,\n          controller,\n          coercionConfiguration,\n        );\n      }\n    }\n  }\n}\n\nfunction createChildrenObservers(\n  controller: Controller,\n  definition: CustomElementDefinition,\n  instance: object,\n): ChildrenObserver[] {\n  const childrenObservers = definition.childrenObservers;\n  const childObserverNames = Object.getOwnPropertyNames(childrenObservers);\n  const length = childObserverNames.length;\n  if (length > 0) {\n    const observers = getLookup(instance as IIndexable);\n    const obs: ChildrenObserver[] = [];\n\n    let name: string;\n    let i = 0;\n    let childrenDescription: ChildrenDefinition;\n    for (; i < length; ++i) {\n      name = childObserverNames[i];\n\n      if (observers[name] == null) {\n        childrenDescription = childrenObservers[name];\n        obs[obs.length] = observers[name] = new ChildrenObserver(\n          controller as ICustomElementController,\n          instance as IIndexable,\n          name,\n          childrenDescription.callback,\n          childrenDescription.query,\n          childrenDescription.filter,\n          childrenDescription.map,\n          childrenDescription.options,\n        );\n      }\n    }\n    return obs;\n  }\n\n  return emptyArray as ChildrenObserver[];\n}\n\nconst AccessScopeAstMap = new Map<PropertyKey, AccessScopeExpression>();\nconst getAccessScopeAst = (key: PropertyKey) => {\n  let ast = AccessScopeAstMap.get(key);\n  if (ast == null) {\n    ast = new AccessScopeExpression(key as string, 0);\n    AccessScopeAstMap.set(key, ast);\n  }\n  return ast;\n};\n\nfunction createWatchers(\n  controller: Controller,\n  context: IServiceLocator,\n  definition: CustomElementDefinition | CustomAttributeDefinition,\n  instance: object,\n) {\n  const observerLocator = context!.get(IObserverLocator);\n  const expressionParser = context.get(IExpressionParser);\n  const watches = definition.watches;\n  const scope: Scope = controller.vmKind === ViewModelKind.customElement\n    ? controller.scope!\n    // custom attribute does not have own scope\n    : Scope.create(instance, null, true);\n  const ii = watches.length;\n  let expression: IWatchDefinition['expression'];\n  let callback: IWatchDefinition['callback'];\n  let ast: IsBindingBehavior;\n  let i = 0;\n\n  for (; ii > i; ++i) {\n    ({ expression, callback } = watches[i]);\n    callback = isFunction(callback)\n      ? callback\n      : Reflect.get(instance, callback) as IWatcherCallback<object>;\n    if (!isFunction(callback)) {\n      if (__DEV__)\n        throw new Error(`Invalid callback for @watch decorator: ${String(callback)}`);\n      else\n        throw new Error(`AUR0506:${String(callback)}`);\n    }\n    if (isFunction(expression)) {\n      controller.addBinding(new ComputedWatcher(\n        instance as IObservable,\n        observerLocator,\n        expression,\n        callback,\n        // there should be a flag to purposely disable proxy\n        // AOT: not true for IE11\n        true,\n      ));\n    } else {\n      ast = isString(expression)\n        ? expressionParser.parse(expression, ExpressionType.IsProperty)\n        : getAccessScopeAst(expression);\n\n      controller.addBinding(new ExpressionWatcher(\n        scope,\n        context,\n        observerLocator,\n        ast,\n        callback\n      ) as unknown as IBinding);\n    }\n  }\n}\n\nexport function isCustomElementController<C extends ICustomElementViewModel = ICustomElementViewModel>(value: unknown): value is ICustomElementController<C> {\n  return value instanceof Controller && value.vmKind === ViewModelKind.customElement;\n}\n\nexport function isCustomElementViewModel(value: unknown): value is ICustomElementViewModel {\n  return isObject(value) && CustomElement.isType(value.constructor);\n}\n\nexport class HooksDefinition {\n  public static readonly none: Readonly<HooksDefinition> = new HooksDefinition({});\n\n  public readonly hasDefine: boolean;\n\n  public readonly hasHydrating: boolean;\n  public readonly hasHydrated: boolean;\n  public readonly hasCreated: boolean;\n\n  public readonly hasBinding: boolean;\n  public readonly hasBound: boolean;\n  public readonly hasAttaching: boolean;\n  public readonly hasAttached: boolean;\n\n  public readonly hasDetaching: boolean;\n  public readonly hasUnbinding: boolean;\n\n  public readonly hasDispose: boolean;\n  public readonly hasAccept: boolean;\n\n  public constructor(target: object) {\n    this.hasDefine = 'define' in target;\n\n    this.hasHydrating = 'hydrating' in target;\n    this.hasHydrated = 'hydrated' in target;\n    this.hasCreated = 'created' in target;\n\n    this.hasBinding = 'binding' in target;\n    this.hasBound = 'bound' in target;\n    this.hasAttaching = 'attaching' in target;\n    this.hasAttached = 'attached' in target;\n\n    this.hasDetaching = 'detaching' in target;\n    this.hasUnbinding = 'unbinding' in target;\n\n    this.hasDispose = 'dispose' in target;\n    this.hasAccept = 'accept' in target;\n  }\n}\n\nconst defaultShadowOptions = {\n  mode: 'open' as 'open' | 'closed'\n};\n\nexport const enum ViewModelKind {\n  customElement,\n  customAttribute,\n  synthetic\n}\n\n/**\n * A controller that is ready for activation. It can be `ISyntheticView`, `ICustomElementController` or `ICustomAttributeController`.\n *\n * In terms of specificity this is identical to `IController`. The only difference is that this\n * type is further initialized and thus has more properties and APIs available.\n */\nexport type IHydratedController = ISyntheticView | ICustomElementController | ICustomAttributeController;\n/**\n * A controller that is ready for activation. It can be `ICustomElementController` or `ICustomAttributeController`.\n *\n * This type of controller is backed by a real component (hence the name) and therefore has ViewModel and may have lifecycle hooks.\n *\n * In contrast, `ISyntheticView` has neither a view model nor lifecycle hooks (but its child controllers, if any, may).\n */\nexport type IHydratedComponentController = ICustomElementController | ICustomAttributeController;\n/**\n * A controller that is ready for activation. It can be `ISyntheticView` or `ICustomElementController`.\n *\n * This type of controller may have child controllers (hence the name) and bindings directly placed on it during hydration.\n *\n * In contrast, `ICustomAttributeController` has neither child controllers nor bindings directly placed on it (but the backing component may).\n *\n * Note: the parent of a `ISyntheticView` is always a `IHydratedComponentController` because views cannot directly own other views. Views may own components, and components may own views or components.\n */\nexport type IHydratedParentController = ISyntheticView | ICustomElementController;\n\n/**\n * A callback that is invoked on each controller in the component tree.\n *\n * Return `true` to stop traversal.\n */\nexport type ControllerVisitor = (controller: IHydratedController) => void | true;\n\n/**\n * The base type for all controller types.\n *\n * Every controller, regardless of their type and state, will have at least the properties/methods in this interface.\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport interface IController<C extends IViewModel = IViewModel> extends IDisposable {\n  /** @internal */readonly id: number;\n  /**\n   * The container associated with this controller.\n   * By default, CE should have their own container while custom attribute & synthetic view\n   * will use the parent container one, since they do not need to manage one\n   */\n  readonly name: string;\n  readonly container: IContainer;\n  readonly flags: LifecycleFlags;\n  readonly vmKind: ViewModelKind;\n  readonly definition: CustomElementDefinition | CustomAttributeDefinition | null;\n  readonly host: HTMLElement | null;\n  readonly state: State;\n  readonly isActive: boolean;\n  readonly parent: IHydratedController | null;\n  readonly isBound: boolean;\n\n  /** @internal */head: IHydratedController | null;\n  /** @internal */tail: IHydratedController | null;\n  /** @internal */next: IHydratedController | null;\n\n  /**\n   * Return `true` to stop traversal.\n   */\n  accept(visitor: ControllerVisitor): void | true;\n}\n\n/**\n * The base type for `ICustomAttributeController` and `ICustomElementController`.\n *\n * Both of those types have the `viewModel` property which represent the user instance containing the bound properties and hooks for this component.\n */\nexport interface IComponentController<C extends IViewModel = IViewModel> extends IController<C> {\n  readonly vmKind: ViewModelKind.customAttribute | ViewModelKind.customElement;\n  readonly definition: CustomElementDefinition | CustomAttributeDefinition;\n\n  /**\n   * The user instance containing the bound properties. This is always an instance of a class, which may either be user-defined, or generated by a view locator.\n   */\n  readonly viewModel: C;\n\n}\n\n/**\n * The base type for `ISyntheticView` and `ICustomElementController`.\n *\n * Both of those types can:\n * - Have `bindings` and `children` which are populated during hydration (hence, 'Hydratable').\n * - Have physical DOM nodes that can be mounted.\n */\nexport interface IHydratableController<C extends IViewModel = IViewModel> extends IController<C> {\n  readonly vmKind: ViewModelKind.customElement | ViewModelKind.synthetic;\n  readonly mountTarget: MountTarget;\n  readonly definition: CustomElementDefinition | null;\n\n  readonly bindings: readonly IBinding[] | null;\n  readonly children: readonly IHydratedController[] | null;\n\n  addBinding(binding: IBinding): void;\n  addChild(controller: IController): void;\n}\n\nexport const enum State {\n  none                     = 0b00_00_00,\n  activating               = 0b00_00_01,\n  activated                = 0b00_00_10,\n  deactivating             = 0b00_01_00,\n  deactivated              = 0b00_10_00,\n  released                 = 0b01_00_00,\n  disposed                 = 0b10_00_00,\n}\n\nexport function stringifyState(state: State): string {\n  const names: string[] = [];\n\n  if ((state & State.activating) === State.activating) { names.push('activating'); }\n  if ((state & State.activated) === State.activated) { names.push('activated'); }\n  if ((state & State.deactivating) === State.deactivating) { names.push('deactivating'); }\n  if ((state & State.deactivated) === State.deactivated) { names.push('deactivated'); }\n  if ((state & State.released) === State.released) { names.push('released'); }\n  if ((state & State.disposed) === State.disposed) { names.push('disposed'); }\n\n  return names.length === 0 ? 'none' : names.join('|');\n}\n\n/**\n * The controller for a synthetic view, that is, a controller created by an `IViewFactory`.\n *\n * A synthetic view, typically created when composing a template controller (`if`, `repeat`, etc), is a hydratable component with mountable DOM nodes that has no user view model.\n *\n * It has either its own synthetic binding context or is locked to some externally sourced scope (in the case of `au-compose`)\n */\nexport interface ISyntheticView extends IHydratableController {\n  readonly vmKind: ViewModelKind.synthetic;\n  readonly definition: null;\n  readonly viewModel: null;\n  readonly isStrictBinding: boolean;\n  /**\n   * The physical DOM nodes that will be appended during the attach operation.\n   */\n  readonly nodes: INodeSequence;\n\n  activate(\n    initiator: IHydratedController,\n    parent: IHydratedController,\n    flags: LifecycleFlags,\n    scope: Scope,\n  ): void | Promise<void>;\n  deactivate(\n    initiator: IHydratedController,\n    parent: IHydratedController,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n  /**\n   * Lock this view's scope to the provided `Scope`. The scope, which is normally set during `activate()`, will then not change anymore.\n   *\n   * This is used by `au-render` to set the binding context of a view to a particular component instance.\n   *\n   * @param scope - The scope to lock this view to.\n   */\n  lockScope(scope: Scope): void;\n  /**\n   * The scope that belongs to this view. This property will always be defined when the `state` property of this view indicates that the view is currently bound.\n   *\n   * The `scope` may be set during `activate()` and unset during `deactivate()`, or it may be statically set during composing with `lockScope()`.\n   */\n  readonly scope: Scope;\n\n  /**\n   * Set the render location that this view will be inserted before.\n   */\n  setLocation(location: IRenderLocation): this;\n  /**\n   * The DOM node that this view will be inserted before (if set).\n   */\n  readonly location: IRenderLocation | null;\n\n  /**\n   * Set the host that this view will be appended to.\n   */\n  setHost(host: Node & ParentNode): this;\n  /**\n   * The DOM node that this view will be appended to (if set).\n   */\n  readonly host: HTMLElement | null;\n\n  /**\n   * Set the `ShadowRoot` that this view will be appended to.\n   */\n  setShadowRoot(shadowRoot: ShadowRoot): this;\n  /**\n   * The ShadowRoot that this view will be appended to (if set).\n   */\n  readonly shadowRoot: ShadowRoot | null;\n\n  /**\n   * Mark this view as not-in-use, so that it can either be disposed or returned to cache after finishing the deactivate lifecycle.\n   *\n   * If this view is cached and later retrieved from the cache, it will be marked as in-use again before starting the activate lifecycle, so this method must be called each time.\n   *\n   * If this method is *not* called before `deactivate()`, this view will neither be cached nor disposed.\n   */\n  release(): void;\n}\n\nexport interface ICustomAttributeController<C extends ICustomAttributeViewModel = ICustomAttributeViewModel> extends IComponentController<C> {\n  readonly vmKind: ViewModelKind.customAttribute;\n  readonly definition: CustomAttributeDefinition;\n  /**\n   * @inheritdoc\n   */\n  readonly viewModel: C;\n  readonly lifecycleHooks: LifecycleHooksLookup;\n  /**\n   * The scope that belongs to this custom attribute. This property will always be defined when the `state` property of this view indicates that the view is currently bound.\n   *\n   * The `scope` will be set during `activate()` and unset during `deactivate()`.\n   *\n   * The scope's `bindingContext` will be the same instance as this controller's `viewModel` property.\n   */\n  readonly scope: Scope;\n  readonly children: null;\n  readonly bindings: null;\n  activate(\n    initiator: IHydratedController,\n    parent: IHydratedController,\n    flags: LifecycleFlags,\n    scope: Scope,\n  ): void | Promise<void>;\n  deactivate(\n    initiator: IHydratedController,\n    parent: IHydratedController,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n}\n\n/**\n * A representation of `IController` specific to a custom element whose `create` hook is about to be invoked (if present).\n *\n * It is not yet hydrated (hence 'dry') with any render-specific information.\n */\nexport interface IDryCustomElementController<C extends IViewModel = IViewModel> extends IComponentController<C>, IHydratableController<C> {\n  readonly vmKind: ViewModelKind.customElement;\n  readonly definition: CustomElementDefinition;\n  /**\n   * The scope that belongs to this custom element. This property is set immediately after the controller is created and is always guaranteed to be available.\n   *\n   * It may be overwritten by end user during the `create()` hook.\n   *\n   * By default, the scope's `bindingContext` will be the same instance as this controller's `viewModel` property.\n   */\n  scope: Scope;\n  /**\n   * The original host dom node.\n   *\n   * For containerless elements, this node will be removed from the DOM and replaced by a comment, which is assigned to the `location` property.\n   *\n   * For ShadowDOM elements, this will be the original declaring element, NOT the shadow root (the shadow root is stored on the `shadowRoot` property)\n   */\n  readonly host: HTMLElement;\n}\n\n/**\n * A representation of `IController` specific to a custom element whose `hydrating` hook is about to be invoked (if present).\n *\n * It has the same properties as `IDryCustomElementController`, as well as a render context (hence 'contextual').\n */\nexport interface IContextualCustomElementController<C extends IViewModel = IViewModel> extends IDryCustomElementController<C> {\n\n}\n\n/**\n * A representation of `IController` specific to a custom element whose `hydrated` hook is about to be invoked (if present).\n *\n * It has the same properties as `IContextualCustomElementController`, except the context is now compiled (hence 'compiled'), as well as the nodes, and projector.\n */\nexport interface ICompiledCustomElementController<C extends IViewModel = IViewModel> extends IContextualCustomElementController<C> {\n  readonly isStrictBinding: boolean;\n  /**\n   * The ShadowRoot, if this custom element uses ShadowDOM.\n   */\n  readonly shadowRoot: ShadowRoot | null;\n  /**\n   * The renderLocation, if this is a `containerless` custom element.\n   */\n  readonly location: IRenderLocation | null;\n  /**\n   * The physical DOM nodes that will be appended during the `mount()` operation.\n   */\n  readonly nodes: INodeSequence;\n}\n\n/**\n * A fully hydrated custom element controller.\n */\nexport interface ICustomElementController<C extends ICustomElementViewModel = ICustomElementViewModel> extends ICompiledCustomElementController<C> {\n  /**\n   * @inheritdoc\n   */\n  readonly viewModel: C;\n  readonly lifecycleHooks: LifecycleHooksLookup;\n\n  activate(\n    initiator: IHydratedController,\n    parent: IHydratedController | null,\n    flags: LifecycleFlags,\n    scope?: Scope,\n  ): void | Promise<void>;\n  deactivate(\n    initiator: IHydratedController,\n    parent: IHydratedController | null,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n}\n\nexport const IController = DI.createInterface<IController>('IController');\n\nexport const IHydrationContext = DI.createInterface<IHydrationContext>('IHydrationContext');\nexport interface IHydrationContext<T = unknown> extends HydrationContext<T> {\n}\n\nclass HydrationContext<T extends ICustomElementViewModel> {\n  public readonly controller: ICustomElementController<T>;\n  public constructor(\n    controller: Controller,\n    public readonly instruction: IControllerElementHydrationInstruction | null,\n    public readonly parent: IHydrationContext | undefined,\n  ) {\n    this.controller = controller as ICustomElementController<T>;\n  }\n}\n\nexport interface IActivationHooks<TParent> {\n  binding?(\n    initiator: IHydratedController,\n    parent: TParent,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n  bound?(\n    initiator: IHydratedController,\n    parent: TParent,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n  attaching?(\n    initiator: IHydratedController,\n    parent: TParent,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n  attached?(\n    initiator: IHydratedController,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n\n  detaching?(\n    initiator: IHydratedController,\n    parent: TParent,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n  unbinding?(\n    initiator: IHydratedController,\n    parent: TParent,\n    flags: LifecycleFlags,\n  ): void | Promise<void>;\n\n  dispose?(): void;\n  /**\n   * If this component controls the instantiation and lifecycles of one or more controllers,\n   * implement this hook to enable component tree traversal for plugins that use it (such as the router).\n   *\n   * Return `true` to stop traversal.\n   */\n  accept?(visitor: ControllerVisitor): void | true;\n}\n\nexport interface ICompileHooks {\n  define?(\n    controller: IDryCustomElementController<this>,\n    /**\n     * The context where this element is hydrated.\n     *\n     * This is created by the controller associated with the CE creating this this controller\n     */\n    hydrationContext: IHydrationContext | null,\n    definition: CustomElementDefinition,\n  ): PartialCustomElementDefinition | void;\n  hydrating?(\n    controller: IContextualCustomElementController<this>,\n  ): void;\n  hydrated?(\n    controller: ICompiledCustomElementController<this>,\n  ): void;\n  created?(\n    controller: ICustomElementController<this> | ICustomAttributeController<this>,\n  ): void;\n}\n\n/**\n * Defines optional lifecycle hooks that will be called only when they are implemented.\n */\nexport interface IViewModel {\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  constructor: Function;\n  readonly $controller?: IController<this>;\n}\n\nexport interface ICustomElementViewModel extends IViewModel, IActivationHooks<IHydratedController | null>, ICompileHooks {\n  readonly $controller?: ICustomElementController<this>;\n  created?(\n    controller: ICustomElementController<this>,\n  ): void;\n}\n\nexport interface ICustomAttributeViewModel extends IViewModel, IActivationHooks<IHydratedController> {\n  readonly $controller?: ICustomAttributeController<this>;\n  link?(\n    controller: IHydratableController,\n    childController: ICustomAttributeController,\n    target: INode,\n    instruction: IInstruction,\n  ): void;\n  created?(\n    controller: ICustomAttributeController<this>,\n  ): void;\n}\n\nexport interface IHydratedCustomElementViewModel extends ICustomElementViewModel {\n  readonly $controller: ICustomElementController<this>;\n}\n\nexport interface IHydratedCustomAttributeViewModel extends ICustomAttributeViewModel {\n  readonly $controller: ICustomAttributeController<this>;\n}\n\nexport interface IControllerElementHydrationInstruction {\n  /**\n   * An internal mechanism to manually halt + resume hydration process\n   *\n   * - 0: no hydration\n   * - 1: hydrate until define() lifecycle\n   *\n   * @internal\n   */\n  readonly hydrate?: boolean;\n  readonly projections: IProjections | null;\n  /**\n   * A list of captured attributes/binding in raw format\n   */\n  readonly captures?: AttrSyntax[];\n}\n\nfunction callDispose(disposable: IDisposable): void {\n  disposable.dispose();\n}\n\n// some reuseable variables to avoid creating nested blocks inside hot paths of controllers\nlet _resolve: undefined | (() => unknown);\nlet _reject: undefined | ((err: unknown) => unknown);\nlet _retPromise: void | Promise<void>;\n","import { DI, InstanceProvider, onResolve, resolveAll, ILogger } from '@aurelia/kernel';\nimport { LifecycleFlags } from '@aurelia/runtime';\nimport { INode } from './dom.js';\nimport { IAppTask } from './app-task.js';\nimport { CustomElement } from './resources/custom-element.js';\nimport { Controller, IControllerElementHydrationInstruction } from './templating/controller.js';\n\nimport type { Constructable, IContainer, IDisposable } from '@aurelia/kernel';\nimport type { TaskSlot } from './app-task.js';\nimport type { ICustomElementViewModel, ICustomElementController } from './templating/controller.js';\nimport type { IPlatform } from './platform.js';\n\nexport interface ISinglePageApp {\n  host: HTMLElement;\n  component: unknown;\n}\n\nexport interface IAppRoot extends AppRoot {}\nexport const IAppRoot = DI.createInterface<IAppRoot>('IAppRoot');\n\nexport interface IWorkTracker extends WorkTracker {}\nexport const IWorkTracker = DI.createInterface<IWorkTracker>('IWorkTracker', x => x.singleton(WorkTracker));\nexport class WorkTracker {\n  /** @internal */ protected static inject = [ILogger];\n  /** @internal */ private _stack: number = 0;\n  /** @internal */ private _promise: Promise<void> | null = null;\n  /** @internal */ private _resolve: (() => void) | null = null;\n  /** @internal */ private readonly _logger: ILogger;\n\n  public constructor(logger: ILogger) {\n    this._logger = logger.scopeTo('WorkTracker');\n  }\n\n  public start(): void {\n    this._logger.trace(`start(stack:${this._stack})`);\n    ++this._stack;\n  }\n\n  public finish(): void {\n    this._logger.trace(`finish(stack:${this._stack})`);\n    if (--this._stack === 0) {\n      const resolve = this._resolve;\n      if (resolve !== null) {\n        this._resolve  = this._promise = null;\n        resolve();\n      }\n    }\n  }\n\n  public wait(): Promise<void> {\n    this._logger.trace(`wait(stack:${this._stack})`);\n    if (this._promise === null) {\n      if (this._stack === 0) {\n        return Promise.resolve();\n      }\n      this._promise = new Promise(resolve => {\n        this._resolve = resolve;\n      });\n    }\n    return this._promise;\n  }\n}\n\nexport class AppRoot implements IDisposable {\n  public readonly host: HTMLElement;\n\n  public controller: ICustomElementController = (void 0)!;\n  public work: IWorkTracker;\n\n  /** @internal */\n  private _hydratePromise: Promise<void> | void = void 0;\n\n  public constructor(\n    public readonly config: ISinglePageApp,\n    public readonly platform: IPlatform,\n    public readonly container: IContainer,\n    rootProvider: InstanceProvider<IAppRoot>,\n  ) {\n    this.host = config.host;\n    this.work = container.get(IWorkTracker);\n    rootProvider.prepare(this);\n\n    container.registerResolver(\n      platform.HTMLElement,\n      container.registerResolver(\n        platform.Element,\n        container.registerResolver(INode, new InstanceProvider('ElementResolver', config.host))\n      )\n    );\n\n    this._hydratePromise = onResolve(this._runAppTasks('beforeCreate'), () => {\n      const component = config.component as Constructable | ICustomElementViewModel;\n      const childCtn = container.createChild();\n      let instance: object;\n      if (CustomElement.isType(component)) {\n        instance = this.container.get(component);\n      } else {\n        instance = config.component as ICustomElementViewModel;\n      }\n\n      const hydrationInst: IControllerElementHydrationInstruction = { hydrate: false, projections: null };\n      const controller = (this.controller = Controller.$el(\n        childCtn,\n        instance,\n        this.host,\n        hydrationInst,\n      )) as Controller;\n\n      controller._hydrateCustomElement(hydrationInst, /* root does not have hydration context */null);\n      return onResolve(this._runAppTasks('hydrating'), () => {\n        controller._hydrate(null);\n        return onResolve(this._runAppTasks('hydrated'), () => {\n          controller._hydrateChildren();\n          this._hydratePromise = void 0;\n        });\n      });\n    });\n  }\n\n  public activate(): void | Promise<void> {\n    return onResolve(this._hydratePromise, () => {\n      return onResolve(this._runAppTasks('beforeActivate'), () => {\n        return onResolve(this.controller.activate(this.controller, null, LifecycleFlags.fromBind, void 0), () => {\n          return this._runAppTasks('afterActivate');\n        });\n      });\n    });\n  }\n\n  public deactivate(): void | Promise<void> {\n    return onResolve(this._runAppTasks('beforeDeactivate'), () => {\n      return onResolve(this.controller.deactivate(this.controller, null, LifecycleFlags.none), () => {\n        return this._runAppTasks('afterDeactivate');\n      });\n    });\n  }\n\n  /** @internal */\n  private _runAppTasks(slot: TaskSlot): void | Promise<void> {\n    return resolveAll(...this.container.getAll(IAppTask).reduce((results, task) => {\n      if (task.slot === slot) {\n        results.push(task.run());\n      }\n      return results;\n    }, [] as (void | Promise<void>)[]));\n  }\n\n  public dispose(): void {\n    this.controller?.dispose();\n  }\n}\n","import { DI, Writable } from '@aurelia/kernel';\nimport { IAppRoot } from './app-root.js';\nimport { IPlatform } from './platform.js';\nimport { CustomElement } from './resources/custom-element.js';\nimport { MountTarget } from './templating/controller.js';\nimport type { IHydratedController } from './templating/controller.js';\n\nexport class Refs {\n  [key: string]: IHydratedController | undefined;\n}\n\nexport function getRef(node: INode, name: string): IHydratedController | null {\n  return node.$au?.[name] ?? null;\n}\n\nexport function setRef(node: INode, name: string, controller: IHydratedController): void {\n  ((node as Writable<INode>).$au ??= new Refs())[name] = controller;\n}\n\nexport type INode<T extends Node = Node> = T & {\n  readonly $au?: Refs;\n};\nexport const INode = DI.createInterface<INode>('INode');\n\nexport type IEventTarget<T extends EventTarget = EventTarget> = T;\nexport const IEventTarget = DI.createInterface<IEventTarget>('IEventTarget', x => x.cachedCallback(handler => {\n  if (handler.has(IAppRoot, true)) {\n    return handler.get(IAppRoot).host;\n  }\n  return handler.get(IPlatform).document;\n}));\n\nexport const IRenderLocation = DI.createInterface<IRenderLocation>('IRenderLocation');\nexport type IRenderLocation<T extends ChildNode = ChildNode> = T & {\n  $start?: IRenderLocation<T>;\n};\n\n/**\n * Represents a DocumentFragment\n */\nexport interface INodeSequence<T extends INode = INode> {\n  readonly platform: IPlatform;\n  readonly isMounted: boolean;\n  readonly isLinked: boolean;\n\n  readonly next?: INodeSequence<T>;\n\n  /**\n   * The nodes of this sequence.\n   */\n  readonly childNodes: ArrayLike<T>;\n\n  readonly firstChild: T;\n\n  readonly lastChild: T;\n\n  /**\n   * Find all instruction targets in this sequence.\n   */\n  findTargets(): ArrayLike<T>;\n\n  /**\n   * Insert this sequence as a sibling before refNode\n   */\n  insertBefore(refNode: T | IRenderLocation): void;\n\n  /**\n   * Append this sequence as a child to parent\n   */\n  appendTo(parent: T, enhance?: boolean): void;\n\n  /**\n   * Remove this sequence from the DOM.\n   */\n  remove(): void;\n\n  addToLinked(): void;\n\n  unlink(): void;\n\n  link(next: INodeSequence<T> | IRenderLocation | undefined): void;\n}\n\nexport const enum NodeType {\n  Element = 1,\n  Attr = 2,\n  Text = 3,\n  CDATASection = 4,\n  EntityReference = 5,\n  Entity = 6,\n  ProcessingInstruction = 7,\n  Comment = 8,\n  Document = 9,\n  DocumentType = 10,\n  DocumentFragment = 11,\n  Notation = 12\n}\n\nconst effectiveParentNodeOverrides = new WeakMap<Node, Node>();\n\n/**\n * Returns the effective parentNode according to Aurelia's component hierarchy.\n *\n * Used by Aurelia to find the closest parent controller relative to a node.\n *\n * This method supports 3 additional scenarios that `node.parentNode` does not support:\n * - Containerless elements. The parentNode in this case is a comment precending the element under specific conditions, rather than a node wrapping the element.\n * - ShadowDOM. If a `ShadowRoot` is encountered, this method retrieves the associated controller via the metadata api to locate the original host.\n * - Portals. If the provided node was moved to a different location in the DOM by a `portal` attribute, then the original parent of the node will be returned.\n *\n * @param node - The node to get the parent for.\n * @returns Either the closest parent node, the closest `IRenderLocation` (comment node that is the containerless host), original portal host, or `null` if this is either the absolute document root or a disconnected node.\n */\nexport function getEffectiveParentNode(node: Node): Node | null {\n  // TODO: this method needs more tests!\n  // First look for any overrides\n  if (effectiveParentNodeOverrides.has(node)) {\n    return effectiveParentNodeOverrides.get(node)!;\n  }\n\n  // Then try to get the nearest au-start render location, which would be the containerless parent,\n  // again looking for any overrides along the way.\n  // otherwise return the normal parent node\n  let containerlessOffset = 0;\n  let next = node.nextSibling;\n  while (next !== null) {\n    if (next.nodeType === NodeType.Comment) {\n      switch (next.textContent) {\n        case 'au-start':\n          // If we see an au-start before we see au-end, it will precede the host of a sibling containerless element rather than a parent.\n          // So we use the offset to ignore the next au-end\n          ++containerlessOffset;\n          break;\n        case 'au-end':\n          if (containerlessOffset-- === 0) {\n            return next;\n          }\n      }\n    }\n    next = next.nextSibling;\n  }\n\n  if (node.parentNode === null && node.nodeType === NodeType.DocumentFragment) {\n    // Could be a shadow root; see if there's a controller and if so, get the original host via the projector\n    const controller = CustomElement.for(node);\n    if (controller === void 0) {\n      // Not a shadow root (or at least, not one created by Aurelia)\n      // Nothing more we can try, just return null\n      return null;\n    }\n    if (controller.mountTarget === MountTarget.shadowRoot) {\n      return getEffectiveParentNode(controller.host);\n    }\n  }\n\n  return node.parentNode;\n}\n\n/**\n * Set the effective parentNode, overriding the DOM-based structure that `getEffectiveParentNode` otherwise defaults to.\n *\n * Used by Aurelia's `portal` template controller to retain the linkage between the portaled nodes (after they are moved to the portal target) and the original `portal` host.\n *\n * @param nodeSequence - The node sequence whose children that, when `getEffectiveParentNode` is called on, return the supplied `parentNode`.\n * @param parentNode - The node to return when `getEffectiveParentNode` is called on any child of the supplied `nodeSequence`.\n */\nexport function setEffectiveParentNode(nodeSequence: INodeSequence, parentNode: Node): void;\n/**\n * Set the effective parentNode, overriding the DOM-based structure that `getEffectiveParentNode` otherwise defaults to.\n *\n * Used by Aurelia's `portal` template controller to retain the linkage between the portaled nodes (after they are moved to the portal target) and the original `portal` host.\n *\n * @param childNode - The node that, when `getEffectiveParentNode` is called on, returns the supplied `parentNode`.\n * @param parentNode - The node to return when `getEffectiveParentNode` is called on the supplied `childNode`.\n */\nexport function setEffectiveParentNode(childNode: Node, parentNode: Node): void;\nexport function setEffectiveParentNode(childNodeOrNodeSequence: Node | INodeSequence, parentNode: Node): void {\n  if ((childNodeOrNodeSequence as INodeSequence).platform !== void 0 && !(childNodeOrNodeSequence instanceof (childNodeOrNodeSequence as INodeSequence).platform.Node)) {\n    const nodes = childNodeOrNodeSequence.childNodes;\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n      effectiveParentNodeOverrides.set(nodes[i] as Node, parentNode);\n    }\n  } else {\n    effectiveParentNodeOverrides.set(childNodeOrNodeSequence as Node, parentNode);\n  }\n}\n\nexport function convertToRenderLocation(node: Node): IRenderLocation {\n  if (isRenderLocation(node)) {\n    return node; // it's already a IRenderLocation (converted by FragmentNodeSequence)\n  }\n\n  const locationEnd = node.ownerDocument!.createComment('au-end');\n  const locationStart = node.ownerDocument!.createComment('au-start');\n\n  if (node.parentNode !== null) {\n    node.parentNode.replaceChild(locationEnd, node);\n    locationEnd.parentNode!.insertBefore(locationStart, locationEnd);\n  }\n\n  (locationEnd as IRenderLocation).$start = locationStart as IRenderLocation;\n\n  return locationEnd as IRenderLocation;\n}\n\nexport function isRenderLocation(node: INode | INodeSequence): node is IRenderLocation {\n  return (node as Comment).textContent === 'au-end';\n}\n\nexport class FragmentNodeSequence implements INodeSequence {\n  public isMounted: boolean = false;\n  public isLinked: boolean = false;\n\n  public firstChild: Node;\n  public lastChild: Node;\n  public childNodes: Node[];\n\n  public next?: INodeSequence = void 0;\n\n  private refNode?: Node = void 0;\n\n  private readonly targets: ArrayLike<Node>;\n\n  public constructor(\n    public readonly platform: IPlatform,\n    private readonly fragment: DocumentFragment,\n  ) {\n    const targetNodeList = fragment.querySelectorAll('.au');\n    let i = 0;\n    let ii = targetNodeList.length;\n    let target: Element;\n    // eslint-disable-next-line\n    let targets = this.targets = Array(ii);\n\n    while (ii > i) {\n      // eagerly convert all markers to RenderLocations (otherwise the renderer\n      // will do it anyway) and store them in the target list (since the comments\n      // can't be queried)\n      target = targetNodeList[i];\n\n      if (target.nodeName === 'AU-M') {\n        // note the renderer will still call this method, but it will just return the\n        // location if it sees it's already a location\n        targets[i] = convertToRenderLocation(target);\n      } else {\n        // also store non-markers for consistent ordering\n        targets[i] = target;\n      }\n      ++i;\n    }\n\n    const childNodeList = fragment.childNodes;\n    const childNodes = this.childNodes = Array(ii = childNodeList.length) as Node[];\n    i = 0;\n    while (ii > i) {\n      childNodes[i] = childNodeList[i];\n      ++i;\n    }\n\n    this.firstChild = fragment.firstChild!;\n    this.lastChild = fragment.lastChild!;\n  }\n\n  public findTargets(): ArrayLike<Node> {\n    return this.targets;\n  }\n\n  public insertBefore(refNode: IRenderLocation & Comment): void {\n    if (this.isLinked && !!this.refNode) {\n      this.addToLinked();\n    } else {\n      const parent = refNode.parentNode!;\n      if (this.isMounted) {\n        let current = this.firstChild;\n        let next: Node;\n        const end = this.lastChild;\n\n        while (current != null) {\n          next = current.nextSibling!;\n          parent.insertBefore(current, refNode);\n\n          if (current === end) {\n            break;\n          }\n\n          current = next;\n        }\n      } else {\n        this.isMounted = true;\n        refNode.parentNode!.insertBefore(this.fragment, refNode);\n      }\n    }\n  }\n\n  public appendTo(parent: Node, enhance: boolean = false): void {\n    if (this.isMounted) {\n      let current = this.firstChild;\n      let next: Node;\n      const end = this.lastChild;\n\n      while (current != null) {\n        next = current.nextSibling!;\n        parent.appendChild(current);\n\n        if (current === end) {\n          break;\n        }\n\n        current = next;\n      }\n    } else {\n      this.isMounted = true;\n      if (!enhance) {\n        parent.appendChild(this.fragment);\n      }\n    }\n  }\n\n  public remove(): void {\n    if (this.isMounted) {\n      this.isMounted = false;\n\n      const fragment = this.fragment;\n      const end = this.lastChild;\n      let next: Node;\n\n      let current = this.firstChild;\n      while (current !== null) {\n        next = current.nextSibling!;\n        fragment.appendChild(current);\n\n        if (current === end) {\n          break;\n        }\n\n        current = next;\n      }\n    }\n  }\n\n  public addToLinked(): void {\n    const refNode = this.refNode!;\n    const parent = refNode.parentNode!;\n    if (this.isMounted) {\n      let current = this.firstChild;\n      let next: Node;\n      const end = this.lastChild;\n\n      while (current != null) {\n        next = current.nextSibling!;\n        parent.insertBefore(current, refNode);\n\n        if (current === end) {\n          break;\n        }\n\n        current = next;\n      }\n    } else {\n      this.isMounted = true;\n      parent.insertBefore(this.fragment, refNode);\n    }\n  }\n\n  public unlink(): void {\n    this.isLinked = false;\n    this.next = void 0;\n    this.refNode = void 0;\n  }\n\n  public link(next: INodeSequence | IRenderLocation & Comment | undefined): void {\n    this.isLinked = true;\n    if (isRenderLocation(next!)) {\n      this.refNode = next;\n    } else {\n      this.next = next;\n      this.obtainRefNode();\n    }\n  }\n\n  private obtainRefNode(): void {\n    if (this.next !== void 0) {\n      this.refNode = this.next.firstChild;\n    } else {\n      this.refNode = void 0;\n    }\n  }\n}\n\nexport const IWindow = DI.createInterface<IWindow>('IWindow', x => x.callback(handler => handler.get(IPlatform).window));\nexport interface IWindow extends Window { }\n\nexport const ILocation = DI.createInterface<ILocation>('ILocation', x => x.callback(handler => handler.get(IWindow).location));\nexport interface ILocation extends Location { }\n\nexport const IHistory = DI.createInterface<IHistory>('IHistory', x => x.callback(handler => handler.get(IWindow).history));\n// NOTE: `IHistory` is documented\n/**\n * https://developer.mozilla.org/en-US/docs/Web/API/History\n *\n * A convenience interface that (unless explicitly overridden in DI) resolves directly to the native browser `history` object.\n *\n * Allows manipulation of the browser session history, that is the pages visited in the tab or frame that the current page is loaded in.\n */\nexport interface IHistory extends History {\n  /**\n   * Returns an integer representing the number of elements in the session history, including the currently loaded page.\n   * For example, for a page loaded in a new tab this property returns 1.\n   */\n  readonly length: number;\n  /**\n   * Allows web applications to explicitly set default scroll restoration behavior on history navigation.\n   *\n   * - `auto` The location on the page to which the user has scrolled will be restored.\n   * - `manual` The location on the page is not restored. The user will have to scroll to the location manually.\n   */\n  scrollRestoration: ScrollRestoration;\n  /**\n   * Returns a value representing the state at the top of the history stack.\n   * This is a way to look at the state without having to wait for a popstate event\n   */\n  readonly state: unknown;\n  /**\n   * Causes the browser to move back one page in the session history.\n   * It has the same effect as calling history.go(-1).\n   * If there is no previous page, this method call does nothing.\n   *\n   * This method is asynchronous.\n   * Add a listener for the `popstate` event in order to determine when the navigation has completed.\n   */\n  back(): void;\n  /**\n   * Causes the browser to move forward one page in the session history.\n   * It has the same effect as calling `history.go(1)`.\n   *\n   * This method is asynchronous.\n   * Add a listener for the `popstate` event in order to determine when the navigation has completed.\n   */\n  forward(): void;\n  /**\n   * https://developer.mozilla.org/en-US/docs/Web/API/History/go\n   *\n   * Loads a specific page from the session history.\n   * You can use it to move forwards and backwards through the history depending on the value of a parameter.\n   *\n   * This method is asynchronous.\n   * Add a listener for the `popstate` event in order to determine when the navigation has completed.\n   *\n   * @param delta - The position in the history to which you want to move, relative to the current page.\n   * A negative value moves backwards, a positive value moves forwards.\n   * So, for example, `history.go(2)` moves forward two pages and `history.go(-2)` moves back two pages.\n   * If no value is passed or if `delta` equals 0, it has the same result as calling `location.reload()`.\n   */\n  go(delta?: number): void;\n  /**\n   * https://developer.mozilla.org/en-US/docs/Web/API/History/pushState\n   *\n   * Adds a state to the browser's session history stack.\n   *\n   * @param state - An object which is associated with the new history entry created by `pushState`.\n   * Whenever the user navigates to the new state, a `popstate` event is fired, and the state property of the event contains a copy of the history entry's state object.\n   * The state object can be anything that can be serialized.\n   * @param title - Most browsers currently ignores this parameter, although they may use it in the future.\n   * Passing the empty string here should be safe against future changes to the method.\n   * Alternatively, you could pass a short title for the state.\n   * @param url - The new history entry's URL is given by this parameter.\n   * Note that the browser won't attempt to load this URL after a call to pushState(), but it might attempt to load the URL later, for instance after the user restarts the browser.\n   * The new URL does not need to be absolute; if it's relative, it's resolved relative to the current URL.\n   * The new URL must be of the same origin as the current URL; otherwise, pushState() will throw an exception.\n   * If this parameter isn't specified, it's set to the document's current URL.\n   */\n  pushState(state: {} | null, title: string, url?: string | null): void;\n  /**\n   * https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState\n   *\n   * Modifies the current history entry, replacing it with the stateObj, title, and URL passed in the method parameters.\n   *\n   * This method is particularly useful when you want to update the state object or URL of the current history entry in response to some user action.\n   *\n   * @param state - An object which is associated with the history entry passed to the `replaceState` method.\n   * @param title - Most browsers currently ignores this parameter, although they may use it in the future.\n   * Passing the empty string here should be safe against future changes to the method.\n   * Alternatively, you could pass a short title for the state.\n   * @param url - The URL of the history entry.\n   * The new URL must be of the same origin as the current URL; otherwise `replaceState` throws an exception.\n   */\n  replaceState(state: {} | null, title: string, url?: string | null): void;\n}\n","import {\n  DelegationStrategy,\n  LifecycleFlags,\n} from '@aurelia/runtime';\n\nimport { IEventTarget } from '../dom.js';\n\nimport type { IDisposable, IIndexable, IServiceLocator } from '@aurelia/kernel';\nimport type { IsBindingBehavior, Scope } from '@aurelia/runtime';\nimport type { IEventDelegator } from '../observation/event-delegator.js';\nimport type { IPlatform } from '../platform.js';\nimport { IAstBasedBinding } from './interfaces-bindings.js';\n\nconst options = {\n  [DelegationStrategy.capturing]: { capture: true } as const,\n  [DelegationStrategy.bubbling]: { capture: false } as const,\n} as const;\n\nexport interface Listener extends IAstBasedBinding {}\n/**\n * Listener binding. Handle event binding between view and view model\n */\nexport class Listener implements IAstBasedBinding {\n  public interceptor: this = this;\n\n  public isBound: boolean = false;\n  public $scope!: Scope;\n\n  private handler: IDisposable = null!;\n\n  public constructor(\n    public platform: IPlatform,\n    public targetEvent: string,\n    public delegationStrategy: DelegationStrategy,\n    public sourceExpression: IsBindingBehavior,\n    public target: Node,\n    public preventDefault: boolean,\n    public eventDelegator: IEventDelegator,\n    public locator: IServiceLocator,\n  ) {}\n\n  public callSource(event: Event): ReturnType<IsBindingBehavior['evaluate']> {\n    const overrideContext = this.$scope.overrideContext;\n    overrideContext.$event = event;\n\n    const result = this.sourceExpression.evaluate(LifecycleFlags.mustEvaluate, this.$scope, this.locator, null);\n\n    Reflect.deleteProperty(overrideContext, '$event');\n\n    if (result !== true && this.preventDefault) {\n      event.preventDefault();\n    }\n\n    return result;\n  }\n\n  public handleEvent(event: Event): void {\n    this.interceptor.callSource(event);\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.isBound) {\n      if (this.$scope === scope) {\n        return;\n      }\n\n      this.interceptor.$unbind(flags | LifecycleFlags.fromBind);\n    }\n\n    this.$scope = scope;\n\n    const sourceExpression = this.sourceExpression;\n    if (sourceExpression.hasBind) {\n      sourceExpression.bind(flags, scope, this.interceptor);\n    }\n\n    if (this.delegationStrategy === DelegationStrategy.none) {\n      this.target.addEventListener(this.targetEvent, this);\n    } else {\n      this.handler = this.eventDelegator.addEventListener(\n        this.locator.get(IEventTarget),\n        this.target,\n        this.targetEvent,\n        this,\n        options[this.delegationStrategy],\n      );\n    }\n\n    // add isBound flag and remove isBinding flag\n    this.isBound = true;\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    if (!this.isBound) {\n      return;\n    }\n\n    const sourceExpression = this.sourceExpression;\n    if (sourceExpression.hasUnbind) {\n      sourceExpression.unbind(flags, this.$scope, this.interceptor);\n    }\n\n    this.$scope = null!;\n    if (this.delegationStrategy === DelegationStrategy.none) {\n      this.target.removeEventListener(this.targetEvent, this);\n    } else {\n      this.handler.dispose();\n      this.handler = null!;\n    }\n\n    // remove isBound and isUnbinding flags\n    this.isBound = false;\n  }\n\n  public observe(obj: IIndexable, propertyName: string): void {\n    return;\n  }\n\n  public handleChange(newValue: unknown, previousValue: unknown, flags: LifecycleFlags): void {\n    return;\n  }\n}\n","import { DI } from '@aurelia/kernel';\nimport { createLookup, isFunction } from '../utilities.js';\nimport type { NodeObserverConfig } from './observer-locator.js';\nimport type { IDisposable } from '@aurelia/kernel';\n\nconst defaultOptions: AddEventListenerOptions = {\n  capture: false,\n};\n\nclass ListenerTracker implements IDisposable {\n  private _count: number = 0;\n  private readonly _captureLookups: Map<EventTarget, Record<string, EventListenerOrEventListenerObject | undefined>> = new Map();\n  private readonly _bubbleLookups: Map<EventTarget, Record<string, EventListenerOrEventListenerObject | undefined>> = new Map();\n\n  public constructor(\n    private readonly _publisher: EventTarget,\n    private readonly _eventName: string,\n    private readonly _options: AddEventListenerOptions = defaultOptions,\n  ) {}\n\n  public _increment(): void {\n    if (++this._count === 1) {\n      this._publisher.addEventListener(this._eventName, this, this._options);\n    }\n  }\n\n  public _decrement(): void {\n    if (--this._count === 0) {\n      this._publisher.removeEventListener(this._eventName, this, this._options);\n    }\n  }\n\n  public dispose(): void {\n    if (this._count > 0) {\n      this._count = 0;\n      this._publisher.removeEventListener(this._eventName, this, this._options);\n    }\n    this._captureLookups.clear();\n    this._bubbleLookups.clear();\n  }\n\n  public _getLookup(target: EventTarget): Record<string, EventListenerOrEventListenerObject | undefined> {\n    const lookups = this._options.capture === true ? this._captureLookups : this._bubbleLookups;\n    let lookup = lookups.get(target);\n    if (lookup === void 0) {\n      lookups.set(target, lookup = createLookup());\n    }\n    return lookup;\n  }\n\n  public handleEvent(event: Event): void {\n    const lookups = this._options.capture === true ? this._captureLookups : this._bubbleLookups;\n    const path = event.composedPath();\n    if (this._options.capture === true) {\n      path.reverse();\n    }\n    for (const target of path) {\n      const lookup = lookups.get(target);\n      if (lookup === void 0) {\n        continue;\n      }\n      const listener = lookup[this._eventName];\n      if (listener === void 0) {\n        continue;\n      }\n      if (isFunction(listener)) {\n        listener(event);\n      } else {\n        listener.handleEvent(event);\n      }\n      if (event.cancelBubble === true) {\n        return;\n      }\n    }\n  }\n}\n\n/**\n * Enable dispose() pattern for `delegate` & `capture` commands\n */\nclass DelegateSubscription implements IDisposable {\n  public constructor(\n    private readonly _tracker: ListenerTracker,\n    private readonly _lookup: Record<string, EventListenerOrEventListenerObject | undefined>,\n    private readonly _eventName: string,\n    callback: EventListenerOrEventListenerObject\n  ) {\n    _tracker._increment();\n    _lookup[_eventName] = callback;\n  }\n\n  public dispose(): void {\n    this._tracker._decrement();\n    this._lookup[this._eventName] = void 0;\n  }\n}\n\nexport class EventSubscriber {\n  private target: EventTarget | null = null;\n  private handler: EventListenerOrEventListenerObject | null = null;\n\n  public constructor(\n    public readonly config: NodeObserverConfig,\n  ) {}\n\n  public subscribe(node: EventTarget, callbackOrListener: EventListenerOrEventListenerObject): void {\n    this.target = node;\n    this.handler = callbackOrListener;\n    let event: string;\n    for (event of this.config.events) {\n      node.addEventListener(event, callbackOrListener);\n    }\n  }\n\n  public dispose(): void {\n    const { target, handler } = this;\n    let event: string;\n    if (target !== null && handler !== null) {\n      for (event of this.config.events) {\n        target.removeEventListener(event, handler);\n      }\n    }\n\n    this.target = this.handler = null!;\n  }\n}\n\nexport interface IEventDelegator extends EventDelegator {}\nexport const IEventDelegator = DI.createInterface<IEventDelegator>('IEventDelegator', x => x.singleton(EventDelegator));\n\nexport class EventDelegator implements IDisposable {\n  /** @internal */\n  private readonly _trackerMaps: Record<string, Map<EventTarget, ListenerTracker> | undefined> = createLookup();\n\n  public addEventListener(\n    publisher: EventTarget,\n    target: Node,\n    eventName: string,\n    listener: EventListenerOrEventListenerObject,\n    options?: AddEventListenerOptions,\n  ): IDisposable {\n    const trackerMap = this._trackerMaps[eventName] ??= new Map<EventTarget, ListenerTracker>();\n    let tracker = trackerMap.get(publisher);\n    if (tracker === void 0) {\n      trackerMap.set(publisher, tracker = new ListenerTracker(publisher, eventName, options));\n    }\n    return new DelegateSubscription(tracker, tracker._getLookup(target), eventName, listener);\n  }\n\n  public dispose(): void {\n    for (const eventName in this._trackerMaps) {\n      const trackerMap = this._trackerMaps[eventName]!;\n      for (const tracker of trackerMap.values()) {\n        tracker.dispose();\n      }\n      trackerMap.clear();\n    }\n  }\n}\n","// A specific file for primitive of au slot to avoid circular dependencies\nimport { DI } from '@aurelia/kernel';\nimport { CustomElementDefinition } from './custom-element.js';\n\nexport type IProjections = Record<string, CustomElementDefinition>;\nexport const IProjections = DI.createInterface<IProjections>(\"IProjections\");\n\nexport interface IAuSlotsInfo extends AuSlotsInfo { }\nexport const IAuSlotsInfo = DI.createInterface<IAuSlotsInfo>('IAuSlotsInfo');\nexport class AuSlotsInfo {\n  /**\n   * @param {string[]} projectedSlots - Name of the slots to which content are projected.\n   */\n  public constructor(\n    public readonly projectedSlots: string[],\n  ) { }\n}\n","import { Metadata, Registration, DI, emptyArray, InstanceProvider } from '@aurelia/kernel';\nimport {\n  BindingMode,\n  ExpressionType,\n  IExpressionParser,\n  IObserverLocator,\n  LifecycleFlags,\n  BindingBehaviorExpression,\n  BindingBehaviorFactory,\n  ExpressionKind,\n  IBinding,\n  Scope,\n} from '@aurelia/runtime';\nimport { CallBinding } from './binding/call-binding.js';\nimport { AttributeBinding } from './binding/attribute.js';\nimport { InterpolationBinding, InterpolationPartBinding, ContentBinding } from './binding/interpolation-binding.js';\nimport { LetBinding } from './binding/let-binding.js';\nimport { PropertyBinding } from './binding/property-binding.js';\nimport { RefBinding } from './binding/ref-binding.js';\nimport { Listener } from './binding/listener.js';\nimport { IEventDelegator } from './observation/event-delegator.js';\nimport { CustomElement, CustomElementDefinition } from './resources/custom-element.js';\nimport { AuSlotsInfo, IAuSlotsInfo, IProjections } from './resources/slot-injectables.js';\nimport { CustomAttribute, CustomAttributeDefinition } from './resources/custom-attribute.js';\nimport { convertToRenderLocation, IRenderLocation, INode, setRef } from './dom.js';\nimport { Controller, ICustomElementController, ICustomElementViewModel, IController, ICustomAttributeViewModel, IHydrationContext, ViewModelKind } from './templating/controller.js';\nimport { IPlatform } from './platform.js';\nimport { IViewFactory } from './templating/view.js';\nimport { IRendering } from './templating/rendering.js';\nimport { defineMetadata, getOwnMetadata } from './shared.js';\nimport { AttrSyntax } from './resources/attribute-pattern.js';\nimport { isString } from './utilities.js';\n\nimport type { IServiceLocator, IContainer, Class, IRegistry, Constructable, IResolver } from '@aurelia/kernel';\nimport type {\n  Interpolation,\n  IsBindingBehavior,\n  AnyBindingExpression,\n  BindingBehaviorInstance,\n  IInterceptableBinding,\n  IObservable,\n  ForOfStatement,\n  DelegationStrategy,\n} from '@aurelia/runtime';\nimport type { IHydratableController } from './templating/controller.js';\nimport type { PartialCustomElementDefinition } from './resources/custom-element.js';\n\nexport const enum InstructionType {\n  hydrateElement = 'ra',\n  hydrateAttribute = 'rb',\n  hydrateTemplateController = 'rc',\n  hydrateLetElement = 'rd',\n  setProperty = 're',\n  interpolation = 'rf',\n  propertyBinding = 'rg',\n  callBinding = 'rh',\n  letBinding = 'ri',\n  refBinding = 'rj',\n  iteratorBinding = 'rk',\n  textBinding = 'ha',\n  listenerBinding = 'hb',\n  attributeBinding = 'hc',\n  stylePropertyBinding = 'hd',\n  setAttribute = 'he',\n  setClassAttribute = 'hf',\n  setStyleAttribute = 'hg',\n  spreadBinding = 'hs',\n  spreadElementProp = 'hp',\n}\n\nexport type InstructionTypeName = string;\n\nexport interface IInstruction {\n  readonly type: InstructionTypeName;\n}\nexport const IInstruction = DI.createInterface<IInstruction>('Instruction');\n\nexport function isInstruction(value: unknown): value is IInstruction {\n  const type = (value as { type?: string }).type;\n  return isString(type) && type.length === 2;\n}\n\nexport class InterpolationInstruction {\n  public get type(): InstructionType.interpolation { return InstructionType.interpolation; }\n\n  public constructor(\n    public from: string | Interpolation,\n    public to: string,\n  ) {}\n}\n\nexport class PropertyBindingInstruction {\n  public get type(): InstructionType.propertyBinding { return InstructionType.propertyBinding; }\n\n  public constructor(\n    public from: string | IsBindingBehavior,\n    public to: string,\n    public mode: BindingMode,\n  ) {}\n}\n\nexport class IteratorBindingInstruction {\n  public get type(): InstructionType.iteratorBinding { return InstructionType.iteratorBinding; }\n\n  public constructor(\n    public from: string | ForOfStatement,\n    public to: string,\n  ) {}\n}\n\nexport class CallBindingInstruction {\n  public get type(): InstructionType.callBinding { return InstructionType.callBinding; }\n\n  public constructor(\n    public from: string | IsBindingBehavior,\n    public to: string,\n  ) {}\n}\n\nexport class RefBindingInstruction {\n  public get type(): InstructionType.refBinding { return InstructionType.refBinding; }\n\n  public constructor(\n    public readonly from: string | IsBindingBehavior,\n    public readonly to: string\n  ) {}\n}\n\nexport class SetPropertyInstruction {\n  public get type(): InstructionType.setProperty { return InstructionType.setProperty; }\n\n  public constructor(\n    public value: unknown,\n    public to: string,\n  ) {}\n}\n\nexport class HydrateElementInstruction {\n  public get type(): InstructionType.hydrateElement { return InstructionType.hydrateElement; }\n\n  /**\n   * A special property that can be used to store <au-slot/> usage information\n   */\n  public auSlot: { name: string; fallback: CustomElementDefinition } | null = null;\n\n  public constructor(\n    /**\n     * The name of the custom element this instruction is associated with\n     */\n    // in theory, Constructor of resources should be accepted too\n    // though it would be unnecessary right now\n    public res: string | /* Constructable |  */CustomElementDefinition,\n    public alias: string | undefined,\n    /**\n     * Bindable instructions for the custom element instance\n     */\n    public props: IInstruction[],\n    /**\n     * Indicates what projections are associated with the element usage\n     */\n    public projections: Record<string, CustomElementDefinition> | null,\n    /**\n     * Indicates whether the usage of the custom element was with a containerless attribute or not\n     */\n    public containerless: boolean,\n    /**\n     * A list of captured attr syntaxes\n     */\n    public captures: AttrSyntax[] | undefined,\n  ) {\n  }\n}\n\nexport class HydrateAttributeInstruction {\n  public get type(): InstructionType.hydrateAttribute { return InstructionType.hydrateAttribute; }\n\n  public constructor(\n    // in theory, Constructor of resources should be accepted too\n    // though it would be unnecessary right now\n    public res: string | /* Constructable |  */CustomAttributeDefinition,\n    public alias: string | undefined,\n    /**\n     * Bindable instructions for the custom attribute instance\n     */\n    public props: IInstruction[],\n  ) {}\n}\n\nexport class HydrateTemplateController {\n  public get type(): InstructionType.hydrateTemplateController { return InstructionType.hydrateTemplateController; }\n\n  public constructor(\n    public def: PartialCustomElementDefinition,\n    // in theory, Constructor of resources should be accepted too\n    // though it would be unnecessary right now\n    public res: string | /* Constructable |  */CustomAttributeDefinition,\n    public alias: string | undefined,\n    /**\n     * Bindable instructions for the template controller instance\n     */\n    public props: IInstruction[],\n  ) {}\n}\n\nexport class HydrateLetElementInstruction {\n  public get type(): InstructionType.hydrateLetElement { return InstructionType.hydrateLetElement; }\n\n  public constructor(\n    public instructions: LetBindingInstruction[],\n    public toBindingContext: boolean,\n  ) {}\n}\n\nexport class LetBindingInstruction {\n  public get type(): InstructionType.letBinding { return InstructionType.letBinding; }\n\n  public constructor(\n    public from: string | IsBindingBehavior | Interpolation,\n    public to: string,\n  ) {}\n}\n\nexport class TextBindingInstruction {\n  public get type(): InstructionType.textBinding { return InstructionType.textBinding; }\n\n  public constructor(\n    public from: string | Interpolation,\n    /**\n     * Indicates whether the value of the expression \"from\"\n     * should be evaluated in strict mode.\n     *\n     * In none strict mode, \"undefined\" and \"null\" are coerced into empty string\n     */\n    public strict: boolean,\n  ) {}\n}\n\nexport class ListenerBindingInstruction {\n  public get type(): InstructionType.listenerBinding { return InstructionType.listenerBinding; }\n\n  public constructor(\n    public from: string | IsBindingBehavior,\n    public to: string,\n    public preventDefault: boolean,\n    public strategy: DelegationStrategy,\n  ) {}\n}\nexport class StylePropertyBindingInstruction {\n  public get type(): InstructionType.stylePropertyBinding { return InstructionType.stylePropertyBinding; }\n\n  public constructor(\n    public from: string | IsBindingBehavior,\n    public to: string,\n  ) {}\n}\n\nexport class SetAttributeInstruction {\n  public get type(): InstructionType.setAttribute { return InstructionType.setAttribute; }\n\n  public constructor(\n    public value: string,\n    public to: string,\n  ) {}\n}\n\nexport class SetClassAttributeInstruction {\n  public readonly type: InstructionType.setClassAttribute = InstructionType.setClassAttribute;\n\n  public constructor(\n    public readonly value: string,\n  ) {}\n}\n\nexport class SetStyleAttributeInstruction {\n  public readonly type: InstructionType.setStyleAttribute = InstructionType.setStyleAttribute;\n\n  public constructor(\n    public readonly value: string,\n  ) {}\n}\n\nexport class AttributeBindingInstruction {\n  public get type(): InstructionType.attributeBinding { return InstructionType.attributeBinding; }\n\n  public constructor(\n    /**\n     * `attr` and `to` have the same value on a normal attribute\n     * Will be different on `class` and `style`\n     * on `class`: attr = `class` (from binding command), to = attribute name\n     * on `style`: attr = `style` (from binding command), to = attribute name\n     */\n    public attr: string,\n    public from: string | IsBindingBehavior,\n    public to: string,\n  ) {}\n}\n\nexport class SpreadBindingInstruction {\n  public get type(): InstructionType.spreadBinding { return InstructionType.spreadBinding; }\n}\n\nexport class SpreadElementPropBindingInstruction {\n  public get type(): InstructionType.spreadElementProp { return InstructionType.spreadElementProp; }\n  public constructor(\n    public readonly instructions: IInstruction,\n  ) {}\n}\n\nexport const ITemplateCompiler = DI.createInterface<ITemplateCompiler>('ITemplateCompiler');\nexport interface ITemplateCompiler {\n  /**\n   * Indicates whether this compiler should compile template in debug mode\n   *\n   * For the default compiler, this means all expressions are kept as is on the template\n   */\n  debug: boolean;\n  /**\n   * Experimental API, for optimization.\n   *\n   * `true` to create CustomElement/CustomAttribute instructions\n   * with resolved resources constructor during compilation, instead of name\n   */\n  resolveResources: boolean;\n  compile(\n    partialDefinition: PartialCustomElementDefinition,\n    context: IContainer,\n    compilationInstruction: ICompliationInstruction | null,\n  ): CustomElementDefinition;\n\n  /**\n   * Compile a list of captured attributes as if they are declared in a template\n   *\n   * @param requestor - the context definition where the attributes is compiled\n   * @param attrSyntaxes - the attributes captured\n   * @param container - the container containing information for the compilation\n   * @param host - the host element where the attributes are spreaded on\n   */\n  compileSpread(\n    requestor: PartialCustomElementDefinition,\n    attrSyntaxes: AttrSyntax[],\n    container: IContainer,\n    host: Element,\n  ): IInstruction[];\n}\n\nexport interface ICompliationInstruction {\n  /**\n   * A record of projections available for compiling a template.\n   * Where each key is the matching slot name for <au-slot/> inside,\n   * and each value is the definition to render and project\n   */\n  projections: IProjections | null;\n}\n\nexport interface IInstructionTypeClassifier<TType extends string = string> {\n  instructionType: TType;\n}\nexport interface IRenderer<\n  TType extends InstructionTypeName = InstructionTypeName\n> extends Partial<IInstructionTypeClassifier<TType>> {\n  render(\n    /**\n     * The controller that is current invoking this renderer\n     */\n    renderingCtrl: IHydratableController,\n    target: unknown,\n    instruction: IInstruction,\n  ): void;\n}\n\nexport const IRenderer = DI.createInterface<IRenderer>('IRenderer');\n\ntype DecoratableInstructionRenderer<TType extends string, TProto, TClass> = Class<TProto & Partial<IInstructionTypeClassifier<TType> & Pick<IRenderer, 'render'>>, TClass> & Partial<IRegistry>;\ntype DecoratedInstructionRenderer<TType extends string, TProto, TClass> =  Class<TProto & IInstructionTypeClassifier<TType> & Pick<IRenderer, 'render'>, TClass> & IRegistry;\n\ntype InstructionRendererDecorator<TType extends string> = <TProto, TClass>(target: DecoratableInstructionRenderer<TType, TProto, TClass>) => DecoratedInstructionRenderer<TType, TProto, TClass>;\n\nexport function renderer<TType extends string>(instructionType: TType): InstructionRendererDecorator<TType> {\n  return function decorator<TProto, TClass>(target: DecoratableInstructionRenderer<TType, TProto, TClass>): DecoratedInstructionRenderer<TType, TProto, TClass> {\n    // wrap the constructor to set the instructionType to the instance (for better performance than when set on the prototype)\n    const decoratedTarget = function (...args: unknown[]): TProto {\n      const instance = new target(...args);\n      instance.instructionType = instructionType;\n      return instance;\n    } as unknown as DecoratedInstructionRenderer<TType, TProto, TClass>;\n    // make sure we register the decorated constructor with DI\n    decoratedTarget.register = function register(container: IContainer): void {\n      Registration.singleton(IRenderer, decoratedTarget).register(container);\n    };\n    // copy over any metadata such as annotations (set by preceding decorators) as well as static properties set by the user\n    // also copy the name, to be less confusing to users (so they can still use constructor.name for whatever reason)\n    // the length (number of ctor arguments) is copied for the same reason\n    const metadataKeys = Metadata.getOwnKeys(target);\n    for (const key of metadataKeys) {\n      defineMetadata(key, getOwnMetadata(key, target), decoratedTarget);\n    }\n    const ownProperties = Object.getOwnPropertyDescriptors(target);\n    Object.keys(ownProperties).filter(prop => prop !== 'prototype').forEach(prop => {\n      Reflect.defineProperty(decoratedTarget, prop, ownProperties[prop]);\n    });\n    return decoratedTarget;\n  };\n}\n\nfunction ensureExpression<TFrom>(parser: IExpressionParser, srcOrExpr: TFrom, expressionType: ExpressionType): Exclude<TFrom, string> {\n  if (isString(srcOrExpr)) {\n    return parser.parse(srcOrExpr, expressionType) as unknown as Exclude<TFrom, string>;\n  }\n  return srcOrExpr as Exclude<TFrom, string>;\n}\n\nfunction getTarget(potentialTarget: object): object {\n  if ((potentialTarget as { viewModel?: object }).viewModel != null) {\n    return (potentialTarget as { viewModel: object }).viewModel;\n  }\n  return potentialTarget;\n}\n\nfunction getRefTarget(refHost: INode, refTargetName: string): object {\n  if (refTargetName === 'element') {\n    return refHost;\n  }\n  switch (refTargetName) {\n    case 'controller':\n      // this means it supports returning undefined\n      return CustomElement.for(refHost)!;\n    case 'view':\n      // todo: returns node sequences for fun?\n      if (__DEV__)\n        throw new Error('Not supported API');\n      else\n        throw new Error('AUR0750');\n    case 'view-model':\n      // this means it supports returning undefined\n      return CustomElement.for(refHost)!.viewModel;\n    default: {\n      const caController = CustomAttribute.for(refHost, refTargetName);\n      if (caController !== void 0) {\n        return caController.viewModel;\n      }\n      const ceController = CustomElement.for(refHost, { name: refTargetName });\n      if (ceController === void 0) {\n        if (__DEV__)\n          throw new Error(`Attempted to reference \"${refTargetName}\", but it was not found amongst the target's API.`);\n        else\n          throw new Error(`AUR0751:${refTargetName}`);\n      }\n      return ceController.viewModel;\n    }\n  }\n}\n\n@renderer(InstructionType.setProperty)\n/** @internal */\nexport class SetPropertyRenderer implements IRenderer {\n  public render(\n    renderingCtrl: IHydratableController,\n    target: IController,\n    instruction: SetPropertyInstruction,\n  ): void {\n    const obj = getTarget(target) as IObservable;\n    if (obj.$observers !== void 0 && obj.$observers[instruction.to] !== void 0) {\n      obj.$observers[instruction.to].setValue(instruction.value, LifecycleFlags.fromBind);\n    } else {\n      obj[instruction.to] = instruction.value;\n    }\n  }\n}\n\n@renderer(InstructionType.hydrateElement)\n/** @internal */\nexport class CustomElementRenderer implements IRenderer {\n  /** @internal */ protected static get inject(): unknown[] { return [IRendering, IPlatform]; }\n  /** @internal */ private readonly _rendering: IRendering;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(rendering: IRendering, platform: IPlatform) {\n    this._rendering = rendering;\n    this._platform = platform;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: HTMLElement,\n    instruction: HydrateElementInstruction,\n  ): void {\n    /* eslint-disable prefer-const */\n    let def: CustomElementDefinition | null;\n    let Ctor: Constructable<ICustomElementViewModel>;\n    let component: ICustomElementViewModel;\n    let childCtrl: ICustomElementController;\n    const res = instruction.res;\n    const projections = instruction.projections;\n    const ctxContainer = renderingCtrl.container;\n    const container = createElementContainer(\n      /* platform         */this._platform,\n      /* parentController */renderingCtrl,\n      /* host             */target,\n      /* instruction      */instruction,\n      /* location         */target,\n      /* auSlotsInfo      */projections == null ? void 0 : new AuSlotsInfo(Object.keys(projections)),\n    );\n    switch (typeof res) {\n      case 'string':\n        def = ctxContainer.find(CustomElement, res);\n        if (def == null) {\n          if (__DEV__)\n            throw new Error(`Element ${res} is not registered in ${(renderingCtrl as Controller)['name']}.`);\n          else\n            throw new Error(`AUR0752:${res}@${(renderingCtrl as Controller)['name']}`);\n        }\n        break;\n      // constructor based instruction\n      // will be enabled later if needed.\n      // As both AOT + runtime based can use definition for perf\n      // -----------------\n      // case 'function':\n      //   def = CustomElement.getDefinition(res);\n      //   break;\n      default:\n        def = res;\n    }\n    Ctor = def.Type;\n    component = container.invoke(Ctor);\n    container.registerResolver(Ctor, new InstanceProvider<typeof Ctor>(def.key, component));\n    childCtrl = Controller.$el(\n      /* own container       */container,\n      /* viewModel           */component,\n      /* host                */target,\n      /* instruction         */instruction,\n      /* definition          */def,\n    );\n\n    setRef(target, def.key, childCtrl);\n\n    const renderers = this._rendering.renderers;\n    const props = instruction.props;\n    const ii = props.length;\n    let i = 0;\n    let propInst: IInstruction;\n    while (ii > i) {\n      propInst = props[i];\n      renderers[propInst.type].render(renderingCtrl, childCtrl, propInst);\n      ++i;\n    }\n\n    renderingCtrl.addChild(childCtrl);\n    /* eslint-enable prefer-const */\n  }\n}\n\n@renderer(InstructionType.hydrateAttribute)\n/** @internal */\nexport class CustomAttributeRenderer implements IRenderer {\n  /** @internal */ protected static get inject(): unknown[] { return [IRendering, IPlatform]; }\n  /** @internal */ private readonly _rendering: IRendering;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(rendering: IRendering, platform: IPlatform) {\n    this._rendering = rendering;\n    this._platform = platform;\n  }\n\n  public render(\n    /**\n     * The cotroller that is currently invoking this renderer\n     */\n    renderingCtrl: IHydratableController,\n    target: HTMLElement,\n    instruction: HydrateAttributeInstruction,\n  ): void {\n    /* eslint-disable prefer-const */\n    let ctxContainer = renderingCtrl.container;\n    let def: CustomAttributeDefinition | null;\n    switch (typeof instruction.res) {\n      case 'string':\n        def = ctxContainer.find(CustomAttribute, instruction.res);\n        if (def == null) {\n          if (__DEV__)\n            throw new Error(`Attribute ${instruction.res} is not registered in ${(renderingCtrl as Controller)['name']}.`);\n          else\n            throw new Error(`AUR0753:${instruction.res}@${(renderingCtrl as Controller)['name']}`);\n        }\n        break;\n      // constructor based instruction\n      // will be enabled later if needed.\n      // As both AOT + runtime based can use definition for perf\n      // -----------------\n      // case 'function':\n      //   def = CustomAttribute.getDefinition(instruction.res);\n      //   break;\n      default:\n        def = instruction.res;\n    }\n    const component = invokeAttribute(\n      /* platform         */this._platform,\n      /* attr definition  */def,\n      /* parentController */renderingCtrl,\n      /* host             */target,\n      /* instruction      */instruction,\n      /* viewFactory      */void 0,\n      /* location         */void 0,\n    );\n    const childController = Controller.$attr(\n      /* context ct */renderingCtrl.container,\n      /* viewModel  */component,\n      /* host       */target,\n      /* definition */def,\n    );\n\n    setRef(target, def.key, childController);\n\n    const renderers = this._rendering.renderers;\n    const props = instruction.props;\n    const ii = props.length;\n    let i = 0;\n    let propInst: IInstruction;\n    while (ii > i) {\n      propInst = props[i];\n      renderers[propInst.type].render(renderingCtrl, childController, propInst);\n      ++i;\n    }\n\n    renderingCtrl.addChild(childController);\n    /* eslint-enable prefer-const */\n  }\n}\n\n@renderer(InstructionType.hydrateTemplateController)\n/** @internal */\nexport class TemplateControllerRenderer implements IRenderer {\n  /** @internal */ protected static get inject(): unknown[] { return [IRendering, IPlatform]; }\n  /** @internal */ private readonly _rendering: IRendering;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(rendering: IRendering, platform: IPlatform) {\n    this._rendering = rendering;\n    this._platform = platform;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: HTMLElement,\n    instruction: HydrateTemplateController,\n  ): void {\n    /* eslint-disable prefer-const */\n    let ctxContainer = renderingCtrl.container;\n    let def: CustomAttributeDefinition | null;\n    switch (typeof instruction.res) {\n      case 'string':\n        def = ctxContainer.find(CustomAttribute, instruction.res);\n        if (def == null) {\n          if (__DEV__)\n            throw new Error(`Attribute ${instruction.res} is not registered in ${(renderingCtrl as Controller)['name']}.`);\n          else\n            throw new Error(`AUR0754:${instruction.res}@${(renderingCtrl as Controller)['name']}`);\n        }\n        break;\n      // constructor based instruction\n      // will be enabled later if needed.\n      // As both AOT + runtime based can use definition for perf\n      // -----------------\n      // case 'function':\n      //   def = CustomAttribute.getDefinition(instruction.res);\n      //   break;\n      default:\n        def = instruction.res;\n    }\n    const viewFactory = this._rendering.getViewFactory(instruction.def, ctxContainer);\n    const renderLocation = convertToRenderLocation(target);\n    const component = invokeAttribute(\n      /* platform         */this._platform,\n      /* attr definition  */def,\n      /* parentController */renderingCtrl,\n      /* host             */target,\n      /* instruction      */instruction,\n      /* viewFactory      */viewFactory,\n      /* location         */renderLocation,\n    );\n    const childController = Controller.$attr(\n      /* container ct */renderingCtrl.container,\n      /* viewModel    */component,\n      /* host         */target,\n      /* definition   */def,\n    );\n\n    setRef(renderLocation, def.key, childController);\n\n    component.link?.(renderingCtrl, childController, target, instruction);\n\n    const renderers = this._rendering.renderers;\n    const props = instruction.props;\n    const ii = props.length;\n    let i = 0;\n    let propInst: IInstruction;\n    while (ii > i) {\n      propInst = props[i];\n      renderers[propInst.type].render(renderingCtrl, childController, propInst);\n      ++i;\n    }\n\n    renderingCtrl.addChild(childController);\n    /* eslint-enable prefer-const */\n  }\n}\n\n@renderer(InstructionType.hydrateLetElement)\n/** @internal */\nexport class LetElementRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n  /** @internal */ private readonly _observerLocator: IObserverLocator;\n\n  public constructor(\n    exprParser: IExpressionParser,\n    observerLocator: IObserverLocator,\n  ) {\n    this._exprParser = exprParser;\n    this._observerLocator = observerLocator;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: Node & ChildNode,\n    instruction: HydrateLetElementInstruction,\n  ): void {\n    target.remove();\n    const childInstructions = instruction.instructions;\n    const toBindingContext = instruction.toBindingContext;\n    const container = renderingCtrl.container;\n    const ii = childInstructions.length;\n\n    let childInstruction: LetBindingInstruction;\n    let expr: AnyBindingExpression;\n    let binding: LetBinding;\n    let i = 0;\n    while (ii > i) {\n      childInstruction = childInstructions[i];\n      expr = ensureExpression(this._exprParser, childInstruction.from, ExpressionType.IsProperty);\n      binding = new LetBinding(expr, childInstruction.to, this._observerLocator, container, toBindingContext);\n      renderingCtrl.addBinding(expr.$kind === ExpressionKind.BindingBehavior\n        ? applyBindingBehavior(binding, expr, container)\n        : binding\n      );\n      ++i;\n    }\n  }\n}\n\n@renderer(InstructionType.callBinding)\n/** @internal */\nexport class CallBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n  /** @internal */ private readonly _observerLocator: IObserverLocator;\n\n  public constructor(\n    exprParser: IExpressionParser,\n    observerLocator: IObserverLocator,\n  ) {\n    this._exprParser = exprParser;\n    this._observerLocator = observerLocator;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: IController,\n    instruction: CallBindingInstruction,\n  ): void {\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.IsProperty | ExpressionType.IsFunction);\n    const binding = new CallBinding(expr, getTarget(target), instruction.to, this._observerLocator, renderingCtrl.container);\n    renderingCtrl.addBinding(expr.$kind === ExpressionKind.BindingBehavior\n      ? applyBindingBehavior(binding, expr, renderingCtrl.container)\n      : binding\n    );\n  }\n}\n\n@renderer(InstructionType.refBinding)\n/** @internal */\nexport class RefBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(exprParser: IExpressionParser) {\n    this._exprParser = exprParser;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: INode,\n    instruction: RefBindingInstruction,\n  ): void {\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.IsProperty);\n    const binding = new RefBinding(expr, getRefTarget(target, instruction.to), renderingCtrl.container);\n    renderingCtrl.addBinding(expr.$kind === ExpressionKind.BindingBehavior\n      ? applyBindingBehavior(binding, expr, renderingCtrl.container)\n      : binding\n    );\n  }\n}\n\n@renderer(InstructionType.interpolation)\n/** @internal */\nexport class InterpolationBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator, IPlatform];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n  /** @internal */ private readonly _observerLocator: IObserverLocator;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(\n    exprParser: IExpressionParser,\n    observerLocator: IObserverLocator,\n    p: IPlatform,\n  ) {\n    this._exprParser = exprParser;\n    this._observerLocator = observerLocator;\n    this._platform = p;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: IController,\n    instruction: InterpolationInstruction,\n  ): void {\n    const container = renderingCtrl.container;\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.Interpolation);\n    const binding = new InterpolationBinding(\n      this._observerLocator,\n      expr,\n      getTarget(target),\n      instruction.to,\n      BindingMode.toView,\n      container,\n      this._platform.domWriteQueue,\n    );\n    const partBindings = binding.partBindings;\n    const ii = partBindings.length;\n    let i = 0;\n    let partBinding: InterpolationPartBinding;\n    for (; ii > i; ++i) {\n      partBinding = partBindings[i];\n      if (partBinding.sourceExpression.$kind === ExpressionKind.BindingBehavior) {\n        partBindings[i] = applyBindingBehavior(\n          partBinding,\n          partBinding.sourceExpression as unknown as IsBindingBehavior,\n          container\n        );\n      }\n    }\n    renderingCtrl.addBinding(binding);\n  }\n}\n\n@renderer(InstructionType.propertyBinding)\n/** @internal */\nexport class PropertyBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator, IPlatform];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n  /** @internal */ private readonly _observerLocator: IObserverLocator;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(\n    exprParser: IExpressionParser,\n    observerLocator: IObserverLocator,\n    p: IPlatform,\n  ) {\n    this._exprParser = exprParser;\n    this._observerLocator = observerLocator;\n    this._platform = p;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: IController,\n    instruction: PropertyBindingInstruction,\n  ): void {\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.IsProperty);\n    const binding = new PropertyBinding(expr, getTarget(target), instruction.to, instruction.mode, this._observerLocator, renderingCtrl.container, this._platform.domWriteQueue);\n    renderingCtrl.addBinding(expr.$kind === ExpressionKind.BindingBehavior\n      ? applyBindingBehavior(binding, expr, renderingCtrl.container)\n      : binding\n    );\n  }\n}\n\n@renderer(InstructionType.iteratorBinding)\n/** @internal */\nexport class IteratorBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator, IPlatform];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n  /** @internal */ private readonly _observerLocator: IObserverLocator;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(\n    exprParser: IExpressionParser,\n    observerLocator: IObserverLocator,\n    p: IPlatform,\n  ) {\n    this._exprParser = exprParser;\n    this._observerLocator = observerLocator;\n    this._platform = p;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: IController,\n    instruction: IteratorBindingInstruction,\n  ): void {\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.IsIterator);\n    const binding = new PropertyBinding(expr, getTarget(target), instruction.to, BindingMode.toView, this._observerLocator, renderingCtrl.container, this._platform.domWriteQueue);\n    renderingCtrl.addBinding(expr.iterable.$kind === ExpressionKind.BindingBehavior\n      ? applyBindingBehavior(binding, expr.iterable, renderingCtrl.container)\n      : binding);\n  }\n}\n\nlet behaviorExpressionIndex = 0;\nconst behaviorExpressions: BindingBehaviorExpression[] = [];\n\nexport function applyBindingBehavior<T extends IInterceptableBinding>(\n  binding: T,\n  expression: IsBindingBehavior,\n  locator: IServiceLocator,\n): T {\n  while (expression instanceof BindingBehaviorExpression) {\n    behaviorExpressions[behaviorExpressionIndex++] = expression;\n    expression = expression.expression;\n  }\n  while (behaviorExpressionIndex > 0) {\n    const behaviorExpression = behaviorExpressions[--behaviorExpressionIndex];\n    const behaviorOrFactory = locator.get<BindingBehaviorFactory | BindingBehaviorInstance>(behaviorExpression.behaviorKey);\n    if (behaviorOrFactory instanceof BindingBehaviorFactory) {\n      binding = behaviorOrFactory.construct(binding, behaviorExpression) as T;\n    }\n  }\n  behaviorExpressions.length = 0;\n  return binding;\n}\n\n@renderer(InstructionType.textBinding)\n/** @internal */\nexport class TextBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator, IPlatform];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n  /** @internal */ private readonly _observerLocator: IObserverLocator;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(\n    exprParser: IExpressionParser,\n    observerLocator: IObserverLocator,\n    p: IPlatform,\n  ) {\n    this._exprParser = exprParser;\n    this._observerLocator = observerLocator;\n    this._platform = p;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: ChildNode,\n    instruction: TextBindingInstruction,\n  ): void {\n    const container = renderingCtrl.container;\n    const next = target.nextSibling!;\n    const parent = target.parentNode!;\n    const doc = this._platform.document;\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.Interpolation);\n    const staticParts = expr.parts;\n    const dynamicParts = expr.expressions;\n\n    const ii = dynamicParts.length;\n    let i = 0;\n    let text = staticParts[0];\n    let binding: ContentBinding;\n    let part: IsBindingBehavior;\n    if (text !== '') {\n      parent.insertBefore(doc.createTextNode(text), next);\n    }\n    for (; ii > i; ++i) {\n      part = dynamicParts[i];\n      binding = new ContentBinding(\n        part,\n        // using a text node instead of comment, as a mean to:\n        // support seamless transition between a html node, or a text\n        // reduce the noise in the template, caused by html comment\n        parent.insertBefore(doc.createTextNode(''), next),\n        container,\n        this._observerLocator,\n        this._platform,\n        instruction.strict\n      );\n      renderingCtrl.addBinding(part.$kind === ExpressionKind.BindingBehavior\n        // each of the dynamic expression of an interpolation\n        // will be mapped to a ContentBinding\n        ? applyBindingBehavior(binding, part, container)\n        : binding\n      );\n      // while each of the static part of an interpolation\n      // will just be a text node\n      text = staticParts[i + 1];\n      if (text !== '') {\n        parent.insertBefore(doc.createTextNode(text), next);\n      }\n    }\n    if (target.nodeName === 'AU-M') {\n      target.remove();\n    }\n  }\n}\n\n@renderer(InstructionType.listenerBinding)\n/** @internal */\nexport class ListenerBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IEventDelegator, IPlatform];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n  /** @internal */ private readonly _eventDelegator: IEventDelegator;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(\n    parser: IExpressionParser,\n    eventDelegator: IEventDelegator,\n    p: IPlatform,\n  ) {\n    this._exprParser = parser;\n    this._eventDelegator = eventDelegator;\n    this._platform = p;\n  }\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: HTMLElement,\n    instruction: ListenerBindingInstruction,\n  ): void {\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.IsFunction);\n    const binding = new Listener(this._platform, instruction.to, instruction.strategy, expr, target, instruction.preventDefault, this._eventDelegator, renderingCtrl.container);\n    renderingCtrl.addBinding(expr.$kind === ExpressionKind.BindingBehavior\n      ? applyBindingBehavior(binding, expr, renderingCtrl.container)\n      : binding\n    );\n  }\n}\n\n@renderer(InstructionType.setAttribute)\n/** @internal */\nexport class SetAttributeRenderer implements IRenderer {\n  public render(\n    _: IHydratableController,\n    target: HTMLElement,\n    instruction: SetAttributeInstruction,\n  ): void {\n    target.setAttribute(instruction.to, instruction.value);\n  }\n}\n\n@renderer(InstructionType.setClassAttribute)\nexport class SetClassAttributeRenderer implements IRenderer {\n  public render(\n    _: IHydratableController,\n    target: HTMLElement,\n    instruction: SetClassAttributeInstruction,\n  ): void {\n    addClasses(target.classList, instruction.value);\n  }\n}\n\n@renderer(InstructionType.setStyleAttribute)\nexport class SetStyleAttributeRenderer implements IRenderer {\n  public render(\n    _: IHydratableController,\n    target: HTMLElement,\n    instruction: SetStyleAttributeInstruction,\n  ): void {\n    target.style.cssText += instruction.value;\n  }\n}\n\n@renderer(InstructionType.stylePropertyBinding)\n/** @internal */\nexport class StylePropertyBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator, IPlatform];\n\n  public constructor(\n    /** @internal */ private readonly _exprParser: IExpressionParser,\n    /** @internal */ private readonly _observerLocator: IObserverLocator,\n    /** @internal */ private readonly _platform: IPlatform,\n  ) {}\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: HTMLElement,\n    instruction: StylePropertyBindingInstruction,\n  ): void {\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.IsProperty);\n    const binding = new PropertyBinding(expr, target.style, instruction.to, BindingMode.toView, this._observerLocator, renderingCtrl.container, this._platform.domWriteQueue);\n    renderingCtrl.addBinding(expr.$kind === ExpressionKind.BindingBehavior\n      ? applyBindingBehavior(binding, expr, renderingCtrl.container)\n      : binding\n    );\n  }\n}\n\n@renderer(InstructionType.attributeBinding)\n/** @internal */\nexport class AttributeBindingRenderer implements IRenderer {\n  /** @internal */ protected static inject = [IExpressionParser, IObserverLocator];\n\n  public constructor(\n    /** @internal */ private readonly _exprParser: IExpressionParser,\n    /** @internal */ private readonly _observerLocator: IObserverLocator,\n  ) {}\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: HTMLElement,\n    instruction: AttributeBindingInstruction,\n  ): void {\n    const expr = ensureExpression(this._exprParser, instruction.from, ExpressionType.IsProperty);\n    const binding = new AttributeBinding(\n      expr,\n      target,\n      instruction.attr/* targetAttribute */,\n      instruction.to/* targetKey */,\n      BindingMode.toView,\n      this._observerLocator,\n      renderingCtrl.container\n    );\n    renderingCtrl.addBinding(expr.$kind === ExpressionKind.BindingBehavior\n      ? applyBindingBehavior(binding, expr, renderingCtrl.container)\n      : binding\n    );\n  }\n}\n\n@renderer(InstructionType.spreadBinding)\nexport class SpreadRenderer implements IRenderer {\n  /** @internal */ protected static get inject() { return [ITemplateCompiler, IRendering]; }\n  public constructor(\n    /** @internal */ private readonly _compiler: ITemplateCompiler,\n    /** @internal */ private readonly _rendering: IRendering,\n  ) {}\n\n  public render(\n    renderingCtrl: IHydratableController,\n    target: HTMLElement,\n    _instruction: SpreadBindingInstruction,\n  ): void {\n    const container = renderingCtrl.container;\n    const hydrationContext = container.get(IHydrationContext);\n    const renderers = this._rendering.renderers;\n    const getHydrationContext = (ancestor: number) => {\n      let currentLevel = ancestor;\n      let currentContext: IHydrationContext | undefined = hydrationContext;\n      while (currentContext != null && currentLevel > 0) {\n        currentContext = currentContext.parent;\n        --currentLevel;\n      }\n      if (currentContext == null) {\n        throw new Error('No scope context for spread binding.');\n      }\n      return currentContext as IHydrationContext<object>;\n    };\n    const renderSpreadInstruction = (ancestor: number) => {\n      const context = getHydrationContext(ancestor);\n      const spreadBinding = createSurrogateBinding(context);\n      const instructions = this._compiler.compileSpread(\n        context.controller.definition,\n        context.instruction?.captures ?? emptyArray,\n        context.controller.container,\n        target,\n      );\n      let inst: IInstruction;\n      for (inst of instructions) {\n        switch (inst.type) {\n          case InstructionType.spreadBinding:\n            renderSpreadInstruction(ancestor + 1);\n            break;\n          case InstructionType.spreadElementProp:\n            renderers[(inst as SpreadElementPropBindingInstruction).instructions.type].render(\n              spreadBinding,\n              CustomElement.for(target),\n              (inst as SpreadElementPropBindingInstruction).instructions,\n            );\n            break;\n          default:\n            renderers[inst.type].render(spreadBinding, target, inst);\n        }\n      }\n      renderingCtrl.addBinding(spreadBinding);\n    };\n    renderSpreadInstruction(0);\n  }\n}\n\nclass SpreadBinding implements IBinding {\n  public interceptor = this;\n  public $scope?: Scope | undefined;\n  public isBound: boolean = false;\n  public readonly locator: IServiceLocator;\n\n  public readonly ctrl: ICustomElementController;\n\n  public get container() {\n    return this.locator;\n  }\n\n  public get definition(): CustomElementDefinition | CustomElementDefinition {\n    return this.ctrl.definition;\n  }\n\n  public get isStrictBinding() {\n    return this.ctrl.isStrictBinding;\n  }\n\n  public constructor(\n    /** @internal */ private readonly _innerBindings: IBinding[],\n    /** @internal */ private readonly _hydrationContext: IHydrationContext<object>,\n  ) {\n    this.ctrl = _hydrationContext.controller;\n    this.locator = this.ctrl.container;\n  }\n\n  public $bind(flags: LifecycleFlags, _scope: Scope): void {\n    if (this.isBound) {\n      return;\n    }\n    this.isBound = true;\n    const innerScope = this.$scope = this._hydrationContext.controller.scope.parentScope ?? void 0;\n    if (innerScope == null) {\n      throw new Error('Invalid spreading. Context scope is null/undefined');\n    }\n\n    this._innerBindings.forEach(b => b.$bind(flags, innerScope));\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    this._innerBindings.forEach(b => b.$unbind(flags));\n    this.isBound = false;\n  }\n\n  public addBinding(binding: IBinding) {\n    this._innerBindings.push(binding);\n  }\n\n  public addChild(controller: IController) {\n    if (controller.vmKind !== ViewModelKind.customAttribute) {\n      throw new Error('Spread binding does not support spreading custom attributes/template controllers');\n    }\n    this.ctrl.addChild(controller);\n  }\n}\n\n// http://jsben.ch/7n5Kt\nfunction addClasses(classList: DOMTokenList, className: string): void {\n  const len = className.length;\n  let start = 0;\n  for (let i = 0; i < len; ++i) {\n    if (className.charCodeAt(i) === 0x20) {\n      if (i !== start) {\n        classList.add(className.slice(start, i));\n      }\n      start = i + 1;\n    } else if (i + 1 === len) {\n      classList.add(className.slice(start));\n    }\n  }\n}\n\nconst createSurrogateBinding = (context: IHydrationContext<object>) =>\n  new SpreadBinding([], context) as SpreadBinding & IHydratableController;\nconst controllerProviderName = 'IController';\nconst instructionProviderName = 'IInstruction';\nconst locationProviderName = 'IRenderLocation';\nconst slotInfoProviderName = 'IAuSlotsInfo';\n\nfunction createElementContainer(\n  p: IPlatform,\n  renderingCtrl: IController,\n  host: HTMLElement,\n  instruction: HydrateElementInstruction,\n  location?: IRenderLocation,\n  auSlotsInfo?: IAuSlotsInfo,\n): IContainer {\n  const ctn = renderingCtrl.container.createChild();\n\n  // todo:\n  // both node provider and location provider may not be allowed to throw\n  // if there's no value associated, unlike InstanceProvider\n  // reason being some custom element can have `containerless` attribute on them\n  // causing the host to disappear, and replace by a location instead\n  ctn.registerResolver(\n    p.HTMLElement,\n    ctn.registerResolver(\n      p.Element,\n      ctn.registerResolver(INode, new InstanceProvider('ElementResolver', host))\n    )\n  );\n  ctn.registerResolver(IController, new InstanceProvider(controllerProviderName, renderingCtrl));\n  ctn.registerResolver(IInstruction, new InstanceProvider(instructionProviderName, instruction));\n  ctn.registerResolver(IRenderLocation, location == null\n    ? noLocationProvider\n    : new InstanceProvider(locationProviderName, location));\n  ctn.registerResolver(IViewFactory, noViewFactoryProvider);\n  ctn.registerResolver(IAuSlotsInfo, auSlotsInfo == null\n    ? noAuSlotProvider\n    : new InstanceProvider(slotInfoProviderName, auSlotsInfo)\n  );\n\n  return ctn;\n}\n\nclass ViewFactoryProvider implements IResolver {\n  private readonly f: IViewFactory | null;\n  public get $isResolver(): true { return true; }\n\n  public constructor(\n    /**\n     * The factory instance that this provider will resolves to,\n     * until explicitly overridden by prepare call\n     */\n    factory: IViewFactory | null\n  ) {\n    this.f = factory;\n  }\n\n  public resolve(): IViewFactory {\n    const f = this.f;\n    if (f === null) {\n      if (__DEV__)\n        throw new Error('Cannot resolve ViewFactory before the provider was prepared.');\n      else\n        throw new Error('AUR7055');\n    }\n    if (!isString(f.name) || f.name.length === 0) {\n      if (__DEV__)\n        throw new Error('Cannot resolve ViewFactory without a (valid) name.');\n      else\n        throw new Error('AUR0756');\n    }\n    return f;\n  }\n}\n\nfunction invokeAttribute(\n  p: IPlatform,\n  definition: CustomAttributeDefinition,\n  renderingCtrl: IController,\n  host: HTMLElement,\n  instruction: HydrateAttributeInstruction | HydrateTemplateController,\n  viewFactory?: IViewFactory,\n  location?: IRenderLocation,\n  auSlotsInfo?: IAuSlotsInfo,\n): ICustomAttributeViewModel {\n  const ctn = renderingCtrl.container.createChild();\n  ctn.registerResolver(\n    p.HTMLElement,\n    ctn.registerResolver(\n      p.Element,\n      ctn.registerResolver(INode, new InstanceProvider('ElementResolver', host))\n    )\n  );\n  renderingCtrl = renderingCtrl instanceof Controller\n    ? renderingCtrl\n    : (renderingCtrl as unknown as SpreadBinding).ctrl;\n  ctn.registerResolver(IController, new InstanceProvider(controllerProviderName, renderingCtrl));\n  ctn.registerResolver(IInstruction, new InstanceProvider<IInstruction>(instructionProviderName, instruction));\n  ctn.registerResolver(IRenderLocation, location == null\n    ? noLocationProvider\n    : new InstanceProvider(locationProviderName, location));\n  ctn.registerResolver(IViewFactory, viewFactory == null\n    ? noViewFactoryProvider\n    : new ViewFactoryProvider(viewFactory));\n  ctn.registerResolver(IAuSlotsInfo, auSlotsInfo == null\n    ? noAuSlotProvider\n    : new InstanceProvider(slotInfoProviderName, auSlotsInfo));\n\n  return ctn.invoke(definition.Type);\n}\n\nconst noLocationProvider = new InstanceProvider<IRenderLocation>(locationProviderName);\nconst noViewFactoryProvider = new ViewFactoryProvider(null);\nconst noAuSlotProvider = new InstanceProvider<IAuSlotsInfo>(slotInfoProviderName, new AuSlotsInfo(emptyArray));\n","import { camelCase, Registration, mergeArrays, firstDefined } from '@aurelia/kernel';\nimport { BindingMode, ExpressionType, DelegationStrategy, IExpressionParser, IsBindingBehavior, registerAliases } from '@aurelia/runtime';\nimport { IAttrMapper } from '../attribute-mapper.js';\nimport {\n  AttributeBindingInstruction,\n  PropertyBindingInstruction,\n  CallBindingInstruction,\n  IteratorBindingInstruction,\n  RefBindingInstruction,\n  ListenerBindingInstruction,\n  SpreadBindingInstruction,\n} from '../renderer.js';\nimport { DefinitionType } from './resources-shared.js';\nimport { appendResourceKey, defineMetadata, getAnnotationKeyFor, getOwnMetadata, getResourceKeyFor } from '../shared.js';\nimport { isString } from '../utilities.js';\n\nimport type {\n  Constructable,\n  IContainer,\n  IResourceKind,\n  ResourceType,\n  ResourceDefinition,\n  PartialResourceDefinition,\n} from '@aurelia/kernel';\nimport type { IInstruction } from '../renderer.js';\nimport type { AttrSyntax } from './attribute-pattern.js';\nimport type { BindableDefinition } from '../bindable.js';\nimport type { CustomAttributeDefinition } from './custom-attribute.js';\nimport type { CustomElementDefinition } from './custom-element.js';\n\n/**\n * Characteristics of a binding command.\n */\nexport const enum CommandType {\n  None       = 0b0_000,\n  // if a binding command is taking over the processing of an attribute\n  // then it should add this flag to its type\n  // which then should be considered by the template compiler to keep the attribute as is in compilation,\n  // instead of normal process: check custom attribute -> check bindable -> command.build()\n  IgnoreAttr = 0b0_001,\n}\n\nexport type PartialBindingCommandDefinition = PartialResourceDefinition<{\n  readonly type?: string | null;\n}>;\n\nexport interface IPlainAttrCommandInfo {\n  readonly node: Element;\n  readonly attr: AttrSyntax;\n  readonly bindable: null;\n  readonly def: null;\n}\n\nexport interface IBindableCommandInfo {\n  readonly node: Element;\n  readonly attr: AttrSyntax;\n  readonly bindable: BindableDefinition;\n  readonly def: CustomAttributeDefinition | CustomElementDefinition;\n}\n\nexport type ICommandBuildInfo = IPlainAttrCommandInfo | IBindableCommandInfo;\n\nexport type BindingCommandInstance<T extends {} = {}> = {\n  type: CommandType;\n  name: string;\n  build(info: ICommandBuildInfo): IInstruction;\n} & T;\n\nexport type BindingCommandType<T extends Constructable = Constructable> = ResourceType<T, BindingCommandInstance, PartialBindingCommandDefinition>;\nexport type BindingCommandKind = IResourceKind<BindingCommandType, BindingCommandDefinition> & {\n  // isType<T>(value: T): value is (T extends Constructable ? BindingCommandType<T> : never);\n  define<T extends Constructable>(name: string, Type: T): BindingCommandType<T>;\n  define<T extends Constructable>(def: PartialBindingCommandDefinition, Type: T): BindingCommandType<T>;\n  define<T extends Constructable>(nameOrDef: string | PartialBindingCommandDefinition, Type: T): BindingCommandType<T>;\n  // getDefinition<T extends Constructable>(Type: T): BindingCommandDefinition<T>;\n  // annotate<K extends keyof PartialBindingCommandDefinition>(Type: Constructable, prop: K, value: PartialBindingCommandDefinition[K]): void;\n  getAnnotation<K extends keyof PartialBindingCommandDefinition>(Type: Constructable, prop: K): PartialBindingCommandDefinition[K];\n};\n\nexport type BindingCommandDecorator = <T extends Constructable>(Type: T) => BindingCommandType<T>;\n\nexport function bindingCommand(name: string): BindingCommandDecorator;\nexport function bindingCommand(definition: PartialBindingCommandDefinition): BindingCommandDecorator;\nexport function bindingCommand(nameOrDefinition: string | PartialBindingCommandDefinition): BindingCommandDecorator {\n  return function (target) {\n    return BindingCommand.define(nameOrDefinition, target);\n  };\n}\n\nexport class BindingCommandDefinition<T extends Constructable = Constructable> implements ResourceDefinition<T, BindingCommandInstance> {\n  private constructor(\n    public readonly Type: BindingCommandType<T>,\n    public readonly name: string,\n    public readonly aliases: readonly string[],\n    public readonly key: string,\n    public readonly type: string | null,\n  ) {}\n\n  public static create<T extends Constructable = Constructable>(\n    nameOrDef: string | PartialBindingCommandDefinition,\n    Type: BindingCommandType<T>,\n  ): BindingCommandDefinition<T> {\n\n    let name: string;\n    let def: PartialBindingCommandDefinition;\n    if (isString(nameOrDef)) {\n      name = nameOrDef;\n      def = { name };\n    } else {\n      name = nameOrDef.name;\n      def = nameOrDef;\n    }\n\n    return new BindingCommandDefinition(\n      Type,\n      firstDefined(getCommandAnnotation(Type, 'name'), name),\n      mergeArrays(getCommandAnnotation(Type, 'aliases'), def.aliases, Type.aliases),\n      getCommandKeyFrom(name),\n      firstDefined(getCommandAnnotation(Type, 'type'), def.type, Type.type, null),\n    );\n  }\n\n  public register(container: IContainer): void {\n    const { Type, key, aliases } = this;\n    Registration.singleton(key, Type).register(container);\n    Registration.aliasTo(key, Type).register(container);\n    registerAliases(aliases, BindingCommand, key, container);\n  }\n}\n\nconst cmdBaseName = getResourceKeyFor('binding-command');\nconst getCommandKeyFrom = (name: string): string => `${cmdBaseName}:${name}`;\nconst getCommandAnnotation = <K extends keyof PartialBindingCommandDefinition>(\n  Type: Constructable,\n  prop: K,\n): PartialBindingCommandDefinition[K] =>\n  getOwnMetadata(getAnnotationKeyFor(prop), Type) as PartialBindingCommandDefinition[K];\n\nexport const BindingCommand = Object.freeze<BindingCommandKind>({\n  name: cmdBaseName,\n  keyFrom: getCommandKeyFrom,\n  // isType<T>(value: T): value is (T extends Constructable ? BindingCommandType<T> : never) {\n  //   return isFunction(value) && hasOwnMetadata(cmdBaseName, value);\n  // },\n  define<T extends Constructable<BindingCommandInstance>>(nameOrDef: string | PartialBindingCommandDefinition, Type: T): T & BindingCommandType<T> {\n    const definition = BindingCommandDefinition.create(nameOrDef, Type as Constructable<BindingCommandInstance>);\n    defineMetadata(cmdBaseName, definition, definition.Type);\n    defineMetadata(cmdBaseName, definition, definition);\n    appendResourceKey(Type, cmdBaseName);\n\n    return definition.Type as BindingCommandType<T>;\n  },\n  // getDefinition<T extends Constructable>(Type: T): BindingCommandDefinition<T> {\n  //   const def = getOwnMetadata(cmdBaseName, Type);\n  //   if (def === void 0) {\n  //     if (__DEV__)\n  //       throw new Error(`No definition found for type ${Type.name}`);\n  //     else\n  //       throw new Error(`AUR0758:${Type.name}`);\n  //   }\n\n  //   return def;\n  // },\n  // annotate<K extends keyof PartialBindingCommandDefinition>(Type: Constructable, prop: K, value: PartialBindingCommandDefinition[K]): void {\n  //   defineMetadata(getAnnotationKeyFor(prop), value, Type);\n  // },\n  getAnnotation: getCommandAnnotation,\n});\n\n@bindingCommand('one-time')\nexport class OneTimeBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.None = CommandType.None;\n  public get name() { return 'one-time'; }\n\n  /** @internal */ protected static inject = [IAttrMapper, IExpressionParser];\n\n  /** @internal */ private readonly _attrMapper: IAttrMapper;\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(m: IAttrMapper, xp: IExpressionParser) {\n    this._attrMapper = m;\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): PropertyBindingInstruction {\n    const attr = info.attr;\n    let target = attr.target;\n    let value = info.attr.rawValue;\n    if (info.bindable == null) {\n      target = this._attrMapper.map(info.node, target)\n        // if the mapper doesn't know how to map it\n        // use the default behavior, which is camel-casing\n        ?? camelCase(target);\n    } else {\n      // if it looks like: <my-el value.bind>\n      // it means        : <my-el value.bind=\"value\">\n      if (value === '' && info.def.type === DefinitionType.Element) {\n        value = camelCase(target);\n      }\n      target = info.bindable.property;\n    }\n    return new PropertyBindingInstruction(this._exprParser.parse(value, ExpressionType.IsProperty), target, BindingMode.oneTime);\n  }\n}\n\n@bindingCommand('to-view')\nexport class ToViewBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.None = CommandType.None;\n  public get name() { return 'to-view'; }\n\n  /** @internal */ protected static inject = [IAttrMapper, IExpressionParser];\n\n  /** @internal */ private readonly _attrMapper: IAttrMapper;\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(attrMapper: IAttrMapper, exprParser: IExpressionParser) {\n    this._attrMapper = attrMapper;\n    this._exprParser = exprParser;\n  }\n\n  public build(info: ICommandBuildInfo): PropertyBindingInstruction {\n    const attr = info.attr;\n    let target = attr.target;\n    let value = info.attr.rawValue;\n    if (info.bindable == null) {\n      target = this._attrMapper.map(info.node, target)\n        // if the mapper doesn't know how to map it\n        // use the default behavior, which is camel-casing\n        ?? camelCase(target);\n    } else {\n      // if it looks like: <my-el value.bind>\n      // it means        : <my-el value.bind=\"value\">\n      if (value === '' && info.def.type === DefinitionType.Element) {\n        value = camelCase(target);\n      }\n      target = info.bindable.property;\n    }\n    return new PropertyBindingInstruction(this._exprParser.parse(value, ExpressionType.IsProperty), target, BindingMode.toView);\n  }\n}\n\n@bindingCommand('from-view')\nexport class FromViewBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.None = CommandType.None;\n  public get name() { return 'from-view'; }\n\n  /** @internal */ protected static inject = [IAttrMapper, IExpressionParser];\n\n  /** @internal */ private readonly _attrMapper: IAttrMapper;\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(m: IAttrMapper, xp: IExpressionParser) {\n    this._attrMapper = m;\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): PropertyBindingInstruction {\n    const attr = info.attr;\n    let target = attr.target;\n    let value = attr.rawValue;\n    if (info.bindable == null) {\n      target = this._attrMapper.map(info.node, target)\n        // if the mapper doesn't know how to map it\n        // use the default behavior, which is camel-casing\n        ?? camelCase(target);\n    } else {\n      // if it looks like: <my-el value.bind>\n      // it means        : <my-el value.bind=\"value\">\n      if (value === '' && info.def.type === DefinitionType.Element) {\n        value = camelCase(target);\n      }\n      target = info.bindable.property;\n    }\n    return new PropertyBindingInstruction(this._exprParser.parse(value, ExpressionType.IsProperty), target, BindingMode.fromView);\n  }\n}\n\n@bindingCommand('two-way')\nexport class TwoWayBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.None = CommandType.None;\n  public get name() { return 'two-way'; }\n\n  /** @internal */ protected static inject = [IAttrMapper, IExpressionParser];\n\n  /** @internal */ private readonly _attrMapper: IAttrMapper;\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(m: IAttrMapper, xp: IExpressionParser) {\n    this._attrMapper = m;\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): PropertyBindingInstruction {\n    const attr = info.attr;\n    let target = attr.target;\n    let value = attr.rawValue;\n    if (info.bindable == null) {\n      target = this._attrMapper.map(info.node, target)\n        // if the mapper doesn't know how to map it\n        // use the default behavior, which is camel-casing\n        ?? camelCase(target);\n    } else {\n      // if it looks like: <my-el value.bind>\n      // it means        : <my-el value.bind=\"value\">\n      if (value === '' && info.def.type === DefinitionType.Element) {\n        value = camelCase(target);\n      }\n      target = info.bindable.property;\n    }\n    return new PropertyBindingInstruction(this._exprParser.parse(value, ExpressionType.IsProperty), target, BindingMode.twoWay);\n  }\n}\n\n@bindingCommand('bind')\nexport class DefaultBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.None = CommandType.None;\n  public get name() { return 'bind'; }\n\n  /** @internal */ protected static inject = [IAttrMapper, IExpressionParser];\n  /** @internal */ private readonly _attrMapper: IAttrMapper;\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(m: IAttrMapper, xp: IExpressionParser) {\n    this._attrMapper = m;\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): PropertyBindingInstruction {\n    type CA = CustomAttributeDefinition;\n    const attr = info.attr;\n    const bindable = info.bindable;\n    let defaultMode: BindingMode;\n    let mode: BindingMode;\n    let target = attr.target;\n    let value = attr.rawValue;\n    if (bindable == null) {\n      mode = this._attrMapper.isTwoWay(info.node, target) ? BindingMode.twoWay : BindingMode.toView;\n      target = this._attrMapper.map(info.node, target)\n        // if the mapper doesn't know how to map it\n        // use the default behavior, which is camel-casing\n        ?? camelCase(target);\n    } else {\n      // if it looks like: <my-el value.bind>\n      // it means        : <my-el value.bind=\"value\">\n      if (value === '' && info.def.type === DefinitionType.Element) {\n        value = camelCase(target);\n      }\n      defaultMode = (info.def as CA).defaultBindingMode;\n      mode = bindable.mode === BindingMode.default || bindable.mode == null\n        ? defaultMode == null || defaultMode === BindingMode.default\n          ? BindingMode.toView\n          : defaultMode\n        : bindable.mode;\n      target = bindable.property;\n    }\n    return new PropertyBindingInstruction(this._exprParser.parse(value, ExpressionType.IsProperty), target, mode);\n  }\n}\n\n@bindingCommand('call')\nexport class CallBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.None = CommandType.None;\n  public get name() { return 'call'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    const target = info.bindable === null\n      ? camelCase(info.attr.target)\n      : info.bindable.property;\n    return new CallBindingInstruction(this._exprParser.parse(info.attr.rawValue, (ExpressionType.IsProperty | ExpressionType.IsFunction) as ExpressionType) as IsBindingBehavior, target);\n  }\n}\n\n@bindingCommand('for')\nexport class ForBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.None = CommandType.None;\n  public get name() { return 'for'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    const target = info.bindable === null\n      ? camelCase(info.attr.target)\n      : info.bindable.property;\n    return new IteratorBindingInstruction(this._exprParser.parse(info.attr.rawValue, ExpressionType.IsIterator), target);\n  }\n}\n\n@bindingCommand('trigger')\nexport class TriggerBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.IgnoreAttr = CommandType.IgnoreAttr;\n  public get name() { return 'trigger'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    return new ListenerBindingInstruction(this._exprParser.parse(info.attr.rawValue, ExpressionType.IsFunction), info.attr.target, true, DelegationStrategy.none);\n  }\n}\n\n@bindingCommand('delegate')\nexport class DelegateBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.IgnoreAttr = CommandType.IgnoreAttr;\n  public get name() { return 'delegate'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    return new ListenerBindingInstruction(this._exprParser.parse(info.attr.rawValue, ExpressionType.IsFunction), info.attr.target, false, DelegationStrategy.bubbling);\n  }\n}\n\n@bindingCommand('capture')\nexport class CaptureBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.IgnoreAttr = CommandType.IgnoreAttr;\n  public get name() { return 'capture'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    return new ListenerBindingInstruction(this._exprParser.parse(info.attr.rawValue, ExpressionType.IsFunction), info.attr.target, false, DelegationStrategy.capturing);\n  }\n}\n\n/**\n * Attr binding command. Compile attr with binding symbol with command `attr` to `AttributeBindingInstruction`\n */\n@bindingCommand('attr')\nexport class AttrBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.IgnoreAttr = CommandType.IgnoreAttr;\n  public get name() { return 'attr'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    return new AttributeBindingInstruction(info.attr.target, this._exprParser.parse(info.attr.rawValue, ExpressionType.IsProperty), info.attr.target);\n  }\n}\n\n/**\n * Style binding command. Compile attr with binding symbol with command `style` to `AttributeBindingInstruction`\n */\n@bindingCommand('style')\nexport class StyleBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.IgnoreAttr = CommandType.IgnoreAttr;\n  public get name() { return 'style'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    return new AttributeBindingInstruction('style', this._exprParser.parse(info.attr.rawValue, ExpressionType.IsProperty), info.attr.target);\n  }\n}\n\n/**\n * Class binding command. Compile attr with binding symbol with command `class` to `AttributeBindingInstruction`\n */\n@bindingCommand('class')\nexport class ClassBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.IgnoreAttr = CommandType.IgnoreAttr;\n  public get name() { return 'class'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    return new AttributeBindingInstruction('class', this._exprParser.parse(info.attr.rawValue, ExpressionType.IsProperty), info.attr.target);\n  }\n}\n\n/**\n * Binding command to refer different targets (element, custom element/attribute view models, controller) attached to an element\n */\n@bindingCommand('ref')\nexport class RefBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType.IgnoreAttr = CommandType.IgnoreAttr;\n  public get name() { return 'ref'; }\n\n  /** @internal */ protected static inject = [IExpressionParser];\n  /** @internal */ private readonly _exprParser: IExpressionParser;\n\n  public constructor(xp: IExpressionParser) {\n    this._exprParser = xp;\n  }\n\n  public build(info: ICommandBuildInfo): IInstruction {\n    return new RefBindingInstruction(this._exprParser.parse(info.attr.rawValue, ExpressionType.IsProperty), info.attr.target);\n  }\n}\n\n@bindingCommand('...$attrs')\nexport class SpreadBindingCommand implements BindingCommandInstance {\n  public readonly type: CommandType = CommandType.IgnoreAttr;\n  public get name(): string { return '...$attrs'; }\n\n  public build(_info: ICommandBuildInfo): IInstruction {\n    return new SpreadBindingInstruction();\n  }\n}\n","import { DI } from '@aurelia/kernel';\nimport { IPlatform } from './platform.js';\nimport { isString } from './utilities.js';\n\n/**\n * Utility that creates a `HTMLTemplateElement` out of string markup or an existing DOM node.\n *\n * It is idempotent in the sense that passing in an existing template element will simply return that template element,\n * so it is always safe to pass in a node without causing unnecessary DOM parsing or template creation.\n */\nexport interface ITemplateElementFactory extends TemplateElementFactory {}\nexport const ITemplateElementFactory = DI.createInterface<ITemplateElementFactory>('ITemplateElementFactory', x => x.singleton(TemplateElementFactory));\n\nconst markupCache: Record<string, HTMLTemplateElement | undefined> = {};\n\nexport class TemplateElementFactory {\n  public static inject = [IPlatform];\n  /** @internal */ private _template: HTMLTemplateElement;\n\n  public constructor(\n    private readonly p: IPlatform,\n  ) {\n    this._template = p.document.createElement('template');\n  }\n\n  public createTemplate(markup: string): HTMLTemplateElement;\n  public createTemplate(node: Node): HTMLTemplateElement;\n  public createTemplate(input: string | Node): HTMLTemplateElement;\n  public createTemplate(input: string | Node): HTMLTemplateElement {\n    if (isString(input)) {\n      let result = markupCache[input];\n      if (result === void 0) {\n        const template = this._template;\n        template.innerHTML = input;\n        const node = template.content.firstElementChild;\n        // if the input is either not wrapped in a template or there is more than one node,\n        // return the whole template that wraps it/them (and create a new one for the next input)\n        if (node == null || node.nodeName !== 'TEMPLATE' || node.nextElementSibling != null) {\n          this._template = this.p.document.createElement('template');\n          result = template;\n        } else {\n          // the node to return is both a template and the only node, so return just the node\n          // and clean up the template for the next input\n          template.content.removeChild(node);\n          result = node as HTMLTemplateElement;\n        }\n\n        markupCache[input] = result;\n      }\n\n      return result.cloneNode(true) as HTMLTemplateElement;\n    }\n    if (input.nodeName !== 'TEMPLATE') {\n      // if we get one node that is not a template, wrap it in one\n      const template = this.p.document.createElement('template');\n      template.content.appendChild(input);\n      return template;\n    }\n    // we got a template element, remove it from the DOM if it's present there and don't\n    // do any other processing\n    input.parentNode?.removeChild(input);\n    return input.cloneNode(true) as HTMLTemplateElement;\n  }\n}\n","import { DI, Resolved } from '@aurelia/kernel';\n\nimport type {\n  Constructable,\n  IContainer,\n  IResolver,\n  Key,\n} from '@aurelia/kernel';\n\n// todo: replace existing resource code with this resolver\n// ===================\n// export const resource = function <T extends Key>(key: T) {\n//   function Resolver(target: Injectable, property?: string | number, descriptor?: PropertyDescriptor | number) {\n//     DI.inject(Resolver)(target, property, descriptor);\n//   }\n//   Resolver.$isResolver = true;\n//   Resolver.resolve = function (handler: IContainer, requestor: IContainer) {\n//     if (/* is root? */requestor.root === requestor) {\n//       return requestor.get(key);\n//     }\n\n//     return requestor.has(key, false)\n//       ? requestor.get(key)\n//       : requestor.root.get(key);\n//   };\n//   return Resolver as IResolver<T> & ((...args: unknown[]) => any);\n// };\n\n/**\n * A resolver builder for resolving all registrations of a key\n * with resource semantic (leaf + root + ignore middle layer container)\n */\nexport const allResources = function <T extends Key>(key: T) {\n  function Resolver(target: Constructable, property?: string | number, descriptor?: PropertyDescriptor | number) {\n    DI.inject(Resolver)(target, property, descriptor);\n  }\n  Resolver.$isResolver = true;\n  Resolver.resolve = function (handler: IContainer, requestor: IContainer) {\n    if (/* is root? */requestor.root === requestor) {\n      return requestor.getAll(key, false);\n    }\n\n    return requestor.has(key, false)\n      ? requestor.getAll(key, false).concat(requestor.root.getAll(key, false))\n      : requestor.root.getAll(key, false);\n  };\n  return Resolver as IResolver<Resolved<T>[]> & ((...args: unknown[]) => any);\n};\n","import { DI, emptyArray, Registration, toArray, ILogger, camelCase, ResourceDefinition, ResourceType, noop, Key } from '@aurelia/kernel';\nimport { BindingMode, ExpressionType, Char, IExpressionParser, PrimitiveLiteralExpression } from '@aurelia/runtime';\nimport { IAttrMapper } from './attribute-mapper.js';\nimport { ITemplateElementFactory } from './template-element-factory.js';\nimport {\n  HydrateAttributeInstruction,\n  HydrateElementInstruction,\n  HydrateLetElementInstruction,\n  HydrateTemplateController,\n  InterpolationInstruction,\n  LetBindingInstruction,\n  SetAttributeInstruction,\n  SetClassAttributeInstruction,\n  SetPropertyInstruction,\n  SetStyleAttributeInstruction,\n  TextBindingInstruction,\n  ITemplateCompiler,\n  PropertyBindingInstruction,\n  SpreadElementPropBindingInstruction,\n} from './renderer.js';\nimport { IPlatform } from './platform.js';\nimport { Bindable, BindableDefinition } from './bindable.js';\nimport { AttrSyntax, IAttributeParser } from './resources/attribute-pattern.js';\nimport { CustomAttribute } from './resources/custom-attribute.js';\nimport { CustomElement, CustomElementDefinition, CustomElementType } from './resources/custom-element.js';\nimport { BindingCommand, CommandType } from './resources/binding-command.js';\nimport { createLookup, isString } from './utilities.js';\nimport { allResources } from './utilities-di.js';\nimport { appendResourceKey, defineMetadata, getResourceKeyFor } from './shared.js';\n\nimport type {\n  IContainer,\n  IResolver,\n  Constructable,\n  Writable,\n} from '@aurelia/kernel';\nimport type { AnyBindingExpression } from '@aurelia/runtime';\nimport type { CustomAttributeDefinition } from './resources/custom-attribute.js';\nimport type { PartialCustomElementDefinition } from './resources/custom-element.js';\nimport type { IProjections } from './resources/slot-injectables.js';\nimport type { BindingCommandInstance, ICommandBuildInfo } from './resources/binding-command.js';\nimport type { ICompliationInstruction, IInstruction, } from './renderer.js';\n\nexport class TemplateCompiler implements ITemplateCompiler {\n  public static register(container: IContainer): IResolver<ITemplateCompiler> {\n    return Registration.singleton(ITemplateCompiler, this).register(container);\n  }\n\n  public debug: boolean = false;\n  public resolveResources: boolean = true;\n\n  public compile(\n    partialDefinition: PartialCustomElementDefinition,\n    container: IContainer,\n    compilationInstruction: ICompliationInstruction | null,\n  ): CustomElementDefinition {\n    const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n    if (definition.template === null || definition.template === void 0) {\n      return definition;\n    }\n    if (definition.needsCompile === false) {\n      return definition;\n    }\n    compilationInstruction ??= emptyCompilationInstructions;\n\n    const context = new CompilationContext(partialDefinition, container, compilationInstruction, null, null, void 0);\n    const template = isString(definition.template) || !partialDefinition.enhance\n      ? context._templateFactory.createTemplate(definition.template)\n      : definition.template as HTMLElement;\n    const isTemplateElement = template.nodeName === 'TEMPLATE' && (template as HTMLTemplateElement).content != null;\n    const content = isTemplateElement ? (template as HTMLTemplateElement).content : template;\n    const hooks = container.get(allResources(ITemplateCompilerHooks));\n    const ii = hooks.length;\n    let i = 0;\n    if (ii > 0) {\n      while (ii > i) {\n        hooks[i].compiling?.(template);\n        ++i;\n      }\n    }\n\n    if (template.hasAttribute(localTemplateIdentifier)) {\n      if (__DEV__)\n        throw new Error('The root cannot be a local template itself.');\n      else\n        throw new Error('AUR0701');\n    }\n    this._compileLocalElement(content, context);\n    this._compileNode(content, context);\n\n    return CustomElementDefinition.create({\n      ...partialDefinition,\n      name: partialDefinition.name || _generateElementName(),\n      dependencies: (partialDefinition.dependencies ?? emptyArray).concat(context.deps ?? emptyArray),\n      instructions: context.rows,\n      surrogates: isTemplateElement\n        ? this._compileSurrogate(template, context)\n        : emptyArray,\n      template,\n      hasSlots: context.hasSlot,\n      needsCompile: false,\n    });\n  }\n\n  public compileSpread(\n    definition: CustomElementDefinition,\n    attrSyntaxs: AttrSyntax[],\n    container: IContainer,\n    el: Element,\n  ): IInstruction[] {\n    const context = new CompilationContext(definition, container, emptyCompilationInstructions, null, null, void 0);\n    const instructions: IInstruction[] = [];\n    const elDef = context._findElement(el.nodeName.toLowerCase());\n    const exprParser = context._exprParser;\n    const ii = attrSyntaxs.length;\n    let i = 0;\n    let attrSyntax: AttrSyntax;\n    let attrDef: CustomAttributeDefinition | null = null;\n    let attrInstructions: (HydrateAttributeInstruction | HydrateTemplateController)[] | undefined;\n    let attrBindableInstructions: IInstruction[];\n    // eslint-disable-next-line\n    let bindablesInfo: BindablesInfo<0> | BindablesInfo<1>;\n    let bindable: BindableDefinition;\n    let primaryBindable: BindableDefinition;\n    let bindingCommand: BindingCommandInstance | null = null;\n    let expr: AnyBindingExpression;\n    let isMultiBindings: boolean;\n    let attrTarget: string;\n    let attrValue: string;\n\n    for (; ii > i; ++i) {\n      attrSyntax = attrSyntaxs[i];\n\n      attrTarget = attrSyntax.target;\n      attrValue = attrSyntax.rawValue;\n\n      bindingCommand = context._createCommand(attrSyntax);\n      if (bindingCommand !== null && (bindingCommand.type & CommandType.IgnoreAttr) > 0) {\n        // when the binding command overrides everything\n        // just pass the target as is to the binding command, and treat it as a normal attribute:\n        // active.class=\"...\"\n        // background.style=\"...\"\n        // my-attr.attr=\"...\"\n\n        commandBuildInfo.node = el;\n        commandBuildInfo.attr = attrSyntax;\n        commandBuildInfo.bindable = null;\n        commandBuildInfo.def = null;\n        instructions.push(bindingCommand.build(commandBuildInfo));\n\n        // to next attribute\n        continue;\n      }\n\n      attrDef = context._findAttr(attrTarget);\n      if (attrDef !== null) {\n        if (attrDef.isTemplateController) {\n          if (__DEV__)\n            throw new Error(`Spreading template controller ${attrTarget} is not supported.`);\n          else\n            throw new Error(`AUR0703:${attrTarget}`);\n        }\n        bindablesInfo = BindablesInfo.from(attrDef, true);\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has explicit configuration noMultiBindings: false\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax.\n        //          Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        isMultiBindings = attrDef.noMultiBindings === false\n          && bindingCommand === null\n          && hasInlineBindings(attrValue);\n        if (isMultiBindings) {\n          attrBindableInstructions = this._compileMultiBindings(el, attrValue, attrDef, context);\n        } else {\n          primaryBindable = bindablesInfo.primary;\n          // custom attribute + single value + WITHOUT binding command:\n          // my-attr=\"\"\n          // my-attr=\"${}\"\n          if (bindingCommand === null) {\n            expr = exprParser.parse(attrValue, ExpressionType.Interpolation);\n            attrBindableInstructions = [\n              expr === null\n                ? new SetPropertyInstruction(attrValue, primaryBindable.property)\n                : new InterpolationInstruction(expr, primaryBindable.property)\n            ];\n          } else {\n            // custom attribute with binding command:\n            // my-attr.bind=\"...\"\n            // my-attr.two-way=\"...\"\n\n            commandBuildInfo.node = el;\n            commandBuildInfo.attr = attrSyntax;\n            commandBuildInfo.bindable = primaryBindable;\n            commandBuildInfo.def = attrDef;\n            attrBindableInstructions = [bindingCommand.build(commandBuildInfo)];\n          }\n        }\n\n        (attrInstructions ??= []).push(new HydrateAttributeInstruction(\n          // todo: def/ def.Type or def.name should be configurable\n          //       example: AOT/runtime can use def.Type, but there are situation\n          //       where instructions need to be serialized, def.name should be used\n          this.resolveResources ? attrDef : attrDef.name,\n          attrDef.aliases != null && attrDef.aliases.includes(attrTarget) ? attrTarget : void 0,\n          attrBindableInstructions\n        ));\n        continue;\n      }\n\n      if (bindingCommand === null) {\n        expr = exprParser.parse(attrValue, ExpressionType.Interpolation);\n\n        // reaching here means:\n        // + maybe a bindable attribute with interpolation\n        // + maybe a plain attribute with interpolation\n        // + maybe a plain attribute\n        if (elDef !== null) {\n          bindablesInfo = BindablesInfo.from(elDef, false);\n          bindable = bindablesInfo.attrs[attrTarget];\n          if (bindable !== void 0) {\n            expr = exprParser.parse(attrValue, ExpressionType.Interpolation);\n            instructions.push(\n              new SpreadElementPropBindingInstruction(\n                expr == null\n                  ? new SetPropertyInstruction(attrValue, bindable.property)\n                  : new InterpolationInstruction(expr, bindable.property)\n              )\n            );\n\n            continue;\n          }\n        }\n\n        if (expr != null) {\n          instructions.push(new InterpolationInstruction(\n            expr,\n            // if not a bindable, then ensure plain attribute are mapped correctly:\n            // e.g: colspan -> colSpan\n            //      innerhtml -> innerHTML\n            //      minlength -> minLength etc...\n            context._attrMapper.map(el, attrTarget) ?? camelCase(attrTarget)\n          ));\n        } else {\n          switch (attrTarget) {\n            case 'class':\n              instructions.push(new SetClassAttributeInstruction(attrValue));\n              break;\n            case 'style':\n              instructions.push(new SetStyleAttributeInstruction(attrValue));\n              break;\n            default:\n              // if not a custom attribute + no binding command + not a bindable + not an interpolation\n              // then it's just a plain attribute\n              instructions.push(new SetAttributeInstruction(attrValue, attrTarget));\n          }\n        }\n      } else {\n        if (elDef !== null) {\n          // if the element is a custom element\n          // - prioritize bindables on a custom element before plain attributes\n          bindablesInfo = BindablesInfo.from(elDef, false);\n          bindable = bindablesInfo.attrs[attrTarget];\n          if (bindable !== void 0) {\n            commandBuildInfo.node = el;\n            commandBuildInfo.attr = attrSyntax;\n            commandBuildInfo.bindable = bindable;\n            commandBuildInfo.def = elDef;\n            instructions.push(new SpreadElementPropBindingInstruction(bindingCommand.build(commandBuildInfo)));\n            continue;\n          }\n        }\n\n        commandBuildInfo.node = el;\n        commandBuildInfo.attr = attrSyntax;\n        commandBuildInfo.bindable = null;\n        commandBuildInfo.def = null;\n        instructions.push(bindingCommand.build(commandBuildInfo));\n      }\n    }\n\n    resetCommandBuildInfo();\n\n    if (attrInstructions != null) {\n      return (attrInstructions as IInstruction[]).concat(instructions);\n    }\n\n    return instructions;\n  }\n\n  /** @internal */\n  private _compileSurrogate(el: Element, context: CompilationContext): IInstruction[] {\n    const instructions: IInstruction[] = [];\n    const attrs = el.attributes;\n    const exprParser = context._exprParser;\n    let ii = attrs.length;\n    let i = 0;\n    let attr: Attr;\n    let attrName: string;\n    let attrValue: string;\n    let attrSyntax: AttrSyntax;\n    let attrDef: CustomAttributeDefinition | null = null;\n    let attrInstructions: HydrateAttributeInstruction[] | undefined;\n    let attrBindableInstructions: IInstruction[];\n    // eslint-disable-next-line\n    let bindableInfo: BindablesInfo<0> | BindablesInfo<1>;\n    let primaryBindable: BindableDefinition;\n    let bindingCommand: BindingCommandInstance | null = null;\n    let expr: AnyBindingExpression;\n    let isMultiBindings: boolean;\n    let realAttrTarget: string;\n    let realAttrValue: string;\n\n    for (; ii > i; ++i) {\n      attr = attrs[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n      attrSyntax = context._attrParser.parse(attrName, attrValue);\n\n      realAttrTarget = attrSyntax.target;\n      realAttrValue = attrSyntax.rawValue;\n\n      if (invalidSurrogateAttribute[realAttrTarget]) {\n        if (__DEV__)\n          throw new Error(`Attribute ${attrName} is invalid on surrogate.`);\n        else\n          throw new Error(`AUR0702:${attrName}`);\n      }\n\n      bindingCommand = context._createCommand(attrSyntax);\n      if (bindingCommand !== null && (bindingCommand.type & CommandType.IgnoreAttr) > 0) {\n        // when the binding command overrides everything\n        // just pass the target as is to the binding command, and treat it as a normal attribute:\n        // active.class=\"...\"\n        // background.style=\"...\"\n        // my-attr.attr=\"...\"\n\n        commandBuildInfo.node = el;\n        commandBuildInfo.attr = attrSyntax;\n        commandBuildInfo.bindable = null;\n        commandBuildInfo.def = null;\n        instructions.push(bindingCommand.build(commandBuildInfo));\n\n        // to next attribute\n        continue;\n      }\n\n      attrDef = context._findAttr(realAttrTarget);\n      if (attrDef !== null) {\n        if (attrDef.isTemplateController) {\n          if (__DEV__)\n            throw new Error(`Template controller ${realAttrTarget} is invalid on surrogate.`);\n          else\n            throw new Error(`AUR0703:${realAttrTarget}`);\n        }\n        bindableInfo = BindablesInfo.from(attrDef, true);\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has explicit configuration noMultiBindings: false\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax.\n        //          Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        isMultiBindings = attrDef.noMultiBindings === false\n          && bindingCommand === null\n          && hasInlineBindings(realAttrValue);\n        if (isMultiBindings) {\n          attrBindableInstructions = this._compileMultiBindings(el, realAttrValue, attrDef, context);\n        } else {\n          primaryBindable = bindableInfo.primary;\n          // custom attribute + single value + WITHOUT binding command:\n          // my-attr=\"\"\n          // my-attr=\"${}\"\n          if (bindingCommand === null) {\n            expr = exprParser.parse(realAttrValue, ExpressionType.Interpolation);\n            attrBindableInstructions = [\n              expr === null\n                ? new SetPropertyInstruction(realAttrValue, primaryBindable.property)\n                : new InterpolationInstruction(expr, primaryBindable.property)\n            ];\n          } else {\n            // custom attribute with binding command:\n            // my-attr.bind=\"...\"\n            // my-attr.two-way=\"...\"\n\n            commandBuildInfo.node = el;\n            commandBuildInfo.attr = attrSyntax;\n            commandBuildInfo.bindable = primaryBindable;\n            commandBuildInfo.def = attrDef;\n            attrBindableInstructions = [bindingCommand.build(commandBuildInfo)];\n          }\n        }\n\n        el.removeAttribute(attrName);\n        --i;\n        --ii;\n        (attrInstructions ??= []).push(new HydrateAttributeInstruction(\n          // todo: def/ def.Type or def.name should be configurable\n          //       example: AOT/runtime can use def.Type, but there are situation\n          //       where instructions need to be serialized, def.name should be used\n          this.resolveResources ? attrDef : attrDef.name,\n          attrDef.aliases != null && attrDef.aliases.includes(realAttrTarget) ? realAttrTarget : void 0,\n          attrBindableInstructions\n        ));\n        continue;\n      }\n\n      if (bindingCommand === null) {\n        expr = exprParser.parse(realAttrValue, ExpressionType.Interpolation);\n        if (expr != null) {\n          el.removeAttribute(attrName);\n          --i;\n          --ii;\n\n          instructions.push(new InterpolationInstruction(\n            expr,\n            // if not a bindable, then ensure plain attribute are mapped correctly:\n            // e.g: colspan -> colSpan\n            //      innerhtml -> innerHTML\n            //      minlength -> minLength etc...\n            context._attrMapper.map(el, realAttrTarget) ?? camelCase(realAttrTarget)\n          ));\n        } else {\n          switch (attrName) {\n            case 'class':\n              instructions.push(new SetClassAttributeInstruction(realAttrValue));\n              break;\n            case 'style':\n              instructions.push(new SetStyleAttributeInstruction(realAttrValue));\n              break;\n            default:\n              // if not a custom attribute + no binding command + not a bindable + not an interpolation\n              // then it's just a plain attribute\n              instructions.push(new SetAttributeInstruction(realAttrValue, attrName));\n          }\n        }\n      } else {\n\n        commandBuildInfo.node = el;\n        commandBuildInfo.attr = attrSyntax;\n        commandBuildInfo.bindable = null;\n        commandBuildInfo.def = null;\n        instructions.push(bindingCommand.build(commandBuildInfo));\n      }\n    }\n\n    resetCommandBuildInfo();\n\n    if (attrInstructions != null) {\n      return (attrInstructions as IInstruction[]).concat(instructions);\n    }\n\n    return instructions;\n  }\n\n  // overall flow:\n  // each of the method will be responsible for compiling its corresponding node type\n  // and it should return the next node to be compiled\n  /** @internal */\n  private _compileNode(node: Node, context: CompilationContext): Node | null {\n    switch (node.nodeType) {\n      case 1:\n        switch (node.nodeName) {\n          case 'LET':\n            return this._compileLet(node as Element, context);\n          // ------------------------------------\n          // todo: possible optimization:\n          // when two conditions below are met:\n          // 1. there's no attribute on au slot,\n          // 2. there's no projection\n          //\n          // -> flatten the au-slot into children as this is just a static template\n          // ------------------------------------\n          // case 'AU-SLOT':\n          //   return this.auSlot(node as Element, container, context);\n          default:\n            return this._compileElement(node as Element, context);\n        }\n      case 3:\n        return this._compileText(node as Text, context);\n      case 11: {\n        let current: Node | null = (node as DocumentFragment).firstChild;\n        while (current !== null) {\n          current = this._compileNode(current, context);\n        }\n        break;\n      }\n    }\n    return node.nextSibling;\n  }\n\n  /** @internal */\n  private _compileLet(el: Element, context: CompilationContext): Node | null {\n    const attrs = el.attributes;\n    const ii = attrs.length;\n    const letInstructions: LetBindingInstruction[] = [];\n    const exprParser = context._exprParser;\n    let toBindingContext = false;\n    let i = 0;\n    let attr: Attr;\n    let attrSyntax: AttrSyntax;\n    let attrName: string;\n    let attrValue: string;\n    let bindingCommand: BindingCommandInstance | null;\n    let realAttrTarget: string;\n    let realAttrValue: string;\n    let expr: AnyBindingExpression;\n\n    for (; ii > i; ++i) {\n      attr = attrs[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n      if (attrName === 'to-binding-context') {\n        toBindingContext = true;\n        continue;\n      }\n\n      attrSyntax = context._attrParser.parse(attrName, attrValue);\n      realAttrTarget = attrSyntax.target;\n      realAttrValue = attrSyntax.rawValue;\n\n      bindingCommand = context._createCommand(attrSyntax);\n      if (bindingCommand !== null) {\n        // supporting one time may not be as simple as it appears\n        // as the let expression could compute its value from various expressions,\n        // which means some value could be unavailable by the time it computes.\n        //\n        // Onetime means it will not have appropriate value, but it's also a good thing,\n        // since often one it's just a simple declaration\n        // todo: consider supporting one-time for <let>\n        switch (bindingCommand.name) {\n          case 'to-view':\n          case 'bind':\n            letInstructions.push(new LetBindingInstruction(\n              exprParser.parse(realAttrValue, ExpressionType.IsProperty),\n              camelCase(realAttrTarget)\n            ));\n            continue;\n          default:\n            if (__DEV__)\n              throw new Error(`Invalid command ${attrSyntax.command} for <let>. Only to-view/bind supported.`);\n            else\n              throw new Error(`AUR0704:${attrSyntax.command}`);\n        }\n      }\n\n      expr = exprParser.parse(realAttrValue, ExpressionType.Interpolation);\n      if (expr === null) {\n        if (__DEV__) {\n          context._logger.warn(\n            `Property ${realAttrTarget} is declared with literal string ${realAttrValue}. ` +\n            `Did you mean ${realAttrTarget}.bind=\"${realAttrValue}\"?`\n          );\n        }\n      }\n\n      letInstructions.push(new LetBindingInstruction(\n        expr === null ? new PrimitiveLiteralExpression(realAttrValue) : expr,\n        camelCase(realAttrTarget)\n      ));\n    }\n    context.rows.push([new HydrateLetElementInstruction(letInstructions, toBindingContext)]);\n    // probably no need to replace\n    // as the let itself can be used as is\n    // though still need to mark el as target to ensure the instruction is matched with a target\n    return this._markAsTarget(el).nextSibling;\n  }\n\n  /** @internal */\n  // eslint-disable-next-line\n  private _compileElement(el: Element, context: CompilationContext): Node | null {\n    // overall, the template compiler does it job by compiling one node,\n    // and let that the process of compiling that node point to the next node to be compiled.\n    // ----------------------------------------\n    // a summary of this 650 line long function:\n    // 1. walk through all attributes to put them into their corresponding instruction groups\n    //    template controllers      -> list 1\n    //    custom attributes         -> list 2\n    //    plain attrs with bindings -> list 3\n    //    el bindables              -> list 4\n    // 2. ensure element instruction is present\n    //    2.1.\n    //      if element is an <au-slot/> compile its content into auSlot property of the element instruction created\n    // 3. sort instructions:\n    //    hydrate custom element instruction\n    //    hydrate custom attribute instructions\n    //    rest kept as is (except special cases & to-be-decided)\n    //    3.1\n    //      mark this element as a target for later hydration\n    // 4. Compiling child nodes of this element\n    //    4.1.\n    //      If 1 or more [Template controller]:\n    //      4.1.1.\n    //          Start processing the most inner (most right TC in list 1) similarly to step 4.2:\n    //          4.1.1.0.\n    //          let innerContext = context.createChild();\n    //          4.1.1.1.\n    //              walks through the child nodes, and perform a [au-slot] check\n    //              - if this is a custom element, then extract all [au-slot] annotated elements into corresponding templates by their target slot name\n    //              - else throw an error as [au-slot] is used on non-custom-element\n    //          4.1.1.2.\n    //              recursively compiles the child nodes into the innerContext\n    //      4.1.2.\n    //          Start processing other Template controllers by walking the TC list (list 1) RIGHT -> LEFT\n    //          Explanation:\n    //              If there' are multiple template controllers on an element,\n    //              only the most inner template controller will have access to the template with the current element\n    //              other \"outer\" template controller will only need to see a marker pointing to a definition of the inner one\n    //    4.2.\n    //      NO [Template controller]\n    //      4.2.1.\n    //          walks through the child nodes, and perform a [au-slot] check\n    //          - if this is a custom element, then extract all [au-slot] annotated elements into corresponding templates by their target slot name\n    //          - else throw an error as [au-slot] is used on non-custom-element\n    //      4.2.2\n    //          recursively compiles the child nodes into the current context\n    // 5. Returning the next node for the compilation\n    const nextSibling = el.nextSibling;\n    const elName = (el.getAttribute('as-element') ?? el.nodeName).toLowerCase();\n    const elDef = context._findElement(elName);\n    const shouldCapture = !!elDef?.capture;\n    const captures: AttrSyntax[] = shouldCapture ? [] : emptyArray;\n    const exprParser = context._exprParser;\n    const removeAttr = this.debug\n      ? noop\n      : () => {\n        el.removeAttribute(attrName);\n        --i;\n        --ii;\n      };\n    let attrs = el.attributes;\n    let instructions: IInstruction[] | undefined;\n    let ii = attrs.length;\n    let i = 0;\n    let attr: Attr;\n    let attrName: string;\n    let attrValue: string;\n    let attrSyntax: AttrSyntax;\n    let plainAttrInstructions: IInstruction[] | undefined;\n    let elBindableInstructions: IInstruction[] | undefined;\n    let attrDef: CustomAttributeDefinition | null = null;\n    let isMultiBindings = false;\n    let bindable: BindableDefinition;\n    let attrInstructions: HydrateAttributeInstruction[] | undefined;\n    let attrBindableInstructions: IInstruction[];\n    let tcInstructions: HydrateTemplateController[] | undefined;\n    let tcInstruction: HydrateTemplateController | undefined;\n    let expr: AnyBindingExpression;\n    let elementInstruction: HydrateElementInstruction | undefined;\n    let bindingCommand: BindingCommandInstance | null = null;\n    // eslint-disable-next-line\n    let bindablesInfo: BindablesInfo<0> | BindablesInfo<1>;\n    let primaryBindable: BindableDefinition;\n    let realAttrTarget: string;\n    let realAttrValue: string;\n    let processContentResult: boolean | undefined | void = true;\n    let hasContainerless = false;\n\n    if (elName === 'slot') {\n      context.root.hasSlot = true;\n    }\n    if (elDef !== null) {\n      // todo: this is a bit ... powerful\n      // maybe do not allow it to process its own attributes\n      processContentResult = elDef.processContent?.call(elDef.Type, el, context.p);\n      // might have changed during the process\n      attrs = el.attributes;\n      ii = attrs.length;\n    }\n\n    if (context.root.def.enhance && el.classList.contains('au')) {\n      if (__DEV__)\n        throw new Error(\n          'Trying to enhance with a template that was probably compiled before. '\n          + 'This is likely going to cause issues. '\n          + 'Consider enhancing only untouched elements or first remove all \"au\" classes.'\n        );\n      else\n        throw new Error(`AUR0705`);\n    }\n\n    // 1. walk and compile through all attributes\n    //    for each of them, put in appropriate group.\n    //    ex. plain attr with binding -> plain attr instruction list\n    //        template controller     -> tc instruction list\n    //        custom attribute        -> ca instruction list\n    //        el bindable attribute   -> el bindable instruction list\n    for (; ii > i; ++i) {\n      attr = attrs[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n      switch (attrName) {\n        case 'as-element':\n        case 'containerless':\n          removeAttr();\n          if (!hasContainerless) {\n            hasContainerless = attrName === 'containerless';\n          }\n          continue;\n      }\n\n      attrSyntax = context._attrParser.parse(attrName, attrValue);\n      bindingCommand = context._createCommand(attrSyntax);\n\n      realAttrTarget = attrSyntax.target;\n      realAttrValue = attrSyntax.rawValue;\n\n      if (shouldCapture) {\n        if (bindingCommand != null && bindingCommand.type & CommandType.IgnoreAttr) {\n          removeAttr();\n          captures.push(attrSyntax);\n          continue;\n        }\n\n        if (realAttrTarget !== 'au-slot') {\n          bindablesInfo = BindablesInfo.from(elDef, false);\n          // if capture is on, capture everything except:\n          // - as-element\n          // - containerless\n          // - bindable properties\n          // - template controller\n          // - custom attribute\n          if (bindablesInfo.attrs[realAttrTarget] == null && !context._findAttr(realAttrTarget)?.isTemplateController) {\n            removeAttr();\n            captures.push(attrSyntax);\n            continue;\n          }\n        }\n      }\n\n      if (bindingCommand !== null && bindingCommand.type & CommandType.IgnoreAttr) {\n        // when the binding command overrides everything\n        // just pass the target as is to the binding command, and treat it as a normal attribute:\n        // active.class=\"...\"\n        // background.style=\"...\"\n        // my-attr.attr=\"...\"\n\n        commandBuildInfo.node = el;\n        commandBuildInfo.attr = attrSyntax;\n        commandBuildInfo.bindable = null;\n        commandBuildInfo.def = null;\n        (plainAttrInstructions ??= []).push(bindingCommand.build(commandBuildInfo));\n\n        removeAttr();\n        // to next attribute\n        continue;\n      }\n\n      // if not a ignore attribute binding command\n      // then process with the next possibilities\n      attrDef = context._findAttr(realAttrTarget);\n      // when encountering an attribute,\n      // custom attribute takes precedence over custom element bindables\n      if (attrDef !== null) {\n        bindablesInfo = BindablesInfo.from(attrDef, true);\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has explicit configuration noMultiBindings: false\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax.\n        //          Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        isMultiBindings = attrDef.noMultiBindings === false\n          && bindingCommand === null\n          && hasInlineBindings(realAttrValue);\n        if (isMultiBindings) {\n          attrBindableInstructions = this._compileMultiBindings(el, realAttrValue, attrDef, context);\n        } else {\n          primaryBindable = bindablesInfo.primary;\n          // custom attribute + single value + WITHOUT binding command:\n          // my-attr=\"\"\n          // my-attr=\"${}\"\n          if (bindingCommand === null) {\n            expr = exprParser.parse(realAttrValue, ExpressionType.Interpolation);\n            attrBindableInstructions = [\n              expr === null\n                ? new SetPropertyInstruction(realAttrValue, primaryBindable.property)\n                : new InterpolationInstruction(expr, primaryBindable.property)\n            ];\n          } else {\n            // custom attribute with binding command:\n            // my-attr.bind=\"...\"\n            // my-attr.two-way=\"...\"\n\n            commandBuildInfo.node = el;\n            commandBuildInfo.attr = attrSyntax;\n            commandBuildInfo.bindable = primaryBindable;\n            commandBuildInfo.def = attrDef;\n            attrBindableInstructions = [bindingCommand.build(commandBuildInfo)];\n          }\n        }\n\n        removeAttr();\n\n        if (attrDef.isTemplateController) {\n          (tcInstructions ??= []).push(new HydrateTemplateController(\n            voidDefinition,\n            // todo: def/ def.Type or def.name should be configurable\n            //       example: AOT/runtime can use def.Type, but there are situation\n            //       where instructions need to be serialized, def.name should be used\n            this.resolveResources ? attrDef : attrDef.name,\n            void 0,\n            attrBindableInstructions,\n          ));\n        } else {\n          (attrInstructions ??= []).push(new HydrateAttributeInstruction(\n            // todo: def/ def.Type or def.name should be configurable\n            //       example: AOT/runtime can use def.Type, but there are situation\n            //       where instructions need to be serialized, def.name should be used\n            this.resolveResources ? attrDef : attrDef.name,\n            attrDef.aliases != null && attrDef.aliases.includes(realAttrTarget) ? realAttrTarget : void 0,\n            attrBindableInstructions\n          ));\n        }\n        continue;\n      }\n\n      if (bindingCommand === null) {\n        // reaching here means:\n        // + maybe a bindable attribute with interpolation\n        // + maybe a plain attribute with interpolation\n        // + maybe a plain attribute\n        if (elDef !== null) {\n          bindablesInfo = BindablesInfo.from(elDef, false);\n          bindable = bindablesInfo.attrs[realAttrTarget];\n          if (bindable !== void 0) {\n            expr = exprParser.parse(realAttrValue, ExpressionType.Interpolation);\n            (elBindableInstructions ??= []).push(\n              expr == null\n                ? new SetPropertyInstruction(realAttrValue, bindable.property)\n                : new InterpolationInstruction(expr, bindable.property)\n            );\n\n            removeAttr();\n            continue;\n          }\n        }\n\n        // reaching here means:\n        // + maybe a plain attribute with interpolation\n        // + maybe a plain attribute\n        expr = exprParser.parse(realAttrValue, ExpressionType.Interpolation);\n        if (expr != null) {\n          // if it's an interpolation, remove the attribute\n          removeAttr();\n\n          (plainAttrInstructions ??= []).push(new InterpolationInstruction(\n            expr,\n            // if not a bindable, then ensure plain attribute are mapped correctly:\n            // e.g: colspan -> colSpan\n            //      innerhtml -> innerHTML\n            //      minlength -> minLength etc...\n            context._attrMapper.map(el, realAttrTarget) ?? camelCase(realAttrTarget)\n          ));\n        }\n        // if not a custom attribute + no binding command + not a bindable + not an interpolation\n        // then it's just a plain attribute, do nothing\n        continue;\n      }\n\n      // reaching here means:\n      // + has binding command\n      // + not an overriding binding command\n      // + not a custom attribute\n      removeAttr();\n\n      if (elDef !== null) {\n        // if the element is a custom element\n        // - prioritize bindables on a custom element before plain attributes\n        bindablesInfo = BindablesInfo.from(elDef, false);\n        bindable = bindablesInfo.attrs[realAttrTarget];\n        if (bindable !== void 0) {\n          commandBuildInfo.node = el;\n          commandBuildInfo.attr = attrSyntax;\n          commandBuildInfo.bindable = bindable;\n          commandBuildInfo.def = elDef;\n          (elBindableInstructions ??= []).push(bindingCommand.build(commandBuildInfo));\n          continue;\n        }\n      }\n\n      // reaching here means:\n      // + a plain attribute\n      // + has binding command\n\n      commandBuildInfo.node = el;\n      commandBuildInfo.attr = attrSyntax;\n      commandBuildInfo.bindable = null;\n      commandBuildInfo.def = null;\n      (plainAttrInstructions ??= []).push(bindingCommand.build(commandBuildInfo));\n    }\n\n    resetCommandBuildInfo();\n\n    if (this._shouldReorderAttrs(el) && plainAttrInstructions != null && plainAttrInstructions.length > 1) {\n      this._reorder(el, plainAttrInstructions);\n    }\n\n    // 2. ensure that element instruction is present if this element is a custom element\n    if (elDef !== null) {\n      elementInstruction = new HydrateElementInstruction(\n        // todo: def/ def.Type or def.name should be configurable\n        //       example: AOT/runtime can use def.Type, but there are situation\n        //       where instructions need to be serialized, def.name should be used\n        this.resolveResources ? elDef : elDef.name,\n        void 0,\n        (elBindableInstructions ?? emptyArray) as IInstruction[],\n        null,\n        hasContainerless,\n        captures,\n      );\n\n      // 2.1 prepare fallback content for <au-slot/>\n      if (elName === 'au-slot') {\n        const slotName = el.getAttribute('name') || /* name=\"\" is the same with no name */'default';\n        const template = context.h('template');\n        const fallbackContentContext = context._createChild();\n        let node: Node | null = el.firstChild;\n        while (node !== null) {\n          // a special case:\n          // <au-slot> doesn't have its own template\n          // so anything attempting to project into it is discarded\n          // doing so during compilation via removing the node,\n          // instead of considering it as part of the fallback view\n          if (node.nodeType === 1 && (node as Element).hasAttribute('au-slot')) {\n            el.removeChild(node);\n          } else {\n            template.content.appendChild(node);\n          }\n          node = el.firstChild;\n        }\n\n        this._compileNode(template.content, fallbackContentContext);\n        elementInstruction.auSlot = {\n          name: slotName,\n          fallback: CustomElementDefinition.create({\n            name: _generateElementName(),\n            template,\n            instructions: fallbackContentContext.rows,\n            needsCompile: false,\n          }),\n        };\n        // todo: shouldn't have to eagerly replace everything like this\n        // this is a leftover refactoring work from the old binder\n        el = this._replaceByMarker(el, context);\n      }\n    }\n\n    // 3. merge and sort all instructions into a single list\n    //    as instruction list for this element\n    if (plainAttrInstructions != null\n      || elementInstruction != null\n      || attrInstructions != null\n    ) {\n      instructions = emptyArray.concat(\n        elementInstruction ?? emptyArray,\n        attrInstructions ?? emptyArray,\n        plainAttrInstructions ?? emptyArray,\n      );\n      // 3.1 mark as template for later hydration\n      this._markAsTarget(el);\n    }\n\n    // 4. compiling child nodes\n    let shouldCompileContent: boolean;\n    if (tcInstructions != null) {\n      // 4.1 if there is 1 or more [Template controller]\n      ii = tcInstructions.length - 1;\n      i = ii;\n      tcInstruction = tcInstructions[i];\n\n      let template: HTMLTemplateElement;\n      // assumption: el.parentNode is not null\n      // but not always the case: e.g compile/enhance an element without parent with TC on it\n      this._replaceByMarker(el, context);\n      if (el.nodeName === 'TEMPLATE') {\n        template = el as HTMLTemplateElement;\n      } else {\n        template = context.h('template');\n        template.content.appendChild(el);\n      }\n      const mostInnerTemplate = template;\n      // 4.1.1.0. prepare child context for the inner template compilation\n      const childContext = context._createChild(instructions == null ? [] : [instructions]);\n\n      let childEl: Element;\n      let targetSlot: string | null;\n      let projections: IProjections | undefined;\n      let slotTemplateRecord: Record<string, (Element | DocumentFragment)[]> | undefined;\n      let slotTemplates: (Element | DocumentFragment)[];\n      let slotTemplate: Element | DocumentFragment;\n      let marker: HTMLElement;\n      let projectionCompilationContext: CompilationContext;\n      let j = 0, jj = 0;\n      // 4.1.1.1.\n      //  walks through the child nodes, and perform [au-slot] check\n      //  note: this is a bit different with the summary above, possibly wrong since it will not throw\n      //        on [au-slot] used on a non-custom-element + with a template controller on it\n      // for each child element of a custom element\n      // scan for [au-slot], if there's one\n      // then extract the element into a projection definition\n      // this allows support for [au-slot] declared on the same element with anther template controller\n      // e.g:\n      //\n      // can do:\n      //  <my-el>\n      //    <div au-slot if.bind=\"...\"></div>\n      //    <div if.bind=\"...\" au-slot></div>\n      //  </my-el>\n      //\n      // instead of:\n      //  <my-el>\n      //    <template au-slot><div if.bind=\"...\"></div>\n      //  </my-el>\n      let child: Node | null = el.firstChild;\n      if (processContentResult !== false) {\n        while (child !== null) {\n          if (child.nodeType === 1) {\n            // if has [au-slot] then it's a projection\n            childEl = (child as Element);\n            child = child.nextSibling;\n            targetSlot = childEl.getAttribute('au-slot');\n            if (targetSlot !== null) {\n              if (elDef === null) {\n                if (__DEV__)\n                  throw new Error(`Projection with [au-slot=\"${targetSlot}\"] is attempted on a non custom element ${el.nodeName}.`);\n                else\n                  throw new Error(`AUR0706:${elName}[${targetSlot}]`);\n              }\n              if (targetSlot === '') {\n                targetSlot = 'default';\n              }\n              childEl.removeAttribute('au-slot');\n              el.removeChild(childEl);\n              ((slotTemplateRecord ??= {})[targetSlot] ??= []).push(childEl);\n            }\n            // if not a targeted slot then use the common node method\n            // todo: in the future, there maybe more special case for a content of a custom element\n            //       it can be all done here\n          } else {\n            child = child.nextSibling;\n          }\n        }\n      }\n\n      if (slotTemplateRecord != null) {\n        projections = {};\n        // aggregate all content targeting the same slot\n        // into a single template\n        // with some special rule around <template> element\n        for (targetSlot in slotTemplateRecord) {\n          template = context.h('template');\n          slotTemplates = slotTemplateRecord[targetSlot];\n          for (j = 0, jj = slotTemplates.length; jj > j; ++j) {\n            slotTemplate = slotTemplates[j];\n            if (slotTemplate.nodeName === 'TEMPLATE') {\n              // this means user has some thing more than [au-slot] on a template\n              // consider this intentional, and use it as is\n              // e.g:\n              // <my-element>\n              //   <template au-slot repeat.for=\"i of items\">\n              // ----vs----\n              // <my-element>\n              //   <template au-slot>this is just some static stuff <b>And a b</b></template>\n              if ((slotTemplate as Element).attributes.length > 0) {\n                template.content.appendChild(slotTemplate);\n              } else {\n                template.content.appendChild((slotTemplate as HTMLTemplateElement).content);\n              }\n            } else {\n              template.content.appendChild(slotTemplate);\n            }\n          }\n\n          // after aggregating all the [au-slot] templates into a single one\n          // compile it\n          // technically, the most inner template controller compilation context\n          // is the parent of this compilation context\n          // but for simplicity in compilation, maybe start with a flatter hierarchy\n          // also, it wouldn't have any real uses\n          projectionCompilationContext = context._createChild();\n          this._compileNode(template.content, projectionCompilationContext);\n          projections[targetSlot] = CustomElementDefinition.create({\n            name: _generateElementName(),\n            template,\n            instructions: projectionCompilationContext.rows,\n            needsCompile: false,\n            isStrictBinding: context.root.def.isStrictBinding,\n          });\n        }\n        elementInstruction!.projections = projections;\n      }\n\n      if (elDef !== null && elDef.containerless) {\n        this._replaceByMarker(el, context);\n      }\n\n      shouldCompileContent = elDef === null || !elDef.containerless && !hasContainerless && processContentResult !== false;\n      if (shouldCompileContent) {\n        // 4.1.1.2:\n        //  recursively compiles the child nodes into the inner context\n        // important:\n        // ======================\n        // only goes inside a template, if there is a template controller on it\n        // otherwise, leave it alone\n        if (el.nodeName === 'TEMPLATE') {\n          this._compileNode((el as HTMLTemplateElement).content, childContext);\n        } else {\n          child = el.firstChild;\n          while (child !== null) {\n            child = this._compileNode(child, childContext);\n          }\n        }\n      }\n      tcInstruction.def = CustomElementDefinition.create({\n        name: _generateElementName(),\n        template: mostInnerTemplate,\n        instructions: childContext.rows,\n        needsCompile: false,\n        isStrictBinding: context.root.def.isStrictBinding,\n      });\n\n      // 4.1.2.\n      //  Start processing other Template controllers by walking the TC list (list 1) RIGHT -> LEFT\n      while (i-- > 0) {\n        // for each of the template controller from [right] to [left]\n        // do create:\n        // (1) a template\n        // (2) add a marker to the template\n        // (3) an instruction\n        // instruction will be corresponded to the marker\n        // =========================\n\n        tcInstruction = tcInstructions[i];\n        template = context.h('template');\n        // appending most inner template is inaccurate, as the most outer one\n        // is not really the parent of the most inner one\n        // but it's only for the purpose of creating a marker,\n        // so it's just an optimization hack\n        marker = context.h('au-m');\n        marker.classList.add('au');\n        template.content.appendChild(marker);\n\n        tcInstruction.def = CustomElementDefinition.create({\n          name: _generateElementName(),\n          template,\n          needsCompile: false,\n          instructions: [[tcInstructions[i + 1]]],\n          isStrictBinding: context.root.def.isStrictBinding,\n        });\n      }\n      // the most outer template controller should be\n      // the only instruction for peek instruction of the current context\n      // e.g\n      // <div if.bind=\"yes\" with.bind=\"scope\" repeat.for=\"i of items\" data-id=\"i.id\">\n      // results in:\n      // -----------\n      //\n      //  TC(if-[value=yes])\n      //    | TC(with-[value=scope])\n      //        | TC(repeat-[...])\n      //            | div(data-id-[value=i.id])\n      context.rows.push([tcInstruction]);\n    } else {\n      // 4.2\n      //\n      // if there's no template controller\n      // then the instruction built is appropriate to be assigned as the peek row\n      // and before the children compilation\n      if (instructions != null) {\n        context.rows.push(instructions);\n      }\n\n      let child = el.firstChild as Node | null;\n      let childEl: Element;\n      let targetSlot: string | null;\n      let projections: IProjections | null = null;\n      let slotTemplateRecord: Record<string, (Element | DocumentFragment)[]> | undefined;\n      let slotTemplates: (Element | DocumentFragment)[];\n      let slotTemplate: Element | DocumentFragment;\n      let template: HTMLTemplateElement;\n      let projectionCompilationContext: CompilationContext;\n      let j = 0, jj = 0;\n      // 4.2.1.\n      //    walks through the child nodes and perform [au-slot] check\n      // --------------------\n      // for each child element of a custom element\n      // scan for [au-slot], if there's one\n      // then extract the element into a projection definition\n      // this allows support for [au-slot] declared on the same element with anther template controller\n      // e.g:\n      //\n      // can do:\n      //  <my-el>\n      //    <div au-slot if.bind=\"...\"></div>\n      //    <div if.bind=\"...\" au-slot></div>\n      //  </my-el>\n      //\n      // instead of:\n      //  <my-el>\n      //    <template au-slot><div if.bind=\"...\"></div>\n      //  </my-el>\n      if (processContentResult !== false) {\n        while (child !== null) {\n          if (child.nodeType === 1) {\n            // if has [au-slot] then it's a projection\n            childEl = (child as Element);\n            child = child.nextSibling;\n            targetSlot = childEl.getAttribute('au-slot');\n            if (targetSlot !== null) {\n              if (elDef === null) {\n                if (__DEV__)\n                  throw new Error(`Projection with [au-slot=\"${targetSlot}\"] is attempted on a non custom element ${el.nodeName}.`);\n                else\n                  throw new Error(`AUR0706:${el.nodeName}[${targetSlot}]`);\n              }\n              if (targetSlot === '') {\n                targetSlot = 'default';\n              }\n              el.removeChild(childEl);\n              childEl.removeAttribute('au-slot');\n              ((slotTemplateRecord ??= {})[targetSlot] ??= []).push(childEl);\n            }\n            // if not a targeted slot then use the common node method\n            // todo: in the future, there maybe more special case for a content of a custom element\n            //       it can be all done here\n          } else {\n            child = child.nextSibling;\n          }\n        }\n      }\n\n      if (slotTemplateRecord != null) {\n        projections = {};\n        // aggregate all content targeting the same slot\n        // into a single template\n        // with some special rule around <template> element\n        for (targetSlot in slotTemplateRecord) {\n          template = context.h('template');\n          slotTemplates = slotTemplateRecord[targetSlot];\n          for (j = 0, jj = slotTemplates.length; jj > j; ++j) {\n            slotTemplate = slotTemplates[j];\n            if (slotTemplate.nodeName === 'TEMPLATE') {\n              // this means user has some thing more than [au-slot] on a template\n              // consider this intentional, and use it as is\n              // e.g:\n              // <my-element>\n              //   <template au-slot repeat.for=\"i of items\">\n              // ----vs----\n              // <my-element>\n              //   <template au-slot>this is just some static stuff <b>And a b</b></template>\n              if ((slotTemplate as Element).attributes.length > 0) {\n                template.content.appendChild(slotTemplate);\n              } else {\n                template.content.appendChild((slotTemplate as HTMLTemplateElement).content);\n              }\n            } else {\n              template.content.appendChild(slotTemplate);\n            }\n          }\n\n          // after aggregating all the [au-slot] templates into a single one\n          // compile it\n          projectionCompilationContext = context._createChild();\n          this._compileNode(template.content, projectionCompilationContext);\n          projections[targetSlot] = CustomElementDefinition.create({\n            name: _generateElementName(),\n            template,\n            instructions: projectionCompilationContext.rows,\n            needsCompile: false,\n            isStrictBinding: context.root.def.isStrictBinding,\n          });\n        }\n        elementInstruction!.projections = projections;\n      }\n\n      // todo: shouldn't have to eagerly replace with a marker like this\n      //       this should be the job of the renderer\n      if (elDef !== null && elDef.containerless) {\n        this._replaceByMarker(el, context);\n      }\n\n      shouldCompileContent = elDef === null || !elDef.containerless && !hasContainerless && processContentResult !== false;\n      if (shouldCompileContent && el.childNodes.length > 0) {\n        // 4.2.2\n        //    recursively compiles the child nodes into current context\n        child = el.firstChild;\n        while (child !== null) {\n          child = this._compileNode(child, context);\n        }\n      }\n    }\n\n    // 5. returns the next node to be compiled\n    return nextSibling;\n  }\n\n  /** @internal */\n  private _compileText(node: Text, context: CompilationContext): Node | null {\n    let text = '';\n    let current: Node | null = node;\n    while (current !== null && current.nodeType === 3) {\n      text += current.textContent!;\n      current = current.nextSibling;\n    }\n    const expr = context._exprParser.parse(text, ExpressionType.Interpolation);\n    if (expr === null) {\n      return current;\n    }\n\n    const parent = node.parentNode!;\n    // prepare a marker\n    parent.insertBefore(this._markAsTarget(context.h('au-m')), node);\n    // and the corresponding instruction\n    context.rows.push([new TextBindingInstruction(expr, !!context.def.isStrictBinding)]);\n\n    // and cleanup all the DOM for rendering text binding\n    node.textContent = '';\n    current = node.nextSibling;\n    while (current !== null && current.nodeType === 3) {\n      parent.removeChild(current);\n      current = node.nextSibling;\n    }\n\n    return node.nextSibling;\n  }\n\n  /** @internal */\n  private _compileMultiBindings(\n    node: Element,\n    attrRawValue: string,\n    attrDef: CustomAttributeDefinition,\n    context: CompilationContext\n  ): IInstruction[] {\n    // custom attribute + multiple values:\n    // my-attr=\"prop1: literal1 prop2.bind: ...; prop3: literal3\"\n    // my-attr=\"prop1.bind: ...; prop2.bind: ...\"\n    // my-attr=\"prop1: ${}; prop2.bind: ...; prop3: ${}\"\n    const bindableAttrsInfo = BindablesInfo.from(attrDef, true);\n    const valueLength = attrRawValue.length;\n    const instructions: IInstruction[] = [];\n\n    let attrName: string | undefined = void 0;\n    let attrValue: string | undefined = void 0;\n\n    let start = 0;\n    let ch = 0;\n    let expr: AnyBindingExpression;\n    let attrSyntax: AttrSyntax;\n    let command: BindingCommandInstance | null;\n    let bindable: BindableDefinition;\n\n    for (let i = 0; i < valueLength; ++i) {\n      ch = attrRawValue.charCodeAt(i);\n\n      if (ch === Char.Backslash) {\n        ++i;\n        // Ignore whatever comes next because it's escaped\n      } else if (ch === Char.Colon) {\n        attrName = attrRawValue.slice(start, i);\n\n        // Skip whitespace after colon\n        while (attrRawValue.charCodeAt(++i) <= Char.Space);\n\n        start = i;\n\n        for (; i < valueLength; ++i) {\n          ch = attrRawValue.charCodeAt(i);\n          if (ch === Char.Backslash) {\n            ++i;\n            // Ignore whatever comes next because it's escaped\n          } else if (ch === Char.Semicolon) {\n            attrValue = attrRawValue.slice(start, i);\n            break;\n          }\n        }\n\n        if (attrValue === void 0) {\n          // No semicolon found, so just grab the rest of the value\n          attrValue = attrRawValue.slice(start);\n        }\n\n        attrSyntax = context._attrParser.parse(attrName, attrValue);\n        // ================================================\n        // todo: should it always camel case???\n        // const attrTarget = camelCase(attrSyntax.target);\n        // ================================================\n        command = context._createCommand(attrSyntax);\n        bindable = bindableAttrsInfo.attrs[attrSyntax.target];\n        if (bindable == null) {\n          if (__DEV__)\n            throw new Error(`Bindable ${attrSyntax.target} not found on ${attrDef.name}.`);\n          else\n            throw new Error(`AUR0707:${attrDef.name}.${attrSyntax.target}`);\n        }\n        if (command === null) {\n          expr = context._exprParser.parse(attrValue, ExpressionType.Interpolation);\n          instructions.push(expr === null\n            ? new SetPropertyInstruction(attrValue, bindable.property)\n            : new InterpolationInstruction(expr, bindable.property)\n          );\n        } else {\n          commandBuildInfo.node = node;\n          commandBuildInfo.attr = attrSyntax;\n          commandBuildInfo.bindable = bindable;\n          commandBuildInfo.def = attrDef;\n          instructions.push(command.build(commandBuildInfo));\n        }\n\n        // Skip whitespace after semicolon\n        while (i < valueLength && attrRawValue.charCodeAt(++i) <= Char.Space);\n\n        start = i;\n\n        attrName = void 0;\n        attrValue = void 0;\n      }\n    }\n\n    resetCommandBuildInfo();\n\n    return instructions;\n  }\n\n  /** @internal */\n  private _compileLocalElement(template: Element | DocumentFragment, context: CompilationContext) {\n    const root: Element | DocumentFragment = template;\n    const localTemplates = toArray(root.querySelectorAll<HTMLTemplateElement>('template[as-custom-element]'));\n    const numLocalTemplates = localTemplates.length;\n    if (numLocalTemplates === 0) { return; }\n    if (numLocalTemplates === root.childElementCount) {\n      if (__DEV__)\n        throw new Error('The custom element does not have any content other than local template(s).');\n      else\n        throw new Error('AUR0708');\n    }\n    const localTemplateNames: Set<string> = new Set();\n    const localElTypes: CustomElementType[] = [];\n\n    for (const localTemplate of localTemplates) {\n      if (localTemplate.parentNode !== root) {\n        if (__DEV__)\n          throw new Error('Local templates needs to be defined directly under root.');\n        else\n          throw new Error('AUR0709');\n      }\n      const name = processTemplateName(localTemplate, localTemplateNames);\n\n      const LocalTemplateType = class LocalTemplate { };\n      const content = localTemplate.content;\n      const bindableEls = toArray(content.querySelectorAll('bindable'));\n      const bindableInstructions = Bindable.for(LocalTemplateType);\n      const properties = new Set<string>();\n      const attributes = new Set<string>();\n      for (const bindableEl of bindableEls) {\n        if (bindableEl.parentNode !== content) {\n          if (__DEV__)\n            throw new Error('Bindable properties of local templates needs to be defined directly under root.');\n          else\n            throw new Error('AUR0710');\n        }\n        const property = bindableEl.getAttribute(LocalTemplateBindableAttributes.property);\n        if (property === null) {\n          if (__DEV__)\n            throw new Error(`The attribute 'property' is missing in ${bindableEl.outerHTML}`);\n          else\n            throw new Error('AUR0711');\n        }\n        const attribute = bindableEl.getAttribute(LocalTemplateBindableAttributes.attribute);\n        if (attribute !== null\n          && attributes.has(attribute)\n          || properties.has(property)\n        ) {\n          if (__DEV__)\n            throw new Error(`Bindable property and attribute needs to be unique; found property: ${property}, attribute: ${attribute}`);\n          else\n            throw new Error(`AUR0712:${property}+${attribute}`);\n        } else {\n          if (attribute !== null) {\n            attributes.add(attribute);\n          }\n          properties.add(property);\n        }\n        bindableInstructions.add({\n          property,\n          attribute: attribute ?? void 0,\n          mode: getBindingMode(bindableEl),\n        });\n        const ignoredAttributes = bindableEl.getAttributeNames().filter((attrName) => !allowedLocalTemplateBindableAttributes.includes(attrName));\n        if (ignoredAttributes.length > 0) {\n          if (__DEV__)\n            context._logger.warn(`The attribute(s) ${ignoredAttributes.join(', ')} will be ignored for ${bindableEl.outerHTML}. Only ${allowedLocalTemplateBindableAttributes.join(', ')} are processed.`);\n        }\n\n        content.removeChild(bindableEl);\n      }\n\n      localElTypes.push(LocalTemplateType);\n      context._addDep(CustomElement.define({ name, template: localTemplate }, LocalTemplateType));\n\n      root.removeChild(localTemplate);\n    }\n\n    // if we have a template like this\n    //\n    // my-app.html\n    // <template as-custom-element=\"le-1\">\n    //  <le-2></le-2>\n    // </template>\n    // <template as-custom-element=\"le-2\">...</template>\n    //\n    // eagerly registering depdendencies inside the loop above\n    // will make `<le-1/>` miss `<le-2/>` as its dependency\n\n    let i = 0;\n    const ii = localElTypes.length;\n    for (; ii > i; ++i) {\n      (CustomElement.getDefinition(localElTypes[i]).dependencies as Key[]).push(\n        ...context.def.dependencies ?? emptyArray,\n        ...context.deps ?? emptyArray,\n      );\n    }\n  }\n\n  /** @internal */\n  private _shouldReorderAttrs(el: Element): boolean {\n    return el.nodeName === 'INPUT' && orderSensitiveInputType[(el as HTMLInputElement).type] === 1;\n  }\n\n  /** @internal */\n  private _reorder(el: Element, instructions: (IInstruction)[]) {\n    switch (el.nodeName) {\n      case 'INPUT': {\n        const _instructions = instructions as (PropertyBindingInstruction | InterpolationInstruction)[];\n        // swap the order of checked and model/value attribute,\n        // so that the required observers are prepared for checked-observer\n        let modelOrValueOrMatcherIndex: number | undefined = void 0;\n        let checkedIndex: number | undefined = void 0;\n        let found = 0;\n        let instruction: PropertyBindingInstruction | InterpolationInstruction;\n        for (let i = 0; i < _instructions.length && found < 3; i++) {\n          instruction = _instructions[i];\n          switch (instruction.to) {\n            case 'model':\n            case 'value':\n            case 'matcher':\n              modelOrValueOrMatcherIndex = i;\n              found++;\n              break;\n            case 'checked':\n              checkedIndex = i;\n              found++;\n              break;\n          }\n        }\n        if (checkedIndex !== void 0 && modelOrValueOrMatcherIndex !== void 0 && checkedIndex < modelOrValueOrMatcherIndex) {\n          [_instructions[modelOrValueOrMatcherIndex], _instructions[checkedIndex]] = [_instructions[checkedIndex], _instructions[modelOrValueOrMatcherIndex]];\n        }\n      }\n    }\n  }\n\n  /**\n   * Mark an element as target with a special css class\n   * and return it\n   *\n   * @internal\n   */\n  private _markAsTarget<T extends Element>(el: T): T {\n    el.classList.add('au');\n    return el;\n  }\n\n  /**\n   * Replace an element with a marker, and return the marker\n   *\n   * @internal\n   */\n  private _replaceByMarker(node: Node, context: CompilationContext): HTMLElement {\n    // todo: assumption made: parentNode won't be null\n    const parent = node.parentNode!;\n    const marker = context.h('au-m');\n    this._markAsTarget(parent.insertBefore(marker, node));\n    parent.removeChild(node);\n    return marker;\n  }\n}\n\n// this class is intended to be an implementation encapsulating the information at the root level of a template\n// this works at the time this is created because everything inside a template should be retrieved\n// from the root itself.\n// if anytime in the future, where it's desirable to retrieve information from somewhere other than root\n// then consider dropping this\n// goal: hide the root container, and all the resources finding calls\nclass CompilationContext {\n  public readonly root: CompilationContext;\n  public readonly parent: CompilationContext | null;\n  public readonly def: PartialCustomElementDefinition;\n  public readonly ci: ICompliationInstruction;\n  public readonly _templateFactory: ITemplateElementFactory;\n  public readonly _logger: ILogger;\n  public readonly _attrParser: IAttributeParser;\n  public readonly _attrMapper: IAttrMapper;\n  public readonly _exprParser: IExpressionParser;\n  public readonly p: IPlatform;\n  // an array representing targets of instructions, built on depth first tree walking compilation\n  public readonly rows: IInstruction[][];\n  public readonly localEls: Set<string>;\n  public hasSlot: boolean = false;\n  public deps: unknown[] | undefined;\n\n  /** @internal */\n  private readonly c: IContainer;\n\n  public constructor(\n    def: PartialCustomElementDefinition,\n    container: IContainer,\n    compilationInstruction: ICompliationInstruction,\n    parent: CompilationContext | null,\n    root: CompilationContext | null,\n    instructions: IInstruction[][] | undefined,\n  ) {\n    const hasParent = parent !== null;\n    this.c = container;\n    this.root = root === null ? this : root;\n    this.def = def;\n    this.ci = compilationInstruction;\n    this.parent = parent;\n    this._templateFactory = hasParent ? parent._templateFactory : container.get(ITemplateElementFactory);\n    // todo: attr parser should be retrieved based in resource semantic (current leaf + root + ignore parent)\n    this._attrParser = hasParent ? parent._attrParser : container.get(IAttributeParser);\n    this._exprParser = hasParent ? parent._exprParser : container.get(IExpressionParser);\n    this._attrMapper = hasParent ? parent._attrMapper : container.get(IAttrMapper);\n    this._logger = hasParent ? parent._logger : container.get(ILogger);\n    this.p = hasParent ? parent.p : container.get(IPlatform);\n    this.localEls = hasParent ? parent.localEls : new Set();\n    this.rows = instructions ?? [];\n  }\n\n  public _addDep(dep: unknown) {\n    (this.root.deps ??= []).push(dep);\n    this.root.c.register(dep);\n  }\n\n  public h<K extends keyof HTMLElementTagNameMap>(name: K): HTMLElementTagNameMap[K];\n  public h(name: string): HTMLElement;\n  public h(name: string): HTMLElement {\n    const el = this.p.document.createElement(name);\n    if (name === 'template') {\n      this.p.document.adoptNode((el as HTMLTemplateElement).content);\n    }\n    return el;\n  }\n\n  /**\n   * Find the custom element definition of a given name\n   */\n  public _findElement(name: string): CustomElementDefinition | null {\n    return this.c.find(CustomElement, name);\n  }\n\n  /**\n   * Find the custom attribute definition of a given name\n   */\n  public _findAttr(name: string): CustomAttributeDefinition | null {\n    return this.c.find(CustomAttribute, name);\n  }\n\n  /**\n   * Create a new child compilation context\n   */\n  public _createChild(instructions?: IInstruction[][]) {\n    return new CompilationContext(this.def, this.c, this.ci, this, this.root, instructions);\n  }\n\n  // todo: ideally binding command shouldn't have to be cached\n  // it can just be a singleton where it' retrieved\n  // the resources semantic should be defined by the resource itself,\n  // rather than baked in the container\n  private readonly _commands: Record<string, BindingCommandInstance | null | undefined> = createLookup();\n  /**\n   * Retrieve a binding command resource instance.\n   *\n   * @param name - The parsed `AttrSyntax`\n   *\n   * @returns An instance of the command if it exists, or `null` if it does not exist.\n   */\n  public _createCommand(syntax: AttrSyntax): BindingCommandInstance | null {\n    if (this.root !== this) {\n      return this.root._createCommand(syntax);\n    }\n    const name = syntax.command;\n    if (name === null) {\n      return null;\n    }\n    let result = this._commands[name];\n    if (result === void 0) {\n      result = this.c.create(BindingCommand, name) as BindingCommandInstance;\n      if (result === null) {\n        if (__DEV__)\n          throw new Error(`Unknown binding command: ${name}`);\n        else\n          throw new Error(`AUR0713:${name}`);\n      }\n      this._commands[name] = result;\n    }\n    return result;\n  }\n}\n\nfunction hasInlineBindings(rawValue: string): boolean {\n  const len = rawValue.length;\n  let ch = 0;\n  let i = 0;\n  while (len > i) {\n    ch = rawValue.charCodeAt(i);\n    if (ch === Char.Backslash) {\n      ++i;\n      // Ignore whatever comes next because it's escaped\n    } else if (ch === Char.Colon) {\n      return true;\n    } else if (ch === Char.Dollar && rawValue.charCodeAt(i + 1) === Char.OpenBrace) {\n      return false;\n    }\n    ++i;\n  }\n  return false;\n}\n\nfunction resetCommandBuildInfo(): void {\n  commandBuildInfo.node\n    = commandBuildInfo.attr\n    = commandBuildInfo.bindable\n    = commandBuildInfo.def = null!;\n}\n\nconst emptyCompilationInstructions: ICompliationInstruction = { projections: null };\n// eslint-disable-next-line\nconst voidDefinition: CustomElementDefinition = { name: 'unnamed' } as CustomElementDefinition;\nconst commandBuildInfo: Writable<ICommandBuildInfo> = {\n  node: null!,\n  attr: null!,\n  bindable: null,\n  def: null,\n};\nconst invalidSurrogateAttribute = Object.assign(createLookup<boolean | undefined>(), {\n  'id': true,\n  'name': true,\n  'au-slot': true,\n  'as-element': true,\n});\nconst orderSensitiveInputType: Record<string, number> = {\n  checkbox: 1,\n  radio: 1,\n  // todo: range is also sensitive to order, for min/max\n};\n\nconst bindableAttrsInfoCache = new WeakMap<CustomElementDefinition | CustomAttributeDefinition, BindablesInfo>();\nexport class BindablesInfo<T extends 0 | 1 = 0> {\n  public static from(def: CustomAttributeDefinition, isAttr: true): BindablesInfo<1>;\n  // eslint-disable-next-line\n  public static from(def: CustomElementDefinition, isAttr: false): BindablesInfo<0>;\n  public static from(def: CustomElementDefinition | CustomAttributeDefinition, isAttr: boolean): BindablesInfo<1 | 0> {\n    let info = bindableAttrsInfoCache.get(def);\n    if (info == null) {\n      type CA = CustomAttributeDefinition;\n      const bindables = def.bindables;\n      const attrs = createLookup<BindableDefinition>();\n      const defaultBindingMode: BindingMode = isAttr\n        ? (def as CA).defaultBindingMode === void 0\n          ? BindingMode.default\n          : (def as CA).defaultBindingMode\n        : BindingMode.default;\n      let bindable: BindableDefinition | undefined;\n      let prop: string;\n      let hasPrimary: boolean = false;\n      let primary: BindableDefinition | undefined;\n      let attr: string;\n\n      // from all bindables, pick the first primary bindable\n      // if there is no primary, pick the first bindable\n      // if there's no bindables, create a new primary with property value\n      for (prop in bindables) {\n        bindable = bindables[prop];\n        attr = bindable.attribute;\n        if (bindable.primary === true) {\n          if (hasPrimary) {\n            if (__DEV__)\n              throw new Error(`Primary already exists on ${def.name}`);\n            else\n              throw new Error(`AUR0714:${def.name}`);\n          }\n          hasPrimary = true;\n          primary = bindable;\n        } else if (!hasPrimary && primary == null) {\n          primary = bindable;\n        }\n\n        attrs[attr] = BindableDefinition.create(prop, def.Type, bindable);\n      }\n      if (bindable == null && isAttr) {\n        // if no bindables are present, default to \"value\"\n        primary = attrs.value = BindableDefinition.create('value', def.Type, { mode: defaultBindingMode });\n      }\n\n      bindableAttrsInfoCache.set(def, info = new BindablesInfo(attrs, bindables, primary));\n    }\n    return info;\n  }\n\n  protected constructor(\n    public readonly attrs: Record<string, BindableDefinition>,\n    public readonly bindables: Record<string, BindableDefinition>,\n    public readonly primary: T extends 1 ? BindableDefinition : BindableDefinition | undefined,\n  ) {}\n}\n\nconst enum LocalTemplateBindableAttributes {\n  property = \"property\",\n  attribute = \"attribute\",\n  mode = \"mode\",\n}\nconst allowedLocalTemplateBindableAttributes: readonly string[] = Object.freeze([\n  LocalTemplateBindableAttributes.property,\n  LocalTemplateBindableAttributes.attribute,\n  LocalTemplateBindableAttributes.mode\n]);\nconst localTemplateIdentifier = 'as-custom-element';\n\nfunction processTemplateName(localTemplate: HTMLTemplateElement, localTemplateNames: Set<string>): string {\n  const name = localTemplate.getAttribute(localTemplateIdentifier);\n  if (name === null || name === '') {\n    if (__DEV__)\n      throw new Error('The value of \"as-custom-element\" attribute cannot be empty for local template');\n    else\n      throw new Error('AUR0715');\n  }\n  if (localTemplateNames.has(name)) {\n    if (__DEV__)\n      throw new Error(`Duplicate definition of the local template named ${name}`);\n    else\n      throw new Error(`AUR0716:${name}`);\n  } else {\n    localTemplateNames.add(name);\n    localTemplate.removeAttribute(localTemplateIdentifier);\n  }\n  return name;\n}\n\nfunction getBindingMode(bindable: Element): BindingMode {\n  switch (bindable.getAttribute(LocalTemplateBindableAttributes.mode)) {\n    case 'oneTime':\n      return BindingMode.oneTime;\n    case 'toView':\n      return BindingMode.toView;\n    case 'fromView':\n      return BindingMode.fromView;\n    case 'twoWay':\n      return BindingMode.twoWay;\n    case 'default':\n    default:\n      return BindingMode.default;\n  }\n}\n\n/**\n * An interface describing the hooks a compilation process should invoke.\n *\n * A feature available to the default template compiler.\n */\nexport const ITemplateCompilerHooks = DI.createInterface<ITemplateCompilerHooks>('ITemplateCompilerHooks');\nexport interface ITemplateCompilerHooks {\n  /**\n   * Should be invoked immediately before a template gets compiled\n   */\n  compiling?(template: HTMLElement): void;\n}\n\nconst typeToHooksDefCache = new WeakMap<Constructable, TemplateCompilerHooksDefinition<unknown>>();\nconst hooksBaseName = getResourceKeyFor('compiler-hooks');\n\nexport const TemplateCompilerHooks = Object.freeze({\n  name: hooksBaseName,\n  define<K extends ITemplateCompilerHooks, T extends Constructable<K>>(Type: T): T {\n    let def = typeToHooksDefCache.get(Type);\n    if (def === void 0) {\n      typeToHooksDefCache.set(Type, def = new TemplateCompilerHooksDefinition(Type));\n      defineMetadata(hooksBaseName, def, Type);\n      appendResourceKey(Type, hooksBaseName);\n    }\n    return Type;\n  }\n});\n\nclass TemplateCompilerHooksDefinition<T> implements ResourceDefinition<Constructable<T>, ITemplateCompilerHooks> {\n  public get name(): string { return ''; }\n\n  public constructor(\n    public readonly Type: ResourceType<Constructable<T>, ITemplateCompilerHooks>,\n  ) {}\n\n  public register(c: IContainer) {\n    c.register(Registration.singleton(ITemplateCompilerHooks, this.Type));\n  }\n}\n\n/**\n * Decorator: Indicates that the decorated class is a template compiler hooks.\n *\n * An instance of this class will be created and appropriate compilation hooks will be invoked\n * at different phases of the default compiler.\n */\n/* eslint-disable */\n// deepscan-disable-next-line\nexport const templateCompilerHooks = (target?: Function) => {\n  return target === void 0 ? decorator : decorator(target);\n  function decorator(t: Function): any {\n    return TemplateCompilerHooks.define(t as Constructable) as unknown as void;\n  };\n}\n/* eslint-enable */\n\nconst _generateElementName = CustomElement.generateName;\n","import { bindingBehavior, BindingBehaviorInstance, BindingMode, LifecycleFlags } from '@aurelia/runtime';\n\nimport type { Scope } from '@aurelia/runtime';\nimport type { PropertyBinding } from '../binding/property-binding.js';\n\nexport abstract class BindingModeBehavior implements BindingBehaviorInstance {\n  /** @internal */\n  private readonly _originalModes: Map<PropertyBinding, BindingMode> = new Map();\n\n  public constructor(\n    private readonly mode: BindingMode,\n  ) {}\n\n  public bind(flags: LifecycleFlags, scope: Scope, binding: PropertyBinding): void {\n    this._originalModes.set(binding, binding.mode);\n    binding.mode = this.mode;\n  }\n\n  public unbind(flags: LifecycleFlags, scope: Scope, binding: PropertyBinding): void {\n    binding.mode = this._originalModes.get(binding)!;\n    this._originalModes.delete(binding);\n  }\n}\n\nexport class OneTimeBindingBehavior extends BindingModeBehavior {\n  public constructor() {\n    super(BindingMode.oneTime);\n  }\n}\n\nexport class ToViewBindingBehavior extends BindingModeBehavior {\n  public constructor() {\n    super(BindingMode.toView);\n  }\n}\n\nexport class FromViewBindingBehavior extends BindingModeBehavior {\n  public constructor() {\n    super(BindingMode.fromView);\n  }\n}\n\nexport class TwoWayBindingBehavior extends BindingModeBehavior {\n  public constructor() {\n    super(BindingMode.twoWay);\n  }\n}\n\nbindingBehavior('oneTime')(OneTimeBindingBehavior);\nbindingBehavior('toView')(ToViewBindingBehavior);\nbindingBehavior('fromView')(FromViewBindingBehavior);\nbindingBehavior('twoWay')(TwoWayBindingBehavior);\n","import { IPlatform } from '@aurelia/kernel';\nimport { bindingBehavior, BindingInterceptor, LifecycleFlags } from '@aurelia/runtime';\n\nimport type { ITask, QueueTaskOptions, TaskQueue } from '@aurelia/kernel';\nimport type { BindingBehaviorExpression, IInterceptableBinding, IsAssign, Scope } from '@aurelia/runtime';\n\nconst defaultDelay = 200;\n\n//\n// A binding behavior that prevents\n// - (v1 + v2) the view-model from being updated in two-way binding, OR\n// - (v1) the the view from being updated in to-view binding,\n// until a specified interval has passed without any changes\n//\nexport class DebounceBindingBehavior extends BindingInterceptor {\n  private readonly taskQueue: TaskQueue;\n  private readonly opts: QueueTaskOptions = { delay: defaultDelay };\n  private readonly firstArg: IsAssign | null = null;\n  private task: ITask | null = null;\n\n  public constructor(\n    binding: IInterceptableBinding,\n    expr: BindingBehaviorExpression,\n  ) {\n    super(binding, expr);\n    this.taskQueue = binding.locator.get(IPlatform).taskQueue;\n    if (expr.args.length > 0) {\n      this.firstArg = expr.args[0];\n    }\n  }\n\n  public callSource(args: object): unknown {\n    this.queueTask(() => this.binding.callSource!(args));\n    return void 0;\n  }\n\n  public handleChange(newValue: unknown, oldValue: unknown, flags: LifecycleFlags): void {\n    // when source has changed before the latest debounced value from target\n    // then discard that value, and take latest value from source only\n    if (this.task !== null) {\n      this.task.cancel();\n      this.task = null;\n    }\n    this.binding.handleChange(newValue, oldValue, flags);\n  }\n\n  public updateSource(newValue: unknown, flags: LifecycleFlags): void {\n    this.queueTask(() => this.binding.updateSource!(newValue, flags));\n  }\n\n  private queueTask(callback: () => void): void {\n    // Queue the new one before canceling the old one, to prevent early yield\n    const task = this.task;\n    this.task = this.taskQueue.queueTask(() => {\n      this.task = null;\n      return callback();\n    }, this.opts);\n    task?.cancel();\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.firstArg !== null) {\n      const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, null));\n      this.opts.delay = isNaN(delay) ? defaultDelay : delay;\n    }\n    this.binding.$bind(flags, scope);\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    this.task?.cancel();\n    this.task = null;\n    this.binding.$unbind(flags);\n  }\n}\n\nbindingBehavior('debounce')(DebounceBindingBehavior);\n","import { bindingBehavior, ISignaler, LifecycleFlags } from '@aurelia/runtime';\nimport type { BindingBehaviorInstance, IBinding, IConnectableBinding, Scope } from '@aurelia/runtime';\n\nexport class SignalBindingBehavior implements BindingBehaviorInstance {\n  /** @internal */\n  protected static inject = [ISignaler];\n  /** @internal */\n  private readonly _lookup: Map<IBinding, string[]> = new Map();\n  /** @internal */\n  private readonly _signaler: ISignaler;\n\n  public constructor(signaler: ISignaler) {\n    this._signaler = signaler;\n  }\n\n  public bind(flags: LifecycleFlags, scope: Scope, binding: IConnectableBinding, ...names: string[]): void {\n    if (!('handleChange' in binding)) {\n      if (__DEV__)\n        throw new Error(`The signal behavior can only be used with bindings that have a 'handleChange' method`);\n      else\n        throw new Error('AUR0817');\n    }\n    if (names.length === 0) {\n      if (__DEV__)\n        throw new Error(`At least one signal name must be passed to the signal behavior, e.g. \\`expr & signal:'my-signal'\\``);\n      else\n        throw new Error('AUR0818');\n    }\n\n    this._lookup.set(binding, names);\n    let name: string;\n    for (name of names) {\n      this._signaler.addSignalListener(name, binding);\n    }\n  }\n\n  public unbind(flags: LifecycleFlags, scope: Scope, binding: IConnectableBinding): void {\n    const names = this._lookup.get(binding)!;\n    this._lookup.delete(binding);\n    let name: string;\n    for (name of names) {\n      this._signaler.removeSignalListener(name, binding);\n    }\n  }\n}\n\nbindingBehavior('signal')(SignalBindingBehavior);\n","import { IPlatform } from '@aurelia/kernel';\nimport { bindingBehavior, BindingInterceptor, LifecycleFlags } from '@aurelia/runtime';\n\nimport type { ITask, QueueTaskOptions, TaskQueue } from '@aurelia/kernel';\nimport type { BindingBehaviorExpression, IInterceptableBinding, IsAssign, Scope } from '@aurelia/runtime';\n\nconst defaultDelay = 200;\n\n// A binding behavior that limits\n// - (v1) the rate at which the view-model is updated in two-way bindings, OR\n// - (v1 + v2) the rate at which the view is updated in to-view binding scenarios.\nexport class ThrottleBindingBehavior extends BindingInterceptor {\n  private readonly _taskQueue: TaskQueue;\n  private readonly _platform: IPlatform;\n  private readonly opts: QueueTaskOptions = { delay: defaultDelay };\n  private readonly firstArg: IsAssign | null = null;\n  private task: ITask | null = null;\n  private lastCall: number = 0;\n  private delay: number = 0;\n\n  public constructor(\n    binding: IInterceptableBinding,\n    expr: BindingBehaviorExpression,\n  ) {\n    super(binding, expr);\n    this._platform = binding.locator.get(IPlatform);\n    this._taskQueue = this._platform.taskQueue;\n    if (expr.args.length > 0) {\n      this.firstArg = expr.args[0];\n    }\n  }\n\n  public callSource(args: object): unknown {\n    this._queueTask(() => this.binding.callSource!(args));\n    return void 0;\n  }\n\n  public handleChange(newValue: unknown, oldValue: unknown, flags: LifecycleFlags): void {\n    // when source has changed before the latest throttled value from target\n    // then discard that value, and take latest value from source only\n    if (this.task !== null) {\n      this.task.cancel();\n      this.task = null;\n      this.lastCall = this._platform.performanceNow();\n    }\n    this.binding.handleChange(newValue, oldValue, flags);\n  }\n\n  public updateSource(newValue: unknown, flags: LifecycleFlags): void {\n    this._queueTask(() => this.binding.updateSource!(newValue, flags));\n  }\n\n  private _queueTask(callback: () => void): void {\n    const opts = this.opts;\n    const platform = this._platform;\n    const nextDelay = this.lastCall + opts.delay! - platform.performanceNow();\n\n    if (nextDelay > 0) {\n      // Queue the new one before canceling the old one, to prevent early yield\n      const task = this.task;\n      opts.delay = nextDelay;\n      this.task = this._taskQueue.queueTask(() => {\n        this.lastCall = platform.performanceNow();\n        this.task = null;\n        opts.delay = this.delay;\n        callback();\n      }, opts);\n\n      task?.cancel();\n    } else {\n      this.lastCall = platform.performanceNow();\n      callback();\n    }\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    if (this.firstArg !== null) {\n      const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, null));\n      this.opts.delay = this.delay = isNaN(delay) ? defaultDelay : delay;\n    }\n    this.binding.$bind(flags, scope);\n  }\n\n  public $unbind(flags: LifecycleFlags): void {\n    this.task?.cancel();\n    this.task = null;\n    super.$unbind(flags);\n  }\n}\n\nbindingBehavior('throttle')(ThrottleBindingBehavior);\n","import { AccessorType } from '@aurelia/runtime';\n\nimport type { IAccessor, LifecycleFlags } from '@aurelia/runtime';\n\n/**\n * Attribute accessor for HTML elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see ElementPropertyAccessor\n */\nexport class DataAttributeAccessor implements IAccessor<string | null> {\n  // ObserverType.Layout is not always true, it depends on the property\n  // but for simplicity, always treat as such\n  public type: AccessorType = AccessorType.Node | AccessorType.Layout;\n\n  public getValue(obj: HTMLElement, key: string): string | null {\n    return obj.getAttribute(key);\n  }\n\n  public setValue(newValue: string | null, f: LifecycleFlags, obj: HTMLElement, key: string): void {\n    if (newValue == null) {\n      obj.removeAttribute(key);\n    } else {\n      obj.setAttribute(key, newValue);\n    }\n  }\n}\n\nexport const attrAccessor = new DataAttributeAccessor();\n","import { LifecycleFlags, bindingBehavior } from '@aurelia/runtime';\nimport { attrAccessor } from '../../observation/data-attribute-accessor.js';\n\nimport type { Scope } from '@aurelia/runtime';\nimport type { PropertyBinding } from '../../binding/property-binding.js';\n\nexport class AttrBindingBehavior {\n  public bind(_flags: LifecycleFlags, _scope: Scope, binding: PropertyBinding): void {\n    binding.targetObserver = attrAccessor;\n  }\n\n  public unbind(_flags: LifecycleFlags, _scope: Scope, _binding: PropertyBinding): void {\n    return;\n  }\n}\nbindingBehavior('attr')(AttrBindingBehavior);\n","import { LifecycleFlags, bindingBehavior } from '@aurelia/runtime';\nimport { Listener } from '../../binding/listener.js';\n\nimport type { Scope } from '@aurelia/runtime';\n\n/** @internal */\nexport function handleSelfEvent(this: SelfableBinding, event: Event): ReturnType<Listener['callSource']> {\n  const target = event.composedPath()[0];\n\n  if (this.target !== target) {\n    return;\n  }\n\n  return this.selfEventCallSource(event);\n}\n\nexport type SelfableBinding = Listener & {\n  selfEventCallSource: Listener['callSource'];\n};\n\nexport class SelfBindingBehavior {\n  public bind(flags: LifecycleFlags, _scope: Scope, binding: SelfableBinding): void {\n    if (!binding.callSource || !binding.targetEvent) {\n      if (__DEV__)\n        throw new Error('Self binding behavior only supports events.');\n      else\n        throw new Error('AUR0801');\n    }\n\n    binding.selfEventCallSource = binding.callSource;\n    binding.callSource = handleSelfEvent;\n  }\n\n  public unbind(flags: LifecycleFlags, _scope: Scope, binding: SelfableBinding): void {\n    binding.callSource = binding.selfEventCallSource;\n    binding.selfEventCallSource = null!;\n  }\n}\n\nbindingBehavior('self')(SelfBindingBehavior);\n","import { AccessorType } from '@aurelia/runtime';\nimport { createLookup } from '../utilities.js';\n\nimport type { IAccessor, LifecycleFlags } from '@aurelia/runtime';\n\nconst nsMap: Record<string, AttributeNSAccessor> = createLookup();\n\n/**\n * Attribute accessor in a XML document/element that can be accessed via a namespace.\n * Wraps [`getAttributeNS`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNS).\n */\nexport class AttributeNSAccessor implements IAccessor<string | null> {\n\n  public static forNs(ns: string): AttributeNSAccessor {\n    return nsMap[ns] ??= new AttributeNSAccessor(ns);\n  }\n\n  // ObserverType.Layout is not always true, it depends on the property\n  // but for simplicity, always treat as such\n  public type: AccessorType = AccessorType.Node | AccessorType.Layout;\n\n  public constructor(\n    /**\n     * The namespace associated with this accessor\n     */\n    public readonly ns: string,\n  ) {\n  }\n\n  public getValue(obj: HTMLElement, propertyKey: string): string | null {\n    return obj.getAttributeNS(this.ns, propertyKey);\n  }\n\n  public setValue(newValue: string | null, f: LifecycleFlags, obj: HTMLElement, key: string): void {\n    if (newValue == null) {\n      obj.removeAttributeNS(this.ns, key);\n    } else {\n      obj.setAttributeNS(this.ns, key, newValue);\n    }\n  }\n}\n","import {\n  CollectionKind,\n  LifecycleFlags,\n  SetterObserver,\n  subscriberCollection,\n  AccessorType,\n  withFlushQueue,\n} from '@aurelia/runtime';\nimport { getCollectionObserver } from './observer-locator.js';\nimport { hasOwnProperty } from '../utilities.js';\n\nimport type { INode } from '../dom.js';\nimport type { EventSubscriber } from './event-delegator.js';\nimport type { ValueAttributeObserver } from './value-attribute-observer.js';\nimport type {\n  ICollectionObserver,\n  IndexMap,\n  ISubscriber,\n  ISubscriberCollection,\n  IObserver,\n  IObserverLocator,\n  IFlushable,\n  IWithFlushQueue,\n  FlushQueue,\n} from '@aurelia/runtime';\n\nexport interface IInputElement extends HTMLInputElement {\n  model?: unknown;\n  $observers?: {\n    model?: SetterObserver;\n    value?: ValueAttributeObserver;\n  };\n  matcher?: typeof defaultMatcher;\n}\n\nfunction defaultMatcher(a: unknown, b: unknown): boolean {\n  return a === b;\n}\n\nexport interface CheckedObserver extends\n  ISubscriberCollection { }\n\nexport class CheckedObserver implements IObserver, IFlushable, IWithFlushQueue {\n  public type: AccessorType = AccessorType.Node | AccessorType.Observer | AccessorType.Layout;\n\n  public readonly queue!: FlushQueue;\n\n  /** @internal */\n  private _value: unknown = void 0;\n\n  /** @internal */\n  private _oldValue: unknown = void 0;\n\n  /** @internal */\n  private readonly _obj: IInputElement;\n\n  /** @internal */\n  private _collectionObserver?: ICollectionObserver<CollectionKind> = void 0;\n\n  /** @internal */\n  private _valueObserver?: ValueAttributeObserver | SetterObserver = void 0;\n\n  /** @internal */\n  private f: LifecycleFlags = LifecycleFlags.none;\n\n  /** @internal */\n  private readonly oL: IObserverLocator;\n\n  public constructor(\n    obj: INode,\n    // deepscan-disable-next-line\n    _key: PropertyKey,\n    public readonly handler: EventSubscriber,\n    observerLocator: IObserverLocator,\n  ) {\n    this._obj = obj as IInputElement;\n    this.oL = observerLocator;\n  }\n\n  public getValue(): unknown {\n    return this._value;\n  }\n\n  public setValue(newValue: unknown, flags: LifecycleFlags): void {\n    const currentValue = this._value;\n    if (newValue === currentValue) {\n      return;\n    }\n    this._value = newValue;\n    this._oldValue = currentValue;\n    this.f = flags;\n    this._observe();\n    this._synchronizeElement();\n    this.queue.add(this);\n  }\n\n  public handleCollectionChange(_indexMap: IndexMap, _flags: LifecycleFlags): void {\n    this._synchronizeElement();\n  }\n\n  public handleChange(_newValue: unknown, _previousValue: unknown, _flags: LifecycleFlags): void {\n    this._synchronizeElement();\n  }\n\n  /** @internal */\n  private _synchronizeElement(): void {\n    const currentValue = this._value;\n    const obj = this._obj;\n    const elementValue = hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n    const isRadio = obj.type === 'radio';\n    const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n\n    if (isRadio) {\n      obj.checked = !!matcher(currentValue, elementValue);\n    } else if (currentValue === true) {\n      obj.checked = true;\n    } else {\n      let hasMatch = false;\n      if (currentValue instanceof Array) {\n        hasMatch = currentValue.findIndex(item => !!matcher(item, elementValue)) !== -1;\n      } else if (currentValue instanceof Set) {\n        for (const v of currentValue) {\n          if (matcher(v, elementValue)) {\n            hasMatch = true;\n            break;\n          }\n        }\n      } else if (currentValue instanceof Map) {\n        for (const pair of currentValue) {\n          const existingItem = pair[0];\n          const $isChecked = pair[1];\n          // a potential complain, when only `true` is supported\n          // but it's consistent with array\n          if (matcher(existingItem, elementValue) && $isChecked === true) {\n            hasMatch = true;\n            break;\n          }\n        }\n      }\n      obj.checked = hasMatch;\n    }\n  }\n\n  public handleEvent(): void {\n    let currentValue = this._oldValue = this._value;\n    const obj = this._obj;\n    const elementValue = hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n    const isChecked = obj.checked;\n    const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n\n    if (obj.type === 'checkbox') {\n      if (currentValue instanceof Array) {\n        // Array binding steps on a change event:\n        // 1. find corresponding item INDEX in the Set based on current model/value and matcher\n        // 2. is the checkbox checked?\n        //    2.1. Yes: is the corresponding item in the Array (index === -1)?\n        //        2.1.1 No: push the current model/value to the Array\n        //    2.2. No: is the corresponding item in the Array (index !== -1)?\n        //        2.2.1: Yes: remove the corresponding item\n        // =================================================\n        const index = currentValue.findIndex(item => !!matcher(item, elementValue));\n\n        // if the checkbox is checkde, and there's no matching value in the existing array\n        // add the checkbox model/value to the array\n        if (isChecked && index === -1) {\n          currentValue.push(elementValue);\n        } else if (!isChecked && index !== -1) {\n          // if the checkbox is not checked, and found a matching item in the array\n          // based on the checkbox model/value\n          // remove the existing item\n          currentValue.splice(index, 1);\n        }\n        // when existing currentValue is an array,\n        // do not invoke callback as only the array obj has changed\n        return;\n      } else if (currentValue instanceof Set) {\n        // Set binding steps on a change event:\n        // 1. find corresponding item in the Set based on current model/value and matcher\n        // 2. is the checkbox checked?\n        //    2.1. Yes: is the corresponding item in the Set?\n        //        2.1.1 No: add the current model/value to the Set\n        //    2.2. No: is the corresponding item in the Set?\n        //        2.2.1: Yes: remove the corresponding item\n        // =================================================\n\n        // 1. find corresponding item\n        const unset = {};\n        let existingItem: unknown = unset;\n        for (const value of currentValue) {\n          if (matcher(value, elementValue) === true) {\n            existingItem = value;\n            break;\n          }\n        }\n        // 2.1. Checkbox is checked, is the corresponding item in the Set?\n        //\n        // if checkbox is checked and there's no value in the existing Set\n        // add the checkbox model/value to the Set\n        if (isChecked && existingItem === unset) {\n          // 2.1.1. add the current model/value to the Set\n          currentValue.add(elementValue);\n        } else if (!isChecked && existingItem !== unset) {\n          // 2.2.1 Checkbox is unchecked, corresponding is in the Set\n          //\n          // if checkbox is not checked, and found a matching item in the Set\n          // based on the checkbox model/value\n          // remove the existing item\n          currentValue.delete(existingItem);\n        }\n        // when existing value is a Set,\n        // do not invoke callback as only the Set has been mutated\n        return;\n      } else if (currentValue instanceof Map) {\n        // Map binding steps on a change event\n        // 1. find corresponding item in the Map based on current model/value and matcher\n        // 2. Set the value of the corresponding item in the Map based on checked state of the checkbox\n        // =================================================\n\n        // 1. find the corresponding item\n        let existingItem: unknown;\n        for (const pair of currentValue) {\n          const currItem = pair[0];\n          if (matcher(currItem, elementValue) === true) {\n            existingItem = currItem;\n            break;\n          }\n        }\n\n        // 2. set the value of the corresponding item in the map\n        // if checkbox is checked and there's no value in the existing Map\n        // add the checkbox model/value to the Map as key,\n        // and value will be checked state of the checkbox\n        currentValue.set(existingItem, isChecked);\n        // when existing value is a Map,\n        // do not invoke callback as only the Map has been mutated\n        return;\n      }\n      currentValue = isChecked;\n    } else if (isChecked) {\n      currentValue = elementValue;\n    } else {\n      // if it's a radio and it has been unchecked\n      // do nothing, as the radio that was checked will fire change event and it will be handle there\n      // a radio cannot be unchecked by user\n      return;\n    }\n    this._value = currentValue;\n    this.queue.add(this);\n  }\n\n  public start() {\n    this.handler.subscribe(this._obj, this);\n    this._observe();\n  }\n\n  public stop(): void {\n    this.handler.dispose();\n    this._collectionObserver?.unsubscribe(this);\n    this._collectionObserver = void 0;\n\n    this._valueObserver?.unsubscribe(this);\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (this.subs.add(subscriber) && this.subs.count === 1) {\n      this.start();\n    }\n  }\n\n  public unsubscribe(subscriber: ISubscriber): void {\n    if (this.subs.remove(subscriber) && this.subs.count === 0) {\n      this.stop();\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, this.f);\n  }\n\n  /** @internal */\n  private _observe() {\n    const obj = this._obj;\n\n    (this._valueObserver ??= obj.$observers?.model ?? obj.$observers?.value)?.subscribe(this);\n\n    this._collectionObserver?.unsubscribe(this);\n    this._collectionObserver = void 0;\n\n    if (obj.type === 'checkbox') {\n      (this._collectionObserver = getCollectionObserver(this._value, this.oL))?.subscribe(this);\n    }\n  }\n}\n\nsubscriberCollection(CheckedObserver);\nwithFlushQueue(CheckedObserver);\n\n// a reusable variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n","import {\n  CollectionKind,\n  LifecycleFlags as LF,\n  subscriberCollection,\n  AccessorType,\n  withFlushQueue,\n  LifecycleFlags,\n} from '@aurelia/runtime';\n\nimport type { INode } from '../dom';\nimport type { EventSubscriber } from './event-delegator';\nimport type {\n  ICollectionObserver,\n  IObserver,\n  IObserverLocator,\n  ISubscriber,\n  ISubscriberCollection,\n  IWithFlushQueue,\n  IFlushable,\n  FlushQueue,\n} from '@aurelia/runtime';\nimport { hasOwnProperty } from '../utilities.js';\n\nconst childObserverOptions = {\n  childList: true,\n  subtree: true,\n  characterData: true\n};\n\nfunction defaultMatcher(a: unknown, b: unknown): boolean {\n  return a === b;\n}\n\nexport interface ISelectElement extends HTMLSelectElement {\n  options: HTMLCollectionOf<IOptionElement> & Pick<HTMLOptionsCollection, 'length' | 'selectedIndex' | 'add' | 'remove'>;\n  matcher?: typeof defaultMatcher;\n}\nexport interface IOptionElement extends HTMLOptionElement {\n  model?: unknown;\n}\n\nexport interface SelectValueObserver extends\n  ISubscriberCollection {}\n\nexport class SelectValueObserver implements IObserver, IFlushable, IWithFlushQueue {\n  // ObserverType.Layout is not always true\n  // but for simplicity, always treat as such\n  public type: AccessorType = AccessorType.Node | AccessorType.Observer | AccessorType.Layout;\n\n  public readonly queue!: FlushQueue;\n\n  public readonly handler: EventSubscriber;\n\n  /** @internal */\n  private _value: unknown = void 0;\n\n  /** @internal */\n  private _oldValue: unknown = void 0;\n\n  /** @internal */\n  private readonly _obj: ISelectElement;\n\n  /** @internal */\n  private _hasChanges: boolean = false;\n  /** @internal */\n  private _arrayObserver?: ICollectionObserver<CollectionKind.array> = void 0;\n  /** @internal */\n  private _nodeObserver?: MutationObserver = void 0;\n\n  /** @internal */\n  private _observing: boolean = false;\n\n  /** @internal */\n  private readonly _observerLocator: IObserverLocator;\n\n  public constructor(\n    obj: INode,\n    // deepscan-disable-next-line\n    _key: PropertyKey,\n    handler: EventSubscriber,\n    observerLocator: IObserverLocator,\n  ) {\n    this._obj = obj as ISelectElement;\n    this._observerLocator = observerLocator;\n    this.handler = handler;\n  }\n\n  public getValue(): unknown {\n    // is it safe to assume the observer has the latest value?\n    // todo: ability to turn on/off cache based on type\n    return this._observing\n      ? this._value\n      : this._obj.multiple\n        // todo: maybe avoid double iteration?\n        ? getSelectedOptions(this._obj.options)\n        : this._obj.value;\n  }\n\n  public setValue(newValue: unknown, flags: LF): void {\n    this._oldValue = this._value;\n    this._value = newValue;\n    this._hasChanges = newValue !== this._oldValue;\n    this._observeArray(newValue instanceof Array ? newValue : null);\n    if ((flags & LF.noFlush) === 0) {\n      this._flushChanges();\n    }\n  }\n\n  /** @internal */\n  private _flushChanges(): void {\n    if (this._hasChanges) {\n      this._hasChanges = false;\n      this.syncOptions();\n    }\n  }\n\n  public handleCollectionChange(): void {\n    // always sync \"selected\" property of <options/>\n    // immediately whenever the array notifies its mutation\n    this.syncOptions();\n  }\n\n  public syncOptions(): void {\n    const value = this._value;\n    const obj = this._obj;\n    const isArray = Array.isArray(value);\n    const matcher = obj.matcher ?? defaultMatcher;\n    const options = obj.options;\n    let i = options.length;\n\n    while (i-- > 0) {\n      const option = options[i];\n      const optionValue = hasOwnProperty.call(option, 'model') ? option.model : option.value;\n      if (isArray) {\n        option.selected = (value as unknown[]).findIndex(item => !!matcher(optionValue, item)) !== -1;\n        continue;\n      }\n      option.selected = !!matcher(optionValue, value);\n    }\n  }\n\n  public syncValue(): boolean {\n    // Spec for synchronizing value from `<select/>`  to `SelectObserver`\n    // When synchronizing value to observed <select/> element, do the following steps:\n    // A. If `<select/>` is multiple\n    //    1. Check if current value, called `currentValue` is an array\n    //      a. If not an array, return true to signal value has changed\n    //      b. If is an array:\n    //        i. gather all current selected <option/>, in to array called `values`\n    //        ii. loop through the `currentValue` array and remove items that are nolonger selected based on matcher\n    //        iii. loop through the `values` array and add items that are selected based on matcher\n    //        iv. Return false to signal value hasn't changed\n    // B. If the select is single\n    //    1. Let `value` equal the first selected option, if no option selected, then `value` is `null`\n    //    2. assign `this.currentValue` to `this.oldValue`\n    //    3. assign `value` to `this.currentValue`\n    //    4. return `true` to signal value has changed\n    const obj = this._obj;\n    const options = obj.options;\n    const len = options.length;\n    const currentValue = this._value;\n    let i = 0;\n\n    if (obj.multiple) {\n      // A.\n      if (!(currentValue instanceof Array)) {\n        // A.1.a\n        return true;\n      }\n      // A.1.b\n      // multi select\n      let option: IOptionElement;\n      // eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing\n      const matcher = obj.matcher || defaultMatcher;\n      // A.1.b.i\n      const values: unknown[] = [];\n      while (i < len) {\n        option = options[i];\n        if (option.selected) {\n          values.push(hasOwnProperty.call(option, 'model')\n            ? option.model\n            : option.value\n          );\n        }\n        ++i;\n      }\n      let a: unknown;\n      // A.1.b.ii\n      i = 0;\n      while (i < currentValue.length) {\n        a = currentValue[i];\n        // Todo: remove arrow fn\n        if (values.findIndex(b => !!matcher(a, b)) === -1) {\n          currentValue.splice(i, 1);\n        } else {\n          ++i;\n        }\n      }\n      // A.1.b.iii\n      i = 0;\n      while (i < values.length) {\n        a = values[i];\n        // Todo: remove arrow fn\n        if (currentValue.findIndex(b => !!matcher(a, b)) === -1) {\n          currentValue.push(a);\n        }\n        ++i;\n      }\n      // A.1.b.iv\n      return false;\n    }\n    // B. single select\n    // B.1\n    let value: unknown = null;\n    let option: IOptionElement;\n    while (i < len) {\n      option = options[i];\n      if (option.selected) {\n        value = hasOwnProperty.call(option, 'model')\n          ? option.model\n          : option.value;\n        break;\n      }\n      ++i;\n    }\n    // B.2\n    this._oldValue = this._value;\n    // B.3\n    this._value = value;\n    // B.4\n    return true;\n  }\n\n  /** @internal */\n  private _start(): void {\n    (this._nodeObserver = new this._obj.ownerDocument.defaultView!.MutationObserver(this._handleNodeChange.bind(this)))\n      .observe(this._obj, childObserverOptions);\n    this._observeArray(this._value instanceof Array ? this._value : null);\n    this._observing = true;\n  }\n\n  /** @internal */\n  private _stop(): void {\n    this._nodeObserver!.disconnect();\n    this._arrayObserver?.unsubscribe(this);\n    this._nodeObserver\n      = this._arrayObserver\n      = void 0;\n    this._observing = false;\n  }\n\n  // todo: observe all kind of collection\n  /** @internal */\n  private _observeArray(array: unknown[] | null): void {\n    this._arrayObserver?.unsubscribe(this);\n    this._arrayObserver = void 0;\n    if (array != null) {\n      if (!this._obj.multiple) {\n        if (__DEV__)\n          throw new Error('Only null or Array instances can be bound to a multi-select.');\n        else\n          throw new Error('AUR0654');\n      }\n      (this._arrayObserver = this._observerLocator.getArrayObserver(array)).subscribe(this);\n    }\n  }\n\n  public handleEvent(): void {\n    const shouldNotify = this.syncValue();\n    if (shouldNotify) {\n      this.queue.add(this);\n      // this.subs.notify(this.currentValue, this.oldValue, LF.none);\n    }\n  }\n\n  /** @internal */\n  private _handleNodeChange(_records: MutationRecord[]): void {\n    // syncing options first means forcing the UI to take the existing state from the model\n    // example: if existing state has only 3 selected option\n    //          and it's adding a 4th <option/> with selected state\n    //          [selected] state will be disregarded as it's not present in the model\n    //          this force uni-direction flow: where UI update is only via user event, or model changes\n    //          Cons:\n    //          Sometimes, an <option selected /> maybe added to the UI, and causes confusion, as it's not selected anymore after the sync\n    //          Consider this before entering release candidate\n    this.syncOptions();\n    const shouldNotify = this.syncValue();\n    if (shouldNotify) {\n      this.queue.add(this);\n    }\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (this.subs.add(subscriber) && this.subs.count === 1) {\n      this.handler.subscribe(this._obj, this);\n      this._start();\n    }\n  }\n\n  public unsubscribe(subscriber: ISubscriber): void {\n    if (this.subs.remove(subscriber) && this.subs.count === 0) {\n      this.handler.dispose();\n      this._stop();\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, LifecycleFlags.none);\n  }\n}\n\nsubscriberCollection(SelectValueObserver);\nwithFlushQueue(SelectValueObserver);\n\nfunction getSelectedOptions(options: ArrayLike<IOptionElement>): unknown[] {\n  const selection: unknown[] = [];\n  if (options.length === 0) {\n    return selection;\n  }\n  const ii = options.length;\n  let i = 0;\n  let option: IOptionElement;\n  while (ii > i) {\n    option = options[i];\n    if (option.selected) {\n      selection[selection.length] = hasOwnProperty.call(option, 'model') ? option.model : option.value;\n    }\n    ++i;\n  }\n  return selection;\n}\n\n// a shared variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n","import { LifecycleFlags, AccessorType } from '@aurelia/runtime';\nimport { emptyArray, kebabCase } from '@aurelia/kernel';\nimport { hasOwnProperty, isFunction, isString } from '../utilities.js';\nimport type { IAccessor } from '@aurelia/runtime';\n\nconst customPropertyPrefix: string = '--';\n\nexport class StyleAttributeAccessor implements IAccessor {\n  public type: AccessorType = AccessorType.Node | AccessorType.Layout;\n\n  public value: unknown = '';\n  /** @internal */\n  private _oldValue: unknown = '';\n\n  public styles: Record<string, number> = {};\n  public version: number = 0;\n\n  /** @internal */\n  private _hasChanges: boolean = false;\n\n  public constructor(\n    public readonly obj: HTMLElement,\n  ) {\n  }\n\n  public getValue(): string {\n    return this.obj.style.cssText;\n  }\n\n  public setValue(newValue: unknown, flags: LifecycleFlags): void {\n    this.value = newValue;\n    this._hasChanges = newValue !== this._oldValue;\n    if ((flags & LifecycleFlags.noFlush) === 0) {\n      this._flushChanges();\n    }\n  }\n\n  /** @internal */\n  private _getStyleTuplesFromString(currentValue: string): [string, string][] {\n    const styleTuples: [string, string][] = [];\n    const urlRegexTester = /url\\([^)]+$/;\n    let offset = 0;\n    let currentChunk = '';\n    let nextSplit: number;\n    let indexOfColon: number;\n    let attribute: string;\n    let value: string;\n    while (offset < currentValue.length) {\n      nextSplit = currentValue.indexOf(';', offset);\n      if (nextSplit === -1) { nextSplit = currentValue.length; }\n      currentChunk += currentValue.substring(offset, nextSplit);\n      offset = nextSplit + 1;\n\n      // Make sure we never split a url so advance to next\n      if (urlRegexTester.test(currentChunk)) {\n        currentChunk += ';';\n        continue;\n      }\n\n      indexOfColon = currentChunk.indexOf(':');\n      attribute = currentChunk.substring(0, indexOfColon).trim();\n      value = currentChunk.substring(indexOfColon + 1).trim();\n      styleTuples.push([attribute, value]);\n      currentChunk = '';\n    }\n\n    return styleTuples;\n  }\n\n  /** @internal */\n  private _getStyleTuplesFromObject(currentValue: Record<string, unknown>): [string, string][] {\n    let value: unknown;\n    let property: string;\n    const styles: [string, string][] = [];\n    for (property in currentValue) {\n      value = currentValue[property];\n      if (value == null) {\n        continue;\n      }\n      if (isString(value)) {\n        // Custom properties should not be tampered with\n        if (property.startsWith(customPropertyPrefix)) {\n          styles.push([property, value]);\n          continue;\n        }\n        styles.push([kebabCase(property), value]);\n        continue;\n      }\n\n      styles.push(...this._getStyleTuples(value));\n    }\n\n    return styles;\n  }\n\n  /** @internal */\n  private _getStyleTuplesFromArray(currentValue: unknown[]): [string, string][] {\n    const len = currentValue.length;\n    if (len > 0) {\n      const styles: [string, string][] = [];\n      let i = 0;\n      for (; len > i; ++i) {\n        styles.push(...this._getStyleTuples(currentValue[i]));\n      }\n      return styles;\n    }\n    return emptyArray;\n  }\n\n  /** @internal */\n  private _getStyleTuples(currentValue: unknown): [string, string][] {\n    if (isString(currentValue)) {\n      return this._getStyleTuplesFromString(currentValue);\n    }\n\n    if (currentValue instanceof Array) {\n      return this._getStyleTuplesFromArray(currentValue);\n    }\n\n    if (currentValue instanceof Object) {\n      return this._getStyleTuplesFromObject(currentValue as Record<string, unknown>);\n    }\n\n    return emptyArray;\n  }\n\n  /** @internal */\n  private _flushChanges(): void {\n    if (this._hasChanges) {\n      this._hasChanges = false;\n      const currentValue = this.value;\n      const styles = this.styles;\n      const styleTuples = this._getStyleTuples(currentValue);\n\n      let style: string;\n      let version = this.version;\n\n      this._oldValue = currentValue;\n\n      let tuple: [string, string];\n      let name: string;\n      let value: string;\n      let i = 0;\n      const len = styleTuples.length;\n      for (; i < len; ++i) {\n        tuple = styleTuples[i];\n        name = tuple[0];\n        value = tuple[1];\n        this.setProperty(name, value);\n        styles[name] = version;\n      }\n\n      this.styles = styles;\n      this.version += 1;\n      if (version === 0) {\n        return;\n      }\n\n      version -= 1;\n      for (style in styles) {\n        if (!hasOwnProperty.call(styles, style) || styles[style] !== version) {\n          continue;\n        }\n        this.obj.style.removeProperty(style);\n      }\n    }\n  }\n\n  public setProperty(style: string, value: string): void {\n    let priority = '';\n\n    if (value != null && isFunction(value.indexOf) && value.includes('!important')) {\n      priority = 'important';\n      value = value.replace('!important', '');\n    }\n\n    this.obj.style.setProperty(style, value, priority);\n  }\n\n  public bind(_flags: LifecycleFlags): void {\n    this.value = this._oldValue = this.obj.style.cssText;\n  }\n}\n","import { LifecycleFlags, subscriberCollection, AccessorType, withFlushQueue } from '@aurelia/runtime';\n\nimport type { EventSubscriber } from './event-delegator.js';\nimport type { INode } from '../dom.js';\nimport type { IIndexable } from '@aurelia/kernel';\nimport type {\n  ISubscriberCollection,\n  ISubscriber,\n  IObserver,\n  IFlushable,\n  IWithFlushQueue,\n  FlushQueue,\n} from '@aurelia/runtime';\n\nexport interface ValueAttributeObserver extends ISubscriberCollection {}\n/**\n * Observer for non-radio, non-checkbox input.\n */\nexport class ValueAttributeObserver implements IObserver, IWithFlushQueue, IFlushable {\n  // ObserverType.Layout is not always true, it depends on the element & property combo\n  // but for simplicity, always treat as such\n  public type: AccessorType = AccessorType.Node | AccessorType.Observer | AccessorType.Layout;\n\n  public readonly queue!: FlushQueue;\n\n  /** @internal */\n  private readonly _obj: INode & IIndexable;\n\n  /** @internal */\n  private readonly _key: PropertyKey;\n\n  /** @internal */\n  private _value: unknown = '';\n\n  /** @internal */\n  private _oldValue: unknown = '';\n\n  /** @internal */\n  private _hasChanges: boolean = false;\n\n  public constructor(\n    obj: INode,\n    key: PropertyKey,\n    public readonly handler: EventSubscriber,\n  ) {\n    this._obj = obj as INode & IIndexable;\n    this._key = key;\n  }\n\n  public getValue(): unknown {\n    // is it safe to assume the observer has the latest value?\n    // todo: ability to turn on/off cache based on type\n    return this._value;\n  }\n\n  public setValue(newValue: string | null, flags: LifecycleFlags): void {\n    if (Object.is(newValue, this._value)) {\n      return;\n    }\n    this._oldValue = this._value;\n    this._value = newValue;\n    this._hasChanges = true;\n    if (!this.handler.config.readonly && (flags & LifecycleFlags.noFlush) === 0) {\n      this._flushChanges(flags);\n    }\n  }\n\n  /** @internal */\n  private _flushChanges(flags: LifecycleFlags): void {\n    if (this._hasChanges) {\n      this._hasChanges = false;\n      this._obj[this._key as string] = this._value ?? this.handler.config.default;\n\n      if ((flags & LifecycleFlags.fromBind) === 0) {\n        this.queue.add(this);\n      }\n    }\n  }\n\n  public handleEvent(): void {\n    this._oldValue = this._value;\n    this._value = this._obj[this._key as string];\n    if (this._oldValue !== this._value) {\n      this._hasChanges = false;\n      this.queue.add(this);\n    }\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (this.subs.add(subscriber) && this.subs.count === 1) {\n      this.handler.subscribe(this._obj, this);\n      this._value = this._oldValue = this._obj[this._key as string];\n    }\n  }\n\n  public unsubscribe(subscriber: ISubscriber): void {\n    if (this.subs.remove(subscriber) && this.subs.count === 0) {\n      this.handler.dispose();\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, LifecycleFlags.none);\n  }\n}\n\nsubscriberCollection(ValueAttributeObserver);\nwithFlushQueue(ValueAttributeObserver);\n\n// a reusable variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n","import { emptyObject, IServiceLocator, Registration } from '@aurelia/kernel';\nimport {\n  AccessorType,\n  IDirtyChecker,\n  INodeObserverLocator,\n  IObserverLocator,\n  PropertyAccessor,\n  SetterObserver,\n} from '@aurelia/runtime';\nimport { IPlatform } from '../platform.js';\nimport { AttributeNSAccessor } from './attribute-ns-accessor.js';\nimport { CheckedObserver } from './checked-observer.js';\nimport { ClassAttributeAccessor } from './class-attribute-accessor.js';\nimport { attrAccessor } from './data-attribute-accessor.js';\nimport { EventSubscriber } from './event-delegator.js';\nimport { SelectValueObserver } from './select-value-observer.js';\nimport { StyleAttributeAccessor } from './style-attribute-accessor.js';\nimport { ISVGAnalyzer } from './svg-analyzer.js';\nimport { ValueAttributeObserver } from './value-attribute-observer.js';\nimport { createLookup, isDataAttribute, isString } from '../utilities.js';\n\nimport type { IIndexable, IContainer } from '@aurelia/kernel';\nimport type { IAccessor, IObserver, ICollectionObserver, CollectionKind } from '@aurelia/runtime';\nimport type { INode } from '../dom.js';\n\n// https://infra.spec.whatwg.org/#namespaces\n// const htmlNS = 'http://www.w3.org/1999/xhtml';\n// const mathmlNS = 'http://www.w3.org/1998/Math/MathML';\n// const svgNS = 'http://www.w3.org/2000/svg';\nconst xlinkNS = 'http://www.w3.org/1999/xlink';\nconst xmlNS = 'http://www.w3.org/XML/1998/namespace';\nconst xmlnsNS = 'http://www.w3.org/2000/xmlns/';\n\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\nconst nsAttributes = Object.assign(\n  createLookup<[string, string]>(),\n  {\n    'xlink:actuate': ['actuate', xlinkNS],\n    'xlink:arcrole': ['arcrole', xlinkNS],\n    'xlink:href': ['href', xlinkNS],\n    'xlink:role': ['role', xlinkNS],\n    'xlink:show': ['show', xlinkNS],\n    'xlink:title': ['title', xlinkNS],\n    'xlink:type': ['type', xlinkNS],\n    'xml:lang': ['lang', xmlNS],\n    'xml:space': ['space', xmlNS],\n    'xmlns': ['xmlns', xmlnsNS],\n    'xmlns:xlink': ['xlink', xmlnsNS],\n  },\n);\n\nconst elementPropertyAccessor = new PropertyAccessor();\nelementPropertyAccessor.type = AccessorType.Node | AccessorType.Layout;\n\nexport type IHtmlObserverConstructor =\n  new (\n    el: INode,\n    key: PropertyKey,\n    handler: EventSubscriber,\n    observerLocator: IObserverLocator,\n    locator: IServiceLocator,\n  ) => IObserver;\n\nexport interface INodeObserverConfig extends Partial<NodeObserverConfig> {\n  events: string[];\n}\n\nexport class NodeObserverConfig {\n  /**\n   * The observer constructor to use\n   */\n  public type: IHtmlObserverConstructor;\n  /**\n   * Indicates the list of events can be used to observe a particular property\n   */\n  public readonly events!: string[];\n  /**\n   * Indicates whether this property is readonly, so observer wont attempt to assign value\n   * example: input.files\n   */\n  public readonly readonly?: boolean;\n  /**\n   * A default value to assign to the corresponding property if the incoming value is null/undefined\n   */\n  public readonly default?: unknown;\n\n  public constructor(config: INodeObserverConfig) {\n    this.type = config.type ?? ValueAttributeObserver;\n    this.events = config.events;\n    this.readonly = config.readonly;\n    this.default = config.default;\n  }\n}\n\nexport class NodeObserverLocator implements INodeObserverLocator {\n  /** @internal */\n  protected static readonly inject = [IServiceLocator, IPlatform, IDirtyChecker, ISVGAnalyzer];\n\n  public allowDirtyCheck: boolean = true;\n\n  /** @internal */\n  private readonly _events: Record<string, Record<string, NodeObserverConfig>> = createLookup();\n  /** @internal */\n  private readonly _globalEvents: Record<string, NodeObserverConfig> = createLookup();\n  /** @internal */\n  private readonly _overrides: Record<string, Record<string, true>> = createLookup();\n  /** @internal */\n  private readonly _globalOverrides: Record<string, true> = createLookup();\n\n  public constructor(\n    private readonly locator: IServiceLocator,\n    private readonly platform: IPlatform,\n    private readonly dirtyChecker: IDirtyChecker,\n    private readonly svgAnalyzer: ISVGAnalyzer,\n  ) {\n    // todo: atm, platform is required to be resolved too eagerly for the `.handles()` check\n    // also a lot of tests assume default availability of observation\n    // those 2 assumptions make it not the right time to extract the following line into a\n    // default configuration for NodeObserverLocator yet\n    // but in the future, they should be, so apps that don't use check box/select, or implement a different\n    // observer don't have to pay the of the default implementation\n    const inputEvents = ['change', 'input'];\n    const inputEventsConfig: INodeObserverConfig = { events: inputEvents, default: '' };\n    this.useConfig({\n      INPUT: {\n        value: inputEventsConfig,\n        valueAsNumber: { events: inputEvents, default: 0 },\n        checked: { type: CheckedObserver, events: inputEvents } ,\n        files: { events: inputEvents, readonly: true },\n      },\n      SELECT: {\n        value: { type: SelectValueObserver, events: ['change'], default: '' },\n      },\n      TEXTAREA: {\n        value: inputEventsConfig,\n      },\n    });\n\n    const contentEventsConfig: INodeObserverConfig = { events: ['change', 'input', 'blur', 'keyup', 'paste'], default: '' };\n    const scrollEventsConfig: INodeObserverConfig = { events: ['scroll'], default: 0 };\n    this.useConfigGlobal({\n      scrollTop: scrollEventsConfig,\n      scrollLeft: scrollEventsConfig,\n      textContent: contentEventsConfig,\n      innerHTML: contentEventsConfig,\n    });\n\n    this.overrideAccessorGlobal('css', 'style', 'class');\n    this.overrideAccessor({\n      INPUT: ['value', 'checked', 'model'],\n      SELECT: ['value'],\n      TEXTAREA: ['value'],\n    });\n  }\n\n  public static register(container: IContainer) {\n    Registration.aliasTo(INodeObserverLocator, NodeObserverLocator).register(container);\n    Registration.singleton(INodeObserverLocator, NodeObserverLocator).register(container);\n  }\n\n  // deepscan-disable-next-line\n  public handles(obj: unknown, _key: PropertyKey): boolean {\n    return obj instanceof this.platform.Node;\n  }\n\n  public useConfig(config: Record<string, Record<string, INodeObserverConfig>>): void;\n  public useConfig(nodeName: string, key: PropertyKey, events: INodeObserverConfig): void;\n  public useConfig(nodeNameOrConfig: string | Record<string, Record<string, INodeObserverConfig>>, key?: PropertyKey, eventsConfig?: INodeObserverConfig): void {\n    const lookup = this._events;\n    let existingMapping: Record<string, NodeObserverConfig>;\n    if (isString(nodeNameOrConfig)) {\n      existingMapping = lookup[nodeNameOrConfig] ??= createLookup();\n      if (existingMapping[key as string] == null) {\n        existingMapping[key as string] = new NodeObserverConfig(eventsConfig!);\n      } else {\n        throwMappingExisted(nodeNameOrConfig, key!);\n      }\n    } else {\n      for (const nodeName in nodeNameOrConfig) {\n        existingMapping = lookup[nodeName] ??= createLookup();\n        const newMapping = nodeNameOrConfig[nodeName];\n        for (key in newMapping) {\n          if (existingMapping[key] == null) {\n            existingMapping[key] = new NodeObserverConfig(newMapping[key]);\n          } else {\n            throwMappingExisted(nodeName, key);\n          }\n        }\n      }\n    }\n  }\n\n  public useConfigGlobal(config: Record<string, INodeObserverConfig>): void;\n  public useConfigGlobal(key: PropertyKey, events: INodeObserverConfig): void;\n  public useConfigGlobal(configOrKey: PropertyKey | Record<string, INodeObserverConfig>, eventsConfig?: INodeObserverConfig): void {\n    const lookup = this._globalEvents;\n    if (typeof configOrKey === 'object') {\n      for (const key in configOrKey) {\n        if (lookup[key] == null) {\n          lookup[key] = new NodeObserverConfig(configOrKey[key]);\n        } else {\n          throwMappingExisted('*', key);\n        }\n      }\n    } else {\n      if (lookup[configOrKey as string] == null) {\n        lookup[configOrKey as string] = new NodeObserverConfig(eventsConfig!);\n      } else {\n        throwMappingExisted('*', configOrKey);\n      }\n    }\n  }\n\n  // deepscan-disable-nextline\n  public getAccessor(obj: HTMLElement, key: PropertyKey, requestor: IObserverLocator): IAccessor | IObserver {\n    if (key in this._globalOverrides || (key in (this._overrides[obj.tagName] ?? emptyObject))) {\n      return this.getObserver(obj, key, requestor);\n    }\n    switch (key) {\n      // class / style / css attribute will be observed using .getObserver() per overrides\n      //\n      // TODO: there are (many) more situation where we want to default to DataAttributeAccessor,\n      // but for now stick to what vCurrent does\n      case 'src': case 'href': case 'role':\n        // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n        return attrAccessor;\n      default: {\n        const nsProps = nsAttributes[key as string];\n        if (nsProps !== undefined) {\n          return AttributeNSAccessor.forNs(nsProps[1]);\n        }\n        if (isDataAttribute(obj, key, this.svgAnalyzer)) {\n          return attrAccessor;\n        }\n        return elementPropertyAccessor;\n      }\n    }\n  }\n\n  /**\n   * For a list of specific elements\n   * compose a list of properties, based on different tag name,\n   * indicating that an overser should be returned instead of an accessor in `.getAccessor()`\n   */\n  public overrideAccessor(overrides: Record<string, string[]>): void;\n  public overrideAccessor(tagName: string, key: PropertyKey): void;\n  public overrideAccessor(tagNameOrOverrides: string | Record<string, string[]>, key?: PropertyKey): void {\n    let existingTagOverride: Record<string, true> | undefined;\n    if (isString(tagNameOrOverrides)) {\n      existingTagOverride = this._overrides[tagNameOrOverrides] ??= createLookup();\n      existingTagOverride[key as string] = true;\n    } else {\n      for (const tagName in tagNameOrOverrides) {\n        for (const key of tagNameOrOverrides[tagName]) {\n          existingTagOverride =this._overrides[tagName] ??= createLookup();\n          existingTagOverride[key] = true;\n        }\n      }\n    }\n  }\n\n  /**\n   * For all elements:\n   * compose a list of properties,\n   * to indicate that an overser should be returned instead of an accessor in `.getAccessor()`\n   */\n  public overrideAccessorGlobal(...keys: string[]): void {\n    for (const key of keys) {\n      this._globalOverrides[key] = true;\n    }\n  }\n\n  public getObserver(el: HTMLElement, key: PropertyKey, requestor: IObserverLocator): IAccessor | IObserver {\n    switch (key) {\n      case 'role':\n        return attrAccessor;\n      case 'class':\n        return new ClassAttributeAccessor(el);\n      case 'css':\n      case 'style':\n        return new StyleAttributeAccessor(el);\n    }\n    const eventsConfig: NodeObserverConfig | undefined = this._events[el.tagName]?.[key as string] ?? this._globalEvents[key as string];\n    if (eventsConfig != null) {\n      return new eventsConfig.type(el, key, new EventSubscriber(eventsConfig), requestor, this.locator);\n    }\n\n    const nsProps = nsAttributes[key as string];\n    if (nsProps !== undefined) {\n      return AttributeNSAccessor.forNs(nsProps[1]);\n    }\n    if (isDataAttribute(el, key, this.svgAnalyzer)) {\n      // todo: should observe\n      return attrAccessor;\n    }\n    if (key in el.constructor.prototype) {\n      if (this.allowDirtyCheck) {\n        return this.dirtyChecker.createProperty(el, key as string);\n      }\n      // consider:\n      // - maybe add a adapter API to handle unknown obj/key combo\n      if (__DEV__)\n        throw new Error(`Unable to observe property ${String(key)}. Register observation mapping with .useConfig().`);\n      else\n        throw new Error(`AUR0652:${String(key)}`);\n    } else {\n      // todo: probably still needs to get the property descriptor via getOwnPropertyDescriptor\n      // but let's start with simplest scenario\n      return new SetterObserver(el as HTMLElement & IIndexable, key as string);\n    }\n  }\n}\n\nexport function getCollectionObserver(collection: unknown, observerLocator: IObserverLocator): ICollectionObserver<CollectionKind> | undefined {\n  if (collection instanceof Array) {\n    return observerLocator.getArrayObserver(collection);\n  }\n  if (collection instanceof Map) {\n    return observerLocator.getMapObserver(collection);\n  }\n  if (collection instanceof Set) {\n    return observerLocator.getSetObserver(collection);\n  }\n}\n\nfunction throwMappingExisted(nodeName: string, key: PropertyKey): never {\n  if (__DEV__)\n    throw new Error(`Mapping for property ${String(key)} of <${nodeName} /> already exists`);\n  else\n    throw new Error(`AUR0653:${String(key)}@${nodeName}`);\n}\n","import { BindingMode, IObserverLocator, LifecycleFlags, bindingBehavior } from '@aurelia/runtime';\nimport { EventSubscriber } from '../../observation/event-delegator.js';\nimport { NodeObserverConfig } from '../../observation/observer-locator.js';\n\nimport type { Writable } from '@aurelia/kernel';\nimport type { Scope } from '@aurelia/runtime';\nimport type { CheckedObserver } from '../../observation/checked-observer.js';\nimport type { SelectValueObserver } from '../../observation/select-value-observer.js';\nimport type { ValueAttributeObserver } from '../../observation/value-attribute-observer.js';\nimport type { PropertyBinding } from '../../binding/property-binding.js';\n\nexport type UpdateTriggerableObserver = (\n  (ValueAttributeObserver & Required<ValueAttributeObserver>) |\n  (CheckedObserver & Required<CheckedObserver>) |\n  (SelectValueObserver & Required<SelectValueObserver>)\n) & {\n  originalHandler?: EventSubscriber;\n};\n\nexport type UpdateTriggerableBinding = PropertyBinding & {\n  targetObserver: UpdateTriggerableObserver;\n};\n\nexport class UpdateTriggerBindingBehavior {\n  public static inject = [IObserverLocator];\n  private readonly oL: IObserverLocator;\n  public constructor(\n    observerLocator: IObserverLocator,\n  ) {\n    this.oL = observerLocator;\n  }\n\n  public bind(flags: LifecycleFlags, _scope: Scope, binding: UpdateTriggerableBinding, ...events: string[]): void {\n    if (events.length === 0) {\n      if (__DEV__)\n        throw new Error('The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">');\n      else\n        throw new Error(`AUR0802`);\n    }\n\n    if (binding.mode !== BindingMode.twoWay && binding.mode !== BindingMode.fromView) {\n      if (__DEV__)\n        throw new Error('The updateTrigger binding behavior can only be applied to two-way/ from-view bindings.');\n      else\n        throw new Error('AUR0803');\n    }\n\n    // ensure the binding's target observer has been set.\n    const targetObserver = this.oL.getObserver(binding.target, binding.targetProperty) as UpdateTriggerableObserver;\n    if (!targetObserver.handler) {\n      if (__DEV__)\n        throw new Error('The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.');\n      else\n        throw new Error('AUR0804');\n    }\n\n    binding.targetObserver = targetObserver;\n\n    // stash the original element subscribe function.\n    const originalHandler = targetObserver.handler;\n    targetObserver.originalHandler = originalHandler;\n\n    // replace the element subscribe function with one that uses the correct events.\n    (targetObserver as Writable<typeof targetObserver>).handler = new EventSubscriber(new NodeObserverConfig({\n      default: originalHandler.config.default,\n      events,\n      readonly: originalHandler.config.readonly\n    }));\n  }\n\n  public unbind(flags: LifecycleFlags, _scope: Scope, binding: UpdateTriggerableBinding): void {\n    // restore the state of the binding.\n    binding.targetObserver.handler.dispose();\n    (binding.targetObserver as Writable<typeof binding.targetObserver>).handler = binding.targetObserver.originalHandler!;\n    binding.targetObserver.originalHandler = null!;\n  }\n}\n\nbindingBehavior('updateTrigger')(UpdateTriggerBindingBehavior);\n","import { BindingMode } from '@aurelia/runtime';\nimport { INode } from '../../dom.js';\nimport { IPlatform } from '../../platform.js';\nimport { customAttribute } from '../custom-attribute.js';\nimport { bindable } from '../../bindable.js';\nimport type { ICustomAttributeController, ICustomAttributeViewModel } from '../../templating/controller.js';\n\n/**\n * Focus attribute for element focus binding\n */\nexport class Focus implements ICustomAttributeViewModel {\n  /** @internal */ protected static inject = [INode, IPlatform];\n\n  public readonly $controller!: ICustomAttributeController<this>;\n\n  @bindable({ mode: BindingMode.twoWay })\n  public value: unknown;\n\n  /**\n   * Indicates whether `apply` should be called when `attached` callback is invoked\n   *\n   * @internal\n   */\n  private _needsApply: boolean = false;\n\n  public constructor(\n    private readonly _element: INode<HTMLElement>,\n    private readonly _platform: IPlatform,\n  ) {}\n\n  public binding(): void {\n    this.valueChanged();\n  }\n\n  /**\n   * Invoked everytime the bound value changes.\n   *\n   * @param newValue - The new value.\n   */\n  public valueChanged(): void {\n    // In theory, we could/should react immediately\n    // but focus state of an element cannot be achieved\n    // while it's disconnected from the document\n    // thus, there neesd to be a check if it's currently connected or not\n    // before applying the value to the element\n    if (this.$controller.isActive) {\n      this._apply();\n    } else {\n      // If the element is not currently connect\n      // toggle the flag to add pending work for later\n      // in attached lifecycle\n      this._needsApply = true;\n    }\n  }\n\n  /**\n   * Invoked when the attribute is attached to the DOM.\n   */\n  public attached(): void {\n    if (this._needsApply) {\n      this._needsApply = false;\n      this._apply();\n    }\n    this._element.addEventListener('focus', this);\n    this._element.addEventListener('blur', this);\n  }\n\n  /**\n   * Invoked when the attribute is afterDetachChildren from the DOM.\n   */\n  public afterDetachChildren(): void {\n    const el = this._element;\n    el.removeEventListener('focus', this);\n    el.removeEventListener('blur', this);\n  }\n\n  /**\n   * EventTarget interface handler for better memory usage\n   */\n  public handleEvent(e: FocusEvent): void {\n    // there are only two event listened to\n    // if the even is focus, it menans the element is focused\n    // only need to switch the value to true\n    if (e.type === 'focus') {\n      this.value = true;\n    } else if (!this._isElFocused) {\n      // else, it's blur event\n      // when a blur event happens, there are two situations\n      // 1. the element itself lost the focus\n      // 2. window lost the focus\n      // To handle both (1) and (2), only need to check if\n      // current active element is still the same element of this focus custom attribute\n      // If it's not, it's a blur event happened on Window because the browser tab lost focus\n      this.value = false;\n    }\n  }\n\n  /**\n   * Focus/blur based on current value\n   */\n  private _apply(): void {\n    const el = this._element;\n    const isFocused = this._isElFocused;\n    const shouldFocus = this.value;\n    if (shouldFocus && !isFocused) {\n      el.focus();\n    } else if (!shouldFocus && isFocused) {\n      el.blur();\n    }\n  }\n\n  /** @internal */ private get _isElFocused(): boolean {\n    return this._element === this._platform.document.activeElement;\n  }\n}\n\ncustomAttribute('focus')(Focus);\n","import { alias } from '@aurelia/runtime';\n\nimport { INode } from '../../dom.js';\nimport { IPlatform } from '../../platform.js';\nimport { customAttribute } from '../custom-attribute.js';\nimport { bindable } from '../../bindable.js';\nimport { IInstruction } from '../../renderer.js';\n\nimport type { ITask } from '@aurelia/runtime';\n\nimport type { ICustomAttributeViewModel } from '../../templating/controller.js';\nimport type { HydrateAttributeInstruction } from '../../renderer.js';\n\nexport class Show implements ICustomAttributeViewModel {\n  @bindable public value: unknown;\n\n  /** @internal */ private _isToggled: boolean;\n  /** @internal */ private _isActive: boolean = false;\n  /** @internal */ private _task: ITask | null = null;\n  /** @internal */ private readonly _base: boolean;\n\n  public constructor(\n    @INode private readonly el: INode<HTMLElement>,\n    @IPlatform private readonly p: IPlatform,\n    @IInstruction instr: HydrateAttributeInstruction,\n  ) {\n    // if this is declared as a 'hide' attribute, then this.base will be false, inverting everything.\n    this._isToggled = this._base = instr.alias !== 'hide';\n  }\n\n  public binding(): void {\n    this._isActive = true;\n    this.update();\n  }\n\n  public detaching() {\n    this._isActive = false;\n    this._task?.cancel();\n    this._task = null;\n  }\n\n  public valueChanged(): void {\n    if (this._isActive && this._task === null) {\n      this._task = this.p.domWriteQueue.queueTask(this.update);\n    }\n  }\n\n  private $val: string = '';\n  private $prio: string = '';\n  private readonly update = (): void => {\n    this._task = null;\n\n    // Only compare at the synchronous moment when we're about to update, because the value might have changed since the update was queued.\n    if (Boolean(this.value) !== this._isToggled) {\n      if (this._isToggled === this._base) {\n        this._isToggled = !this._base;\n        // Note: in v1 we used the 'au-hide' class, but in v2 it's so trivial to conditionally apply classes (e.g. 'hide.class=\"someCondition\"'),\n        // that it's probably better to avoid the CSS inject infra involvement and keep this CA as simple as possible.\n        // Instead, just store and restore the property values (with each mutation, to account for in-between updates), to cover the common cases, until there is convincing feedback to do otherwise.\n        this.$val = this.el.style.getPropertyValue('display');\n        this.$prio = this.el.style.getPropertyPriority('display');\n        this.el.style.setProperty('display', 'none', 'important');\n      } else {\n        this._isToggled = this._base;\n        this.el.style.setProperty('display', this.$val, this.$prio);\n        // If the style attribute is now empty, remove it.\n        if (this.el.getAttribute('style') === '') {\n          this.el.removeAttribute('style');\n        }\n      }\n    }\n  };\n}\n\nalias('hide')(Show);\ncustomAttribute('show')(Show);\n","import { nextId, onResolve } from '@aurelia/kernel';\nimport { LifecycleFlags } from '@aurelia/runtime';\nimport { IRenderLocation, setEffectiveParentNode } from '../../dom.js';\nimport { IPlatform } from '../../platform.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { templateController } from '../custom-attribute.js';\nimport { bindable } from '../../bindable.js';\nimport { isString } from '../../utilities.js';\nimport type { ControllerVisitor, ICustomAttributeController, ICustomAttributeViewModel, IHydratedController, IHydratedParentController, ISyntheticView } from '../../templating/controller.js';\n\nexport type PortalTarget<T extends Node & ParentNode = Node & ParentNode> = string | T | null | undefined;\ntype ResolvedTarget<T extends Node & ParentNode = Node & ParentNode> = T | null;\n\nexport type PortalLifecycleCallback = (target: PortalTarget, view: ISyntheticView) => void | Promise<void>;\n\nexport class Portal<T extends Node & ParentNode = Node & ParentNode> implements ICustomAttributeViewModel {\n  public static inject = [IViewFactory, IRenderLocation, IPlatform];\n\n  public readonly $controller!: ICustomAttributeController<this>;\n\n  public readonly id: number = nextId('au$component');\n\n  @bindable({ primary: true })\n  public target: PortalTarget;\n\n  @bindable({ callback: 'targetChanged' })\n  public renderContext: PortalTarget;\n\n  @bindable()\n  public strict: boolean = false;\n\n  @bindable()\n  public deactivating?: PortalLifecycleCallback;\n\n  @bindable()\n  public activating?: PortalLifecycleCallback;\n\n  @bindable()\n  public deactivated?: PortalLifecycleCallback;\n\n  @bindable()\n  public activated?: PortalLifecycleCallback;\n\n  @bindable()\n  public callbackContext: unknown;\n\n  public view: ISyntheticView;\n\n  /** @internal */ private _currentTarget?: PortalTarget;\n  /** @internal */ private readonly _platform: IPlatform;\n\n  public constructor(\n    factory: IViewFactory,\n    originalLoc: IRenderLocation,\n    p: IPlatform,\n  ) {\n    this._platform = p;\n    // to make the shape of this object consistent.\n    // todo: is this necessary\n    this._currentTarget = p.document.createElement('div');\n\n    this.view = factory.create();\n    setEffectiveParentNode(this.view.nodes, originalLoc as unknown as Node);\n  }\n\n  public attaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    if (this.callbackContext == null) {\n      this.callbackContext = this.$controller.scope.bindingContext;\n    }\n    const newTarget = this._currentTarget = this._resolveTarget();\n    this.view.setHost(newTarget);\n\n    return this._activating(initiator, newTarget, flags);\n  }\n\n  public detaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return this._deactivating(initiator, this._currentTarget as T, flags);\n  }\n\n  public targetChanged(): void {\n    const { $controller } = this;\n    if (!$controller.isActive) {\n      return;\n    }\n\n    const oldTarget = this._currentTarget;\n    const newTarget = this._currentTarget = this._resolveTarget();\n\n    if (oldTarget === newTarget) {\n      return;\n    }\n\n    this.view.setHost(newTarget);\n    // TODO(fkleuver): fix and test possible race condition\n    const ret = onResolve(\n      this._deactivating(null, newTarget, $controller.flags),\n      () => {\n        return this._activating(null, newTarget, $controller.flags);\n      },\n    );\n    if (ret instanceof Promise) { ret.catch(err => { throw err; }); }\n  }\n\n  /** @internal */\n  private _activating(\n    initiator: IHydratedController | null,\n    target: T,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { activating, callbackContext, view } = this;\n\n    view.setHost(target);\n\n    return onResolve(\n      activating?.call(callbackContext, target, view),\n      () => {\n        return this._activate(initiator, target, flags);\n      },\n    );\n  }\n\n  /** @internal */\n  private _activate(\n    initiator: IHydratedController | null,\n    target: T,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { $controller, view } = this;\n\n    if (initiator === null) {\n      view.nodes.appendTo(target);\n    } else {\n      // TODO(fkleuver): fix and test possible race condition\n      return onResolve(\n        view.activate(initiator ?? view, $controller, flags, $controller.scope),\n        () => {\n          return this._activated(target);\n        },\n      );\n    }\n\n    return this._activated(target);\n  }\n\n  /** @internal */\n  private _activated(\n    target: T,\n  ): void | Promise<void> {\n    const { activated, callbackContext, view } = this;\n\n    return activated?.call(callbackContext, target, view);\n  }\n\n  /** @internal */\n  private _deactivating(\n    initiator: IHydratedController | null,\n    target: T,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { deactivating, callbackContext, view } = this;\n\n    return onResolve(\n      deactivating?.call(callbackContext, target, view),\n      () => {\n        return this._deactivate(initiator, target, flags);\n      },\n    );\n  }\n\n  /** @internal */\n  private _deactivate(\n    initiator: IHydratedController | null,\n    target: T,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { $controller, view } = this;\n\n    if (initiator === null) {\n      view.nodes.remove();\n    } else {\n      return onResolve(\n        view.deactivate(initiator, $controller, flags),\n        () => {\n          return this._deactivated(target);\n        },\n      );\n    }\n\n    return this._deactivated(target);\n  }\n\n  /** @internal */\n  private _deactivated(\n    target: T,\n  ): void | Promise<void> {\n    const { deactivated, callbackContext, view } = this;\n\n    return deactivated?.call(callbackContext, target, view);\n  }\n\n  private _resolveTarget(): T {\n    const p = this._platform;\n    // with a $ in front to make it less confusing/error prone\n    const $document = p.document;\n    let target = this.target;\n    let context = this.renderContext;\n\n    if (target === '') {\n      if (this.strict) {\n        if (__DEV__)\n          throw new Error('Empty querySelector');\n        else\n          throw new Error('AUR0811');\n      }\n      return $document.body as unknown as T;\n    }\n\n    if (isString(target)) {\n      let queryContext: ParentNode = $document;\n      if (isString(context)) {\n        context = $document.querySelector(context) as ResolvedTarget;\n      }\n      if (context instanceof p.Node) {\n        queryContext = context;\n      }\n      target = queryContext.querySelector(target) as ResolvedTarget;\n    }\n\n    if (target instanceof p.Node) {\n      return target as T & Node & ParentNode;\n    }\n\n    if (target == null) {\n      if (this.strict) {\n        if (__DEV__)\n          throw new Error('Portal target not found');\n        else\n          throw new Error('AUR0812');\n      }\n      return $document.body as unknown as T;\n    }\n\n    return target as T & Node & ParentNode;\n  }\n\n  public dispose(): void {\n    this.view.dispose();\n    this.view = (void 0)!;\n    this.callbackContext = null;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.view?.accept(visitor) === true) {\n      return true;\n    }\n  }\n}\n\ntemplateController('portal')(Portal);\n","import { nextId } from '@aurelia/kernel';\nimport { LifecycleFlags } from '@aurelia/runtime';\nimport { IRenderLocation } from '../../dom.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { templateController } from '../custom-attribute.js';\nimport type { ISyntheticView, ICustomAttributeController, ICustomAttributeViewModel, IHydratedController, IHydratedParentController, ControllerVisitor } from '../../templating/controller.js';\n\nabstract class FlagsTemplateController implements ICustomAttributeViewModel {\n  public readonly id: number;\n\n  public view: ISyntheticView;\n\n  public readonly $controller!: ICustomAttributeController<this>;\n\n  public constructor(\n    factory: IViewFactory,\n    location: IRenderLocation,\n  /** @internal */ private readonly _flags: LifecycleFlags,\n  ) {\n    this.id = nextId('au$component');\n\n    this.view = factory.create().setLocation(location);\n  }\n\n  public attaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { $controller } = this;\n    return this.view.activate(initiator, $controller, flags | this._flags, $controller.scope);\n  }\n\n  public detaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return this.view.deactivate(initiator, this.$controller, flags);\n  }\n\n  public dispose(): void {\n    this.view.dispose();\n    this.view = (void 0)!;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.view?.accept(visitor) === true) {\n      return true;\n    }\n  }\n}\n\nexport class FrequentMutations extends FlagsTemplateController {\n  /** @internal */ protected static inject = [IViewFactory, IRenderLocation];\n\n  public constructor(factory: IViewFactory, location: IRenderLocation) {\n    super(factory, location, LifecycleFlags.persistentTargetObserverQueue);\n  }\n}\n\nexport class ObserveShallow extends FlagsTemplateController {\n  /** @internal */ protected static inject = [IViewFactory, IRenderLocation];\n\n  public constructor(factory: IViewFactory, location: IRenderLocation) {\n    super(factory, location, LifecycleFlags.observeLeafPropertiesOnly);\n  }\n}\n\ntemplateController('frequent-mutations')(FrequentMutations);\ntemplateController('observe-shallow')(ObserveShallow);\n","import { nextId, onResolve } from '@aurelia/kernel';\nimport { LifecycleFlags } from '@aurelia/runtime';\nimport { IRenderLocation } from '../../dom.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { templateController } from '../custom-attribute.js';\nimport { bindable } from '../../bindable.js';\nimport { IWorkTracker } from '../../app-root.js';\n\nimport type { ISyntheticView, ICustomAttributeController, ICustomAttributeViewModel, IHydratedController, IHydratedParentController, ControllerVisitor, IHydratableController } from '../../templating/controller.js';\nimport type { IInstruction } from '../../renderer.js';\nimport type { INode } from '../../dom.js';\n\nexport class If implements ICustomAttributeViewModel {\n  /** @internal */ protected static inject = [IViewFactory, IRenderLocation, IWorkTracker];\n\n  public readonly id: number = nextId('au$component');\n\n  public elseFactory?: IViewFactory = void 0;\n  public elseView?: ISyntheticView = void 0;\n  public ifView?: ISyntheticView = void 0;\n  public view?: ISyntheticView = void 0;\n\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n\n  @bindable public value: unknown = false;\n  /**\n   * `false` to always dispose the existing `view` whenever the value of if changes to false\n   */\n  @bindable({\n    set: v => v === '' || !!v && v !== 'false'\n  })\n  public cache: boolean = true;\n  private pending: void | Promise<void> = void 0;\n  private _wantsDeactivate: boolean = false;\n  private _swapId: number = 0;\n\n  public constructor(\n    private readonly ifFactory: IViewFactory,\n    private readonly location: IRenderLocation,\n    private readonly work: IWorkTracker,\n  ) {}\n\n  public attaching(initiator: IHydratedController, parent: IHydratedController, f: LifecycleFlags): void | Promise<void> {\n    let view: ISyntheticView | undefined;\n    const ctrl = this.$controller;\n    const swapId = this._swapId++;\n    /**\n     * returns true when\n     * 1. entering deactivation of the [if] itself\n     * 2. new swap has started since this change\n     */\n    const isCurrent = () => !this._wantsDeactivate && this._swapId === swapId + 1;\n    return onResolve(this.pending, () => {\n      if (!isCurrent()) {\n        return;\n      }\n      this.pending = void 0;\n      if (this.value) {\n        view = (this.view = this.ifView = this.cache && this.ifView != null\n          ? this.ifView\n          : this.ifFactory.create()\n        );\n      } else {\n        // truthy -> falsy\n        view = (this.view = this.elseView = this.cache && this.elseView != null\n          ? this.elseView\n          : this.elseFactory?.create()\n        );\n      }\n      if (view == null) {\n        return;\n      }\n      // todo: else view should set else location\n      view.setLocation(this.location);\n\n      // Promise return values from user VM hooks are awaited by the initiator\n      this.pending = onResolve(\n        view.activate(initiator, ctrl, f, ctrl.scope),\n        () => {\n          if (isCurrent()) {\n            this.pending = void 0;\n          }\n        });\n      // old\n      // void (this.view = this.updateView(this.value, f))?.activate(initiator, this.ctrl, f, this.ctrl.scope);\n    });\n  }\n\n  public detaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    this._wantsDeactivate = true;\n    return onResolve(this.pending, () => {\n      this._wantsDeactivate = false;\n      this.pending = void 0;\n      // Promise return values from user VM hooks are awaited by the initiator\n      void this.view?.deactivate(initiator, this.$controller, flags);\n    });\n  }\n\n  public valueChanged(newValue: unknown, oldValue: unknown, f: LifecycleFlags): void | Promise<void> {\n    if (!this.$controller.isActive) {\n      return;\n    }\n    // change scenarios:\n    // truthy -> truthy (do nothing)\n    // falsy -> falsy (do nothing)\n    // truthy -> falsy (no cache = destroy)\n    // falsy -> truthy (no view = create)\n    newValue = !!newValue;\n    oldValue = !!oldValue;\n    if (newValue === oldValue) {\n      return;\n    }\n    this.work.start();\n    const currView = this.view;\n    const ctrl = this.$controller;\n    const swapId = this._swapId++;\n    /**\n     * returns true when\n     * 1. entering deactivation of the [if] itself\n     * 2. new swap has started since this change\n     */\n    const isCurrent = () => !this._wantsDeactivate && this._swapId === swapId + 1;\n    let view: ISyntheticView | undefined;\n    return onResolve(onResolve(this.pending,\n      () => this.pending = onResolve(\n        currView?.deactivate(currView, ctrl, f),\n        () => {\n          if (!isCurrent()) {\n            return;\n          }\n          // falsy -> truthy\n          if (newValue) {\n            view = (this.view = this.ifView = this.cache && this.ifView != null\n              ? this.ifView\n              : this.ifFactory.create()\n            );\n          } else {\n            // truthy -> falsy\n            view = (this.view = this.elseView = this.cache && this.elseView != null\n              ? this.elseView\n              : this.elseFactory?.create()\n            );\n          }\n          if (view == null) {\n            return;\n          }\n          // todo: location should be based on either the [if]/[else] attribute\n          //       instead of always the if\n          view.setLocation(this.location);\n          return onResolve(\n            view.activate(view, ctrl, f, ctrl.scope),\n            () => {\n              if (isCurrent()) {\n                this.pending = void 0;\n              }\n            }\n          );\n        }\n      )\n    ), () => this.work.finish());\n  }\n\n  public dispose(): void {\n    this.ifView?.dispose();\n    this.elseView?.dispose();\n    this.ifView\n      = this.elseView\n      = this.view\n      = void 0;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.view?.accept(visitor) === true) {\n      return true;\n    }\n  }\n}\ntemplateController('if')(If);\n\nexport class Else implements ICustomAttributeViewModel {\n  public static inject = [IViewFactory];\n  public readonly id: number = nextId('au$component');\n\n  public constructor(\n    private readonly factory: IViewFactory,\n  ) {}\n\n  public link(\n    controller: IHydratableController,\n    _childController: ICustomAttributeController,\n    _target: INode,\n    _instruction: IInstruction,\n  ): void {\n    const children = controller.children!;\n    const ifBehavior: If | ICustomAttributeController = children[children.length - 1] as If | ICustomAttributeController;\n    if (ifBehavior instanceof If) {\n      ifBehavior.elseFactory = this.factory;\n    } else if (ifBehavior.viewModel instanceof If) {\n      ifBehavior.viewModel.elseFactory = this.factory;\n    } else {\n      if (__DEV__)\n        throw new Error(`Unsupported If behavior`); // TODO: create error code\n      else\n        throw new Error('AUR0810');\n    }\n  }\n}\ntemplateController({ name: 'else' })(Else);\n","import { compareNumber, nextId, IDisposable, onResolve } from '@aurelia/kernel';\nimport {\n  applyMutationsToIndices,\n  BindingBehaviorExpression,\n  BindingContext,\n  Collection,\n  CollectionObserver,\n  DestructuringAssignmentExpression,\n  ExpressionKind,\n  ForOfStatement,\n  getCollectionObserver,\n  IndexMap,\n  IOverrideContext,\n  IsBindingBehavior,\n  LifecycleFlags as LF,\n  Scope,\n  synchronizeIndices,\n  ValueConverterExpression,\n} from '@aurelia/runtime';\nimport { IRenderLocation } from '../../dom.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { templateController } from '../custom-attribute.js';\nimport { IController } from '../../templating/controller.js';\nimport { bindable } from '../../bindable.js';\n\nimport type { PropertyBinding } from '../../binding/property-binding.js';\nimport type { ISyntheticView, ICustomAttributeController, IHydratableController, ICustomAttributeViewModel, IHydratedController, IHydratedParentController, ControllerVisitor } from '../../templating/controller.js';\n\ntype Items<C extends Collection = unknown[]> = C | undefined;\n\nfunction dispose(disposable: IDisposable): void {\n  disposable.dispose();\n}\n\nconst wrappedExprs = [\n  ExpressionKind.BindingBehavior,\n  ExpressionKind.ValueConverter,\n];\n\nexport class Repeat<C extends Collection = unknown[]> implements ICustomAttributeViewModel {\n  /** @internal */ protected static inject = [IRenderLocation, IController, IViewFactory];\n  public readonly id: number = nextId('au$component');\n\n  public views: ISyntheticView[] = [];\n  public key?: string = void 0;\n\n  public forOf!: ForOfStatement;\n  public local!: string;\n\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n\n  @bindable public items: Items<C>;\n\n  /** @internal */ private _observer?: CollectionObserver = void 0;\n  /** @internal */ private _innerItems: Items<C> | null;\n  /** @internal */ private _forOfBinding!: PropertyBinding;\n  /** @internal */ private _observingInnerItems: boolean = false;\n  /** @internal */ private _reevaluating: boolean = false;\n  /** @internal */ private _innerItemsExpression: IsBindingBehavior | null = null;\n  /** @internal */ private _normalizedItems?: unknown[] = void 0;\n  /** @internal */ private _hasDestructuredLocal: boolean = false;\n\n  public constructor(\n    /** @internal */ private readonly _location: IRenderLocation,\n    /** @internal */ private readonly _parent: IHydratableController,\n    /** @internal */ private readonly _factory: IViewFactory\n  ) {}\n\n  public binding(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LF,\n  ): void | Promise<void> {\n    const bindings = this._parent.bindings as PropertyBinding[];\n    const ii = bindings.length;\n    let binding: PropertyBinding = (void 0)!;\n    let forOf!: ForOfStatement;\n    let i = 0;\n    for (; ii > i; ++i) {\n      binding = bindings[i];\n      if (binding.target === this && binding.targetProperty === 'items') {\n        forOf = this.forOf = binding.sourceExpression as ForOfStatement;\n        this._forOfBinding = binding;\n\n        let expression = forOf.iterable;\n        while (expression != null && wrappedExprs.includes(expression.$kind)) {\n          expression = (expression as ValueConverterExpression | BindingBehaviorExpression).expression;\n          this._observingInnerItems = true;\n        }\n        this._innerItemsExpression = expression;\n\n        break;\n      }\n    }\n\n    this._checkCollectionObserver(flags);\n    const dec = forOf.declaration;\n    if(!(this._hasDestructuredLocal = dec.$kind === ExpressionKind.ArrayDestructuring || dec.$kind === ExpressionKind.ObjectDestructuring)) {\n      this.local = dec.evaluate(flags, this.$controller.scope, binding.locator, null) as string;\n    }\n  }\n\n  public attaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LF,\n  ): void | Promise<void> {\n    this._normalizeToArray(flags);\n\n    return this._activateAllViews(initiator, flags);\n  }\n\n  public detaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LF,\n  ): void | Promise<void> {\n    this._checkCollectionObserver(flags);\n\n    return this._deactivateAllViews(initiator, flags);\n  }\n\n  // called by SetterObserver\n  public itemsChanged(flags: LF): void {\n    const { $controller } = this;\n    if (!$controller.isActive) {\n      return;\n    }\n    flags |= $controller.flags;\n    this._checkCollectionObserver(flags);\n    this._normalizeToArray(flags);\n\n    const ret = onResolve(\n      this._deactivateAllViews(null, flags),\n      () => {\n        // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add a variety of `if` integration tests\n        return this._activateAllViews(null, flags);\n      },\n    );\n    if (ret instanceof Promise) { ret.catch(err => { throw err; }); }\n  }\n\n  // called by a CollectionObserver\n  public handleCollectionChange(\n    indexMap: IndexMap | undefined,\n    flags: LF,\n  ): void {\n    const { $controller } = this;\n    if (!$controller.isActive) {\n      return;\n    }\n    if (this._observingInnerItems) {\n      if (this._reevaluating) {\n        return;\n      }\n      this._reevaluating = true;\n      this.items = this.forOf.iterable.evaluate(flags, $controller.scope, this._forOfBinding.locator, null) as Items<C>;\n      this._reevaluating = false;\n      return;\n    }\n\n    flags |= $controller.flags;\n    this._normalizeToArray(flags);\n\n    if (indexMap === void 0) {\n      const ret = onResolve(\n        this._deactivateAllViews(null, flags),\n        () => {\n          // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add a variety of `if` integration tests\n          return this._activateAllViews(null, flags);\n        },\n      );\n      if (ret instanceof Promise) { ret.catch(err => { throw err; }); }\n    } else {\n      const oldLength = this.views.length;\n      applyMutationsToIndices(indexMap);\n      // first detach+unbind+(remove from array) the deleted view indices\n      if (indexMap.deletedItems.length > 0) {\n        indexMap.deletedItems.sort(compareNumber);\n        const ret = onResolve(\n          this._deactivateAndRemoveViewsByKey(indexMap, flags),\n          () => {\n            // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add a variety of `if` integration tests\n            return this._createAndActivateAndSortViewsByKey(oldLength, indexMap, flags);\n          },\n        );\n        if (ret instanceof Promise) { ret.catch(err => { throw err; }); }\n      } else {\n        // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add integration tests\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this._createAndActivateAndSortViewsByKey(oldLength, indexMap, flags);\n      }\n    }\n  }\n\n  // todo: subscribe to collection from inner expression\n  /** @internal */\n  private _checkCollectionObserver(flags: LF): void {\n    const scope = this.$controller.scope;\n\n    let innerItems = this._innerItems;\n    let observingInnerItems = this._observingInnerItems;\n    if (observingInnerItems) {\n      innerItems = this._innerItems = this._innerItemsExpression!.evaluate(flags, scope, this._forOfBinding.locator, null) as Items<C> ?? null;\n      observingInnerItems = this._observingInnerItems = !Object.is(this.items, innerItems);\n    }\n\n    const oldObserver = this._observer;\n    if ((flags & LF.fromUnbind)) {\n      if (oldObserver !== void 0) {\n        oldObserver.unsubscribe(this);\n      }\n    } else if (this.$controller.isActive) {\n      const newObserver = this._observer = getCollectionObserver(observingInnerItems ? innerItems : this.items);\n      if (oldObserver !== newObserver && oldObserver) {\n        oldObserver.unsubscribe(this);\n      }\n      if (newObserver) {\n        newObserver.subscribe(this);\n      }\n    }\n  }\n\n  /** @internal */\n  private _normalizeToArray(flags: LF): void {\n    const items: Items<C> = this.items;\n    if (items instanceof Array) {\n      this._normalizedItems = items;\n      return;\n    }\n    const forOf = this.forOf;\n    if (forOf === void 0) {\n      return;\n    }\n    const normalizedItems: unknown[] = [];\n    this.forOf.iterate(flags, items, (arr, index, item) => {\n      normalizedItems[index] = item;\n    });\n    this._normalizedItems = normalizedItems;\n  }\n\n  /** @internal */\n  private _activateAllViews(\n    initiator: IHydratedController | null,\n    flags: LF,\n  ): void | Promise<void> {\n    let promises: Promise<void>[] | undefined = void 0;\n    let ret: void | Promise<void>;\n    let view: ISyntheticView;\n    let viewScope: Scope;\n\n    const { $controller, _factory: factory, local, _location: location, items } = this;\n    const parentScope = $controller.scope;\n    const forOf = this.forOf;\n    const newLen = forOf.count(flags, items);\n    const views = this.views = Array(newLen);\n\n    forOf.iterate(flags, items, (arr, i, item) => {\n      view = views[i] = factory.create().setLocation(location);\n      view.nodes.unlink();\n      if(this._hasDestructuredLocal) {\n        (forOf.declaration as DestructuringAssignmentExpression)!.assign(flags, viewScope = Scope.fromParent(parentScope, BindingContext.create()), this._forOfBinding.locator, item);\n      } else {\n        viewScope = Scope.fromParent(parentScope, BindingContext.create(local, item));\n      }\n      setContextualProperties(viewScope.overrideContext as IRepeatOverrideContext, i, newLen);\n\n      ret = view.activate(initiator ?? view, $controller, flags, viewScope);\n      if (ret instanceof Promise) {\n        (promises ?? (promises = [])).push(ret);\n      }\n    });\n\n    if (promises !== void 0) {\n      return (promises as Promise<void>[]).length === 1\n        ? promises[0]\n        : Promise.all(promises) as unknown as Promise<void>;\n    }\n  }\n\n  /** @internal */\n  private _deactivateAllViews(\n    initiator: IHydratedController | null,\n    flags: LF,\n  ): void | Promise<void> {\n    let promises: Promise<void>[] | undefined = void 0;\n    let ret: void | Promise<void>;\n    let view: ISyntheticView;\n    let i = 0;\n\n    const { views, $controller } = this;\n    const ii = views.length;\n\n    for (; ii > i; ++i) {\n      view = views[i];\n      view.release();\n      ret = view.deactivate(initiator ?? view, $controller, flags);\n      if (ret instanceof Promise) {\n        (promises ?? (promises = [])).push(ret);\n      }\n    }\n\n    if (promises !== void 0) {\n      return promises.length === 1\n        ? promises[0]\n        : Promise.all(promises) as unknown as Promise<void>;\n    }\n  }\n\n  /** @internal */\n  private _deactivateAndRemoveViewsByKey(\n    indexMap: IndexMap,\n    flags: LF,\n  ): void | Promise<void> {\n    let promises: Promise<void>[] | undefined = void 0;\n    let ret: void | Promise<void>;\n    let view: ISyntheticView;\n\n    const { $controller, views } = this;\n\n    const deleted = indexMap.deletedItems;\n    const deletedLen = deleted.length;\n    let i = 0;\n    for (; deletedLen > i; ++i) {\n      view = views[deleted[i]];\n      view.release();\n      ret = view.deactivate(view, $controller, flags);\n      if (ret instanceof Promise) {\n        (promises ?? (promises = [])).push(ret);\n      }\n    }\n\n    i = 0;\n    let j = 0;\n    for (; deletedLen > i; ++i) {\n      j = deleted[i] - i;\n      views.splice(j, 1);\n    }\n\n    if (promises !== void 0) {\n      return promises.length === 1\n        ? promises[0]\n        : Promise.all(promises) as unknown as Promise<void>;\n    }\n  }\n\n  /** @internal */\n  private _createAndActivateAndSortViewsByKey(\n    oldLength: number,\n    indexMap: IndexMap,\n    flags: LF,\n  ): void | Promise<void> {\n    let promises: Promise<void>[] | undefined = void 0;\n    let ret: void | Promise<void>;\n    let view: ISyntheticView;\n    let viewScope: Scope;\n    let i = 0;\n\n    const { $controller, _factory: factory, local, _normalizedItems: normalizedItems, _location: location, views } = this;\n    const mapLen = indexMap.length;\n\n    for (; mapLen > i; ++i) {\n      if (indexMap[i] === -2) {\n        view = factory.create();\n        views.splice(i, 0, view);\n      }\n    }\n\n    if (views.length !== mapLen) {\n      if (__DEV__)\n        throw new Error(`viewsLen=${views.length}, mapLen=${mapLen}`);\n      else\n        throw new Error(`AUR0814:${views.length}!=${mapLen}`);\n    }\n\n    const parentScope = $controller.scope;\n    const newLen = indexMap.length;\n    synchronizeIndices(views, indexMap);\n\n    // this algorithm retrieves the indices of the longest increasing subsequence of items in the repeater\n    // the items on those indices are not moved; this minimizes the number of DOM operations that need to be performed\n    const seq = longestIncreasingSubsequence(indexMap);\n    const seqLen = seq.length;\n\n    let next: ISyntheticView;\n    let j = seqLen - 1;\n    i = newLen - 1;\n    for (; i >= 0; --i) {\n      view = views[i];\n      next = views[i + 1];\n\n      view.nodes.link(next?.nodes ?? location);\n\n      if (indexMap[i] === -2) {\n        if(this._hasDestructuredLocal) {\n          (this.forOf.declaration as DestructuringAssignmentExpression)!.assign(flags, viewScope = Scope.fromParent(parentScope, BindingContext.create()), this._forOfBinding.locator, normalizedItems![i]);\n        } else {\n          viewScope = Scope.fromParent(parentScope, BindingContext.create(local, normalizedItems![i]));\n        }\n        setContextualProperties(viewScope.overrideContext as IRepeatOverrideContext, i, newLen);\n        view.setLocation(location);\n\n        ret = view.activate(view, $controller, flags, viewScope);\n        if (ret instanceof Promise) {\n          (promises ?? (promises = [])).push(ret);\n        }\n      } else if (j < 0 || seqLen === 1 || i !== seq[j]) {\n        setContextualProperties(view.scope.overrideContext as IRepeatOverrideContext, i, newLen);\n        view.nodes.insertBefore(view.location!);\n      } else {\n        if (oldLength !== newLen) {\n          setContextualProperties(view.scope.overrideContext as IRepeatOverrideContext, i, newLen);\n        }\n        --j;\n      }\n    }\n\n    if (promises !== void 0) {\n      return promises.length === 1\n        ? promises[0]\n        : Promise.all(promises) as unknown as Promise<void>;\n    }\n  }\n\n  public dispose(): void {\n    this.views.forEach(dispose);\n    this.views = (void 0)!;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    const { views } = this;\n\n    if (views !== void 0) {\n      for (let i = 0, ii = views.length; i < ii; ++i) {\n        if (views[i].accept(visitor) === true) {\n          return true;\n        }\n      }\n    }\n  }\n}\ntemplateController('repeat')(Repeat);\n\nlet maxLen = 16;\nlet prevIndices = new Int32Array(maxLen);\nlet tailIndices = new Int32Array(maxLen);\n\n// Based on inferno's lis_algorithm @ https://github.com/infernojs/inferno/blob/master/packages/inferno/src/DOM/patching.ts#L732\n// with some tweaks to make it just a bit faster + account for IndexMap (and some names changes for readability)\n/** @internal */\nexport function longestIncreasingSubsequence(indexMap: IndexMap): Int32Array {\n  const len = indexMap.length;\n\n  if (len > maxLen) {\n    maxLen = len;\n    prevIndices = new Int32Array(len);\n    tailIndices = new Int32Array(len);\n  }\n\n  let cursor = 0;\n  let cur = 0;\n  let prev = 0;\n  let i = 0;\n  let j = 0;\n  let low = 0;\n  let high = 0;\n  let mid = 0;\n\n  for (; i < len; i++) {\n    cur = indexMap[i];\n    if (cur !== -2) {\n      j = prevIndices[cursor];\n\n      prev = indexMap[j];\n      if (prev !== -2 && prev < cur) {\n        tailIndices[i] = j;\n        prevIndices[++cursor] = i;\n        continue;\n      }\n\n      low = 0;\n      high = cursor;\n\n      while (low < high) {\n        mid = (low + high) >> 1;\n        prev = indexMap[prevIndices[mid]];\n        if (prev !== -2 && prev < cur) {\n          low = mid + 1;\n        } else {\n          high = mid;\n        }\n      }\n\n      prev = indexMap[prevIndices[low]];\n      if (cur < prev || prev === -2) {\n        if (low > 0) {\n          tailIndices[i] = prevIndices[low - 1];\n        }\n        prevIndices[low] = i;\n      }\n    }\n  }\n  i = ++cursor;\n  const result = new Int32Array(i);\n  cur = prevIndices[cursor - 1];\n\n  while (cursor-- > 0) {\n    result[cursor] = cur;\n    cur = tailIndices[cur];\n  }\n  while (i-- > 0) prevIndices[i] = 0;\n  return result;\n}\n\ninterface IRepeatOverrideContext extends IOverrideContext {\n  $index: number;\n  $odd: boolean;\n  $even: boolean;\n  $first: boolean;\n  $middle: boolean;\n  $last: boolean;\n  $length: number; // new in v2, there are a few requests, not sure if it should stay\n}\n\nfunction setContextualProperties(oc: IRepeatOverrideContext, index: number, length: number): void {\n  const isFirst = index === 0;\n  const isLast = index === length - 1;\n  const isEven = index % 2 === 0;\n  oc.$index = index;\n  oc.$first = isFirst;\n  oc.$last = isLast;\n  oc.$middle = !isFirst && !isLast;\n  oc.$even = isEven;\n  oc.$odd = !isEven;\n  oc.$length = length;\n}\n","import { nextId } from '@aurelia/kernel';\nimport { LifecycleFlags, Scope } from '@aurelia/runtime';\nimport { IRenderLocation } from '../../dom.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { templateController } from '../custom-attribute.js';\nimport { bindable } from '../../bindable.js';\nimport type { ISyntheticView, ICustomAttributeController, ICustomAttributeViewModel, IHydratedController, IHydratedParentController, ControllerVisitor } from '../../templating/controller.js';\n\nexport class With implements ICustomAttributeViewModel {\n  /** @internal */ protected static inject = [IViewFactory, IRenderLocation];\n  public readonly id: number = nextId('au$component');\n\n  public view: ISyntheticView;\n\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n\n  @bindable public value?: object;\n\n  public constructor(\n    factory: IViewFactory,\n    location: IRenderLocation\n  ) {\n    this.id = nextId('au$component');\n    this.view = factory.create().setLocation(location);\n  }\n\n  public valueChanged(\n    newValue: unknown,\n    _oldValue: unknown,\n    _flags: LifecycleFlags,\n  ): void {\n    const $controller = this.$controller;\n    const bindings = this.view.bindings;\n    let scope: Scope;\n    let i = 0, ii = 0;\n    if ($controller.isActive && bindings != null) {\n      scope = Scope.fromParent($controller.scope, newValue === void 0 ? {} : newValue as object);\n      for (ii = bindings.length; ii > i; ++i) {\n        bindings[i].$bind(LifecycleFlags.fromBind, scope);\n      }\n    }\n  }\n\n  public attaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { $controller, value } = this;\n    const scope = Scope.fromParent($controller.scope, value === void 0 ? {} : value);\n    return this.view.activate(initiator, $controller, flags, scope);\n  }\n\n  public detaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return this.view.deactivate(initiator, this.$controller, flags);\n  }\n\n  public dispose(): void {\n    this.view.dispose();\n    this.view = (void 0)!;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.view?.accept(visitor) === true) {\n      return true;\n    }\n  }\n}\n\ntemplateController('with')(With);\n","import {\n  ILogger,\n  LogLevel,\n  nextId,\n  onResolve,\n  resolveAll,\n  Writable,\n} from '@aurelia/kernel';\nimport {\n  LifecycleFlags,\n  BindingMode,\n  ICollectionObserver,\n  CollectionKind,\n  IObserverLocator,\n  IndexMap,\n  Scope,\n} from '@aurelia/runtime';\nimport { IRenderLocation } from '../../dom.js';\nimport { templateController } from '../custom-attribute.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { bindable } from '../../bindable.js';\n\nimport type { Controller, ICustomAttributeController, ICustomAttributeViewModel, IHydratedController, IHydratedParentController, IHydratableController, ISyntheticView, ControllerVisitor } from '../../templating/controller.js';\nimport type { INode } from '../../dom.js';\nimport type { IInstruction } from '../../renderer.js';\n\n@templateController('switch')\nexport class Switch implements ICustomAttributeViewModel {\n  public readonly id: number = nextId('au$component');\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n  private view!: ISyntheticView;\n\n  @bindable public value: unknown;\n\n  /** @internal */\n  public readonly cases: Case[] = [];\n  /** @internal */\n  public defaultCase?: Case;\n  private activeCases: Case[] = [];\n  /**\n   * This is kept around here so that changes can be awaited from the tests.\n   * This needs to be removed after the scheduler is ready to handle/queue the floating promises.\n   */\n  public readonly promise: Promise<void> | void = void 0;\n\n  public constructor(\n    @IViewFactory private readonly _factory: IViewFactory,\n    @IRenderLocation private readonly _location: IRenderLocation,\n  ) { }\n\n  public link(\n    _controller: IHydratableController,\n    _childController: ICustomAttributeController,\n    _target: INode,\n    _instruction: IInstruction,\n  ): void {\n    this.view = this._factory.create(this.$controller).setLocation(this._location);\n  }\n\n  public attaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    const view = this.view;\n    const $controller = this.$controller;\n\n    this.queue(() => view.activate(initiator, $controller, flags, $controller.scope));\n    this.queue(() => this.swap(initiator, flags, this.value));\n    return this.promise;\n  }\n\n  public detaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    this.queue(() => {\n      const view = this.view;\n      return view.deactivate(initiator, this.$controller, flags);\n    });\n    return this.promise;\n  }\n\n  public dispose(): void {\n    this.view?.dispose();\n    this.view = (void 0)!;\n  }\n\n  public valueChanged(_newValue: boolean, _oldValue: boolean, flags: LifecycleFlags): void {\n    if (!this.$controller.isActive) { return; }\n    this.queue(() => this.swap(null, flags, this.value));\n  }\n\n  public caseChanged($case: Case, flags: LifecycleFlags): void {\n    this.queue(() => this._handleCaseChange($case, flags));\n  }\n\n  /** @internal */\n  private _handleCaseChange($case: Case, flags: LifecycleFlags): void | Promise<void> {\n    const isMatch = $case.isMatch(this.value, flags);\n    const activeCases = this.activeCases;\n    const numActiveCases = activeCases.length;\n\n    // Early termination #1\n    if (!isMatch) {\n      /** The previous match started with this; thus clear. */\n      if (numActiveCases > 0 && activeCases[0].id === $case.id) {\n        return this._clearActiveCases(null, flags);\n      }\n      /**\n       * There are 2 different scenarios here:\n       * 1. $case in activeCases: Indicates by-product of fallthrough. The starting case still satisfies. Return.\n       * 2. $case not in activeCases: It was previously not active, and currently also not a match. Return.\n       */\n      return;\n    }\n\n    // Early termination #2\n    if (numActiveCases > 0 && activeCases[0].id < $case.id) {\n      // Even if this case now a match, the previous case still wins by as that has lower ordinal.\n      return;\n    }\n\n    // compute the new active cases\n    const newActiveCases: Case[] = [];\n    let fallThrough = $case.fallThrough;\n    if (!fallThrough) {\n      newActiveCases.push($case);\n    } else {\n      const cases = this.cases;\n      const idx = cases.indexOf($case);\n      for (let i = idx, ii = cases.length; i < ii && fallThrough; i++) {\n        const c = cases[i];\n        newActiveCases.push(c);\n        fallThrough = c.fallThrough;\n      }\n    }\n\n    return onResolve(\n      this._clearActiveCases(null, flags, newActiveCases),\n      () => {\n        this.activeCases = newActiveCases;\n        return this._activateCases(null, flags);\n      }\n    );\n  }\n\n  private swap(initiator: IHydratedController | null, flags: LifecycleFlags, value: unknown): void | Promise<void> {\n    const newActiveCases: Case[] = [];\n\n    let fallThrough: boolean = false;\n    for (const $case of this.cases) {\n      if (fallThrough || $case.isMatch(value, flags)) {\n        newActiveCases.push($case);\n        fallThrough = $case.fallThrough;\n      }\n      if (newActiveCases.length > 0 && !fallThrough) { break; }\n    }\n    const defaultCase = this.defaultCase;\n    if (newActiveCases.length === 0 && defaultCase !== void 0) {\n      newActiveCases.push(defaultCase);\n    }\n\n    return onResolve(\n      this.activeCases.length > 0\n        ? this._clearActiveCases(initiator, flags, newActiveCases)\n        : void 0!,\n      () => {\n        this.activeCases = newActiveCases;\n        if (newActiveCases.length === 0) { return; }\n        return this._activateCases(initiator, flags);\n      }\n    );\n  }\n\n  /** @internal */\n  private _activateCases(initiator: IHydratedController | null, flags: LifecycleFlags): void | Promise<void> {\n    const controller = this.$controller;\n    if (!controller.isActive) { return; }\n\n    const cases = this.activeCases;\n    const length = cases.length;\n    if (length === 0) { return; }\n\n    const scope = controller.scope;\n\n    // most common case\n    if (length === 1) {\n      return cases[0].activate(initiator, flags, scope);\n    }\n\n    return resolveAll(...cases.map(($case) => $case.activate(initiator, flags, scope)));\n  }\n\n  /** @internal */\n  private _clearActiveCases(initiator: IHydratedController | null, flags: LifecycleFlags, newActiveCases: Case[] = []): void | Promise<void> {\n    const cases = this.activeCases;\n    const numCases = cases.length;\n\n    if (numCases === 0) { return; }\n\n    if (numCases === 1) {\n      const firstCase = cases[0];\n      if (!newActiveCases.includes(firstCase)) {\n        cases.length = 0;\n        return firstCase.deactivate(initiator, flags);\n      }\n      return;\n    }\n\n    return onResolve(\n      resolveAll(...cases.reduce((acc: (void | Promise<void>)[], $case) => {\n        if (!newActiveCases.includes($case)) {\n          acc.push($case.deactivate(initiator, flags));\n        }\n        return acc;\n      }, [])),\n      () => {\n        cases.length = 0;\n      }\n    );\n  }\n\n  private queue(action: () => void | Promise<void>): void {\n    const previousPromise = this.promise;\n    let promise: void | Promise<void> = void 0;\n    promise = (this as Writable<Switch>).promise = onResolve(\n      onResolve(previousPromise, action),\n      () => {\n        if (this.promise === promise) {\n          (this as Writable<Switch>).promise = void 0;\n        }\n      }\n    );\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.$controller.accept(visitor) === true) {\n      return true;\n    }\n    if (this.activeCases.some(x => x.accept(visitor))) {\n      return true;\n    }\n  }\n}\n\n@templateController('case')\nexport class Case implements ICustomAttributeViewModel {\n  /** @internal */ protected static inject = [IViewFactory, IObserverLocator, IRenderLocation, ILogger];\n\n  public readonly id: number = nextId('au$component');\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n\n  @bindable public value: unknown;\n  @bindable({\n    set: v => {\n      switch (v) {\n        case 'true': return true;\n        case 'false': return false;\n        default: return !!v;\n      }\n    },\n    mode: BindingMode.oneTime\n  })\n  public fallThrough: boolean = false;\n\n  public view: ISyntheticView | undefined = void 0;\n  private $switch!: Switch;\n  /** @internal */ private readonly _debug: boolean;\n  /** @internal */ private readonly _logger: ILogger;\n  /** @internal */ private _observer: ICollectionObserver<CollectionKind.array> | undefined;\n\n  public constructor(\n    /** @internal */ private readonly _factory: IViewFactory,\n    /** @internal */ private readonly _locator: IObserverLocator,\n    /** @internal */ private readonly _location: IRenderLocation,\n    logger: ILogger,\n  ) {\n    this._debug = logger.config.level <= LogLevel.debug;\n    this._logger = logger.scopeTo(`${this.constructor.name}-#${this.id}`);\n  }\n\n  public link(\n    controller: IHydratableController,\n    _childController: ICustomAttributeController,\n    _target: INode,\n    _instruction: IInstruction,\n  ): void {\n    const switchController: IHydratedParentController = (controller as Controller).parent! as IHydratedParentController;\n    const $switch = switchController?.viewModel;\n    if ($switch instanceof Switch) {\n      this.$switch = $switch;\n      this.linkToSwitch($switch);\n    } else {\n      if (__DEV__)\n        throw new Error('The parent switch not found; only `*[switch] > *[case|default-case]` relation is supported.');\n      else\n        throw new Error('AUR0815');\n    }\n  }\n\n  public detaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    return this.deactivate(initiator, flags);\n  }\n\n  public isMatch(value: unknown, flags: LifecycleFlags): boolean {\n    this._logger.debug('isMatch()');\n    const $value = this.value;\n    if (Array.isArray($value)) {\n      if (this._observer === void 0) {\n        this._observer = this._observeCollection(flags, $value);\n      }\n      return $value.includes(value);\n    }\n    return $value === value;\n  }\n\n  public valueChanged(newValue: unknown, _oldValue: unknown, flags: LifecycleFlags): void {\n    if (Array.isArray(newValue)) {\n      this._observer?.unsubscribe(this);\n      this._observer = this._observeCollection(flags, newValue);\n    } else if (this._observer !== void 0) {\n      this._observer.unsubscribe(this);\n    }\n    this.$switch.caseChanged(this, flags);\n  }\n\n  public handleCollectionChange(_indexMap: IndexMap, flags: LifecycleFlags): void {\n    this.$switch.caseChanged(this, flags);\n  }\n\n  public activate(initiator: IHydratedController | null, flags: LifecycleFlags, scope: Scope): void | Promise<void> {\n    let view = this.view;\n    if(view === void 0) {\n      view = this.view = this._factory.create().setLocation(this._location);\n    }\n    if (view.isActive) { return; }\n    return view.activate(initiator ?? view, this.$controller, flags, scope);\n  }\n\n  public deactivate(initiator: IHydratedController | null, flags: LifecycleFlags): void | Promise<void> {\n    const view = this.view;\n    if (view === void 0 || !view.isActive) { return; }\n    return view.deactivate(initiator ?? view, this.$controller, flags);\n  }\n\n  public dispose(): void {\n    this._observer?.unsubscribe(this);\n    this.view?.dispose();\n    this.view = (void 0)!;\n  }\n\n  protected linkToSwitch(auSwitch: Switch): void {\n    auSwitch.cases.push(this);\n  }\n\n  private _observeCollection(flags: LifecycleFlags, $value: unknown[]) {\n    const observer = this._locator.getArrayObserver($value);\n    observer.subscribe(this);\n    return observer;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.$controller.accept(visitor) === true) {\n      return true;\n    }\n    return this.view?.accept(visitor);\n  }\n}\n\n@templateController('default-case')\nexport class DefaultCase extends Case {\n\n  protected linkToSwitch($switch: Switch): void {\n    if ($switch.defaultCase !== void 0) {\n      if (__DEV__)\n        throw new Error('Multiple \\'default-case\\'s are not allowed.');\n      else\n        throw new Error('AUR0816');\n    }\n    $switch.defaultCase = this;\n  }\n}\n","import { ILogger, nextId, onResolve, resolveAll, Task, TaskAbortError, TaskStatus } from '@aurelia/kernel';\nimport { BindingMode, LifecycleFlags, Scope } from '@aurelia/runtime';\nimport { bindable } from '../../bindable.js';\nimport { INode, IRenderLocation } from '../../dom.js';\nimport { IPlatform } from '../../platform.js';\nimport { IInstruction } from '../../renderer.js';\nimport {\n  Controller,\n  ICustomAttributeController,\n  ICustomAttributeViewModel,\n  IHydratableController,\n  IHydratedController,\n  IHydratedParentController,\n  ISyntheticView\n} from '../../templating/controller.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { attributePattern, AttrSyntax } from '../attribute-pattern.js';\nimport { templateController } from '../custom-attribute.js';\n\n@templateController('promise')\nexport class PromiseTemplateController implements ICustomAttributeViewModel {\n  public readonly id: number = nextId('au$component');\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n  private view!: ISyntheticView;\n\n  @bindable public value!: Promise<unknown>;\n\n  public pending?: PendingTemplateController;\n  public fulfilled?: FulfilledTemplateController;\n  public rejected?: RejectedTemplateController;\n\n  private viewScope!: Scope;\n  private preSettledTask: Task<void | Promise<void>> | null = null;\n  private postSettledTask: Task<void | Promise<void>> | null = null;\n  private postSettlePromise!: Promise<void>;\n\n  /** @internal */ private readonly logger: ILogger;\n\n  public constructor(\n  /** @internal */ @IViewFactory private readonly _factory: IViewFactory,\n  /** @internal */ @IRenderLocation private readonly _location: IRenderLocation,\n  /** @internal */ @IPlatform private readonly _platform: IPlatform,\n    @ILogger logger: ILogger,\n  ) {\n    this.logger = logger.scopeTo('promise.resolve');\n  }\n\n  public link(\n    _controller: IHydratableController,\n    _childController: ICustomAttributeController,\n    _target: INode,\n    _instruction: IInstruction,\n  ): void {\n    this.view = this._factory.create(this.$controller).setLocation(this._location);\n  }\n\n  public attaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    const view = this.view;\n    const $controller = this.$controller;\n\n    return onResolve(\n      view.activate(initiator, $controller, flags, this.viewScope = Scope.fromParent($controller.scope, {})),\n      () => this.swap(initiator, flags)\n    );\n  }\n\n  public valueChanged(_newValue: boolean, _oldValue: boolean, flags: LifecycleFlags): void {\n    if (!this.$controller.isActive) { return; }\n    this.swap(null, flags);\n  }\n\n  private swap(initiator: IHydratedController | null, flags: LifecycleFlags): void {\n    const value = this.value;\n    if (!(value instanceof Promise)) {\n      this.logger.warn(`The value '${String(value)}' is not a promise. No change will be done.`);\n      return;\n    }\n    const q = this._platform.domWriteQueue;\n    const fulfilled = this.fulfilled;\n    const rejected = this.rejected;\n    const pending = this.pending;\n    const s = this.viewScope;\n\n    let preSettlePromise: Promise<void>;\n    const defaultQueuingOptions = { reusable: false };\n    const $swap = () => {\n      // Note that the whole thing is not wrapped in a q.queueTask intentionally.\n      // Because that would block the app till the actual promise is resolved, which is not the goal anyway.\n      void resolveAll(\n        // At first deactivate the fulfilled and rejected views, as well as activate the pending view.\n        // The order of these 3 should not necessarily be sequential (i.e. order-irrelevant).\n        preSettlePromise = (this.preSettledTask = q.queueTask(() => {\n          return resolveAll(\n            fulfilled?.deactivate(initiator, flags),\n            rejected?.deactivate(initiator, flags),\n            pending?.activate(initiator, flags, s)\n          );\n        }, defaultQueuingOptions)).result.catch((err) => { if (!(err instanceof TaskAbortError)) throw err; }),\n        value\n          .then(\n            (data) => {\n              if (this.value !== value) {\n                return;\n              }\n              const fulfill = () => {\n                // Deactivation of pending view and the activation of the fulfilled view should not necessarily be sequential.\n                this.postSettlePromise = (this.postSettledTask = q.queueTask(() => resolveAll(\n                  pending?.deactivate(initiator, flags),\n                  rejected?.deactivate(initiator, flags),\n                  fulfilled?.activate(initiator, flags, s, data),\n                ), defaultQueuingOptions)).result;\n              };\n              if (this.preSettledTask!.status === TaskStatus.running) {\n                void preSettlePromise.then(fulfill);\n              } else {\n                this.preSettledTask!.cancel();\n                fulfill();\n              }\n            },\n            (err) => {\n              if (this.value !== value) {\n                return;\n              }\n              const reject = () => {\n                // Deactivation of pending view and the activation of the rejected view should also not necessarily be sequential.\n                this.postSettlePromise = (this.postSettledTask = q.queueTask(() => resolveAll(\n                  pending?.deactivate(initiator, flags),\n                  fulfilled?.deactivate(initiator, flags),\n                  rejected?.activate(initiator, flags, s, err),\n                ), defaultQueuingOptions)).result;\n              };\n              if (this.preSettledTask!.status === TaskStatus.running) {\n                void preSettlePromise.then(reject);\n              } else {\n                this.preSettledTask!.cancel();\n                reject();\n              }\n            },\n          ));\n    };\n\n    if (this.postSettledTask?.status === TaskStatus.running) {\n      void this.postSettlePromise.then($swap);\n    } else {\n      this.postSettledTask?.cancel();\n      $swap();\n    }\n  }\n\n  public detaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    this.preSettledTask?.cancel();\n    this.postSettledTask?.cancel();\n    this.preSettledTask = this.postSettledTask = null;\n    return this.view.deactivate(initiator, this.$controller, flags);\n  }\n\n  public dispose(): void {\n    this.view?.dispose();\n    this.view = (void 0)!;\n  }\n}\n\n@templateController('pending')\nexport class PendingTemplateController implements ICustomAttributeViewModel {\n  public readonly id: number = nextId('au$component');\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n\n  @bindable({ mode: BindingMode.toView }) public value!: Promise<unknown>;\n\n  public view: ISyntheticView | undefined = void 0;\n\n  public constructor(\n    /** @internal */ @IViewFactory private readonly _factory: IViewFactory,\n    /** @internal */ @IRenderLocation private readonly _location: IRenderLocation,\n  ) { }\n\n  public link(\n    controller: IHydratableController,\n    _childController: ICustomAttributeController,\n    _target: INode,\n    _instruction: IInstruction,\n  ): void {\n    getPromiseController(controller).pending = this;\n  }\n\n  public activate(initiator: IHydratedController | null, flags: LifecycleFlags, scope: Scope): void | Promise<void> {\n    let view = this.view;\n    if(view === void 0) {\n      view = this.view = this._factory.create().setLocation(this._location);\n    }\n    if (view.isActive) { return; }\n    return view.activate(view, this.$controller, flags, scope);\n  }\n\n  public deactivate(initiator: IHydratedController | null, flags: LifecycleFlags): void | Promise<void> {\n    const view = this.view;\n    if (view === void 0 || !view.isActive) { return; }\n    return view.deactivate(view, this.$controller, flags);\n  }\n\n  public detaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    return this.deactivate(initiator, flags);\n  }\n\n  public dispose(): void {\n    this.view?.dispose();\n    this.view = (void 0)!;\n  }\n}\n\n@templateController('then')\nexport class FulfilledTemplateController implements ICustomAttributeViewModel {\n  public readonly id: number = nextId('au$component');\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n\n  @bindable({ mode: BindingMode.fromView }) public value!: unknown;\n\n  public view: ISyntheticView | undefined = void 0;\n\n  public constructor(\n    /** @internal */ @IViewFactory private readonly _factory: IViewFactory,\n    /** @internal */ @IRenderLocation private readonly _location: IRenderLocation,\n  ) { }\n\n  public link(\n    controller: IHydratableController,\n    _childController: ICustomAttributeController,\n    _target: INode,\n    _instruction: IInstruction,\n  ): void {\n    getPromiseController(controller).fulfilled = this;\n  }\n\n  public activate(initiator: IHydratedController | null, flags: LifecycleFlags, scope: Scope, resolvedValue: unknown): void | Promise<void> {\n    this.value = resolvedValue;\n    let view = this.view;\n    if(view === void 0) {\n      view = this.view = this._factory.create().setLocation(this._location);\n    }\n    if (view.isActive) { return; }\n    return view.activate(view, this.$controller, flags, scope);\n  }\n\n  public deactivate(initiator: IHydratedController | null, flags: LifecycleFlags): void | Promise<void> {\n    const view = this.view;\n    if (view === void 0 || !view.isActive) { return; }\n    return view.deactivate(view, this.$controller, flags);\n  }\n\n  public detaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    return this.deactivate(initiator, flags);\n  }\n\n  public dispose(): void {\n    this.view?.dispose();\n    this.view = (void 0)!;\n  }\n}\n\n@templateController('catch')\nexport class RejectedTemplateController implements ICustomAttributeViewModel {\n  public readonly id: number = nextId('au$component');\n  public readonly $controller!: ICustomAttributeController<this>; // This is set by the controller after this instance is constructed\n\n  @bindable({ mode: BindingMode.fromView }) public value!: unknown;\n\n  public view: ISyntheticView | undefined = void 0;\n\n  public constructor(\n    @IViewFactory private readonly _factory: IViewFactory,\n    @IRenderLocation private readonly _location: IRenderLocation,\n  ) { }\n\n  public link(\n    controller: IHydratableController,\n    _childController: ICustomAttributeController,\n    _target: INode,\n    _instruction: IInstruction,\n  ): void {\n    getPromiseController(controller).rejected = this;\n  }\n\n  public activate(initiator: IHydratedController | null, flags: LifecycleFlags, scope: Scope, error: unknown): void | Promise<void> {\n    this.value = error;\n    let view = this.view;\n    if(view === void 0) {\n      view = this.view = this._factory.create().setLocation(this._location);\n    }\n    if (view.isActive) { return; }\n    return view.activate(view, this.$controller, flags, scope);\n  }\n\n  public deactivate(initiator: IHydratedController | null, flags: LifecycleFlags): void | Promise<void> {\n    const view = this.view;\n    if (view === void 0 || !view.isActive) { return; }\n    return view.deactivate(view, this.$controller, flags);\n  }\n\n  public detaching(initiator: IHydratedController, parent: IHydratedParentController, flags: LifecycleFlags): void | Promise<void> {\n    return this.deactivate(initiator, flags);\n  }\n\n  public dispose(): void {\n    this.view?.dispose();\n    this.view = (void 0)!;\n  }\n}\n\nfunction getPromiseController(controller: IHydratableController) {\n  const promiseController: IHydratedParentController = (controller as Controller).parent! as IHydratedParentController;\n  const $promise = promiseController?.viewModel;\n  if ($promise instanceof PromiseTemplateController) {\n    return $promise;\n  }\n  if (__DEV__)\n    throw new Error('The parent promise.resolve not found; only `*[promise.resolve] > *[pending|then|catch]` relation is supported.');\n  else\n    throw new Error('AUR0813');\n}\n\n@attributePattern({ pattern: 'promise.resolve', symbols: '' })\nexport class PromiseAttributePattern {\n  public 'promise.resolve'(name: string, value: string, _parts: string[]): AttrSyntax {\n    return new AttrSyntax(name, value, 'promise', 'bind');\n  }\n}\n\n@attributePattern({ pattern: 'then', symbols: '' })\nexport class FulfilledAttributePattern {\n  public 'then'(name: string, value: string, _parts: string[]): AttrSyntax {\n    return new AttrSyntax(name, value, 'then', 'from-view');\n  }\n}\n\n@attributePattern({ pattern: 'catch', symbols: '' })\nexport class RejectedAttributePattern {\n  public 'catch'(name: string, value: string, _parts: string[]): AttrSyntax {\n    return new AttrSyntax(name, value, 'catch', 'from-view');\n  }\n}\n","import { Constructable, IContainer, IRegistry, Key } from '@aurelia/kernel';\nimport {\n  HydrateElementInstruction,\n  isInstruction,\n  SetAttributeInstruction,\n  IInstruction,\n  SetPropertyInstruction,\n} from './renderer.js';\nimport { IPlatform } from './platform.js';\nimport { CustomElement, CustomElementDefinition, CustomElementType } from './resources/custom-element.js';\nimport { IViewFactory } from './templating/view.js';\nimport { IRendering } from './templating/rendering.js';\nimport { isString } from './utilities.js';\n\nimport type { ISyntheticView } from './templating/controller.js';\n\nexport function createElement<C extends Constructable = Constructable>(\n  p: IPlatform,\n  tagOrType: string | C,\n  props?: Record<string, string | IInstruction>,\n  children?: ArrayLike<unknown>\n): RenderPlan {\n  if (isString(tagOrType)) {\n    return createElementForTag(p, tagOrType, props, children);\n  }\n  if (CustomElement.isType(tagOrType)) {\n    return createElementForType(p, tagOrType, props, children);\n  }\n  throw new Error(`Invalid Tag or Type.`);\n}\n\n/**\n * RenderPlan. Todo: describe goal of this class\n */\nexport class RenderPlan {\n  /** @internal */ private _lazyDef?: CustomElementDefinition = void 0;\n\n  public constructor(\n    // 2 following props accessed in the test, can't mangle\n    // todo: refactor tests\n    /** @internal */ private readonly node: Node,\n    /** @internal */ private readonly instructions: IInstruction[][],\n    /** @internal */ private readonly _dependencies: Key[]\n  ) {}\n\n  public get definition(): CustomElementDefinition {\n    if (this._lazyDef === void 0) {\n      this._lazyDef = CustomElementDefinition.create({\n        name: CustomElement.generateName(),\n        template: this.node,\n        needsCompile: isString(this.node),\n        instructions: this.instructions,\n        dependencies: this._dependencies,\n      });\n    }\n    return this._lazyDef;\n  }\n\n  public createView(parentContainer: IContainer): ISyntheticView {\n    return this.getViewFactory(parentContainer).create();\n  }\n\n  public getViewFactory(parentContainer: IContainer): IViewFactory {\n    return parentContainer.root.get(IRendering).getViewFactory(\n      this.definition,\n      parentContainer.createChild().register(...this._dependencies)\n    );\n  }\n\n  /** @internal */\n  public mergeInto(parent: Node & ParentNode, instructions: IInstruction[][], dependencies: Key[]): void {\n    parent.appendChild(this.node);\n    instructions.push(...this.instructions);\n    dependencies.push(...this._dependencies);\n  }\n}\n\nfunction createElementForTag(p: IPlatform, tagName: string, props?: Record<string, string | IInstruction>, children?: ArrayLike<unknown>): RenderPlan {\n  const instructions: IInstruction[] = [];\n  const allInstructions: IInstruction[][] = [];\n  const dependencies: IRegistry[] = [];\n  const element = p.document.createElement(tagName);\n  let hasInstructions = false;\n\n  if (props) {\n    Object.keys(props)\n      .forEach(to => {\n        const value = props[to];\n\n        if (isInstruction(value)) {\n          hasInstructions = true;\n          instructions.push(value);\n        } else {\n          element.setAttribute(to, value);\n        }\n      });\n  }\n\n  if (hasInstructions) {\n    element.className = 'au';\n    allInstructions.push(instructions);\n  }\n\n  if (children) {\n    addChildren(p, element, children, allInstructions, dependencies);\n  }\n\n  return new RenderPlan(element, allInstructions, dependencies);\n}\n\nfunction createElementForType(\n  p: IPlatform,\n  Type: CustomElementType,\n  props?: Record<string, unknown>,\n  children?: ArrayLike<unknown>,\n): RenderPlan {\n  const definition = CustomElement.getDefinition(Type);\n  const instructions: IInstruction[] = [];\n  const allInstructions = [instructions];\n  const dependencies: Key[] = [];\n  const childInstructions: IInstruction[] = [];\n  const bindables = definition.bindables;\n  const element = p.document.createElement(definition.name);\n  element.className = 'au';\n\n  if (!dependencies.includes(Type)) {\n    dependencies.push(Type);\n  }\n\n  instructions.push(new HydrateElementInstruction(definition, void 0, childInstructions, null, false, void 0));\n\n  if (props) {\n    Object.keys(props)\n      .forEach(to => {\n        const value = props[to] as IInstruction | string;\n\n        if (isInstruction(value)) {\n          childInstructions.push(value);\n        } else {\n          if (bindables[to] === void 0) {\n            childInstructions.push(new SetAttributeInstruction(value, to));\n          } else {\n            childInstructions.push(new SetPropertyInstruction(value, to));\n          }\n        }\n      });\n  }\n\n  if (children) {\n    addChildren(p, element, children, allInstructions, dependencies);\n  }\n\n  return new RenderPlan(element, allInstructions, dependencies);\n}\n\nfunction addChildren<T extends HTMLElement>(\n  p: IPlatform,\n  parent: T,\n  children: ArrayLike<unknown>,\n  allInstructions: IInstruction[][],\n  dependencies: Key[],\n): void {\n  for (let i = 0, ii = children.length; i < ii; ++i) {\n    const current = children[i];\n\n    switch (typeof current) {\n      case 'string':\n        parent.appendChild(p.document.createTextNode(current));\n        break;\n      case 'object':\n        if (current instanceof p.Node) {\n          parent.appendChild(current);\n        } else if ('mergeInto' in (current as RenderPlan)) {\n          (current as RenderPlan).mergeInto(parent, allInstructions, dependencies);\n        }\n    }\n  }\n}\n","import { Constructable, nextId, onResolve } from '@aurelia/kernel';\nimport { BindingMode, LifecycleFlags } from '@aurelia/runtime';\nimport { createElement, RenderPlan } from '../../create-element.js';\nimport { HydrateElementInstruction, IInstruction } from '../../renderer.js';\nimport { IPlatform } from '../../platform.js';\nimport { IViewFactory } from '../../templating/view.js';\nimport { CustomElement, customElement, CustomElementDefinition } from '../custom-element.js';\nimport { bindable } from '../../bindable.js';\nimport { ControllerVisitor, ICustomElementController, ICustomElementViewModel, IHydratedController, IHydratedParentController, IHydrationContext, ISyntheticView } from '../../templating/controller.js';\nimport { IRendering } from '../../templating/rendering.js';\nimport { isString } from '../../utilities.js';\n\nexport type Subject = string | IViewFactory | ISyntheticView | RenderPlan | Constructable | CustomElementDefinition;\nexport type MaybeSubjectPromise = Subject | Promise<Subject> | undefined;\n\nfunction toLookup(\n  acc: Record<string, IInstruction>,\n  item: IInstruction & { to?: string },\n): Record<string, IInstruction> {\n  const to = item.to;\n  if (to !== void 0 && to !== 'subject' && to !== 'composing') {\n    acc[to] = item as IInstruction;\n  }\n\n  return acc;\n}\n\nexport class AuRender implements ICustomElementViewModel {\n  /** @internal */ protected static inject = [IPlatform, IInstruction, IHydrationContext, IRendering];\n  public readonly id: number = nextId('au$component');\n\n  @bindable\n  public component?: MaybeSubjectPromise = void 0;\n\n  @bindable({ mode: BindingMode.fromView })\n  public composing: boolean = false;\n\n  public view?: ISyntheticView = void 0;\n\n  /** @internal */ private readonly _properties: Record<string, IInstruction>;\n\n  /** @internal */ private _lastSubject?: MaybeSubjectPromise = void 0;\n\n  public readonly $controller!: ICustomElementController<this>; // This is set by the controller after this instance is constructed\n\n  public constructor(\n    /** @internal */ private readonly _platform: IPlatform,\n    /** @internal */ private readonly _instruction: HydrateElementInstruction,\n    /** @internal */ private readonly _hdrContext: IHydrationContext,\n    /** @internal */ private readonly _rendering: IRendering,\n  ) {\n    this._properties = _instruction.props.reduce(toLookup, {});\n  }\n\n  public attaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController | null,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { component, view } = this;\n    if (view === void 0 || this._lastSubject !== component) {\n      this._lastSubject = component;\n      this.composing = true;\n\n      return this.compose(void 0, component, initiator, flags);\n    }\n\n    return this.compose(view, component, initiator, flags);\n  }\n\n  public detaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController | null,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return this._deactivate(this.view, initiator, flags);\n  }\n\n  public componentChanged(\n    newValue: Subject | Promise<Subject>,\n    previousValue: Subject | Promise<Subject>,\n    flags: LifecycleFlags,\n  ): void {\n    const { $controller } = this;\n    if (!$controller.isActive) {\n      return;\n    }\n    if (this._lastSubject === newValue) {\n      return;\n    }\n\n    this._lastSubject = newValue;\n    this.composing = true;\n\n    flags |= $controller.flags;\n    const ret = onResolve(\n      this._deactivate(this.view, null, flags),\n      () => {\n        // TODO(fkleuver): handle & test race condition\n        return this.compose(void 0, newValue, null, flags);\n      },\n    );\n    if (ret instanceof Promise) { ret.catch(err => { throw err; }); }\n  }\n\n  private compose(\n    view: ISyntheticView | undefined | Promise<ISyntheticView | undefined>,\n    subject: MaybeSubjectPromise,\n    initiator: IHydratedController | null,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return onResolve(\n      view === void 0\n        ? onResolve(subject, resolvedSubject => this._resolveView(resolvedSubject, flags))\n        : view,\n      resolvedView => this._activate(this.view = resolvedView, initiator, flags),\n    );\n  }\n\n  /** @internal */\n  private _deactivate(\n    view: ISyntheticView | undefined,\n    initiator: IHydratedController | null,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return view?.deactivate(initiator ?? view, this.$controller, flags);\n  }\n\n  /** @internal */\n  private _activate(\n    view: ISyntheticView | undefined,\n    initiator: IHydratedController | null,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    const { $controller } = this;\n    return onResolve(\n      view?.activate(initiator ?? view, $controller, flags, $controller.scope),\n      () => {\n        this.composing = false;\n      },\n    );\n  }\n\n  /** @internal */\n  private _resolveView(subject: Subject | undefined, flags: LifecycleFlags): ISyntheticView | undefined {\n    const view = this._provideViewFor(subject, flags);\n\n    if (view) {\n      view.setLocation(this.$controller.location!);\n      view.lockScope(this.$controller.scope);\n      return view;\n    }\n\n    return void 0;\n  }\n\n  /** @internal */\n  private _provideViewFor(comp: Subject | undefined, _flags: LifecycleFlags): ISyntheticView | undefined {\n    if (!comp) {\n      return void 0;\n    }\n\n    const ctxContainer = this._hdrContext.controller.container;\n    if (typeof comp === 'object') {\n      if (isController(comp)) { // IController\n        return comp;\n      }\n\n      if ('createView' in comp) { // RenderPlan\n        return comp.createView(ctxContainer);\n      }\n\n      if ('create' in comp) { // IViewFactory\n        return comp.create();\n      }\n\n      if ('template' in comp) { // Raw Template Definition\n        return this._rendering.getViewFactory(CustomElementDefinition.getOrCreate(comp), ctxContainer).create();\n      }\n    }\n\n    if (isString(comp)) {\n      const def = ctxContainer.find(CustomElement, comp);\n      if (def == null) {\n        if (__DEV__)\n          throw new Error(`Unable to find custom element ${comp} for <au-render>.`);\n        else\n          throw new Error(`AUR0809:${comp}`);\n      }\n      comp = def.Type;\n    }\n\n    // Constructable (Custom Element Constructor)\n    return createElement(\n      this._platform,\n      comp,\n      this._properties,\n      this.$controller.host.childNodes,\n    ).createView(ctxContainer);\n  }\n\n  public dispose(): void {\n    this.view?.dispose();\n    this.view = (void 0)!;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.view?.accept(visitor) === true) {\n      return true;\n    }\n  }\n}\n\ncustomElement({ name: 'au-render', template: null, containerless: true, capture: true })(AuRender);\n\nfunction isController(subject: Exclude<Subject, string>): subject is ISyntheticView {\n  return 'lockScope' in subject;\n}\n","import { Constructable, IContainer, InstanceProvider, onResolve, transient } from '@aurelia/kernel';\nimport { LifecycleFlags, Scope } from '@aurelia/runtime';\nimport { bindable } from '../../bindable.js';\nimport { convertToRenderLocation, INode, IRenderLocation, isRenderLocation } from '../../dom.js';\nimport { IPlatform } from '../../platform.js';\nimport { HydrateElementInstruction, IInstruction } from '../../renderer.js';\nimport { Controller, IController, ICustomElementController, IHydratedController, ISyntheticView } from '../../templating/controller.js';\nimport { IRendering } from '../../templating/rendering.js';\nimport { isFunction, isPromise } from '../../utilities.js';\nimport { CustomElement, customElement, CustomElementDefinition } from '../custom-element.js';\n\n/**\n * An optional interface describing the dialog activate convention.\n */\nexport interface IDynamicComponentActivate<T> {\n  /**\n   * Implement this hook if you want to perform custom logic just before the component is is composed.\n   * The returned value is not used.\n   */\n  activate?(model?: T): unknown | Promise<unknown>;\n}\n\ntype MaybePromise<T> = T | Promise<T>;\ntype ChangeSource = 'view' | 'viewModel' | 'model' | 'scopeBehavior';\n\n// Desired usage:\n// <au-component view.bind=\"Promise<string>\" view-model.bind=\"\" model.bind=\"\" />\n// <au-component view.bind=\"<string>\" model.bind=\"\" />\n//\nexport class AuCompose {\n\n  /** @internal */\n  protected static get inject() {\n    return [IContainer, IController, INode, IPlatform, IInstruction, transient(CompositionContextFactory)];\n  }\n\n  /* determine what template used to compose the component */\n  @bindable\n  public view?: string | Promise<string>;\n\n  /* determine the view model instance used to compose the component */\n  @bindable\n  public viewModel?: Constructable | object | Promise<Constructable | object>;\n\n  /* the model used to pass to activate lifecycle of the component */\n  @bindable\n  public model?: unknown;\n\n  @bindable({\n    set: v => {\n      if (v === 'scoped' || v === 'auto') {\n        return v;\n      }\n      if (__DEV__)\n        throw new Error('Invalid scope behavior config. Only \"scoped\" or \"auto\" allowed.');\n      else\n        throw new Error('AUR0805');\n    }\n  })\n  public scopeBehavior: 'auto' | 'scoped' = 'auto';\n\n  /** @internal */\n  public readonly $controller!: ICustomElementController<AuCompose>;\n\n  /** @internal */\n  private _pending?: Promise<void> | void;\n  public get pending(): Promise<void> | void {\n    return this._pending;\n  }\n\n  /** @internal */\n  private _composition: ICompositionController | undefined = void 0;\n  public get composition(): ICompositionController | undefined {\n    return this._composition;\n  }\n\n  /** @internal */ private readonly _rendering: IRendering;\n  /** @internal */ private readonly _location: IRenderLocation | undefined;\n  /** @internal */ private readonly _instruction: HydrateElementInstruction;\n  /** @internal */ private readonly _contextFactory: CompositionContextFactory;\n\n  public constructor(\n    /** @internal */ private readonly _container: IContainer,\n    /** @internal */ private readonly parent: ISyntheticView | ICustomElementController,\n    /** @internal */ private readonly host: HTMLElement,\n    /** @internal */ private readonly _platform: IPlatform,\n    // todo: use this to retrieve au-slot instruction\n    //        for later enhancement related to <au-slot/> + compose\n    instruction: HydrateElementInstruction,\n    contextFactory: CompositionContextFactory,\n  ) {\n    this._location = instruction.containerless ? convertToRenderLocation(this.host) : void 0;\n    this._rendering = _container.get(IRendering);\n    this._instruction = instruction;\n    this._contextFactory = contextFactory;\n  }\n\n  public attaching(initiator: IHydratedController, _parent: IHydratedController, _flags: LifecycleFlags): void | Promise<void> {\n    return this._pending = onResolve(\n      this.queue(new ChangeInfo(this.view, this.viewModel, this.model, void 0), initiator),\n      (context) => {\n        if (this._contextFactory.isCurrent(context)) {\n          this._pending = void 0;\n        }\n      }\n    );\n  }\n\n  public detaching(initiator: IHydratedController): void | Promise<void> {\n    const cmpstn = this._composition;\n    const pending = this._pending;\n    this._contextFactory.invalidate();\n    this._composition = this._pending = void 0;\n    return onResolve(pending, () => cmpstn?.deactivate(initiator));\n  }\n\n  /** @internal */\n  protected propertyChanged(name: ChangeSource): void {\n    if (name === 'model' && this._composition != null) {\n      // eslint-disable-next-line\n      this._composition.update(this.model);\n      return;\n    }\n    this._pending = onResolve(this._pending, () =>\n      onResolve(\n        this.queue(new ChangeInfo(this.view, this.viewModel, this.model, name), void 0),\n        (context) => {\n          if (this._contextFactory.isCurrent(context)) {\n            this._pending = void 0;\n          }\n        }\n      )\n    );\n  }\n\n  /** @internal */\n  private queue(change: ChangeInfo, initiator: IHydratedController | undefined): CompositionContext | Promise<CompositionContext> {\n    const factory = this._contextFactory;\n    const compositionCtrl = this._composition;\n    // todo: handle consequitive changes that create multiple queues\n    return onResolve(\n      factory.create(change),\n      context => {\n        // Don't compose [stale] view/view model\n        // by always ensuring that the composition context is the latest one\n        if (factory.isCurrent(context)) {\n          return onResolve(this.compose(context), (result) => {\n            // Don't activate [stale] controller\n            // by always ensuring that the composition context is the latest one\n            if (factory.isCurrent(context)) {\n              return onResolve(result.activate(initiator), () => {\n                // Don't conclude the [stale] composition\n                // by always ensuring that the composition context is the latest one\n                if (factory.isCurrent(context)) {\n                  // after activation, if the composition context is still the most recent one\n                  // then the job is done\n                  this._composition = result;\n                  return onResolve(compositionCtrl?.deactivate(initiator), () => context);\n                } else {\n                  // the stale controller should be deactivated\n                  return onResolve(\n                    result.controller.deactivate(result.controller, this.$controller, LifecycleFlags.fromUnbind),\n                    // todo: do we need to deactivate?\n                    () => {\n                      result.controller.dispose();\n                      return context;\n                    }\n                  );\n                }\n              });\n            }\n\n            result.controller.dispose();\n            return context;\n          });\n        }\n\n        return context;\n      }\n    );\n  }\n\n  /** @internal */\n  private compose(context: CompositionContext): MaybePromise<ICompositionController> {\n    let comp: IDynamicComponentActivate<unknown>;\n    let compositionHost: HTMLElement | IRenderLocation;\n    let removeCompositionHost: () => void;\n    // todo: when both view model and view are empty\n    //       should it throw or try it best to proceed?\n    //       current: proceed\n    const { view, viewModel, model } = context.change;\n    const { _container: container, host, $controller, _location: loc } = this;\n    const srcDef = this.getDef(viewModel);\n    const childCtn: IContainer = container.createChild();\n    const parentNode = loc == null ? host.parentNode : loc.parentNode;\n\n    if (srcDef !== null) {\n      if (srcDef.containerless) {\n        if (__DEV__)\n          throw new Error('Containerless custom element is not supported by <au-compose/>');\n        else\n          throw new Error('AUR0806');\n      }\n      if (loc == null) {\n        compositionHost = host;\n        removeCompositionHost = () => {\n          // This is a normal composition, the content template is removed by deactivation process\n          // but the host remains\n        };\n      } else {\n        // todo: should the host be appended later, during the activation phase instead?\n        compositionHost = parentNode!.insertBefore(this._platform.document.createElement(srcDef.name), loc);\n        removeCompositionHost = () => {\n          compositionHost.remove();\n        };\n      }\n      comp = this.getVm(childCtn, viewModel, compositionHost);\n    } else {\n      compositionHost = loc == null\n        ? host\n        : loc;\n      comp = this.getVm(childCtn, viewModel, compositionHost);\n    }\n    const compose: () => ICompositionController = () => {\n      // custom element based composition\n      if (srcDef !== null) {\n        const controller = Controller.$el(\n          childCtn,\n          comp,\n          compositionHost as HTMLElement,\n          { projections: this._instruction.projections },\n          srcDef,\n        );\n\n        return new CompositionController(\n          controller,\n          (attachInitiator) => controller.activate(attachInitiator ?? controller, $controller, LifecycleFlags.fromBind, $controller.scope.parentScope!),\n          // todo: call deactivate on the component view model\n          (deactachInitiator) => onResolve(\n            controller.deactivate(deactachInitiator ?? controller, $controller, LifecycleFlags.fromUnbind),\n            removeCompositionHost\n          ),\n          // casting is technically incorrect\n          // but it's ignored in the caller anyway\n          (model) => comp.activate?.(model) as MaybePromise<void>,\n          context,\n        );\n      } else {\n        const targetDef = CustomElementDefinition.create({\n          name: CustomElement.generateName(),\n          template: view,\n        });\n        const viewFactory = this._rendering.getViewFactory(targetDef, childCtn);\n        const controller = Controller.$view(\n          viewFactory,\n          $controller\n        );\n        const scope = this.scopeBehavior === 'auto'\n          ? Scope.fromParent(this.parent.scope, comp)\n          : Scope.create(comp);\n\n        if (isRenderLocation(compositionHost)) {\n          controller.setLocation(compositionHost);\n        } else {\n          controller.setHost(compositionHost);\n        }\n\n        return new CompositionController(\n          controller,\n          (attachInitiator) => controller.activate(attachInitiator ?? controller, $controller, LifecycleFlags.fromBind, scope),\n          // todo: call deactivate on the component view model\n          // a difference with composing custom element is that we leave render location/host alone\n          // as they all share the same host/render location\n          (detachInitiator) => controller.deactivate(detachInitiator ?? controller, $controller, LifecycleFlags.fromUnbind),\n          // casting is technically incorrect\n          // but it's ignored in the caller anyway\n          (model) => comp.activate?.(model) as MaybePromise<void>,\n          context,\n        );\n      }\n    };\n    if ('activate' in comp) {\n      // todo: try catch\n      // req:  ensure synchronosity of compositions that dont employ promise\n      return onResolve(comp.activate!(model), () => compose());\n    } else {\n      return compose();\n    }\n  }\n\n  /** @internal */\n  private getVm(container: IContainer, comp: Constructable | object | undefined, host: HTMLElement | IRenderLocation): IDynamicComponentActivate<unknown> {\n    if (comp == null) {\n      return new EmptyComponent();\n    }\n    if (typeof comp === 'object') {\n      return comp;\n    }\n\n    const p = this._platform;\n    const isLocation = isRenderLocation(host);\n    container.registerResolver(\n      p.Element,\n      container.registerResolver(\n        INode,\n        new InstanceProvider('ElementResolver', isLocation ? null : host)\n      )\n    );\n    container.registerResolver(\n      IRenderLocation,\n      new InstanceProvider('IRenderLocation', isLocation ? host : null)\n    );\n\n    const instance = container.invoke(comp);\n    container.registerResolver(comp, new InstanceProvider('au-compose.viewModel', instance));\n\n    return instance;\n  }\n\n  /** @internal */\n  private getDef(component?: object | Constructable) {\n    const Ctor = (isFunction(component)\n      ? component\n      : component?.constructor) as Constructable;\n    return CustomElement.isType(Ctor)\n      ? CustomElement.getDefinition(Ctor)\n      : null;\n  }\n}\n\ncustomElement('au-compose')(AuCompose);\n\nclass EmptyComponent { }\n\nexport interface ICompositionController {\n  readonly controller: IHydratedController;\n  readonly context: CompositionContext;\n  activate(initiator?: IHydratedController): void | Promise<void>;\n  // deactivation is done differently, compared to activation\n  // when the `<au-component/>` is deactivated, initiator will be an ancestor controller\n  //\n  // while when the value of the @bindables changes, initiator should be\n  // the controller wrapped in this composition controller\n  deactivate(detachInitator?: IHydratedController): void | Promise<void>;\n  update(model: unknown): void | Promise<void>;\n}\n\nclass CompositionContextFactory {\n  private id = 0;\n\n  public isCurrent(context: CompositionContext): boolean {\n    return context.id === this.id;\n  }\n\n  public create(changes: ChangeInfo): MaybePromise<CompositionContext> {\n    return onResolve(changes.load(), (loaded) => new CompositionContext(++this.id, loaded));\n  }\n\n  // simplify increasing the id will invalidate all previously created context\n  public invalidate(): void {\n    this.id++;\n  }\n}\n\nclass ChangeInfo {\n  public constructor(\n    public readonly view: MaybePromise<string> | undefined,\n    public readonly viewModel: MaybePromise<Constructable | object> | undefined,\n    public readonly model: unknown | undefined,\n    public readonly src: ChangeSource | undefined,\n  ) { }\n\n  public load(): MaybePromise<LoadedChangeInfo> {\n    if (isPromise(this.view) || isPromise(this.viewModel)) {\n      return Promise\n        .all([this.view, this.viewModel])\n        .then(([view, viewModel]) => {\n          return new LoadedChangeInfo(view, viewModel, this.model, this.src);\n        });\n    } else {\n      return new LoadedChangeInfo(this.view, this.viewModel, this.model, this.src);\n    }\n  }\n}\n\nclass LoadedChangeInfo {\n  public constructor(\n    public readonly view: string | undefined,\n    public readonly viewModel: Constructable | object | undefined,\n    public readonly model: unknown | undefined,\n    public readonly src: ChangeSource | undefined,\n  ) { }\n}\n\nclass CompositionContext {\n  public constructor(\n    public readonly id: number,\n    public readonly change: LoadedChangeInfo,\n  ) { }\n}\n\nclass CompositionController implements ICompositionController {\n  private state: /* stopped */-1 | /* initial */0 | /* started */1 = 0;\n\n  public constructor(\n    public readonly controller: ISyntheticView | ICustomElementController,\n    private readonly start: (attachInitiator?: IHydratedController) => void | Promise<void>,\n    private readonly stop: (detachInitator?: IHydratedController) => void | Promise<void>,\n    public readonly update: (model: unknown) => void | Promise<void>,\n    public readonly context: CompositionContext,\n  ) {\n\n  }\n\n  public activate(initiator?: IHydratedController) {\n    if (this.state !== 0) {\n      if (__DEV__)\n        throw new Error(`Composition has already been activated/deactivated. Id: ${this.controller.name}`);\n      else\n        throw new Error(`AUR0807:${this.controller.name}`);\n    }\n    this.state = 1;\n    return this.start(initiator);\n  }\n\n  public deactivate(detachInitator?: IHydratedController) {\n    switch (this.state) {\n      case 1:\n        this.state = -1;\n        return this.stop(detachInitator);\n      case -1:\n        if (__DEV__)\n          throw new Error('Composition has already been deactivated.');\n        else\n          throw new Error('AUR0808');\n      default:\n        this.state = -1;\n    }\n  }\n}\n","import { Scope } from '@aurelia/runtime';\nimport { IRenderLocation } from '../../dom.js';\nimport { bindable } from '../../bindable.js';\nimport { customElement } from '../custom-element.js';\nimport { IInstruction } from '../../renderer.js';\nimport { IHydrationContext } from '../../templating/controller.js';\nimport { IRendering } from '../../templating/rendering.js';\n\nimport type { Writable } from '@aurelia/kernel';\nimport type { LifecycleFlags } from '@aurelia/runtime';\nimport type { ControllerVisitor, ICustomElementController, ICustomElementViewModel, IHydratedController, IHydratedParentController, ISyntheticView } from '../../templating/controller.js';\nimport type { IViewFactory } from '../../templating/view.js';\nimport type { HydrateElementInstruction } from '../../renderer.js';\n\nexport class AuSlot implements ICustomElementViewModel {\n  /** @internal */ public static get inject() { return [IRenderLocation, IInstruction, IHydrationContext, IRendering]; }\n\n  public readonly view: ISyntheticView;\n  public readonly $controller!: ICustomElementController<this>; // This is set by the controller after this instance is constructed\n\n  /** @internal */ private _parentScope: Scope | null = null;\n  /** @internal */ private _outerScope: Scope | null = null;\n  /** @internal */ private readonly _hasProjection: boolean;\n  /** @internal */ private readonly _hdrContext: IHydrationContext;\n\n  @bindable\n  public expose: object | undefined;\n\n  public constructor(\n    location: IRenderLocation,\n    instruction: HydrateElementInstruction,\n    hdrContext: IHydrationContext,\n    rendering: IRendering,\n  ) {\n    let factory: IViewFactory;\n    const slotInfo = instruction.auSlot!;\n    const projection = hdrContext.instruction?.projections?.[slotInfo.name];\n    if (projection == null) {\n      factory = rendering.getViewFactory(slotInfo.fallback, hdrContext.controller.container);\n      this._hasProjection = false;\n    } else {\n      factory = rendering.getViewFactory(projection, hdrContext.parent!.controller.container);\n      this._hasProjection = true;\n    }\n    this._hdrContext = hdrContext;\n    this.view = factory.create().setLocation(location);\n  }\n\n  public binding(\n    _initiator: IHydratedController,\n    _parent: IHydratedParentController,\n    _flags: LifecycleFlags,\n  ): void | Promise<void> {\n    this._parentScope = this.$controller.scope.parentScope!;\n    let outerScope: Scope;\n    if (this._hasProjection) {\n      // if there is a projection,\n      // then the au-slot should connect the outer scope with the inner scope binding context\n      // via overlaying the outerscope with another scope that has\n      // - binding context & override context pointing to the outer scope binding & override context respectively\n      // - override context has the $host pointing to inner scope binding context\n      outerScope = this._hdrContext.controller.scope.parentScope!;\n      (this._outerScope = Scope.fromParent(outerScope, outerScope.bindingContext))\n        .overrideContext.$host = this.expose ?? this._parentScope.bindingContext;\n    }\n  }\n\n  public attaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return this.view.activate(\n      initiator,\n      this.$controller,\n      flags,\n      this._hasProjection ? this._outerScope! : this._parentScope!,\n    );\n  }\n\n  public detaching(\n    initiator: IHydratedController,\n    parent: IHydratedParentController,\n    flags: LifecycleFlags,\n  ): void | Promise<void> {\n    return this.view.deactivate(initiator, this.$controller, flags);\n  }\n\n  public exposeChanged(v: object): void {\n    if (this._hasProjection && this._outerScope != null) {\n      this._outerScope.overrideContext.$host = v;\n    }\n  }\n\n  public dispose(): void {\n    this.view.dispose();\n    (this as Writable<this>).view = (void 0)!;\n  }\n\n  public accept(visitor: ControllerVisitor): void | true {\n    if (this.view?.accept(visitor) === true) {\n      return true;\n    }\n  }\n}\n\ncustomElement({ name: 'au-slot', template: null, containerless: true })(AuSlot);\n","import { DI } from '@aurelia/kernel';\nimport { valueConverter } from '@aurelia/runtime';\n\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\n\nexport interface ISanitizer {\n  /**\n   * Sanitizes the provided input.\n   *\n   * @param input - The input to be sanitized.\n   */\n  sanitize(input: string): string;\n}\n\nexport const ISanitizer = DI.createInterface<ISanitizer>('ISanitizer', x => x.singleton(class {\n  public sanitize(input: string): string {\n    return input.replace(SCRIPT_REGEX, '');\n  }\n}));\n\n/**\n * Simple html sanitization converter to preserve whitelisted elements and attributes on a bound property containing html.\n */\nexport class SanitizeValueConverter {\n  public constructor(\n    /** @internal */ @ISanitizer private readonly _sanitizer: ISanitizer,\n  ) {}\n\n  /**\n   * Process the provided markup that flows to the view.\n   *\n   * @param untrustedMarkup - The untrusted markup to be sanitized.\n   */\n  public toView(untrustedMarkup: string): string|null {\n    if (untrustedMarkup == null) {\n      return null;\n    }\n\n    return this._sanitizer.sanitize(untrustedMarkup);\n  }\n}\n\nvalueConverter('sanitize')(SanitizeValueConverter);\n","import { ComposableObjectComponentType, IViewLocator, ViewSelector } from '../../templating/view.js';\nimport { valueConverter } from '@aurelia/runtime';\nimport type { ICustomElementViewModel } from '../../templating/controller.js';\n\nexport class ViewValueConverter {\n  public constructor(\n    /** @internal */ @IViewLocator private readonly _viewLocator: IViewLocator,\n  ) {}\n\n  public toView<T extends ICustomElementViewModel>(\n    object: T | null | undefined,\n    viewNameOrSelector?: string | ViewSelector\n  ): ComposableObjectComponentType<T> | null {\n    return this._viewLocator.getViewComponentForObject<T>(\n      object,\n      viewNameOrSelector\n    );\n  }\n}\n\nvalueConverter('view')(ViewValueConverter);\n","import { IContainer, IRegistry, noop, Registration } from '@aurelia/kernel';\nimport {\n  AtPrefixedTriggerAttributePattern,\n  ColonPrefixedBindAttributePattern,\n  SpreadAttributePattern,\n  DotSeparatedAttributePattern,\n  RefAttributePattern,\n} from './resources/attribute-pattern.js';\nimport {\n  CallBindingCommand,\n  DefaultBindingCommand,\n  ForBindingCommand,\n  FromViewBindingCommand,\n  OneTimeBindingCommand,\n  ToViewBindingCommand,\n  TwoWayBindingCommand,\n  AttrBindingCommand,\n  CaptureBindingCommand,\n  ClassBindingCommand,\n  DelegateBindingCommand,\n  RefBindingCommand,\n  StyleBindingCommand,\n  TriggerBindingCommand,\n  SpreadBindingCommand,\n} from './resources/binding-command.js';\nimport { TemplateCompiler } from './template-compiler.js';\nimport {\n  CallBindingRenderer,\n  CustomAttributeRenderer,\n  CustomElementRenderer,\n  InterpolationBindingRenderer,\n  IteratorBindingRenderer,\n  LetElementRenderer,\n  PropertyBindingRenderer,\n  RefBindingRenderer,\n  SetPropertyRenderer,\n  TemplateControllerRenderer,\n  AttributeBindingRenderer,\n  ListenerBindingRenderer,\n  SetAttributeRenderer,\n  StylePropertyBindingRenderer,\n  TextBindingRenderer,\n  SetClassAttributeRenderer,\n  SetStyleAttributeRenderer,\n  SpreadRenderer,\n} from './renderer.js';\nimport {\n  FromViewBindingBehavior,\n  OneTimeBindingBehavior,\n  ToViewBindingBehavior,\n  TwoWayBindingBehavior,\n} from './binding-behaviors/binding-mode.js';\nimport { DebounceBindingBehavior } from './binding-behaviors/debounce.js';\nimport { SignalBindingBehavior } from './binding-behaviors/signals.js';\nimport { ThrottleBindingBehavior } from './binding-behaviors/throttle.js';\nimport { SVGAnalyzer } from './observation/svg-analyzer.js';\nimport { AttrBindingBehavior } from './resources/binding-behaviors/attr.js';\nimport { SelfBindingBehavior } from './resources/binding-behaviors/self.js';\nimport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger.js';\nimport { Focus } from './resources/custom-attributes/focus.js';\nimport { Show } from './resources/custom-attributes/show.js';\nimport { Portal } from './resources/template-controllers/portal.js';\nimport { FrequentMutations, ObserveShallow } from './resources/template-controllers/flags.js';\nimport { Else, If } from './resources/template-controllers/if.js';\nimport { Repeat } from './resources/template-controllers/repeat.js';\nimport { With } from './resources/template-controllers/with.js';\nimport { Switch, Case, DefaultCase } from './resources/template-controllers/switch.js';\nimport {\n  PromiseTemplateController,\n  PendingTemplateController,\n  FulfilledTemplateController,\n  RejectedTemplateController,\n  // TODO: activate after the attribute parser and/or interpreter such that for `t`, `then` is not picked up.\n  PromiseAttributePattern,\n  FulfilledAttributePattern,\n  RejectedAttributePattern,\n} from './resources/template-controllers/promise.js';\nimport { AuRender } from './resources/custom-elements/au-render.js';\nimport { AuCompose } from './resources/custom-elements/au-compose.js';\nimport { AuSlot } from './resources/custom-elements/au-slot.js';\nimport { SanitizeValueConverter } from './resources/value-converters/sanitize.js';\nimport { ViewValueConverter } from './resources/value-converters/view.js';\nimport { NodeObserverLocator } from './observation/observer-locator.js';\nimport { ICoercionConfiguration } from '@aurelia/runtime';\n\nexport const DebounceBindingBehaviorRegistration = DebounceBindingBehavior as unknown as IRegistry;\nexport const OneTimeBindingBehaviorRegistration = OneTimeBindingBehavior as unknown as IRegistry;\nexport const ToViewBindingBehaviorRegistration = ToViewBindingBehavior as unknown as IRegistry;\nexport const FromViewBindingBehaviorRegistration = FromViewBindingBehavior as unknown as IRegistry;\nexport const SignalBindingBehaviorRegistration = SignalBindingBehavior as unknown as IRegistry;\nexport const ThrottleBindingBehaviorRegistration = ThrottleBindingBehavior as unknown as IRegistry;\nexport const TwoWayBindingBehaviorRegistration = TwoWayBindingBehavior as unknown as IRegistry;\n\nexport const ITemplateCompilerRegistration = TemplateCompiler as IRegistry;\nexport const INodeObserverLocatorRegistration = NodeObserverLocator as IRegistry;\n\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `ITemplateCompiler`\n * - `ITargetAccessorLocator`\n * - `ITargetObserverLocator`\n */\nexport const DefaultComponents = [\n  ITemplateCompilerRegistration,\n  INodeObserverLocatorRegistration,\n];\n\nexport const SVGAnalyzerRegistration = SVGAnalyzer as IRegistry;\n\nexport const AtPrefixedTriggerAttributePatternRegistration = AtPrefixedTriggerAttributePattern as unknown as IRegistry;\nexport const ColonPrefixedBindAttributePatternRegistration = ColonPrefixedBindAttributePattern as unknown as IRegistry;\nexport const RefAttributePatternRegistration = RefAttributePattern as unknown as IRegistry;\nexport const DotSeparatedAttributePatternRegistration = DotSeparatedAttributePattern as unknown as IRegistry;\nexport const SpreadAttributePatternRegistration = SpreadAttributePattern as unknown as IRegistry;\n\n/**\n * Default binding syntax for the following attribute name patterns:\n * - `ref`\n * - `target.command` (dot-separated)\n */\nexport const DefaultBindingSyntax = [\n  RefAttributePatternRegistration,\n  DotSeparatedAttributePatternRegistration,\n  SpreadAttributePatternRegistration,\n];\n\n/**\n * Binding syntax for short-hand attribute name patterns:\n * - `@target` (short-hand for `target.trigger`)\n * - `:target` (short-hand for `target.bind`)\n */\nexport const ShortHandBindingSyntax = [\n  AtPrefixedTriggerAttributePatternRegistration,\n  ColonPrefixedBindAttributePatternRegistration\n];\n\nexport const CallBindingCommandRegistration = CallBindingCommand as unknown as IRegistry;\nexport const DefaultBindingCommandRegistration = DefaultBindingCommand as unknown as IRegistry;\nexport const ForBindingCommandRegistration = ForBindingCommand as unknown as IRegistry;\nexport const FromViewBindingCommandRegistration = FromViewBindingCommand as unknown as IRegistry;\nexport const OneTimeBindingCommandRegistration = OneTimeBindingCommand as unknown as IRegistry;\nexport const ToViewBindingCommandRegistration = ToViewBindingCommand as unknown as IRegistry;\nexport const TwoWayBindingCommandRegistration = TwoWayBindingCommand as unknown as IRegistry;\nexport const RefBindingCommandRegistration = RefBindingCommand as unknown as IRegistry;\nexport const TriggerBindingCommandRegistration = TriggerBindingCommand as unknown as IRegistry;\nexport const DelegateBindingCommandRegistration = DelegateBindingCommand as unknown as IRegistry;\nexport const CaptureBindingCommandRegistration = CaptureBindingCommand as unknown as IRegistry;\nexport const AttrBindingCommandRegistration = AttrBindingCommand as unknown as IRegistry;\nexport const ClassBindingCommandRegistration = ClassBindingCommand as unknown as IRegistry;\nexport const StyleBindingCommandRegistration = StyleBindingCommand as unknown as IRegistry;\nexport const SpreadBindingCommandRegistration = SpreadBindingCommand as unknown as IRegistry;\n\n/**\n * Default HTML-specific (but environment-agnostic) binding commands:\n * - Property observation: `.bind`, `.one-time`, `.from-view`, `.to-view`, `.two-way`\n * - Function call: `.call`\n * - Collection observation: `.for`\n * - Event listeners: `.trigger`, `.delegate`, `.capture`\n */\nexport const DefaultBindingLanguage = [\n  DefaultBindingCommandRegistration,\n  OneTimeBindingCommandRegistration,\n  FromViewBindingCommandRegistration,\n  ToViewBindingCommandRegistration,\n  TwoWayBindingCommandRegistration,\n  CallBindingCommandRegistration,\n  ForBindingCommandRegistration,\n  RefBindingCommandRegistration,\n  TriggerBindingCommandRegistration,\n  DelegateBindingCommandRegistration,\n  CaptureBindingCommandRegistration,\n  ClassBindingCommandRegistration,\n  StyleBindingCommandRegistration,\n  AttrBindingCommandRegistration,\n  SpreadBindingCommandRegistration,\n];\n\nexport const SanitizeValueConverterRegistration = SanitizeValueConverter as unknown as IRegistry;\nexport const ViewValueConverterRegistration = ViewValueConverter as unknown as IRegistry;\nexport const FrequentMutationsRegistration = FrequentMutations as unknown as IRegistry;\nexport const ObserveShallowRegistration = ObserveShallow as unknown as IRegistry;\nexport const IfRegistration = If as unknown as IRegistry;\nexport const ElseRegistration = Else as unknown as IRegistry;\nexport const RepeatRegistration = Repeat as unknown as IRegistry;\nexport const WithRegistration = With as unknown as IRegistry;\nexport const SwitchRegistration = Switch as unknown as IRegistry;\nexport const CaseRegistration = Case as unknown as IRegistry;\nexport const DefaultCaseRegistration = DefaultCase as unknown as IRegistry;\nexport const PromiseTemplateControllerRegistration = PromiseTemplateController as unknown as IRegistry;\nexport const PendingTemplateControllerRegistration = PendingTemplateController as unknown as IRegistry;\nexport const FulfilledTemplateControllerRegistration = FulfilledTemplateController as unknown as IRegistry;\nexport const RejectedTemplateControllerRegistration = RejectedTemplateController as unknown as IRegistry;\n// TODO: activate after the attribute parser and/or interpreter such that for `t`, `then` is not picked up.\nexport const PromiseAttributePatternRegistration = PromiseAttributePattern as unknown as IRegistry;\nexport const FulfilledAttributePatternRegistration = FulfilledAttributePattern as unknown as IRegistry;\nexport const RejectedAttributePatternRegistration = RejectedAttributePattern as unknown as IRegistry;\nexport const AttrBindingBehaviorRegistration = AttrBindingBehavior as unknown as IRegistry;\nexport const SelfBindingBehaviorRegistration = SelfBindingBehavior as unknown as IRegistry;\nexport const UpdateTriggerBindingBehaviorRegistration = UpdateTriggerBindingBehavior as unknown as IRegistry;\nexport const AuRenderRegistration = AuRender as unknown as IRegistry;\nexport const AuComposeRegistration = AuCompose as unknown as IRegistry;\nexport const PortalRegistration = Portal as unknown as IRegistry;\nexport const FocusRegistration = Focus as unknown as IRegistry;\nexport const ShowRegistration = Show as unknown as IRegistry;\n\n/**\n * Default HTML-specific (but environment-agnostic) resources:\n * - Binding Behaviors: `oneTime`, `toView`, `fromView`, `twoWay`, `signal`, `debounce`, `throttle`, `attr`, `self`, `updateTrigger`\n * - Custom Elements: `au-compose`, `au-slot`\n * - Custom Attributes: `blur`, `focus`, `portal`\n * - Template controllers: `if`/`else`, `repeat`, `with`\n * - Value Converters: `sanitize`\n */\nexport const DefaultResources = [\n  DebounceBindingBehaviorRegistration,\n  OneTimeBindingBehaviorRegistration,\n  ToViewBindingBehaviorRegistration,\n  FromViewBindingBehaviorRegistration,\n  SignalBindingBehaviorRegistration,\n  ThrottleBindingBehaviorRegistration,\n  TwoWayBindingBehaviorRegistration,\n  SanitizeValueConverterRegistration,\n  ViewValueConverterRegistration,\n  FrequentMutationsRegistration,\n  ObserveShallowRegistration,\n  IfRegistration,\n  ElseRegistration,\n  RepeatRegistration,\n  WithRegistration,\n  SwitchRegistration,\n  CaseRegistration,\n  DefaultCaseRegistration,\n  PromiseTemplateControllerRegistration,\n  PendingTemplateControllerRegistration,\n  FulfilledTemplateControllerRegistration,\n  RejectedTemplateControllerRegistration,\n  // TODO: activate after the attribute parser and/or interpreter such that for `t`, `then` is not picked up.\n  PromiseAttributePatternRegistration,\n  FulfilledAttributePatternRegistration,\n  RejectedAttributePatternRegistration,\n  AttrBindingBehaviorRegistration,\n  SelfBindingBehaviorRegistration,\n  UpdateTriggerBindingBehaviorRegistration,\n  AuRenderRegistration,\n  AuComposeRegistration,\n  PortalRegistration,\n  FocusRegistration,\n  ShowRegistration,\n  AuSlot,\n];\n\nexport const CallBindingRendererRegistration = CallBindingRenderer as unknown as IRegistry;\nexport const CustomAttributeRendererRegistration = CustomAttributeRenderer as unknown as IRegistry;\nexport const CustomElementRendererRegistration = CustomElementRenderer as unknown as IRegistry;\nexport const InterpolationBindingRendererRegistration = InterpolationBindingRenderer as unknown as IRegistry;\nexport const IteratorBindingRendererRegistration = IteratorBindingRenderer as unknown as IRegistry;\nexport const LetElementRendererRegistration = LetElementRenderer as unknown as IRegistry;\nexport const PropertyBindingRendererRegistration = PropertyBindingRenderer as unknown as IRegistry;\nexport const RefBindingRendererRegistration = RefBindingRenderer as unknown as IRegistry;\nexport const SetPropertyRendererRegistration = SetPropertyRenderer as unknown as IRegistry;\nexport const TemplateControllerRendererRegistration = TemplateControllerRenderer as unknown as IRegistry;\nexport const ListenerBindingRendererRegistration = ListenerBindingRenderer as unknown as IRegistry;\nexport const AttributeBindingRendererRegistration = AttributeBindingRenderer as unknown as IRegistry;\nexport const SetAttributeRendererRegistration = SetAttributeRenderer as unknown as IRegistry;\nexport const SetClassAttributeRendererRegistration = SetClassAttributeRenderer as unknown as IRegistry;\nexport const SetStyleAttributeRendererRegistration = SetStyleAttributeRenderer as unknown as IRegistry;\nexport const StylePropertyBindingRendererRegistration = StylePropertyBindingRenderer as unknown as IRegistry;\nexport const TextBindingRendererRegistration = TextBindingRenderer as unknown as IRegistry;\nexport const SpreadRendererRegistration = SpreadRenderer as unknown as IRegistry;\n\n/**\n * Default renderers for:\n * - PropertyBinding: `bind`, `one-time`, `to-view`, `from-view`, `two-way`\n * - IteratorBinding: `for`\n * - CallBinding: `call`\n * - RefBinding: `ref`\n * - InterpolationBinding: `${}`\n * - SetProperty\n * - `customElement` hydration\n * - `customAttribute` hydration\n * - `templateController` hydration\n * - `let` element hydration\n * - Listener Bindings: `trigger`, `capture`, `delegate`\n * - SetAttribute\n * - StyleProperty: `style`, `css`\n * - TextBinding: `${}`\n */\nexport const DefaultRenderers = [\n  PropertyBindingRendererRegistration,\n  IteratorBindingRendererRegistration,\n  CallBindingRendererRegistration,\n  RefBindingRendererRegistration,\n  InterpolationBindingRendererRegistration,\n  SetPropertyRendererRegistration,\n  CustomElementRendererRegistration,\n  CustomAttributeRendererRegistration,\n  TemplateControllerRendererRegistration,\n  LetElementRendererRegistration,\n  ListenerBindingRendererRegistration,\n  AttributeBindingRendererRegistration,\n  SetAttributeRendererRegistration,\n  SetClassAttributeRendererRegistration,\n  SetStyleAttributeRendererRegistration,\n  StylePropertyBindingRendererRegistration,\n  TextBindingRendererRegistration,\n  SpreadRendererRegistration,\n];\n\nexport const StandardConfiguration = createConfiguration(noop);\n\nfunction createConfiguration(optionsProvider: ConfigurationOptionsProvider) {\n  return {\n    optionsProvider,\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container: IContainer): IContainer {\n      const runtimeConfigurationOptions: IRuntimeHtmlConfigurationOptions = {\n        coercingOptions: {\n          enableCoercion: false,\n          coerceNullish: false\n        }\n      };\n\n      optionsProvider(runtimeConfigurationOptions);\n\n      /**\n       * Standard DI configuration containing html-specific (but environment-agnostic) registrations:\n       * - `RuntimeConfiguration` from `@aurelia/runtime`\n       * - `DefaultComponents`\n       * - `DefaultResources`\n       * - `DefaultRenderers`\n       */\n      return container.register(\n        Registration.instance(ICoercionConfiguration, runtimeConfigurationOptions.coercingOptions),\n        ...DefaultComponents,\n        ...DefaultResources,\n        ...DefaultBindingSyntax,\n        ...DefaultBindingLanguage,\n        ...DefaultRenderers,\n      );\n    },\n    customize(cb?: ConfigurationOptionsProvider) {\n      return createConfiguration(cb ?? optionsProvider);\n    },\n  };\n}\n\nexport type ConfigurationOptionsProvider = (options: IRuntimeHtmlConfigurationOptions) => void;\ninterface IRuntimeHtmlConfigurationOptions {\n  coercingOptions: ICoercionConfiguration;\n}\n","import { DI, Registration, InstanceProvider, onResolve } from '@aurelia/kernel';\nimport { BrowserPlatform } from '@aurelia/platform-browser';\nimport { LifecycleFlags } from '@aurelia/runtime';\nimport { AppRoot, IAppRoot, ISinglePageApp } from './app-root.js';\nimport { IEventTarget, INode } from './dom.js';\nimport { IPlatform } from './platform.js';\nimport { CustomElement, CustomElementDefinition } from './resources/custom-element.js';\nimport { Controller, ICustomElementController, ICustomElementViewModel, IHydratedParentController } from './templating/controller.js';\nimport { isFunction } from './utilities.js';\n\nimport type {\n  Constructable,\n  IContainer,\n  IDisposable,\n} from '@aurelia/kernel';\n\nexport interface IAurelia extends Aurelia {}\nexport const IAurelia = DI.createInterface<IAurelia>('IAurelia');\n\nexport class Aurelia implements IDisposable {\n  /** @internal */\n  private _isRunning: boolean = false;\n  public get isRunning(): boolean { return this._isRunning; }\n  /** @internal */\n  private _isStarting: boolean = false;\n  public get isStarting(): boolean { return this._isStarting; }\n  /** @internal */\n  private _isStopping: boolean = false;\n  public get isStopping(): boolean { return this._isStopping; }\n\n  // TODO:\n  // root should just be a controller,\n  // in all other parts of the framework, root of something is always the same type of that thing\n  // i.e: container.root => a container, RouteContext.root => a RouteContext\n  // Aurelia.root of a controller hierarchy should behave similarly\n  /** @internal */\n  private _root: IAppRoot | undefined = void 0;\n  public get root(): IAppRoot {\n    if (this._root == null) {\n      if (this.next == null) {\n        if (__DEV__)\n          throw new Error(`root is not defined`);\n        else\n          throw new Error('AUR0767');\n      }\n      return this.next;\n    }\n    return this._root;\n  }\n\n  private next: IAppRoot | undefined = void 0;\n\n  /** @internal */\n  private readonly _rootProvider: InstanceProvider<IAppRoot>;\n\n  public constructor(\n    public readonly container: IContainer = DI.createContainer(),\n  ) {\n    if (container.has(IAurelia, true)) {\n      if (__DEV__)\n        throw new Error('An instance of Aurelia is already registered with the container or an ancestor of it.');\n      else\n        throw new Error('AUR0768');\n    }\n\n    container.registerResolver(IAurelia, new InstanceProvider<IAurelia>('IAurelia', this));\n    container.registerResolver(IAppRoot, this._rootProvider = new InstanceProvider('IAppRoot'));\n  }\n\n  public register(...params: unknown[]): this {\n    this.container.register(...params);\n    return this;\n  }\n\n  public app(config: ISinglePageApp): Omit<this, 'register' | 'app' | 'enhance'> {\n    this.next = new AppRoot(config, this._initPlatform(config.host), this.container, this._rootProvider);\n    return this;\n  }\n\n  /**\n   * @param parentController - The owning controller of the view created by this enhance call\n   */\n  public enhance<T, K = T extends Constructable<infer I> ? I : T>(config: IEnhancementConfig<T>, parentController?: IHydratedParentController | null): ICustomElementController<K> | Promise<ICustomElementController<K>> {\n    const ctn = config.container ?? this.container.createChild();\n    const host = config.host as HTMLElement;\n    const p = this._initPlatform(host);\n    const comp = config.component as unknown as K;\n    let bc: ICustomElementViewModel & K;\n    if (isFunction(comp)) {\n      ctn.registerResolver(\n        p.HTMLElement,\n        ctn.registerResolver(\n          p.Element,\n          ctn.registerResolver(INode, new InstanceProvider('ElementResolver', host))\n        )\n      );\n      bc = ctn.invoke(comp as unknown as Constructable<ICustomElementViewModel & K>);\n    } else {\n      bc = comp;\n    }\n    ctn.registerResolver(IEventTarget, new InstanceProvider('IEventTarget', host));\n    parentController = parentController ?? null;\n\n    const view = Controller.$el(\n      ctn,\n      bc,\n      host,\n      null,\n      CustomElementDefinition.create({ name: CustomElement.generateName(), template: host, enhance: true }),\n    );\n    return onResolve(\n      view.activate(view, parentController, LifecycleFlags.fromBind),\n      () => view\n    );\n  }\n\n  public async waitForIdle(): Promise<void> {\n    const platform = this.root.platform;\n    await platform.domWriteQueue.yield();\n    await platform.domReadQueue.yield();\n    await platform.taskQueue.yield();\n  }\n\n  /** @internal */\n  private _initPlatform(host: HTMLElement): IPlatform {\n    let p: IPlatform;\n    if (!this.container.has(IPlatform, false)) {\n      if (host.ownerDocument.defaultView === null) {\n        if (__DEV__)\n          throw new Error(`Failed to initialize the platform object. The host element's ownerDocument does not have a defaultView`);\n        else\n          throw new Error('AUR0769');\n      }\n      p = new BrowserPlatform(host.ownerDocument.defaultView);\n      this.container.register(Registration.instance(IPlatform, p));\n    } else {\n      p = this.container.get(IPlatform);\n    }\n    return p;\n  }\n\n  /** @internal */\n  private _startPromise: Promise<void> | void = void 0;\n  public start(root: IAppRoot | undefined = this.next): void | Promise<void> {\n    if (root == null) {\n      if (__DEV__)\n        throw new Error(`There is no composition root`);\n      else\n        throw new Error('AUR0770');\n    }\n\n    if (this._startPromise instanceof Promise) {\n      return this._startPromise;\n    }\n\n    return this._startPromise = onResolve(this.stop(), () => {\n      Reflect.set(root.host, '$aurelia', this);\n      this._rootProvider.prepare(this._root = root);\n      this._isStarting = true;\n\n      return onResolve(root.activate(), () => {\n        this._isRunning = true;\n        this._isStarting = false;\n        this._startPromise = void 0;\n        this._dispatchEvent(root, 'au-started', root.host);\n      });\n    });\n  }\n\n  /** @internal */\n  private _stopPromise: Promise<void> | void = void 0;\n  public stop(dispose: boolean = false): void | Promise<void> {\n    if (this._stopPromise instanceof Promise) {\n      return this._stopPromise;\n    }\n\n    if (this._isRunning === true) {\n      const root = this._root!;\n      this._isRunning = false;\n      this._isStopping = true;\n\n      return this._stopPromise = onResolve(root.deactivate(), () => {\n        Reflect.deleteProperty(root.host, '$aurelia');\n        if (dispose) {\n          root.dispose();\n        }\n        this._root = void 0;\n        this._rootProvider.dispose();\n        this._isStopping = false;\n        this._dispatchEvent(root, 'au-stopped', root.host);\n      });\n    }\n  }\n\n  public dispose(): void {\n    if (this._isRunning || this._isStopping) {\n      if (__DEV__)\n        throw new Error(`The aurelia instance must be fully stopped before it can be disposed`);\n      else\n        throw new Error('AUR0771');\n    }\n    this.container.dispose();\n  }\n\n  /** @internal */\n  private _dispatchEvent(root: IAppRoot, name: string, target: HTMLElement): void {\n    const ev = new root.platform.window.CustomEvent(name, { detail: this, bubbles: true, cancelable: true });\n    target.dispatchEvent(ev);\n  }\n}\n\nexport interface IEnhancementConfig<T> {\n  host: Element;\n  /**\n   * The binding context of the enhancement. Will be instantiate by DI if a constructor is given\n   */\n  component: T;\n  /**\n   * A predefined container for the enhanced view.\n   */\n  container?: IContainer;\n}\n","export const enum DefinitionType {\n  Element = 1,\n  Attribute = 2,\n}\n","import { DI } from '@aurelia/kernel';\n\nimport type { Constructable, IContainer, IDisposable } from '@aurelia/kernel';\nimport type { ICustomElementViewModel } from '../../templating/controller.js';\n\n/**\n * The dialog service for composing view & view model into a dialog\n */\nexport const IDialogService = DI.createInterface<IDialogService>('IDialogService');\nexport interface IDialogService {\n  readonly controllers: IDialogController[];\n  /**\n   * Opens a new dialog.\n   *\n   * @param settings - Dialog settings for this dialog instance.\n   * @returns Promise A promise that settles when the dialog is closed.\n   */\n  open(settings?: IDialogSettings): DialogOpenPromise;\n\n  /**\n   * Closes all open dialogs at the time of invocation.\n   *\n   * @returns Promise<DialogController[]> All controllers whose close operation was cancelled.\n   */\n  closeAll(): Promise<IDialogController[]>;\n}\n\n/**\n * The controller asscociated with every dialog view model\n */\nexport const IDialogController = DI.createInterface<IDialogController>('IDialogController');\nexport interface IDialogController {\n  readonly settings: IDialogLoadedSettings;\n  /**\n   * A promise that will be fulfilled once this dialog has been closed\n   */\n  readonly closed: Promise<DialogCloseResult>;\n\n  ok(value?: unknown): Promise<DialogCloseResult<DialogDeactivationStatuses.Ok>>;\n  cancel(value?: unknown): Promise<DialogCloseResult<DialogDeactivationStatuses.Cancel>>;\n  error(value?: unknown): Promise<void>;\n}\n\n/**\n * An interface describing the object responsible for creating the dom structure of a dialog\n */\nexport const IDialogDomRenderer = DI.createInterface<IDialogDomRenderer>('IDialogDomRenderer');\nexport interface IDialogDomRenderer {\n  render(dialogHost: Element, settings: IDialogLoadedSettings): IDialogDom;\n}\n\n/**\n * An interface describing the DOM structure of a dialog\n */\nexport const IDialogDom = DI.createInterface<IDialogDom>('IDialogDom');\nexport interface IDialogDom extends IDisposable {\n  readonly overlay: HTMLElement;\n  readonly contentHost: HTMLElement;\n}\n\n// export type IDialogCancellableOpenResult = IDialogOpenResult | IDialogCancelResult;\n\n/* tslint:disable:max-line-length */\n/**\n * The promised returned from a dialog composition.\n */\nexport interface DialogOpenPromise extends Promise<DialogOpenResult> {\n  /**\n   * Add a callback that will be invoked when a dialog has been closed\n   */\n  whenClosed<TResult1, TResult2>(\n    onfulfilled?: (value: DialogCloseResult) => TResult1 | PromiseLike<TResult1>,\n    onrejected?: (reason: unknown) => TResult2 | PromiseLike<TResult2>\n  ): Promise<TResult1 | TResult2>;\n}\n/* tslint:enable:max-line-length */\n\nexport type DialogActionKey = 'Escape' | 'Enter';\nexport type DialogMouseEventType = 'click' | 'mouseup' | 'mousedown';\n\nexport interface IDialogSettings<\n  TModel = unknown,\n  TVm extends object = object,\n> {\n\n  /**\n   * The view model url, constructor or instance for the dialog.\n   */\n  component?: () => Constructable<TVm> | TVm | Promise<TVm | Constructable<TVm>>;\n\n  /**\n   * The view url or view strategy to override the default view location convention.\n   */\n  template?: string | Element | Promise<string | Element> | (() => string | Element | Promise<string | Element>);\n\n  /**\n   * Data to be passed to the \"activate\" hook on the view model.\n   */\n  model?: TModel;\n\n  /**\n   * The element that will parent the dialog.\n   */\n  host?: Element;\n\n  /**\n   * The container for the dialog creation.\n   * One will be created from the root if not provided.\n   */\n  container?: IContainer;\n\n  /**\n   * When set to \"false\" allows the dialog to be closed with ESC key or clicking outside the dialog.\n   * When set to \"true\" the dialog does not close on ESC key or clicking outside of it.\n   */\n  lock?: boolean;\n\n  /**\n   * Allows for closing the top most dialog via the keyboard.\n   * When set to \"false\" no action will be taken.\n   * If set to \"true\", \"Escape\" or an array containing \"Escape\"\n   * the dialog will be \"cancel\" closed when the ESC key is pressed.\n   * If set to \"Enter\" or and array containing \"Enter\"\n   * the dialog will be \"ok\" closed  when the ENTER key is pressed.\n   * Using the array format allows combining the ESC and ENTER keys.\n   */\n  keyboard?: DialogActionKey[];\n\n  /**\n   * Determines which type of mouse event should be used for closing the dialog\n   *\n   * Default: click\n   */\n  mouseEvent?: DialogMouseEventType;\n\n  /**\n   * When set to \"true\" allows for the dismissal of the dialog by clicking outside of it.\n   */\n  overlayDismiss?: boolean;\n\n  /**\n   * The z-index of the dialog.\n   * In the terms of the DialogRenderer it is applied to the dialog overlay and the dialog container.\n   */\n  startingZIndex?: number;\n\n  /**\n   * When set to true conveys a cancellation as a rejection.\n   */\n  rejectOnCancel?: boolean;\n}\n\nexport type IDialogLoadedSettings<T extends object = object> = Omit<IDialogSettings<T>, 'component' | 'template' | 'keyboard'> & {\n  component?: Constructable<T> | T;\n  template?: string | Element;\n  readonly keyboard: DialogActionKey[];\n};\n\nexport type IDialogGlobalSettings = Pick<\n  IDialogSettings,\n  'lock' | 'startingZIndex' | 'rejectOnCancel'\n>;\nexport const IDialogGlobalSettings = DI.createInterface<IDialogGlobalSettings>('IDialogGlobalSettings');\n\nexport interface DialogError<T> extends Error {\n  wasCancelled: boolean;\n  value?: T;\n}\n\n/**\n * The error thrown when a \"cancel\" occurs and DialogSettings.rejectOnCancel is set to \"true\".\n */\nexport type DialogCancelError<T> = DialogError<T> & { wasCancelled: true };\n\n/**\n * The error thrown when the dialog is closed with the `DialogController.prototype.error` method.\n */\nexport type DialogCloseError<T> = DialogError<T> & { wasCancelled: false };\n\nexport class DialogOpenResult {\n  private constructor(\n    public readonly wasCancelled: boolean,\n    public readonly dialog: IDialogController,\n  ) {}\n\n  public static create(\n    wasCancelled: boolean,\n    dialog: IDialogController,\n  ) {\n    return new DialogOpenResult(wasCancelled, dialog);\n  }\n}\n\nexport class DialogCloseResult<\n  T extends DialogDeactivationStatuses = DialogDeactivationStatuses,\n  TVal = unknown\n> {\n  private constructor(\n    public readonly status: T,\n    public readonly value?: TVal,\n  ) {}\n\n  public static create<T extends DialogDeactivationStatuses, TVal = unknown>(status: T, value?: TVal): DialogCloseResult<T, TVal> {\n    return new DialogCloseResult(status, value);\n  }\n}\n\nexport interface IDialogCustomElementViewModel<T = unknown> extends ICustomElementViewModel, IDialogComponent<T> {\n  readonly $dialog: IDialogController;\n}\n\nexport const enum DialogDeactivationStatuses {\n  Ok = 'ok',\n  Error = 'error',\n  Cancel = 'cancel',\n  /**\n   * If a view model refused to deactivate in canDeactivate,\n   * then this status should be used to reflect that\n   */\n  Abort = 'abort',\n}\n\n/**\n * The result received when a dialog opens.\n */\nexport interface DialogOpenResult {\n  readonly wasCancelled: boolean;\n  /**\n   * The controller for the open dialog.\n   */\n  readonly dialog: IDialogController;\n}\n\n// #region Implementable\n\nexport interface IDialogComponent<T> {\n  canActivate?: IDialogComponentCanActivate<T>['canActivate'];\n  activate?: IDialogComponentActivate<T>['activate'];\n  canDeactivate?: IDialogComponentCanDeactivate['canDeactivate'];\n  deactivate?: IDialogComponentDeactivate['deactivate'];\n}\n/**\n * An optional interface describing the dialog canActivate convention.\n */\nexport interface IDialogComponentCanActivate<T> {\n  /**\n   * Implement this hook if you want to control whether or not the dialog can be open.\n   * To cancel the opening of the dialog return false or a promise that resolves to false.\n   * Any other returned value is coerced to true.\n   */\n  canActivate(model?: T): boolean | Promise<boolean> | PromiseLike<boolean>;\n}\n\n/**\n * An optional interface describing the dialog activate convention.\n */\nexport interface IDialogComponentActivate<T> {\n  /**\n   * Implement this hook if you want to perform custom logic just before the dialog is open.\n   */\n  activate(model?: T): void | Promise<void> | PromiseLike<void>;\n}\n\n/**\n * An optional interface describing the dialog canDeactivate convention.\n */\nexport interface IDialogComponentCanDeactivate {\n  /**\n   * Implement this hook if you want to control whether or not the dialog can be closed.\n   * To cancel the closing of the dialog return false or a promise that resolves to false.\n   * Any other returned value is coerced to true.\n   */\n  canDeactivate(result: DialogCloseResult): boolean | Promise<boolean> | PromiseLike<boolean>;\n}\n\n/**\n * An optional interface describing the dialog deactivate convention.\n */\nexport interface IDialogComponentDeactivate {\n  /**\n   * Implement this hook if you want to perform custom logic when the dialog is being closed.\n   */\n  deactivate(result: DialogCloseResult): void | Promise<void> | PromiseLike<void>;\n}\n\n// #endregion\n","import { Constructable, IContainer, InstanceProvider, onResolve, Registration } from '@aurelia/kernel';\nimport { LifecycleFlags } from '@aurelia/runtime';\nimport { Controller, ICustomElementController } from '../../templating/controller.js';\nimport {\n  DialogDeactivationStatuses,\n  IDialogController,\n  IDialogDomRenderer,\n  IDialogDom,\n  DialogOpenResult,\n  DialogCloseResult,\n  DialogCancelError,\n  DialogCloseError,\n} from './dialog-interfaces.js';\nimport { IEventTarget, INode } from '../../dom.js';\nimport { IPlatform } from '../../platform.js';\nimport { CustomElement, CustomElementDefinition } from '../../resources/custom-element.js';\nimport { isFunction } from '../../utilities.js';\n\nimport type {\n  IDialogComponent,\n  IDialogLoadedSettings,\n} from './dialog-interfaces.js';\n\n/**\n * A controller object for a Dialog instance.\n */\nexport class DialogController implements IDialogController {\n  private readonly p: IPlatform;\n  private readonly ctn: IContainer;\n\n  /** @internal */\n  private cmp!: IDialogComponent<object>;\n\n  /** @internal */\n  private _resolve!: (result: DialogCloseResult) => void;\n\n  /** @internal */\n  private _reject!: (reason: unknown) => void;\n\n  /**\n   * @internal\n   */\n  private _closingPromise: Promise<DialogCloseResult> | undefined;\n\n  /**\n   * The settings used by this controller.\n   */\n  public settings!: IDialogLoadedSettings;\n\n  public readonly closed: Promise<DialogCloseResult>;\n\n  /**\n   * The dom structure created to support the dialog associated with this controller\n   */\n  private dom!: IDialogDom;\n\n  /**\n   * The component controller associated with this dialog controller\n   *\n   * @internal\n   */\n  private controller!: ICustomElementController;\n\n  protected static get inject() { return [IPlatform, IContainer]; }\n\n  public constructor(\n    p: IPlatform,\n    container: IContainer,\n  ) {\n    this.p = p;\n    this.ctn = container;\n    this.closed = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  /** @internal */\n  public activate(settings: IDialogLoadedSettings): Promise<DialogOpenResult> {\n    const container = this.ctn.createChild();\n    const { model, template, rejectOnCancel } = settings;\n    const hostRenderer: IDialogDomRenderer = container.get(IDialogDomRenderer);\n    const dialogTargetHost = settings.host ?? this.p.document.body;\n    const dom = this.dom = hostRenderer.render(dialogTargetHost, settings);\n    const rootEventTarget = container.has(IEventTarget, true)\n      ? container.get(IEventTarget) as Element\n      : null;\n    const contentHost = dom.contentHost;\n\n    this.settings = settings;\n    // application root host may be a different element with the dialog root host\n    // example:\n    // <body>\n    //   <my-app>\n    //   <au-dialog-container>\n    // when it's different, needs to ensure delegate bindings work\n    if (rootEventTarget == null || !rootEventTarget.contains(dialogTargetHost)) {\n      container.register(Registration.instance(IEventTarget, dialogTargetHost));\n    }\n\n    container.register(\n      Registration.instance(INode, contentHost),\n      Registration.instance(IDialogDom, dom),\n    );\n\n    return new Promise(r => {\n        const cmp = Object.assign(this.cmp = this.getOrCreateVm(container, settings, contentHost), { $dialog: this });\n        r(cmp.canActivate?.(model) ?? true);\n      })\n      .then(canActivate => {\n        if (canActivate !== true) {\n          dom.dispose();\n          if (rejectOnCancel) {\n            throw createDialogCancelError(null, 'Dialog activation rejected');\n          }\n          return DialogOpenResult.create(true, this);\n        }\n\n        const cmp = this.cmp;\n\n        return onResolve(cmp.activate?.(model), () => {\n          const ctrlr = this.controller = Controller.$el(\n            container,\n            cmp,\n            contentHost,\n            null,\n            CustomElementDefinition.create(\n              this.getDefinition(cmp) ?? { name: CustomElement.generateName(), template }\n            )\n          ) as ICustomElementController;\n          return onResolve(ctrlr.activate(ctrlr, null, LifecycleFlags.fromBind), () => {\n            dom.overlay.addEventListener(settings.mouseEvent ?? 'click', this);\n            return DialogOpenResult.create(false, this);\n          });\n        });\n      }, e => {\n        dom.dispose();\n        throw e;\n      });\n  }\n\n  /** @internal */\n  public deactivate<T extends DialogDeactivationStatuses>(status: T, value?: unknown): Promise<DialogCloseResult<T>> {\n    if (this._closingPromise) {\n      return this._closingPromise as Promise<DialogCloseResult<T>>;\n    }\n\n    let deactivating = true;\n    const { controller, dom, cmp, settings: { mouseEvent, rejectOnCancel }} = this;\n    const dialogResult = DialogCloseResult.create(status, value);\n\n    const promise: Promise<DialogCloseResult<T>> = new Promise<DialogCloseResult<T>>(r => {\n      r(onResolve(\n        cmp.canDeactivate?.(dialogResult) ?? true,\n        canDeactivate => {\n          if (canDeactivate !== true) {\n            // we are done, do not block consecutive calls\n            deactivating = false;\n            this._closingPromise = void 0;\n            if (rejectOnCancel) {\n              throw createDialogCancelError(null, 'Dialog cancellation rejected');\n            }\n            return DialogCloseResult.create(DialogDeactivationStatuses.Abort as T);\n          }\n          return onResolve(cmp.deactivate?.(dialogResult),\n            () => onResolve(controller.deactivate(controller, null, LifecycleFlags.fromUnbind),\n              () => {\n                dom.dispose();\n                dom.overlay.removeEventListener(mouseEvent ?? 'click', this);\n                if (!rejectOnCancel && status !== DialogDeactivationStatuses.Error) {\n                  this._resolve(dialogResult);\n                } else {\n                  this._reject(createDialogCancelError(value, 'Dialog cancelled with a rejection on cancel'));\n                }\n                return dialogResult;\n              }\n            )\n          );\n        }\n      ));\n    }).catch(reason => {\n      this._closingPromise = void 0;\n      throw reason;\n    });\n    // when component canDeactivate is synchronous, and returns something other than true\n    // then the below assignment will override\n    // the assignment inside the callback without the deactivating variable check\n    this._closingPromise = deactivating ? promise : void 0;\n    return promise;\n  }\n\n  /**\n   * Closes the dialog with a successful output.\n   *\n   * @param value - The returned success output.\n   */\n  public ok(value?: unknown): Promise<DialogCloseResult<DialogDeactivationStatuses.Ok>> {\n    return this.deactivate(DialogDeactivationStatuses.Ok, value);\n  }\n\n  /**\n   * Closes the dialog with a cancel output.\n   *\n   * @param value - The returned cancel output.\n   */\n  public cancel(value?: unknown): Promise<DialogCloseResult<DialogDeactivationStatuses.Cancel>> {\n    return this.deactivate(DialogDeactivationStatuses.Cancel, value);\n  }\n\n  /**\n   * Closes the dialog with an error output.\n   *\n   * @param value - A reason for closing with an error.\n   * @returns Promise An empty promise object.\n   */\n  public error(value: unknown): Promise<void> {\n    const closeError = createDialogCloseError(value);\n    return new Promise(r => r(onResolve(\n      this.cmp.deactivate?.(DialogCloseResult.create(DialogDeactivationStatuses.Error, closeError)),\n      () => onResolve(\n        this.controller.deactivate(this.controller, null, LifecycleFlags.fromUnbind),\n        () => {\n          this.dom.dispose();\n          this._reject(closeError);\n        }\n      )\n    )));\n  }\n\n  /** @internal */\n  public handleEvent(event: MouseEvent): void {\n    if (/* user allows dismiss on overlay click */this.settings.overlayDismiss\n      && /* did not click inside the host element */!this.dom.contentHost.contains(event.target as Element)\n    ) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      this.cancel();\n    }\n  }\n\n  private getOrCreateVm(container: IContainer, settings: IDialogLoadedSettings, host: HTMLElement): IDialogComponent<object> {\n    const Component = settings.component;\n    if (Component == null) {\n      return new EmptyComponent();\n    }\n    if (typeof Component === 'object') {\n      return Component;\n    }\n\n    const p = this.p;\n\n    container.registerResolver(\n      p.HTMLElement,\n      container.registerResolver(\n        p.Element,\n        container.registerResolver(INode, new InstanceProvider('ElementResolver', host))\n      )\n    );\n\n    return container.invoke(Component);\n  }\n\n  private getDefinition(component?: object | Constructable) {\n    const Ctor = (isFunction(component)\n      ? component\n      : component?.constructor) as Constructable;\n    return CustomElement.isType(Ctor)\n      ? CustomElement.getDefinition(Ctor)\n      : null;\n  }\n}\n\nclass EmptyComponent {}\n\nfunction createDialogCancelError<T>(output: T | undefined, msg: string): DialogCancelError<T> {\n  const error = new Error(msg) as DialogCancelError<T>;\n  error.wasCancelled = true;\n  error.value = output;\n  return error;\n}\n\nfunction createDialogCloseError<T = unknown>(output: T): DialogCloseError<T> {\n  const error = new Error() as DialogCloseError<T>;\n  error.wasCancelled = false;\n  error.value = output;\n  return error;\n}\n","import { IContainer, onResolve, Registration, resolveAll } from '@aurelia/kernel';\n\nimport {\n  DialogActionKey,\n  DialogCloseResult,\n  DialogDeactivationStatuses,\n  DialogOpenResult,\n  IDialogService,\n  IDialogController,\n  IDialogGlobalSettings,\n  IDialogLoadedSettings,\n} from './dialog-interfaces.js';\nimport { DialogController } from './dialog-controller.js';\nimport { AppTask } from '../../app-task.js';\nimport { IPlatform } from '../../platform.js';\nimport { isFunction } from '../../utilities.js';\n\nimport type {\n  DialogOpenPromise,\n  IDialogSettings,\n} from './dialog-interfaces.js';\n\n/**\n * A default implementation for the dialog service allowing for the creation of dialogs.\n */\nexport class DialogService implements IDialogService {\n  public get controllers() {\n    return this.dlgs.slice(0);\n  }\n  /**\n   * The current dialog controllers\n   *\n   * @internal\n   */\n  private readonly dlgs: IDialogController[] = [];\n\n  private get top(): IDialogController | null {\n    const dlgs = this.dlgs;\n    return dlgs.length > 0 ? dlgs[dlgs.length - 1] : null;\n  }\n\n  // tslint:disable-next-line:member-ordering\n  protected static get inject() { return [IContainer, IPlatform, IDialogGlobalSettings]; }\n\n  public constructor(\n    private readonly _ctn: IContainer,\n    private readonly p: IPlatform,\n    private readonly _defaultSettings: IDialogGlobalSettings,\n  ) {}\n\n  public static register(container: IContainer) {\n    container.register(\n      Registration.singleton(IDialogService, this),\n      AppTask.beforeDeactivate(IDialogService, dialogService => onResolve(\n        dialogService.closeAll(),\n        (openDialogController) => {\n          if (openDialogController.length > 0) {\n            // todo: what to do?\n            if (__DEV__)\n              throw new Error(`There are still ${openDialogController.length} open dialog(s).`);\n            else\n              throw new Error(`AUR0901:${openDialogController.length}`);\n          }\n        }\n      ))\n    );\n  }\n\n  /**\n   * Opens a new dialog.\n   *\n   * @param settings - Dialog settings for this dialog instance.\n   * @returns A promise that settles when the dialog is closed.\n   *\n   * Example usage:\n   * ```ts\n   * dialogService.open({ component: () => MyDialog, template: 'my-template' })\n   * dialogService.open({ component: () => MyDialog, template: document.createElement('my-template') })\n   *\n   * // JSX to hyperscript\n   * dialogService.open({ component: () => MyDialog, template: <my-template /> })\n   *\n   * dialogService.open({ component: () => import('...'), template: () => fetch('my.server/dialog-view.html') })\n   * ```\n   */\n  public open(settings: IDialogSettings): DialogOpenPromise {\n    return asDialogOpenPromise(new Promise<DialogOpenResult>(resolve => {\n      const $settings = DialogSettings.from(this._defaultSettings, settings);\n      const container = $settings.container ?? this._ctn.createChild();\n\n      resolve(onResolve(\n        $settings.load(),\n        loadedSettings => {\n          const dialogController = container.invoke(DialogController);\n          container.register(Registration.instance(IDialogController, dialogController));\n          container.register(Registration.callback(DialogController, () => {\n            if (__DEV__)\n              throw new Error('Invalid injection of DialogController. Use IDialogController instead.');\n            else\n              throw new Error('AUR0902');\n          }));\n\n          return onResolve(\n            dialogController.activate(loadedSettings),\n            openResult => {\n              if (!openResult.wasCancelled) {\n                if (this.dlgs.push(dialogController) === 1) {\n                  this.p.window.addEventListener('keydown', this);\n                }\n\n                const $removeController = () => this.remove(dialogController);\n                dialogController.closed.then($removeController, $removeController);\n              }\n              return openResult;\n            }\n          );\n        }\n      ));\n    }));\n  }\n\n  /**\n   * Closes all open dialogs at the time of invocation.\n   *\n   * @returns All controllers whose close operation was cancelled.\n   */\n  public closeAll(): Promise<IDialogController[]> {\n    return Promise\n      .all(Array.from(this.dlgs)\n        .map(controller => {\n          if (controller.settings.rejectOnCancel) {\n            // this will throw when calling cancel\n            // so only leave return null as noop\n            return controller.cancel().then(() => null);\n          }\n          return controller.cancel().then(result =>\n            result.status === DialogDeactivationStatuses.Cancel\n              ? null\n              : controller\n          );\n        })\n      )\n      .then(unclosedControllers =>\n        unclosedControllers.filter(unclosed => !!unclosed) as IDialogController[]\n      );\n  }\n\n  /** @internal */\n  private remove(controller: DialogController): void {\n    const dlgs = this.dlgs;\n    const idx = dlgs.indexOf(controller);\n    if (idx > -1) {\n      this.dlgs.splice(idx, 1);\n    }\n    if (dlgs.length === 0) {\n      this.p.window.removeEventListener('keydown', this);\n    }\n  }\n\n  /** @internal */\n  public handleEvent(e: Event): void {\n    const keyEvent = e as KeyboardEvent;\n    const key = getActionKey(keyEvent);\n    if (key == null) {\n      return;\n    }\n    const top = this.top;\n    if (top === null || top.settings.keyboard.length === 0) {\n      return;\n    }\n    const keyboard = top.settings.keyboard;\n    if (key === 'Escape' && keyboard.includes(key)) {\n      void top.cancel();\n    } else if (key === 'Enter' && keyboard.includes(key)) {\n      void top.ok();\n    }\n  }\n}\n\ninterface DialogSettings<T extends object = object> extends IDialogSettings<T> {}\nclass DialogSettings<T extends object = object> implements IDialogSettings<T> {\n\n  public static from(...srcs: Partial<IDialogSettings>[]): DialogSettings {\n    return (Object.assign(new DialogSettings(), ...srcs) as DialogSettings)\n      ._validate()\n      ._normalize();\n  }\n\n  public load(): IDialogLoadedSettings | Promise<IDialogLoadedSettings> {\n    const loaded = this as IDialogLoadedSettings;\n    const cmp = this.component;\n    const template = this.template;\n    const maybePromise = resolveAll(...[\n      cmp == null\n        ? void 0\n        : onResolve(cmp(), loadedCmp => { loaded.component = loadedCmp; }),\n      isFunction(template)\n        ? onResolve(template(), loadedTpl => { loaded.template = loadedTpl; })\n        : void 0\n    ]);\n    return maybePromise instanceof Promise\n      ? maybePromise.then(() => loaded)\n      : loaded;\n  }\n\n  /** @internal */\n  private _validate(): this {\n    if (this.component == null && this.template == null) {\n      if (__DEV__)\n        throw new Error('Invalid Dialog Settings. You must provide \"component\", \"template\" or both.');\n      else\n        throw new Error('AUR0903');\n    }\n    return this;\n  }\n\n  /** @internal */\n  private _normalize(): DialogSettings {\n    if (this.keyboard == null) {\n      this.keyboard = this.lock ? [] : ['Enter', 'Escape'];\n    }\n    if (typeof this.overlayDismiss !== 'boolean') {\n      this.overlayDismiss = !this.lock;\n    }\n    return this;\n  }\n}\n\nfunction whenClosed<TResult1 = unknown, TResult2 = unknown>(\n  this: Promise<DialogOpenResult>,\n  onfulfilled?: (r: DialogCloseResult) => TResult1 | PromiseLike<TResult1>,\n  onrejected?: (err: unknown) => TResult2 | PromiseLike<TResult2>\n): Promise<TResult1 | TResult2> {\n  return this.then(openResult => openResult.dialog.closed.then(onfulfilled, onrejected), onrejected);\n}\n\nfunction asDialogOpenPromise(promise: Promise<unknown>): DialogOpenPromise {\n  (promise as DialogOpenPromise).whenClosed = whenClosed;\n  return promise as DialogOpenPromise;\n}\n\nfunction getActionKey(e: KeyboardEvent): DialogActionKey | undefined {\n  if ((e.code || e.key) === 'Escape' || e.keyCode === 27) {\n    return 'Escape';\n  }\n  if ((e.code || e.key) === 'Enter' || e.keyCode === 13) {\n    return 'Enter';\n  }\n  return undefined;\n}\n","import { IPlatform } from '../../platform.js';\nimport {\n  IDialogDomRenderer,\n  IDialogDom,\n  IDialogGlobalSettings,\n} from './dialog-interfaces.js';\n\nimport { IContainer, Registration } from '@aurelia/kernel';\n\nexport class DefaultDialogGlobalSettings implements IDialogGlobalSettings {\n\n  public static register(container: IContainer) {\n    Registration.singleton(IDialogGlobalSettings, this).register(container);\n  }\n\n  public lock: boolean = true;\n  public startingZIndex = 1000;\n  public rejectOnCancel = false;\n}\n\nconst baseWrapperCss = 'position:absolute;width:100%;height:100%;top:0;left:0;';\n\nexport class DefaultDialogDomRenderer implements IDialogDomRenderer {\n\n  /** @internal */\n  protected static inject = [IPlatform];\n\n  public constructor(private readonly p: IPlatform) {}\n\n  public static register(container: IContainer) {\n    Registration.singleton(IDialogDomRenderer, this).register(container);\n  }\n\n  private readonly wrapperCss: string = `${baseWrapperCss} display:flex;`;\n  private readonly overlayCss: string = baseWrapperCss;\n  private readonly hostCss: string = 'position:relative;margin:auto;';\n\n  public render(dialogHost: HTMLElement): IDialogDom {\n    const doc = this.p.document;\n    const h = (name: string, css: string) => {\n      const el = doc.createElement(name);\n      el.style.cssText = css;\n      return el;\n    };\n    const wrapper = dialogHost.appendChild(h('au-dialog-container', this.wrapperCss));\n    const overlay = wrapper.appendChild(h('au-dialog-overlay', this.overlayCss));\n    const host = wrapper.appendChild(h('div', this.hostCss));\n    return new DefaultDialogDom(wrapper, overlay, host);\n  }\n}\n\nexport class DefaultDialogDom implements IDialogDom {\n  public constructor(\n    public readonly wrapper: HTMLElement,\n    public readonly overlay: HTMLElement,\n    public readonly contentHost: HTMLElement,\n  ) {\n  }\n\n  public dispose(): void {\n    this.wrapper.remove();\n  }\n}\n","import { IContainer, IRegistry, noop, Registration } from '@aurelia/kernel';\n\nimport { IDialogGlobalSettings } from './dialog-interfaces.js';\nimport { DefaultDialogGlobalSettings, DefaultDialogDomRenderer } from './dialog-default-impl.js';\nimport { AppTask } from '../../app-task.js';\nimport { DialogService } from './dialog-service.js';\n\nexport type DialogConfigurationProvider = (settings: IDialogGlobalSettings) => void | Promise<unknown>;\n\nexport interface DialogConfiguration extends IRegistry {\n  settingsProvider: DialogConfigurationProvider;\n  register(container: IContainer): IContainer;\n  customize(cb: DialogConfigurationProvider, registrations?: IRegistry[]): DialogConfiguration;\n}\n\nfunction createDialogConfiguration(settingsProvider: DialogConfigurationProvider, registrations: IRegistry[]): DialogConfiguration {\n  return {\n    settingsProvider: settingsProvider,\n    register: (ctn: IContainer) => ctn.register(\n      ...registrations,\n      AppTask.beforeCreate(() => settingsProvider(ctn.get(IDialogGlobalSettings)) as void)\n    ),\n    customize(cb: DialogConfigurationProvider, regs?: IRegistry[]) {\n      return createDialogConfiguration(cb, regs ?? registrations);\n    },\n  };\n}\n\n/**\n * A noop configuration for Dialog, should be used as:\n```ts\nDialogConfiguration.customize(settings => {\n  // adjust default value of the settings\n}, [all_implementations_here])\n```\n */\nexport const DialogConfiguration = createDialogConfiguration(() => {\n  if (__DEV__)\n    throw new Error('Invalid dialog configuration. ' +\n      'Specify the implementations for ' +\n      '<IDialogService>, <IDialogGlobalSettings> and <IDialogDomRenderer>, ' +\n      'or use the DialogDefaultConfiguration export.'\n    );\n  else\n    throw new Error('AUR0904');\n}, [class NoopDialogGlobalSettings {\n  public static register(container: IContainer): void {\n    container.register(Registration.singleton(IDialogGlobalSettings, this));\n  }\n}]);\n\nexport const DialogDefaultConfiguration = createDialogConfiguration(noop, [\n  DialogService,\n  DefaultDialogGlobalSettings,\n  DefaultDialogDomRenderer,\n]);\n","import { Constructable, DI, IContainer, IIndexable, InstanceProvider } from '@aurelia/kernel';\nimport { LifecycleFlags } from '@aurelia/runtime';\n\nimport { INode, setRef } from '../dom.js';\nimport { IPlatform } from '../platform.js';\nimport { CustomElement, CustomElementDefinition, PartialCustomElementDefinition } from '../resources/custom-element.js';\nimport { Controller, ICustomElementController } from '../templating/controller.js';\nimport { IRendering } from '../templating/rendering.js';\n\nexport const IWcElementRegistry = DI.createInterface<IAuElementRegistry>(x => x.singleton(WcCustomElementRegistry));\nexport interface IAuElementRegistry {\n  /**\n   * Define a web-component custom element for a set of given parameters\n   *\n   * @param name - the name to register with the underlying CustomElementRegistry\n   * @param def - the definition of the view model of the underlying web-components custom element.\n   *\n   * This can be either a plain class, or an object with definition specification like in a normal Aurelia customElement view model configuration\n   * @param options - The web-component definition options in the call customElements.define(..., xxx)\n   *\n   * This is to define extend built-in element etc...\n   *\n   * @returns the web-component custom element class. This can be used in application to further enhance/spy on its instances\n   */\n  define(name: string, def: Constructable, options?: ElementDefinitionOptions): Constructable<HTMLElement>;\n  define(name: string, def: Omit<PartialCustomElementDefinition, 'name'>, options?: ElementDefinitionOptions): Constructable<HTMLElement>;\n}\n\nexport type WebComponentViewModelClass = Constructable\n  | {\n    bindables?: PartialCustomElementDefinition['bindables'];\n    watches?: PartialCustomElementDefinition['watches'];\n    template?: PartialCustomElementDefinition['template'];\n    shadowOptions?: PartialCustomElementDefinition['shadowOptions'];\n  };\n\n/**\n * A default implementation of `IAuElementRegistry` interface.\n */\nexport class WcCustomElementRegistry implements IAuElementRegistry {\n  /** @internal */\n  protected static inject = [IContainer, IPlatform, IRendering];\n\n  /** @internal */\n  private readonly ctn: IContainer;\n  /** @internal */\n  private readonly p: IPlatform;\n  /** @internal */\n  private readonly r: IRendering;\n\n  public constructor(ctn: IContainer, p: IPlatform, r: IRendering) {\n    this.ctn = ctn;\n    this.p = p;\n    this.r = r;\n  }\n\n  public define(name: string, def: Constructable | Omit<PartialCustomElementDefinition, 'name'>, options?: ElementDefinitionOptions): Constructable<HTMLElement> {\n    if (!name.includes('-')) {\n      throw new Error('Invalid web-components custom element name. It must include a \"-\"');\n    }\n    let elDef: CustomElementDefinition;\n    if (def == null) {\n      throw new Error('Invalid custom element definition');\n    }\n    switch (typeof def) {\n      case 'function':\n        elDef = CustomElement.isType(def)\n          ? CustomElement.getDefinition(def)\n          : CustomElementDefinition.create(CustomElement.generateName(), def);\n        break;\n      default:\n        elDef = CustomElementDefinition.getOrCreate(def as PartialCustomElementDefinition);\n        break;\n    }\n    if (elDef.containerless) {\n      throw new Error('Containerless custom element is not supported. Consider using buitl-in extends instead');\n    }\n    const BaseClass = !options?.extends ? HTMLElement : this.p.document.createElement(options.extends).constructor as unknown as Constructable<HTMLElement>;\n    const container = this.ctn;\n    const rendering = this.r;\n    const bindables = elDef.bindables;\n    const p = this.p;\n    class CustomElementClass extends BaseClass {\n      public static readonly observedAttributes = Object.keys(bindables);\n\n      private auCtrl!: ICustomElementController;\n      private auInited: boolean | undefined;\n\n      private auInit() {\n        if (this.auInited) {\n          return;\n        }\n        this.auInited = true;\n        const childCtn = container.createChild();\n        childCtn.registerResolver(\n          p.HTMLElement,\n          childCtn.registerResolver(\n            p.Element,\n            childCtn.registerResolver(INode, new InstanceProvider<INode>('ElementProvider', this))\n          )\n        );\n        const compiledDef = rendering.compile(\n          elDef,\n          childCtn,\n          // todo: compile existing child element with [au-slot] into here\n          //       complication: what are the scope for the [au-slot] view?\n          { projections: null }\n        );\n        const viewModel = childCtn.invoke(compiledDef.Type);\n        const controller = this.auCtrl = Controller.$el(childCtn, viewModel, this, null, compiledDef);\n        setRef(this, compiledDef.key, controller);\n      }\n\n      public connectedCallback() {\n        this.auInit();\n        // eslint-disable-next-line\n        this.auCtrl.activate(this.auCtrl, null, LifecycleFlags.none);\n      }\n\n      public disconnectedCallback() {\n        // eslint-disable-next-line\n        this.auCtrl.deactivate(this.auCtrl, null, LifecycleFlags.none);\n      }\n\n      public adoptedCallback() {\n        this.auInit();\n      }\n\n      public attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n        this.auInit();\n        (this.auCtrl.viewModel as IIndexable)[name] = newValue;\n      }\n    }\n\n    for (const bindableProp in bindables) {\n      Object.defineProperty(CustomElementClass.prototype, bindableProp, {\n        configurable: true,\n        enumerable: false,\n        get(this: CustomElementClass) {\n          return (this['auCtrl'].viewModel as IIndexable)[bindableProp];\n        },\n        set(this: CustomElementClass, v: unknown) {\n          if (!this['auInited']) {\n            this['auInit']();\n          }\n          (this['auCtrl'].viewModel as IIndexable)[bindableProp] = v;\n        }\n      });\n    }\n\n    this.p.customElements.define(name, CustomElementClass, options);\n\n    return CustomElementClass;\n  }\n}\n","import { Metadata, Protocol } from '@aurelia/kernel';\n\n/**\n * A shortcut to Object.prototype.hasOwnProperty\n * Needs to do explicit .call\n *\n * @internal\n */\nexport const hasOwnProp = Object.prototype.hasOwnProperty;\n\n/** @internal */ export const def = Reflect.defineProperty;\n\n// eslint-disable-next-line @typescript-eslint/ban-types\n/** @internal */ export const isFunction = <K extends Function>(v: unknown): v is K => typeof v === 'function';\n\n/** @internal */ export const isString = (v: unknown): v is string => typeof v === 'string';\n\n/** @internal */ export function defineHiddenProp<T>(obj: object, key: PropertyKey, value: T): T {\n  def(obj, key, {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value\n  });\n  return value;\n}\n\n/** @internal */ export function ensureProto<T extends object, K extends keyof T>(\n  proto: T,\n  key: K,\n  defaultValue: unknown,\n  force: boolean = false\n): void {\n  if (force || !hasOwnProp.call(proto, key)) {\n    defineHiddenProp(proto, key, defaultValue);\n  }\n}\n\n/** @internal */ export const createLookup = <T>(): Record<string, T> => Object.create(null) as Record<string, T>;\n\n/** @internal */ export const getOwnMetadata = Metadata.getOwn;\n/** @internal */ export const hasOwnMetadata = Metadata.hasOwn;\n/** @internal */ export const defineMetadata = Metadata.define;\n/** @internal */ export const getAnnotationKeyFor = Protocol.annotation.keyFor;\n/** @internal */ export const getResourceKeyFor = Protocol.resource.keyFor;\n/** @internal */ export const appendResourceKey = Protocol.resource.appendTo;\n","import { Registration } from '@aurelia/kernel';\nimport { defineMetadata, getAnnotationKeyFor, getOwnMetadata } from './utilities-objects.js';\nimport type { Constructable, IResourceKind, ResourceDefinition, IContainer } from '@aurelia/kernel';\n\nexport function alias(...aliases: readonly string[]) {\n  return function (target: Constructable) {\n    const key = getAnnotationKeyFor('aliases');\n    const existing = getOwnMetadata(key, target) as string[] | undefined;\n    if (existing === void 0) {\n      defineMetadata(key, aliases, target);\n    } else {\n      existing.push(...aliases);\n    }\n  };\n}\n\nexport function registerAliases(aliases: readonly string[], resource: IResourceKind<Constructable, ResourceDefinition>, key: string, container: IContainer) {\n  for (let i = 0, ii = aliases.length; i < ii; ++i) {\n    Registration.aliasTo(key, resource.keyFrom(aliases[i])).register(container);\n  }\n}\n","import { LifecycleFlags } from '../observation.js';\n\nimport type { IIndexable } from '@aurelia/kernel';\nimport type { IBinding, IBindingContext, IOverrideContext } from '../observation.js';\nimport { hasOwnProp } from '../utilities-objects.js';\n\nconst marker = Object.freeze({});\n\nexport class BindingContext implements IBindingContext {\n  [key: string]: unknown;\n\n  private constructor(keyOrObj?: string | IIndexable, value?: unknown) {\n    if (keyOrObj !== void 0) {\n      if (value !== void 0) {\n        // if value is defined then it's just a property and a value to initialize with\n        this[keyOrObj as string] = value;\n      } else {\n        // can either be some random object or another bindingContext to clone from\n        for (const prop in keyOrObj as IIndexable) {\n          if (hasOwnProp.call(keyOrObj, prop)) {\n            this[prop] = (keyOrObj as IIndexable)[prop];\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Create a new synthetic `BindingContext` for use in a `Scope`.\n   *\n   * @param obj - Optional. An existing object or `BindingContext` to (shallow) clone (own) properties from.\n   */\n  public static create(obj?: IIndexable): BindingContext;\n  /**\n   * Create a new synthetic `BindingContext` for use in a `Scope`.\n   *\n   * @param key - The name of the only property to initialize this `BindingContext` with.\n   * @param value - The value of the only property to initialize this `BindingContext` with.\n   */\n  public static create(key: string, value: unknown): BindingContext;\n  /**\n   * Create a new synthetic `BindingContext` for use in a `Scope`.\n   *\n   * This overload signature is simply the combined signatures of the other two, and can be used\n   * to keep strong typing in situations where the arguments are dynamic.\n   */\n  public static create(keyOrObj?: string | IIndexable, value?: unknown): BindingContext;\n  public static create(keyOrObj?: string | IIndexable, value?: unknown): BindingContext {\n    return new BindingContext(keyOrObj, value);\n  }\n\n  public static get(scope: Scope, name: string, ancestor: number, flags: LifecycleFlags): IBindingContext | IOverrideContext | IBinding | undefined | null {\n    if (scope == null) {\n      if (__DEV__)\n        throw new Error(`Scope is ${scope}.`);\n      else\n        throw new Error(`AUR0203:${scope}`);\n    }\n    let overrideContext: IOverrideContext | null = scope.overrideContext;\n    let currentScope: Scope | null = scope;\n    // let bc: IBindingContext | null;\n\n    if (ancestor > 0) {\n      // jump up the required number of ancestor contexts (eg $parent.$parent requires two jumps)\n      while (ancestor > 0) {\n        ancestor--;\n        currentScope = currentScope.parentScope;\n        if (currentScope?.overrideContext == null) {\n          return void 0;\n        }\n      }\n\n      overrideContext = currentScope.overrideContext;\n      // Here we are giving benefit of doubt considering the dev has used one or more `$parent` token, and thus should know what s/he is targeting.\n      return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n    }\n\n    // walk the scope hierarchy until\n    // the first scope that has the property in its contexts\n    // or\n    // the closet boundary scope\n    // -------------------------\n    // this behavior is different with v1\n    // where it would fallback to the immediate scope instead of the root one\n    // TODO: maybe avoid immediate loop and return earlier\n    // -------------------------\n    while (\n      !currentScope?.isBoundary\n      && overrideContext != null\n      && !(name in overrideContext)\n      && !(\n        overrideContext.bindingContext\n        && name in overrideContext.bindingContext\n      )\n    ) {\n      currentScope = currentScope!.parentScope ?? null;\n      overrideContext = currentScope?.overrideContext ?? null;\n    }\n\n    if (overrideContext) {\n      return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n    }\n\n    // This following code block is the v1 behavior of scope selection\n    // where it would walk the scope hierarchy and stop at the first scope\n    // that has matching property.\n    // if no scope in the hierarchy, until the closest boundary scope has the property\n    // then pick the scope it started with\n    // ------------------\n    // if (currentScope.isBoundary) {\n    //   if (overrideContext != null) {\n    //     if (name in overrideContext) {\n    //       return overrideContext;\n    //     }\n    //     bc = overrideContext.bindingContext;\n    //     if (bc != null && name in bc) {\n    //       return bc;\n    //     }\n    //   }\n    // } else {\n    //   // traverse the context and it's ancestors, searching for a context that has the name.\n    //   do {\n    //     if (overrideContext != null) {\n    //       if (name in overrideContext) {\n    //         return overrideContext;\n    //       }\n    //       bc = overrideContext.bindingContext;\n    //       if (bc != null && name in bc) {\n    //         return bc;\n    //       }\n    //     }\n    //     if (currentScope.isBoundary) {\n    //       break;\n    //     }\n    //     currentScope = currentScope.parentScope;\n    //     overrideContext = currentScope == null ? null : currentScope.overrideContext;\n    //   } while (currentScope != null);\n    // }\n\n    // still nothing found. return the root binding context (or null\n    // if this is a parent scope traversal, to ensure we fall back to the\n    // correct level)\n    if (flags & LifecycleFlags.isTraversingParentScope) {\n      return marker;\n    }\n    return scope.bindingContext || scope.overrideContext;\n  }\n}\n\nexport class Scope {\n  private constructor(\n    public parentScope: Scope | null,\n    public bindingContext: IBindingContext,\n    public overrideContext: IOverrideContext,\n    public readonly isBoundary: boolean,\n  ) { }\n\n  /**\n   * Create a new `Scope` backed by the provided `BindingContext` and a new standalone `OverrideContext`.\n   *\n   * Use this overload when the scope is for the root component, in a unit test,\n   * or when you simply want to prevent binding expressions from traversing up the scope.\n   *\n   * @param bc - The `BindingContext` to back the `Scope` with.\n   */\n  public static create(bc: object): Scope;\n  /**\n   * Create a new `Scope` backed by the provided `BindingContext` and `OverrideContext`.\n   *\n   * @param bc - The `BindingContext` to back the `Scope` with.\n   * @param oc - The `OverrideContext` to back the `Scope` with.\n   * If a binding expression attempts to access a property that does not exist on the `BindingContext`\n   * during binding, it will traverse up via the `parentScope` of the scope until\n   * it finds the property.\n   */\n  public static create(bc: object, oc: IOverrideContext, isBoundary?: boolean): Scope;\n  /**\n   * Create a new `Scope` backed by the provided `BindingContext` and `OverrideContext`.\n   *\n   * Use this overload when the scope is for the root component, in a unit test,\n   * or when you simply want to prevent binding expressions from traversing up the scope.\n   *\n   * @param bc - The `BindingContext` to back the `Scope` with.\n   * @param oc - null. This overload is functionally equivalent to not passing this argument at all.\n   */\n  public static create(bc: object, oc: null, isBoundary?: boolean): Scope;\n  public static create(bc: object, oc?: IOverrideContext | null, isBoundary?: boolean): Scope {\n    return new Scope(null, bc as IBindingContext, oc == null ? OverrideContext.create(bc) : oc, isBoundary ?? false);\n  }\n\n  public static fromOverride(oc: IOverrideContext): Scope {\n    if (oc == null) {\n      if (__DEV__)\n        throw new Error(`OverrideContext is ${oc}`);\n      else\n        throw new Error(`AUR0204:${oc}`);\n    }\n    return new Scope(null, oc.bindingContext, oc, false);\n  }\n\n  public static fromParent(ps: Scope | null, bc: object): Scope {\n    if (ps == null) {\n      if (__DEV__)\n        throw new Error(`ParentScope is ${ps}`);\n      else\n        throw new Error(`AUR0205:${ps}`);\n    }\n    return new Scope(ps, bc as IBindingContext, OverrideContext.create(bc), false);\n  }\n}\n\nexport class OverrideContext implements IOverrideContext {\n  [key: string]: unknown;\n\n  public bindingContext: IBindingContext;\n\n  private constructor(bindingContext: IBindingContext) {\n    this.bindingContext = bindingContext;\n  }\n\n  public static create(bc: object): OverrideContext {\n    return new OverrideContext(bc as IBindingContext);\n  }\n}\n","import { DI } from '@aurelia/kernel';\nimport { createLookup } from '../utilities-objects.js';\nimport type { ISubscriber, LifecycleFlags } from '../observation.js';\n\ntype Signal = string;\n\nexport interface ISignaler extends Signaler {}\nexport const ISignaler = DI.createInterface<ISignaler>('ISignaler', x => x.singleton(Signaler));\n\nexport class Signaler {\n  public signals: Record<string, Set<ISubscriber> | undefined> = createLookup();\n\n  public dispatchSignal(name: Signal, flags?: LifecycleFlags): void {\n    const listeners = this.signals[name];\n    if (listeners === undefined) {\n      return;\n    }\n    let listener: ISubscriber;\n    for (listener of listeners.keys()) {\n      listener.handleChange(undefined, undefined, flags!);\n    }\n  }\n\n  public addSignalListener(name: Signal, listener: ISubscriber): void {\n    const signals = this.signals;\n    const listeners = signals[name];\n    if (listeners === undefined) {\n      signals[name] = new Set([listener]);\n    } else {\n      listeners.add(listener);\n    }\n  }\n\n  public removeSignalListener(name: Signal, listener: ISubscriber): void {\n    const listeners = this.signals[name];\n    if (listeners) {\n      listeners.delete(listener);\n    }\n  }\n}\n","import {\n  ResourceType,\n  Registration,\n  mergeArrays,\n  firstDefined,\n  DI,\n  fromAnnotationOrDefinitionOrTypeOrDefault,\n} from '@aurelia/kernel';\nimport { Collection, IndexMap, LifecycleFlags } from './observation.js';\nimport { registerAliases } from './alias.js';\nimport { appendResourceKey, defineMetadata, getAnnotationKeyFor, getOwnMetadata, getResourceKeyFor, hasOwnMetadata, isFunction, isString } from './utilities-objects.js';\n\nimport type {\n  Constructable,\n  IContainer,\n  ResourceDefinition,\n  IResourceKind,\n  PartialResourceDefinition,\n  IServiceLocator,\n  Key,\n} from '@aurelia/kernel';\nimport type { BindingObserverRecord, IConnectableBinding } from './binding/connectable.js';\nimport type { BindingBehaviorExpression, ForOfStatement, IsBindingBehavior } from './binding/ast.js';\nimport type { IObserverLocator } from './observation/observer-locator.js';\nimport type { IBinding } from './observation.js';\nimport type { Scope } from './observation/binding-context.js';\n\nexport type PartialBindingBehaviorDefinition = PartialResourceDefinition<{\n  strategy?: BindingBehaviorStrategy;\n}>;\n\nexport type BindingBehaviorInstance<T extends {} = {}> = {\n  bind(flags: LifecycleFlags, scope: Scope, binding: IBinding, ...args: T[]): void;\n  unbind(flags: LifecycleFlags, scope: Scope, binding: IBinding, ...args: T[]): void;\n} & T;\n\nexport const enum BindingBehaviorStrategy {\n  singleton = 1,\n  interceptor = 2,\n}\n\nexport type BindingBehaviorType<T extends Constructable = Constructable> = ResourceType<T, BindingBehaviorInstance>;\nexport type BindingBehaviorKind = IResourceKind<BindingBehaviorType, BindingBehaviorDefinition> & {\n  isType<T>(value: T): value is (T extends Constructable ? BindingBehaviorType<T> : never);\n  define<T extends Constructable>(name: string, Type: T): BindingBehaviorType<T>;\n  define<T extends Constructable>(def: PartialBindingBehaviorDefinition, Type: T): BindingBehaviorType<T>;\n  define<T extends Constructable>(nameOrDef: string | PartialBindingBehaviorDefinition, Type: T): BindingBehaviorType<T>;\n  getDefinition<T extends Constructable>(Type: T): BindingBehaviorDefinition<T>;\n  annotate<K extends keyof PartialBindingBehaviorDefinition>(Type: Constructable, prop: K, value: PartialBindingBehaviorDefinition[K]): void;\n  getAnnotation<K extends keyof PartialBindingBehaviorDefinition>(Type: Constructable, prop: K): PartialBindingBehaviorDefinition[K];\n};\n\nexport type BindingBehaviorDecorator = <T extends Constructable>(Type: T) => BindingBehaviorType<T>;\n\nexport function bindingBehavior(definition: PartialBindingBehaviorDefinition): BindingBehaviorDecorator;\nexport function bindingBehavior(name: string): BindingBehaviorDecorator;\nexport function bindingBehavior(nameOrDef: string | PartialBindingBehaviorDefinition): BindingBehaviorDecorator;\nexport function bindingBehavior(nameOrDef: string | PartialBindingBehaviorDefinition): BindingBehaviorDecorator {\n  return function (target) {\n    return BindingBehavior.define(nameOrDef, target);\n  };\n}\n\nexport class BindingBehaviorDefinition<T extends Constructable = Constructable> implements ResourceDefinition<T, BindingBehaviorInstance> {\n  private constructor(\n    public readonly Type: BindingBehaviorType<T>,\n    public readonly name: string,\n    public readonly aliases: readonly string[],\n    public readonly key: string,\n    public readonly strategy: BindingBehaviorStrategy,\n  ) {}\n\n  public static create<T extends Constructable = Constructable>(\n    nameOrDef: string | PartialBindingBehaviorDefinition,\n    Type: BindingBehaviorType<T>,\n  ): BindingBehaviorDefinition<T> {\n\n    let name: string;\n    let def: PartialBindingBehaviorDefinition;\n    if (isString(nameOrDef)) {\n      name = nameOrDef;\n      def = { name };\n    } else {\n      name = nameOrDef.name;\n      def = nameOrDef;\n    }\n\n    const inheritsFromInterceptor = Object.getPrototypeOf(Type) === BindingInterceptor;\n\n    return new BindingBehaviorDefinition(\n      Type,\n      firstDefined(getBehaviorAnnotation(Type, 'name'), name),\n      mergeArrays(getBehaviorAnnotation(Type, 'aliases'), def.aliases, Type.aliases),\n      BindingBehavior.keyFrom(name),\n      fromAnnotationOrDefinitionOrTypeOrDefault('strategy', def, Type, () => inheritsFromInterceptor ? BindingBehaviorStrategy.interceptor : BindingBehaviorStrategy.singleton),\n    );\n  }\n\n  public register(container: IContainer): void {\n    const { Type, key, aliases, strategy } = this;\n    switch (strategy) {\n      case BindingBehaviorStrategy.singleton:\n        Registration.singleton(key, Type).register(container);\n        break;\n      case BindingBehaviorStrategy.interceptor:\n        Registration.instance(key, new BindingBehaviorFactory(container, Type)).register(container);\n        break;\n    }\n    Registration.aliasTo(key, Type).register(container);\n    registerAliases(aliases, BindingBehavior, key, container);\n  }\n}\n\nexport class BindingBehaviorFactory<T extends Constructable = Constructable> {\n  private readonly deps: readonly Key[];\n\n  public constructor(\n    private readonly ctn: IContainer,\n    private readonly Type: BindingBehaviorType<T>,\n  ) {\n    this.deps = DI.getDependencies(Type);\n  }\n\n  public construct(\n    binding: IInterceptableBinding,\n    expr: BindingBehaviorExpression,\n  ): IInterceptableBinding {\n    const container = this.ctn;\n    const deps = this.deps;\n    switch (deps.length) {\n      case 0:\n        // TODO(fkleuver): fix this cast\n        return new this.Type(binding, expr) as unknown as IInterceptableBinding;\n      case 1:\n        return new this.Type(container.get(deps[0]), binding, expr) as unknown as IInterceptableBinding;\n      case 2:\n        return new this.Type(container.get(deps[0]), container.get(deps[1]), binding, expr) as unknown as IInterceptableBinding;\n      default:\n        return new this.Type(...deps.map(d => container.get(d) as unknown), binding, expr) as unknown as IInterceptableBinding;\n    }\n  }\n}\n\nexport type IInterceptableBinding = Exclude<IConnectableBinding, 'updateTarget' | 'updateSource' | 'callSource' | 'handleChange'> & {\n  updateTarget?(value: unknown, flags: LifecycleFlags): void;\n  updateSource?(value: unknown, flags: LifecycleFlags): void;\n\n  callSource?(args: object): unknown;\n  handleChange?(newValue: unknown, previousValue: unknown, flags: LifecycleFlags): void;\n};\n\nexport interface BindingInterceptor extends IConnectableBinding {}\n\nexport class BindingInterceptor implements IInterceptableBinding {\n  public interceptor: this = this;\n  public get oL(): IObserverLocator {\n    return this.binding.oL;\n  }\n  public get locator(): IServiceLocator {\n    return this.binding.locator;\n  }\n  public get $scope(): Scope | undefined {\n    return this.binding.$scope;\n  }\n  public get isBound(): boolean {\n    return this.binding.isBound;\n  }\n  public get obs(): BindingObserverRecord {\n    return this.binding.obs;\n  }\n  public get sourceExpression(): IsBindingBehavior | ForOfStatement {\n    return (this.binding as unknown as { sourceExpression: IsBindingBehavior | ForOfStatement }).sourceExpression;\n  }\n\n  public constructor(\n    public readonly binding: IInterceptableBinding,\n    public readonly expr: BindingBehaviorExpression,\n  ) {\n    let interceptor: IBinding;\n    while (binding.interceptor !== this) {\n      interceptor = binding.interceptor;\n      binding.interceptor = this;\n      binding = interceptor as IInterceptableBinding;\n    }\n  }\n\n  public updateTarget(value: unknown, flags: LifecycleFlags): void {\n    this.binding.updateTarget!(value, flags);\n  }\n  public updateSource(value: unknown, flags: LifecycleFlags): void {\n    this.binding.updateSource!(value, flags);\n  }\n  public callSource(args: object): unknown {\n    return this.binding.callSource!(args);\n  }\n  public handleChange(newValue: unknown, previousValue: unknown, flags: LifecycleFlags): void {\n    this.binding.handleChange(newValue, previousValue, flags);\n  }\n  public handleCollectionChange(indexMap: IndexMap, flags: LifecycleFlags): void {\n    this.binding.handleCollectionChange(indexMap, flags);\n  }\n  public observe(obj: object, key: string): void {\n    this.binding.observe(obj, key);\n  }\n  public observeCollection(observer: Collection): void {\n    this.binding.observeCollection(observer);\n  }\n\n  public $bind(flags: LifecycleFlags, scope: Scope): void {\n    this.binding.$bind(flags, scope);\n  }\n  public $unbind(flags: LifecycleFlags): void {\n    this.binding.$unbind(flags);\n  }\n}\n\nconst bbBaseName = getResourceKeyFor('binding-behavior');\nconst getBehaviorAnnotation = <K extends keyof PartialBindingBehaviorDefinition>(\n  Type: Constructable,\n  prop: K,\n): PartialBindingBehaviorDefinition[K] => getOwnMetadata(getAnnotationKeyFor(prop), Type) as PartialBindingBehaviorDefinition[K];\n\nexport const BindingBehavior = Object.freeze<BindingBehaviorKind>({\n  name: bbBaseName,\n  keyFrom(name: string): string {\n    return `${bbBaseName}:${name}`;\n  },\n  isType<T>(value: T): value is (T extends Constructable ? BindingBehaviorType<T> : never) {\n    return isFunction(value) && hasOwnMetadata(bbBaseName, value);\n  },\n  define<T extends Constructable<BindingBehaviorInstance>>(nameOrDef: string | PartialBindingBehaviorDefinition, Type: T): BindingBehaviorType<T> {\n    const definition = BindingBehaviorDefinition.create(nameOrDef, Type as Constructable<BindingBehaviorInstance>);\n    defineMetadata(bbBaseName, definition, definition.Type);\n    defineMetadata(bbBaseName, definition, definition);\n    appendResourceKey(Type, bbBaseName);\n\n    return definition.Type as BindingBehaviorType<T>;\n  },\n  getDefinition<T extends Constructable>(Type: T): BindingBehaviorDefinition<T> {\n    const def = getOwnMetadata(bbBaseName, Type) as BindingBehaviorDefinition<T>;\n    if (def === void 0) {\n      if (__DEV__)\n        throw new Error(`No definition found for type ${Type.name}`);\n      else\n        throw new Error(`AUR0151:${Type.name}`);\n    }\n\n    return def;\n  },\n  annotate<K extends keyof PartialBindingBehaviorDefinition>(Type: Constructable, prop: K, value: PartialBindingBehaviorDefinition[K]): void {\n    defineMetadata(getAnnotationKeyFor(prop), value, Type);\n  },\n  getAnnotation: getBehaviorAnnotation,\n});\n","import {\n  Registration,\n  mergeArrays,\n  firstDefined,\n} from '@aurelia/kernel';\nimport { registerAliases } from './alias.js';\nimport { appendResourceKey, defineMetadata, getAnnotationKeyFor, getOwnMetadata, getResourceKeyFor, hasOwnMetadata, isFunction, isString } from './utilities-objects.js';\n\nimport type {\n  Constructable,\n  IContainer,\n  ResourceDefinition,\n  IResourceKind,\n  ResourceType,\n  PartialResourceDefinition,\n} from '@aurelia/kernel';\n\nexport type PartialValueConverterDefinition = PartialResourceDefinition;\n\nexport type ValueConverterInstance<T extends {} = {}> = {\n  toView(input: unknown, ...args: unknown[]): unknown;\n  fromView?(input: unknown, ...args: unknown[]): unknown;\n} & T;\n\nexport type ValueConverterType<T extends Constructable = Constructable> = ResourceType<T, ValueConverterInstance>;\nexport type ValueConverterKind = IResourceKind<ValueConverterType, ValueConverterDefinition> & {\n  isType<T>(value: T): value is (T extends Constructable ? ValueConverterType<T> : never);\n  define<T extends Constructable>(name: string, Type: T): ValueConverterType<T>;\n  define<T extends Constructable>(def: PartialValueConverterDefinition, Type: T): ValueConverterType<T>;\n  define<T extends Constructable>(nameOrDef: string | PartialValueConverterDefinition, Type: T): ValueConverterType<T>;\n  getDefinition<T extends Constructable>(Type: T): ValueConverterDefinition<T>;\n  annotate<K extends keyof PartialValueConverterDefinition>(Type: Constructable, prop: K, value: PartialValueConverterDefinition[K]): void;\n  getAnnotation<K extends keyof PartialValueConverterDefinition>(Type: Constructable, prop: K): PartialValueConverterDefinition[K];\n};\n\nexport type ValueConverterDecorator = <T extends Constructable>(Type: T) => ValueConverterType<T>;\n\nexport function valueConverter(definition: PartialValueConverterDefinition): ValueConverterDecorator;\nexport function valueConverter(name: string): ValueConverterDecorator;\nexport function valueConverter(nameOrDef: string | PartialValueConverterDefinition): ValueConverterDecorator;\nexport function valueConverter(nameOrDef: string | PartialValueConverterDefinition): ValueConverterDecorator {\n  return function (target) {\n    return ValueConverter.define(nameOrDef, target);\n  };\n}\n\nexport class ValueConverterDefinition<T extends Constructable = Constructable> implements ResourceDefinition<T, ValueConverterInstance> {\n  private constructor(\n    public readonly Type: ValueConverterType<T>,\n    public readonly name: string,\n    public readonly aliases: readonly string[],\n    public readonly key: string,\n  ) {}\n\n  public static create<T extends Constructable = Constructable>(\n    nameOrDef: string | PartialValueConverterDefinition,\n    Type: ValueConverterType<T>,\n  ): ValueConverterDefinition<T> {\n\n    let name: string;\n    let def: PartialValueConverterDefinition;\n    if (isString(nameOrDef)) {\n      name = nameOrDef;\n      def = { name };\n    } else {\n      name = nameOrDef.name;\n      def = nameOrDef;\n    }\n\n    return new ValueConverterDefinition(\n      Type,\n      firstDefined(getConverterAnnotation(Type, 'name'), name),\n      mergeArrays(getConverterAnnotation(Type, 'aliases'), def.aliases, Type.aliases),\n      ValueConverter.keyFrom(name),\n    );\n  }\n\n  public register(container: IContainer): void {\n    const { Type, key, aliases } = this;\n    Registration.singleton(key, Type).register(container);\n    Registration.aliasTo(key, Type).register(container);\n    registerAliases(aliases, ValueConverter, key, container);\n  }\n}\n\nconst vcBaseName = getResourceKeyFor('value-converter');\nconst getConverterAnnotation = <K extends keyof PartialValueConverterDefinition>(\n  Type: Constructable,\n  prop: K,\n// eslint-disable-next-line @typescript-eslint/no-unsafe-return\n): PartialValueConverterDefinition[K] => getOwnMetadata(getAnnotationKeyFor(prop), Type);\n\nexport const ValueConverter = Object.freeze<ValueConverterKind>({\n  name: vcBaseName,\n  keyFrom: (name: string): string => `${vcBaseName}:${name}`,\n  isType<T>(value: T): value is (T extends Constructable ? ValueConverterType<T> : never) {\n    return isFunction(value) && hasOwnMetadata(vcBaseName, value);\n  },\n  define<T extends Constructable<ValueConverterInstance>>(nameOrDef: string | PartialValueConverterDefinition, Type: T): ValueConverterType<T> {\n    const definition = ValueConverterDefinition.create(nameOrDef, Type as Constructable<ValueConverterInstance>);\n    defineMetadata(vcBaseName, definition, definition.Type);\n    defineMetadata(vcBaseName, definition, definition);\n    appendResourceKey(Type, vcBaseName);\n\n    return definition.Type as ValueConverterType<T>;\n  },\n  getDefinition<T extends Constructable>(Type: T): ValueConverterDefinition<T> {\n    const def = getOwnMetadata(vcBaseName, Type);\n    if (def === void 0) {\n      if (__DEV__)\n        throw new Error(`No definition found for type ${Type.name}`);\n      else\n        throw new Error(`AUR0152:${Type.name}`);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return def;\n  },\n  annotate<K extends keyof PartialValueConverterDefinition>(Type: Constructable, prop: K, value: PartialValueConverterDefinition[K]): void {\n    defineMetadata(getAnnotationKeyFor(prop), value, Type);\n  },\n  getAnnotation: getConverterAnnotation,\n});\n","import { emptyArray, isArrayIndex, isNumberOrBigInt, isStringOrDate } from '@aurelia/kernel';\nimport { LifecycleFlags as LF } from '../observation.js';\nimport { BindingContext, Scope } from '../observation/binding-context.js';\nimport { ISignaler } from '../observation/signaler.js';\nimport { BindingBehavior, BindingBehaviorInstance, BindingBehaviorFactory } from '../binding-behavior.js';\nimport { ValueConverter, ValueConverterInstance } from '../value-converter.js';\nimport { IConnectableBinding } from './connectable.js';\nimport { isFunction, isString } from '../utilities-objects.js';\n\nimport type { IIndexable, IServiceLocator, ResourceDefinition } from '@aurelia/kernel';\nimport type {\n  Collection,\n  IBindingContext,\n  IObservable,\n  IOverrideContext,\n  IConnectable,\n  ISubscriber,\n} from '../observation.js';\n\nexport const enum ExpressionKind {\n  CallsFunction                 = 0b0000000000100_00000, // Calls a function (CallFunction, CallScope, CallMember, TaggedTemplate) -> needs a valid function object returning from its lefthandside's evaluate()\n  HasAncestor                   = 0b0000000001000_00000, // Has an \"ancestor\" property, meaning the expression could climb up the context (only AccessThis, AccessScope and CallScope)\n  IsPrimary                     = 0b0000000010000_00000, // Is a primary expression according to ES parsing rules\n  IsLeftHandSide                = 0b0000000100000_00000, // Is a left-hand side expression according to ES parsing rules, includes IsPrimary\n  HasBind                       = 0b0000001000000_00000, // Has a bind() method (currently only BindingBehavior)\n  HasUnbind                     = 0b0000010000000_00000, // Has an unbind() method (currentl only BindingBehavior and ValueConverter)\n  IsAssignable                  = 0b0000100000000_00000, // Is an assignable expression according to ES parsing rules (only AccessScope, AccessMember, AccessKeyed ans Assign)\n  IsLiteral                     = 0b0001000000000_00000, // Is literal expression (Primitive, Array, Object or Template)\n  IsResource                    = 0b0010000000000_00000, // Is an Aurelia resource (ValueConverter or BindingBehavior)\n  IsForDeclaration              = 0b0100000000000_00000, // Is a For declaration (for..of, for..in -> currently only ForOfStatement)\n  Type                          = 0b0000000000000_11111, // Type mask to uniquely identify each AST class (concrete types start below)\n  // ---------------------------------------------------------------------------------------------------------------------------\n  AccessThis                    = 0b0000000111000_00001, //               HasAncestor\n  AccessScope                   = 0b0000100111011_00010, // IsAssignable  HasAncestor\n  ArrayLiteral                  = 0b0001000110001_00011, //\n  ObjectLiteral                 = 0b0001000110001_00100, //\n  PrimitiveLiteral              = 0b0001000110000_00101, //\n  Template                      = 0b0001000110001_00110, //\n  Unary                         = 0b0000000000001_00111, //\n  CallScope                     = 0b0000000101101_01000, //               HasAncestor  CallsFunction\n  CallMember                    = 0b0000000100100_01001, //                            CallsFunction\n  CallFunction                  = 0b0000000100100_01010, //                            CallsFunction\n  AccessMember                  = 0b0000100100011_01011, // IsAssignable\n  AccessKeyed                   = 0b0000100100011_01100, // IsAssignable\n  TaggedTemplate                = 0b0000000100101_01101, //                            CallsFunction\n  Binary                        = 0b0000000000001_01110, //\n  Conditional                   = 0b0000000000001_11111, //\n  Assign                        = 0b0000100000000_10000, // IsAssignable\n  ValueConverter                = 0b0010010000001_10001, //\n  BindingBehavior               = 0b0010011000001_10010, //\n  HtmlLiteral                   = 0b0000000000001_10011, //\n  ArrayBindingPattern           = 0b0100000000000_10100, //\n  ObjectBindingPattern          = 0b0100000000000_10101, //\n  BindingIdentifier             = 0b0100000000000_10110, //\n  ForOfStatement                = 0b0000011000001_10111, //\n  Interpolation                 = 0b0000000000000_11000, //\n  ArrayDestructuring            = 0b0101100000000_11001, // IsAssignable\n  ObjectDestructuring           = 0b0110100000000_11001, // IsAssignable\n  DestructuringAssignmentLeaf   = 0b1000100000000_11001, // IsAssignable\n}\n\nexport type UnaryOperator = 'void' | 'typeof' | '!' | '-' | '+';\n\nexport type BinaryOperator = '&&' | '||' | '==' | '===' | '!=' | '!==' | 'instanceof' | 'in' | '+' | '-' | '*' | '/' | '%' | '<' | '>' | '<=' | '>=';\n\nexport type IsPrimary = AccessThisExpression | AccessScopeExpression | ArrayLiteralExpression | ObjectLiteralExpression | PrimitiveLiteralExpression | TemplateExpression;\nexport type IsLiteral = ArrayLiteralExpression | ObjectLiteralExpression | PrimitiveLiteralExpression | TemplateExpression;\nexport type IsLeftHandSide = IsPrimary | CallFunctionExpression | CallMemberExpression | CallScopeExpression | AccessMemberExpression | AccessKeyedExpression | TaggedTemplateExpression;\nexport type IsUnary = IsLeftHandSide | UnaryExpression;\nexport type IsBinary = IsUnary | BinaryExpression;\nexport type IsConditional = IsBinary | ConditionalExpression;\nexport type IsAssign = IsConditional | AssignExpression;\nexport type IsValueConverter = IsAssign | ValueConverterExpression;\nexport type IsBindingBehavior = IsValueConverter | BindingBehaviorExpression;\nexport type IsAssignable = AccessScopeExpression | AccessKeyedExpression | AccessMemberExpression | AssignExpression;\nexport type IsExpression = IsBindingBehavior | Interpolation;\nexport type BindingIdentifierOrPattern = BindingIdentifier | ArrayBindingPattern | ObjectBindingPattern;\nexport type IsExpressionOrStatement = IsExpression | ForOfStatement | BindingIdentifierOrPattern | HtmlLiteralExpression | DestructuringAssignmentExpression | DestructuringAssignmentSingleExpression | DestructuringAssignmentRestExpression;\nexport type AnyBindingExpression = Interpolation | ForOfStatement | IsBindingBehavior;\n\nexport interface IExpressionHydrator {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  hydrate(jsonExpr: any): any;\n}\n\nexport interface IVisitor<T = unknown> {\n  visitAccessKeyed(expr: AccessKeyedExpression): T;\n  visitAccessMember(expr: AccessMemberExpression): T;\n  visitAccessScope(expr: AccessScopeExpression): T;\n  visitAccessThis(expr: AccessThisExpression): T;\n  visitArrayBindingPattern(expr: ArrayBindingPattern): T;\n  visitArrayLiteral(expr: ArrayLiteralExpression): T;\n  visitAssign(expr: AssignExpression): T;\n  visitBinary(expr: BinaryExpression): T;\n  visitBindingBehavior(expr: BindingBehaviorExpression): T;\n  visitBindingIdentifier(expr: BindingIdentifier): T;\n  visitCallFunction(expr: CallFunctionExpression): T;\n  visitCallMember(expr: CallMemberExpression): T;\n  visitCallScope(expr: CallScopeExpression): T;\n  visitConditional(expr: ConditionalExpression): T;\n  visitForOfStatement(expr: ForOfStatement): T;\n  visitHtmlLiteral(expr: HtmlLiteralExpression): T;\n  visitInterpolation(expr: Interpolation): T;\n  visitObjectBindingPattern(expr: ObjectBindingPattern): T;\n  visitObjectLiteral(expr: ObjectLiteralExpression): T;\n  visitPrimitiveLiteral(expr: PrimitiveLiteralExpression): T;\n  visitTaggedTemplate(expr: TaggedTemplateExpression): T;\n  visitTemplate(expr: TemplateExpression): T;\n  visitUnary(expr: UnaryExpression): T;\n  visitValueConverter(expr: ValueConverterExpression): T;\n  visitDestructuringAssignmentExpression(expr: DestructuringAssignmentExpression): T;\n  visitDestructuringAssignmentSingleExpression(expr: DestructuringAssignmentSingleExpression): T;\n  visitDestructuringAssignmentRestExpression(expr: DestructuringAssignmentRestExpression): T;\n}\n\nexport class Unparser implements IVisitor<void> {\n  public text: string = '';\n\n  public static unparse(expr: IsExpressionOrStatement): string {\n    const visitor = new Unparser();\n    expr.accept(visitor);\n    return visitor.text;\n  }\n\n  public visitAccessMember(expr: AccessMemberExpression): void {\n    expr.object.accept(this);\n    this.text += `.${expr.name}`;\n  }\n\n  public visitAccessKeyed(expr: AccessKeyedExpression): void {\n    expr.object.accept(this);\n    this.text += '[';\n    expr.key.accept(this);\n    this.text += ']';\n  }\n\n  public visitAccessThis(expr: AccessThisExpression): void {\n    if (expr.ancestor === 0) {\n      this.text += '$this';\n      return;\n    }\n    this.text += '$parent';\n    let i = expr.ancestor - 1;\n    while (i--) {\n      this.text += '.$parent';\n    }\n  }\n\n  public visitAccessScope(expr: AccessScopeExpression): void {\n    let i = expr.ancestor;\n    while (i--) {\n      this.text += '$parent.';\n    }\n    this.text += expr.name;\n  }\n\n  public visitArrayLiteral(expr: ArrayLiteralExpression): void {\n    const elements = expr.elements;\n    this.text += '[';\n    for (let i = 0, length = elements.length; i < length; ++i) {\n      if (i !== 0) {\n        this.text += ',';\n      }\n      elements[i].accept(this);\n    }\n    this.text += ']';\n  }\n\n  public visitObjectLiteral(expr: ObjectLiteralExpression): void {\n    const keys = expr.keys;\n    const values = expr.values;\n    this.text += '{';\n    for (let i = 0, length = keys.length; i < length; ++i) {\n      if (i !== 0) {\n        this.text += ',';\n      }\n      this.text += `'${keys[i]}':`;\n      values[i].accept(this);\n    }\n    this.text += '}';\n  }\n\n  public visitPrimitiveLiteral(expr: PrimitiveLiteralExpression): void {\n    this.text += '(';\n    if (isString(expr.value)) {\n      const escaped = expr.value.replace(/'/g, '\\\\\\'');\n      this.text += `'${escaped}'`;\n    } else {\n      this.text += `${expr.value}`;\n    }\n    this.text += ')';\n  }\n\n  public visitCallFunction(expr: CallFunctionExpression): void {\n    this.text += '(';\n    expr.func.accept(this);\n    this.writeArgs(expr.args);\n    this.text += ')';\n  }\n\n  public visitCallMember(expr: CallMemberExpression): void {\n    this.text += '(';\n    expr.object.accept(this);\n    this.text += `.${expr.name}`;\n    this.writeArgs(expr.args);\n    this.text += ')';\n  }\n\n  public visitCallScope(expr: CallScopeExpression): void {\n    this.text += '(';\n    let i = expr.ancestor;\n    while (i--) {\n      this.text += '$parent.';\n    }\n    this.text += expr.name;\n    this.writeArgs(expr.args);\n    this.text += ')';\n  }\n\n  public visitTemplate(expr: TemplateExpression): void {\n    const { cooked, expressions } = expr;\n    const length = expressions.length;\n    this.text += '`';\n    this.text += cooked[0];\n    for (let i = 0; i < length; i++) {\n      expressions[i].accept(this);\n      this.text += cooked[i + 1];\n    }\n    this.text += '`';\n  }\n\n  public visitTaggedTemplate(expr: TaggedTemplateExpression): void {\n    const { cooked, expressions } = expr;\n    const length = expressions.length;\n    expr.func.accept(this);\n    this.text += '`';\n    this.text += cooked[0];\n    for (let i = 0; i < length; i++) {\n      expressions[i].accept(this);\n      this.text += cooked[i + 1];\n    }\n    this.text += '`';\n  }\n\n  public visitUnary(expr: UnaryExpression): void {\n    this.text += `(${expr.operation}`;\n    if (expr.operation.charCodeAt(0) >= /* a */97) {\n      this.text += ' ';\n    }\n    expr.expression.accept(this);\n    this.text += ')';\n  }\n\n  public visitBinary(expr: BinaryExpression): void {\n    this.text += '(';\n    expr.left.accept(this);\n    if (expr.operation.charCodeAt(0) === /* i */105) {\n      this.text += ` ${expr.operation} `;\n    } else {\n      this.text += expr.operation;\n    }\n    expr.right.accept(this);\n    this.text += ')';\n  }\n\n  public visitConditional(expr: ConditionalExpression): void {\n    this.text += '(';\n    expr.condition.accept(this);\n    this.text += '?';\n    expr.yes.accept(this);\n    this.text += ':';\n    expr.no.accept(this);\n    this.text += ')';\n  }\n\n  public visitAssign(expr: AssignExpression): void {\n    this.text += '(';\n    expr.target.accept(this);\n    this.text += '=';\n    expr.value.accept(this);\n    this.text += ')';\n  }\n\n  public visitValueConverter(expr: ValueConverterExpression): void {\n    const args = expr.args;\n    expr.expression.accept(this);\n    this.text += `|${expr.name}`;\n    for (let i = 0, length = args.length; i < length; ++i) {\n      this.text += ':';\n      args[i].accept(this);\n    }\n  }\n\n  public visitBindingBehavior(expr: BindingBehaviorExpression): void {\n    const args = expr.args;\n    expr.expression.accept(this);\n    this.text += `&${expr.name}`;\n    for (let i = 0, length = args.length; i < length; ++i) {\n      this.text += ':';\n      args[i].accept(this);\n    }\n  }\n\n  public visitArrayBindingPattern(expr: ArrayBindingPattern): void {\n    const elements = expr.elements;\n    this.text += '[';\n    for (let i = 0, length = elements.length; i < length; ++i) {\n      if (i !== 0) {\n        this.text += ',';\n      }\n      elements[i].accept(this);\n    }\n    this.text += ']';\n  }\n\n  public visitObjectBindingPattern(expr: ObjectBindingPattern): void {\n    const keys = expr.keys;\n    const values = expr.values;\n    this.text += '{';\n    for (let i = 0, length = keys.length; i < length; ++i) {\n      if (i !== 0) {\n        this.text += ',';\n      }\n      this.text += `'${keys[i]}':`;\n      values[i].accept(this);\n    }\n    this.text += '}';\n  }\n\n  public visitBindingIdentifier(expr: BindingIdentifier): void {\n    this.text += expr.name;\n  }\n\n  public visitHtmlLiteral(_expr: HtmlLiteralExpression): void { throw new Error('visitHtmlLiteral'); }\n\n  public visitForOfStatement(expr: ForOfStatement): void {\n    expr.declaration.accept(this);\n    this.text += ' of ';\n    expr.iterable.accept(this);\n  }\n\n  public visitInterpolation(expr: Interpolation): void {\n    const { parts, expressions } = expr;\n    const length = expressions.length;\n    this.text += '${';\n    this.text += parts[0];\n    for (let i = 0; i < length; i++) {\n      expressions[i].accept(this);\n      this.text += parts[i + 1];\n    }\n    this.text += '}';\n  }\n\n  public visitDestructuringAssignmentExpression(expr: DestructuringAssignmentExpression): void {\n    const $kind = expr.$kind;\n    const isObjDes = $kind === ExpressionKind.ObjectDestructuring;\n    this.text += isObjDes ? '{' : '[';\n    const list = expr.list;\n    const len = list.length;\n    let i: number;\n    let item: DestructuringAssignmentExpression | DestructuringAssignmentSingleExpression | DestructuringAssignmentRestExpression;\n    for(i = 0; i< len; i++) {\n      item = list[i];\n      switch(item.$kind) {\n        case ExpressionKind.DestructuringAssignmentLeaf:\n          item.accept(this);\n          break;\n        case ExpressionKind.ArrayDestructuring:\n        case ExpressionKind.ObjectDestructuring: {\n          const source = item.source;\n          if(source) {\n            source.accept(this);\n            this.text += ':';\n          }\n          item.accept(this);\n          break;\n        }\n      }\n    }\n    this.text += isObjDes ? '}' : ']';\n  }\n\n  public visitDestructuringAssignmentSingleExpression(expr: DestructuringAssignmentSingleExpression): void {\n    expr.source.accept(this);\n    this.text += ':';\n    expr.target.accept(this);\n    const initializer = expr.initializer;\n    if(initializer !== void 0) {\n      this.text +='=';\n      initializer.accept(this);\n    }\n  }\n\n  public visitDestructuringAssignmentRestExpression(expr: DestructuringAssignmentRestExpression): void {\n    this.text += '...';\n    expr.accept(this);\n  }\n\n  private writeArgs(args: readonly IsBindingBehavior[]): void {\n    this.text += '(';\n    for (let i = 0, length = args.length; i < length; ++i) {\n      if (i !== 0) {\n        this.text += ',';\n      }\n      args[i].accept(this);\n    }\n    this.text += ')';\n  }\n}\n\n// export interface IAstEvaluator {\n//   readonly scope: Scope;\n//   create<T>(kind: ExpressionKind.ValueConverter, name: string): ValueConverterInstance<T>;\n//   create<T>(kind: ExpressionKind.BindingBehavior, name: string): BindingBehaviorInstance<T>;\n// }\n\ntype BindingWithBehavior = IConnectableBinding & { [key: string]: BindingBehaviorInstance | undefined };\n\nexport class CustomExpression {\n  public constructor(\n    public readonly value: string,\n  ) {}\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator, _c: IConnectable | null): string {\n    return this.value;\n  }\n}\n\nexport class BindingBehaviorExpression {\n  public get $kind(): ExpressionKind.BindingBehavior { return ExpressionKind.BindingBehavior; }\n  public get hasBind(): true { return true; }\n  public get hasUnbind(): true { return true; }\n  public readonly behaviorKey: string;\n\n  public constructor(\n    public readonly expression: IsBindingBehavior,\n    public readonly name: string,\n    public readonly args: readonly IsAssign[],\n  ) {\n    this.behaviorKey = BindingBehavior.keyFrom(name);\n  }\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    return this.expression.evaluate(f, s, l, c);\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, val: unknown): unknown {\n    return this.expression.assign(f, s, l, val);\n  }\n\n  public bind(f: LF, s: Scope, b: IConnectableBinding): void {\n    if (this.expression.hasBind) {\n      this.expression.bind(f, s, b);\n    }\n    const behavior = b.locator.get<BindingBehaviorInstance>(this.behaviorKey);\n    if (behavior == null) {\n      if (__DEV__)\n        throw new Error(`BindingBehavior named '${this.name}' could not be found. Did you forget to register it as a dependency?`);\n      else\n        throw new Error(`AUR0101:${this.name}`);\n    }\n    if (!(behavior instanceof BindingBehaviorFactory)) {\n      if ((b as BindingWithBehavior)[this.behaviorKey] === void 0) {\n        (b as BindingWithBehavior)[this.behaviorKey] = behavior;\n        (behavior.bind.call as (...args: unknown[]) => void)(behavior, f, s, b, ...this.args.map(a => a.evaluate(f, s, b.locator, null)));\n      } else {\n        if (__DEV__)\n          throw new Error(`BindingBehavior named '${this.name}' already applied.`);\n        else\n          throw new Error(`AUR0102:${this.name}`);\n      }\n    }\n  }\n\n  public unbind(f: LF, s: Scope, b: IConnectableBinding): void {\n    const key = this.behaviorKey;\n    const $b = b as BindingWithBehavior;\n    if ($b[key] !== void 0) {\n      if (isFunction($b[key]!.unbind)) {\n        $b[key]!.unbind(f, s, b);\n      }\n      $b[key] = void 0;\n    }\n    if (this.expression.hasUnbind) {\n      this.expression.unbind(f, s, b);\n    }\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitBindingBehavior(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class ValueConverterExpression {\n  public get $kind(): ExpressionKind.ValueConverter { return ExpressionKind.ValueConverter; }\n  public readonly converterKey: string;\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): true { return true; }\n\n  public constructor(\n    public readonly expression: IsValueConverter,\n    public readonly name: string,\n    public readonly args: readonly IsAssign[],\n  ) {\n    this.converterKey = ValueConverter.keyFrom(name);\n  }\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    const vc = l.get<ValueConverterExpression & ValueConverterInstance & { signals?: string[] }>(this.converterKey);\n    if (vc == null) {\n      if (__DEV__)\n        throw new Error(`ValueConverter named '${this.name}' could not be found. Did you forget to register it as a dependency?`);\n      else\n        throw new Error(`AUR0103:${this.name}`);\n    }\n    // note: the cast is expected. To connect, it just needs to be a IConnectable\n    // though to work with signal, it needs to have `handleChange`\n    // so having `handleChange` as a guard in the connectable as a safe measure is needed\n    // to make sure signaler works\n    if (c !== null && ('handleChange' in (c  as unknown as ISubscriber))) {\n      const signals = vc.signals;\n      if (signals != null) {\n        const signaler = l.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n          signaler.addSignalListener(signals[i], c as unknown as ISubscriber);\n        }\n      }\n    }\n    if ('toView' in vc) {\n      return vc.toView(this.expression.evaluate(f, s, l, c), ...this.args.map(a => a.evaluate(f, s, l, c)));\n    }\n    return this.expression.evaluate(f, s, l, c);\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, val: unknown): unknown {\n    const vc = l.get<ValueConverterExpression & ValueConverterInstance>(this.converterKey);\n    if (vc == null) {\n      if (__DEV__)\n        throw new Error(`ValueConverter named '${this.name}' could not be found. Did you forget to register it as a dependency?`);\n      else\n        throw new Error(`AUR0104:${this.name}`);\n    }\n    if ('fromView' in vc) {\n      val = vc.fromView!(val, ...this.args.map(a => a.evaluate(f, s, l, null)));\n    }\n    return this.expression.assign(f, s, l, val);\n  }\n\n  public unbind(_f: LF, _s: Scope, b: IConnectableBinding): void {\n    const vc = b.locator.get(this.converterKey) as { signals?: string[] };\n    if (vc.signals === void 0) {\n      return;\n    }\n    const signaler = b.locator.get(ISignaler);\n    for (let i = 0; i < vc.signals.length; ++i) {\n      // the cast is correct, as the value converter expression would only add\n      // a IConnectable that also implements `ISubscriber` interface to the signaler\n      signaler.removeSignalListener(vc.signals[i], b as unknown as ISubscriber);\n    }\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitValueConverter(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class AssignExpression {\n  public get $kind(): ExpressionKind.Assign { return ExpressionKind.Assign; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly target: IsAssignable,\n    public readonly value: IsAssign,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    return this.target.assign(f, s, l, this.value.evaluate(f, s, l, c));\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, val: unknown): unknown {\n    this.value.assign(f, s, l, val);\n    return this.target.assign(f, s, l, val);\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitAssign(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class ConditionalExpression {\n  public get $kind(): ExpressionKind.Conditional { return ExpressionKind.Conditional; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly condition: IsBinary,\n    public readonly yes: IsAssign,\n    public readonly no: IsAssign,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n    return this.condition.evaluate(f, s, l, c) ? this.yes.evaluate(f, s, l, c) : this.no.evaluate(f, s, l, c);\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitConditional(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class AccessThisExpression {\n  public static readonly $this: AccessThisExpression = new AccessThisExpression(0);\n  public static readonly $parent: AccessThisExpression = new AccessThisExpression(1);\n  public get $kind(): ExpressionKind.AccessThis { return ExpressionKind.AccessThis; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly ancestor: number = 0,\n  ) {}\n\n  public evaluate(_f: LF, s: Scope, _l: IServiceLocator, _c: IConnectable | null): IBindingContext | undefined {\n    let oc: IOverrideContext | null = s.overrideContext;\n    let currentScope: Scope | null = s;\n    let i = this.ancestor;\n    while (i-- && oc) {\n      currentScope = currentScope!.parentScope;\n      oc = currentScope?.overrideContext ?? null;\n    }\n    return i < 1 && oc ? oc.bindingContext : void 0;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitAccessThis(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class AccessScopeExpression {\n  public get $kind(): ExpressionKind.AccessScope { return ExpressionKind.AccessScope; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly name: string,\n    public readonly ancestor: number = 0,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, _l: IServiceLocator, c: IConnectable | null): IBindingContext | IOverrideContext {\n    const obj = BindingContext.get(s, this.name, this.ancestor, f) as IBindingContext;\n    if (c !== null) {\n      c.observe(obj, this.name);\n    }\n    const evaluatedValue = obj[this.name] as ReturnType<AccessScopeExpression['evaluate']>;\n    if (evaluatedValue == null && this.name === '$host') {\n      if (__DEV__)\n        throw new Error('Unable to find $host context. Did you forget [au-slot] attribute?');\n      else\n        throw new Error('AUR0105');\n    }\n    if (f & LF.isStrictBindingStrategy) {\n      return evaluatedValue;\n    }\n    return evaluatedValue == null ? '' as unknown as ReturnType<AccessScopeExpression['evaluate']> : evaluatedValue;\n  }\n\n  public assign(f: LF, s: Scope, _l: IServiceLocator, val: unknown): unknown {\n    if (this.name === '$host') {\n      if (__DEV__)\n        throw new Error('Invalid assignment. $host is a reserved keyword.');\n      else\n        throw new Error('AUR0106');\n    }\n    const obj = BindingContext.get(s, this.name, this.ancestor, f) as IObservable;\n    if (obj instanceof Object) {\n      if (obj.$observers?.[this.name] !== void 0) {\n        obj.$observers[this.name].setValue(val, f);\n        return val;\n      } else {\n        return obj[this.name] = val;\n      }\n    }\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitAccessScope(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class AccessMemberExpression {\n  public get $kind(): ExpressionKind.AccessMember { return ExpressionKind.AccessMember; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly object: IsLeftHandSide,\n    public readonly name: string,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    const instance = this.object.evaluate(f, s, l, (f & LF.observeLeafPropertiesOnly) > 0 ? null : c) as IIndexable;\n    if (f & LF.isStrictBindingStrategy) {\n      if (instance == null) {\n        return instance;\n      }\n      if (c !== null) {\n        c.observe(instance, this.name);\n      }\n      return instance[this.name];\n    }\n    if (c !== null && instance instanceof Object) {\n      c.observe(instance, this.name);\n    }\n    // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n    return instance ? instance[this.name] : '';\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, val: unknown): unknown {\n    const obj = this.object.evaluate(f, s, l, null) as IObservable;\n    if (obj instanceof Object) {\n      if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n        obj.$observers[this.name].setValue(val, f);\n      } else {\n        obj[this.name] = val;\n      }\n    } else {\n      this.object.assign(f, s, l, { [this.name]: val });\n    }\n    return val;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitAccessMember(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class AccessKeyedExpression {\n  public get $kind(): ExpressionKind.AccessKeyed { return ExpressionKind.AccessKeyed; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly object: IsLeftHandSide,\n    public readonly key: IsAssign,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    const instance = this.object.evaluate(f, s, l, (f & LF.observeLeafPropertiesOnly) > 0 ? null : c) as IIndexable;\n    if (instance instanceof Object) {\n      const key = this.key.evaluate(f, s, l, (f & LF.observeLeafPropertiesOnly) > 0 ? null : c) as string;\n      if (c !== null) {\n        c.observe(instance, key);\n      }\n      return instance[key];\n    }\n    return void 0;\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, val: unknown): unknown {\n    const instance = this.object.evaluate(f, s, l, null) as IIndexable;\n    const key = this.key.evaluate(f, s, l, null) as string;\n    return instance[key] = val;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitAccessKeyed(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class CallScopeExpression {\n  public get $kind(): ExpressionKind.CallScope { return ExpressionKind.CallScope; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly name: string,\n    public readonly args: readonly IsAssign[],\n    public readonly ancestor: number = 0,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    const args = this.args.map(a => a.evaluate(f, s, l, c));\n    const context = BindingContext.get(s, this.name, this.ancestor, f)!;\n    // ideally, should observe property represents by this.name as well\n    // because it could be changed\n    // todo: did it ever surprise anyone?\n    const func = getFunction(f, context, this.name);\n    if (func) {\n      return func.apply(context, args);\n    }\n    return void 0;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitCallScope(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class CallMemberExpression {\n  public get $kind(): ExpressionKind.CallMember { return ExpressionKind.CallMember; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly object: IsLeftHandSide,\n    public readonly name: string,\n    public readonly args: readonly IsAssign[],\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    const instance = this.object.evaluate(f, s, l, (f & LF.observeLeafPropertiesOnly) > 0 ? null : c) as IIndexable;\n\n    const args = this.args.map(a => a.evaluate(f, s, l, c));\n    const func = getFunction(f, instance, this.name);\n    if (func) {\n      return func.apply(instance, args);\n    }\n    return void 0;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitCallMember(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class CallFunctionExpression {\n  public get $kind(): ExpressionKind.CallFunction { return ExpressionKind.CallFunction; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly func: IsLeftHandSide,\n    public readonly args: readonly IsAssign[],\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    const func = this.func.evaluate(f, s, l, c);\n    if (isFunction(func)) {\n      return func(...this.args.map(a => a.evaluate(f, s, l, c)));\n    }\n    if (!(f & LF.mustEvaluate) && (func == null)) {\n      return void 0;\n    }\n    if (__DEV__)\n      throw new Error(`Expression is not a function.`);\n    else\n      throw new Error('AUR0107');\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitCallFunction(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class BinaryExpression {\n  public get $kind(): ExpressionKind.Binary { return ExpressionKind.Binary; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly operation: BinaryOperator,\n    public readonly left: IsBinary,\n    public readonly right: IsBinary,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    switch (this.operation) {\n      case '&&':\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        return this.left.evaluate(f, s, l, c) && this.right.evaluate(f, s, l, c);\n      case '||':\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        return this.left.evaluate(f, s, l, c) || this.right.evaluate(f, s, l, c);\n      case '==':\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, c) == this.right.evaluate(f, s, l, c);\n      case '===':\n        return this.left.evaluate(f, s, l, c) === this.right.evaluate(f, s, l, c);\n      case '!=':\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, c) != this.right.evaluate(f, s, l, c);\n      case '!==':\n        return this.left.evaluate(f, s, l, c) !== this.right.evaluate(f, s, l, c);\n      case 'instanceof': {\n        const right = this.right.evaluate(f, s, l, c);\n        if (isFunction(right)) {\n          return this.left.evaluate(f, s, l, c) instanceof right;\n        }\n        return false;\n      }\n      case 'in': {\n        const right = this.right.evaluate(f, s, l, c);\n        if (right instanceof Object) {\n          return this.left.evaluate(f, s, l, c) as string in right;\n        }\n        return false;\n      }\n      // note: autoConvertAdd (and the null check) is removed because the default spec behavior is already largely similar\n      // and where it isn't, you kind of want it to behave like the spec anyway (e.g. return NaN when adding a number to undefined)\n      // this makes bugs in user code easier to track down for end users\n      // also, skipping these checks and leaving it to the runtime is a nice little perf boost and simplifies our code\n      case '+': {\n        const left: unknown = this.left.evaluate(f, s, l, c);\n        const right: unknown = this.right.evaluate(f, s, l, c);\n\n        if ((f & LF.isStrictBindingStrategy) > 0) {\n          return (left as number) + (right as number);\n        }\n\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (!left || !right) {\n          if (isNumberOrBigInt(left) || isNumberOrBigInt(right)) {\n            return (left as number || 0) + (right as number || 0);\n          }\n          if (isStringOrDate(left) || isStringOrDate(right)) {\n            return (left as string || '') + (right as string || '');\n          }\n        }\n        return (left as number) + (right as number);\n      }\n      case '-':\n        return (this.left.evaluate(f, s, l, c) as number) - (this.right.evaluate(f, s, l, c) as number);\n      case '*':\n        return (this.left.evaluate(f, s, l, c) as number) * (this.right.evaluate(f, s, l, c) as number);\n      case '/':\n        return (this.left.evaluate(f, s, l, c) as number) / (this.right.evaluate(f, s, l, c) as number);\n      case '%':\n        return (this.left.evaluate(f, s, l, c) as number) % (this.right.evaluate(f, s, l, c) as number);\n      case '<':\n        return (this.left.evaluate(f, s, l, c) as number) < (this.right.evaluate(f, s, l, c) as number);\n      case '>':\n        return (this.left.evaluate(f, s, l, c) as number) > (this.right.evaluate(f, s, l, c) as number);\n      case '<=':\n        return (this.left.evaluate(f, s, l, c) as number) <= (this.right.evaluate(f, s, l, c) as number);\n      case '>=':\n        return (this.left.evaluate(f, s, l, c) as number) >= (this.right.evaluate(f, s, l, c) as number);\n      default:\n        if (__DEV__)\n          throw new Error(`Unknown binary operator: '${this.operation}'`);\n        else\n          throw new Error(`AUR0108:${this.operation}`);\n    }\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitBinary(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class UnaryExpression {\n  public get $kind(): ExpressionKind.Unary { return ExpressionKind.Unary; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly operation: UnaryOperator,\n    public readonly expression: IsLeftHandSide,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    switch (this.operation) {\n      case 'void':\n        return void this.expression.evaluate(f, s, l, c);\n      case 'typeof':\n        return typeof this.expression.evaluate(f | LF.isStrictBindingStrategy, s, l, c);\n      case '!':\n        return !(this.expression.evaluate(f, s, l, c) as boolean);\n      case '-':\n        return -(this.expression.evaluate(f, s, l, c) as number);\n      case '+':\n        return +(this.expression.evaluate(f, s, l, c) as number);\n      default:\n        if (__DEV__)\n          throw new Error(`Unknown unary operator: '${this.operation}'`);\n        else\n          throw new Error(`AUR0109:${this.operation}`);\n    }\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitUnary(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\nexport class PrimitiveLiteralExpression<TValue extends null | undefined | number | boolean | string = null | undefined | number | boolean | string> {\n  public static readonly $undefined: PrimitiveLiteralExpression<undefined> = new PrimitiveLiteralExpression<undefined>(void 0);\n  public static readonly $null: PrimitiveLiteralExpression<null> = new PrimitiveLiteralExpression<null>(null);\n  public static readonly $true: PrimitiveLiteralExpression<true> = new PrimitiveLiteralExpression<true>(true);\n  public static readonly $false: PrimitiveLiteralExpression<false> = new PrimitiveLiteralExpression<false>(false);\n  public static readonly $empty: PrimitiveLiteralExpression<string> = new PrimitiveLiteralExpression<''>('');\n  public get $kind(): ExpressionKind.PrimitiveLiteral { return ExpressionKind.PrimitiveLiteral; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly value: TValue,\n  ) {}\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator, _c: IConnectable | null): TValue {\n    return this.value;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitPrimitiveLiteral(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class HtmlLiteralExpression {\n  public get $kind(): ExpressionKind.HtmlLiteral { return ExpressionKind.HtmlLiteral; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly parts: readonly HtmlLiteralExpression[],\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): string {\n    let result = '';\n    for (let i = 0; i < this.parts.length; ++i) {\n      const v = this.parts[i].evaluate(f, s, l, c);\n      if (v == null) {\n        continue;\n      }\n      result += v;\n    }\n    return result;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown, _projection?: ResourceDefinition): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitHtmlLiteral(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class ArrayLiteralExpression {\n  public static readonly $empty: ArrayLiteralExpression = new ArrayLiteralExpression(emptyArray);\n  public get $kind(): ExpressionKind.ArrayLiteral { return ExpressionKind.ArrayLiteral; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly elements: readonly IsAssign[],\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): readonly unknown[] {\n    return this.elements.map(e => e.evaluate(f, s, l, c));\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitArrayLiteral(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class ObjectLiteralExpression {\n  public static readonly $empty: ObjectLiteralExpression = new ObjectLiteralExpression(emptyArray, emptyArray);\n  public get $kind(): ExpressionKind.ObjectLiteral { return ExpressionKind.ObjectLiteral; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly keys: readonly (number | string)[],\n    public readonly values: readonly IsAssign[],\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): Record<string, unknown> {\n    const instance: Record<string, unknown> = {};\n    for (let i = 0; i < this.keys.length; ++i) {\n      instance[this.keys[i]] = this.values[i].evaluate(f, s, l, c);\n    }\n    return instance;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitObjectLiteral(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class TemplateExpression {\n  public static readonly $empty: TemplateExpression = new TemplateExpression(['']);\n  public get $kind(): ExpressionKind.Template { return ExpressionKind.Template; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly cooked: readonly string[],\n    public readonly expressions: readonly IsAssign[] = emptyArray,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): string {\n    let result = this.cooked[0];\n    for (let i = 0; i < this.expressions.length; ++i) {\n      result += String(this.expressions[i].evaluate(f, s, l, c));\n      result += this.cooked[i + 1];\n    }\n    return result;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitTemplate(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class TaggedTemplateExpression {\n  public get $kind(): ExpressionKind.TaggedTemplate { return ExpressionKind.TaggedTemplate; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly cooked: readonly string[] & { raw?: readonly string[] },\n    raw: readonly string[],\n    public readonly func: IsLeftHandSide,\n    public readonly expressions: readonly IsAssign[] = emptyArray,\n  ) {\n    cooked.raw = raw;\n  }\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): string {\n    const results = this.expressions.map(e => e.evaluate(f, s, l, c));\n    const func = this.func.evaluate(f, s, l, c);\n    if (!isFunction(func)) {\n      if (__DEV__)\n        throw new Error(`Left-hand side of tagged template expression is not a function.`);\n      else\n        throw new Error(`AUR0110`);\n    }\n    return func(this.cooked, ...results);\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitTaggedTemplate(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class ArrayBindingPattern {\n  public get $kind(): ExpressionKind.ArrayBindingPattern { return ExpressionKind.ArrayBindingPattern; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  // We'll either have elements, or keys+values, but never all 3\n  public constructor(\n    public readonly elements: readonly IsAssign[],\n  ) {}\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator, _c: IConnectable | null): unknown {\n    // TODO: this should come after batch\n    // as a destructuring expression like [x, y] = value\n    //\n    // should only trigger change only once:\n    // batch(() => {\n    //   object.x = value[0]\n    //   object.y = value[1]\n    // })\n    //\n    // instead of twice:\n    // object.x = value[0]\n    // object.y = value[1]\n    return void 0;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    // TODO\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitArrayBindingPattern(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class ObjectBindingPattern {\n  public get $kind(): ExpressionKind.ObjectBindingPattern { return ExpressionKind.ObjectBindingPattern; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  // We'll either have elements, or keys+values, but never all 3\n  public constructor(\n    public readonly keys: readonly (string | number)[],\n    public readonly values: readonly IsAssign[],\n  ) {}\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator, _c: IConnectable | null): unknown {\n    // TODO\n    // similar to array binding ast, this should only come after batch\n    // for a single notification per destructing,\n    // regardless number of property assignments on the scope binding context\n    return void 0;\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    // TODO\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitObjectBindingPattern(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nexport class BindingIdentifier {\n  public get $kind(): ExpressionKind.BindingIdentifier { return ExpressionKind.BindingIdentifier; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly name: string,\n  ) {}\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator | null, _c: IConnectable | null): string {\n    return this.name;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitBindingIdentifier(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nconst toStringTag = Object.prototype.toString as {\n  call(obj: unknown): keyof '[object Array]' | '[object Map]' | '[object Set]' | '[object Number]' | '[object Null]' | '[object Undefined]';\n};\n\n// https://tc39.github.io/ecma262/#sec-iteration-statements\n// https://tc39.github.io/ecma262/#sec-for-in-and-for-of-statements\nexport class ForOfStatement {\n  public get $kind(): ExpressionKind.ForOfStatement { return ExpressionKind.ForOfStatement; }\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly declaration: BindingIdentifierOrPattern | DestructuringAssignmentExpression,\n    public readonly iterable: IsBindingBehavior,\n  ) {}\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): unknown {\n    return this.iterable.evaluate(f, s, l, c);\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public count(_f: LF, result: Collection | number | null | undefined): number {\n    switch (toStringTag.call(result) as string) {\n      case '[object Array]': return (result as unknown[]).length;\n      case '[object Map]': return (result as Map<unknown, unknown>).size;\n      case '[object Set]': return (result as Set<unknown>).size;\n      case '[object Number]': return result as number;\n      case '[object Null]': return 0;\n      case '[object Undefined]': return 0;\n      // todo: remove this count method\n      default: throw new Error(`Cannot count ${toStringTag.call(result) as string}`);\n    }\n  }\n\n  // deepscan-disable-next-line\n  public iterate(f: LF, result: Collection | number | null | undefined, func: (arr: Collection, index: number, item: unknown) => void): void {\n    switch (toStringTag.call(result) as string) {\n      case '[object Array]': return $array(result as unknown[], func);\n      case '[object Map]': return $map(result as Map<unknown, unknown>, func);\n      case '[object Set]': return $set(result as Set<unknown>, func);\n      case '[object Number]': return $number(result as number, func);\n      case '[object Null]': return;\n      case '[object Undefined]': return;\n      // todo: remove this count method\n      default: throw new Error(`Cannot iterate over ${toStringTag.call(result) as string}`);\n    }\n  }\n\n  public bind(f: LF, s: Scope, b: IConnectableBinding): void {\n    if (this.iterable.hasBind) {\n      this.iterable.bind(f, s, b);\n    }\n  }\n\n  public unbind(f: LF, s: Scope, b: IConnectableBinding): void {\n    if (this.iterable.hasUnbind) {\n      this.iterable.unbind(f, s, b);\n    }\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitForOfStatement(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\n/*\n* Note: this implementation is far simpler than the one in vCurrent and might be missing important stuff (not sure yet)\n* so while this implementation is identical to Template and we could reuse that one, we don't want to lock outselves in to potentially the wrong abstraction\n* but this class might be a candidate for removal if it turns out it does provide all we need\n*/\nexport class Interpolation {\n  public get $kind(): ExpressionKind.Interpolation { return ExpressionKind.Interpolation; }\n  public readonly isMulti: boolean;\n  public readonly firstExpression: IsBindingBehavior;\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n\n  public constructor(\n    public readonly parts: readonly string[],\n    public readonly expressions: readonly IsBindingBehavior[] = emptyArray,\n  ) {\n    this.isMulti = expressions.length > 1;\n    this.firstExpression = expressions[0];\n  }\n\n  public evaluate(f: LF, s: Scope, l: IServiceLocator, c: IConnectable | null): string {\n    if (this.isMulti) {\n      let result = this.parts[0];\n      for (let i = 0; i < this.expressions.length; ++i) {\n        result += String(this.expressions[i].evaluate(f, s, l, c));\n        result += this.parts[i + 1];\n      }\n      return result;\n    } else {\n      return `${this.parts[0]}${this.firstExpression.evaluate(f, s, l, c)}${this.parts[1]}`;\n    }\n  }\n\n  public assign(_f: LF, _s: Scope, _l: IServiceLocator, _obj: unknown): unknown {\n    return void 0;\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitInterpolation(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\n// spec: https://tc39.es/ecma262/#sec-destructuring-assignment\n/** This is an internal API */\nexport class DestructuringAssignmentExpression {\n  public get hasBind(): false { return false; }\n  public get hasUnbind(): false { return false; }\n  public constructor(\n    public readonly $kind: ExpressionKind.ArrayDestructuring | ExpressionKind.ObjectDestructuring,\n    public readonly list: readonly (DestructuringAssignmentExpression | DestructuringAssignmentSingleExpression | DestructuringAssignmentRestExpression)[],\n    public readonly source: AccessMemberExpression | AccessKeyedExpression | undefined,\n    public readonly initializer: IsBindingBehavior | undefined,\n  ) { }\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator, _c: IConnectable | null): undefined {\n    return void 0;\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, value: unknown): void {\n    const list = this.list;\n    const len = list.length;\n    let i: number;\n    let item: DestructuringAssignmentExpression | DestructuringAssignmentSingleExpression | DestructuringAssignmentRestExpression;\n    for (i = 0; i < len; i++) {\n      item = list[i];\n      switch(item.$kind) {\n        case ExpressionKind.DestructuringAssignmentLeaf:\n          item.assign(f, s, l, value);\n          break;\n        case ExpressionKind.ArrayDestructuring:\n        case ExpressionKind.ObjectDestructuring: {\n          if (typeof value !== 'object' || value === null) {\n            if (__DEV__) {\n              throw new Error('Cannot use non-object value for destructuring assignment.');\n            } else {\n              throw new Error('AUR0112');\n            }\n          }\n          let source = item.source!.evaluate(f, Scope.create(value), l, null);\n          if(source === void 0) {\n            source = item.initializer?.evaluate(f, s, l, null);\n          }\n          item.assign(f, s, l, source);\n          break;\n        }\n      }\n    }\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitDestructuringAssignmentExpression(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\n/** This is an internal API */\nexport class DestructuringAssignmentSingleExpression {\n  public get $kind(): ExpressionKind.DestructuringAssignmentLeaf { return ExpressionKind.DestructuringAssignmentLeaf; }\n  public constructor(\n    public readonly target: AccessMemberExpression,\n    public readonly source: AccessMemberExpression | AccessKeyedExpression,\n    public readonly initializer: IsBindingBehavior | undefined,\n  ) { }\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator, _c: IConnectable | null): undefined {\n    return void 0;\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, value: unknown): void {\n    if(value == null) { return; }\n    if (typeof value !== 'object') {\n      if (__DEV__) {\n        throw new Error('Cannot use non-object value for destructuring assignment.');\n      } else {\n        throw new Error('AUR0112');\n      }\n    }\n    let source = this.source.evaluate(f, Scope.create(value), l, null);\n    if(source === void 0) {\n      source = this.initializer?.evaluate(f, s, l, null);\n    }\n    this.target.assign(f, s, l, source);\n  }\n\n  public accept<T>(visitor: IVisitor<T>): T {\n    return visitor.visitDestructuringAssignmentSingleExpression(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\n/** This is an internal API */\nexport class DestructuringAssignmentRestExpression {\n  public get $kind(): ExpressionKind.DestructuringAssignmentLeaf { return ExpressionKind.DestructuringAssignmentLeaf; }\n  public constructor(\n    public readonly target: AccessMemberExpression,\n    public readonly indexOrProperties: string[] | number,\n  ) { }\n\n  public evaluate(_f: LF, _s: Scope, _l: IServiceLocator, _c: IConnectable | null): undefined {\n    return void 0;\n  }\n\n  public assign(f: LF, s: Scope, l: IServiceLocator, value: unknown): void {\n    if(value == null) { return; }\n    if (typeof value !== 'object') {\n      if (__DEV__) {\n        throw new Error('Cannot use non-object value for destructuring assignment.');\n      } else {\n        throw new Error('AUR0112');\n      }\n    }\n\n    const indexOrProperties = this.indexOrProperties;\n\n    let restValue: Record<string, unknown> | unknown[];\n    if (isArrayIndex(indexOrProperties)) {\n      if (!Array.isArray(value)) {\n        if (__DEV__) {\n          throw new Error('Cannot use non-array value for array-destructuring assignment.');\n        } else {\n          throw new Error('AUR0112');\n        }\n      }\n      restValue = value.slice(indexOrProperties);\n    } else {\n      restValue = Object\n          .entries(value)\n          .reduce((acc, [k, v]) => {\n            if (!indexOrProperties.includes(k)) { acc[k] = v; }\n            return acc;\n          // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n          }, {} as Record<string, unknown>);\n    }\n    this.target.assign(f, s, l, restValue);\n  }\n\n  public accept<T>(_visitor: IVisitor<T>): T {\n    return _visitor.visitDestructuringAssignmentRestExpression(this);\n  }\n\n  public toString(): string {\n    return Unparser.unparse(this);\n  }\n}\n\nfunction getFunction(f: LF, obj: object, name: string): ((...args: unknown[]) => unknown) | null {\n  const func = obj == null ? null : (obj as IIndexable)[name];\n  if (isFunction(func)) {\n    return func as (...args: unknown[]) => unknown;\n  }\n  if (!(f & LF.mustEvaluate) && func == null) {\n    return null;\n  }\n  if (__DEV__)\n    throw new Error(`Expected '${name}' to be a function`);\n  else\n    throw new Error(`AUR0111:${name}`);\n}\n\nfunction $array(result: unknown[], func: (arr: Collection, index: number, item: unknown) => void): void {\n  for (let i = 0, ii = result.length; i < ii; ++i) {\n    func(result, i, result[i]);\n  }\n}\n\nfunction $map(result: Map<unknown, unknown>, func: (arr: Collection, index: number, item: unknown) => void): void {\n  const arr = Array(result.size);\n  let i = -1;\n  for (const entry of result.entries()) {\n    arr[++i] = entry;\n  }\n  $array(arr, func);\n}\n\nfunction $set(result: Set<unknown>, func: (arr: Collection, index: number, item: unknown) => void): void {\n  const arr = Array(result.size);\n  let i = -1;\n  for (const key of result.keys()) {\n    arr[++i] = key;\n  }\n  $array(arr, func);\n}\n\nfunction $number(result: number, func: (arr: Collection, index: number, item: unknown) => void): void {\n  const arr = Array(result);\n  for (let i = 0; i < result; ++i) {\n    arr[i] = i;\n  }\n  $array(arr, func);\n}\n","import { DI, IIndexable, IServiceLocator } from '@aurelia/kernel';\nimport type { Scope } from './observation/binding-context.js';\nimport type { CollectionLengthObserver, CollectionSizeObserver } from './observation/collection-length-observer.js';\n\nexport interface IBinding {\n  interceptor: this;\n  readonly locator: IServiceLocator;\n  readonly $scope?: Scope;\n  readonly isBound: boolean;\n  $bind(flags: LifecycleFlags, scope: Scope): void;\n  $unbind(flags: LifecycleFlags): void;\n}\n\nexport const ICoercionConfiguration = DI.createInterface<ICoercionConfiguration>('ICoercionConfiguration');\nexport interface ICoercionConfiguration {\n  /** When set to `true`, enables the automatic type-coercion for bindables globally. */\n  enableCoercion: boolean;\n  /** When set to `true`, coerces the `null` and `undefined` values to the target types. This is ineffective when `disableCoercion` is set to `true.` */\n  coerceNullish: boolean;\n}\n\nexport type InterceptorFunc<TInput = unknown, TOutput = unknown> = (value: TInput, coercionConfig: ICoercionConfiguration | null) => TOutput;\n\n/*\n* Note: the oneTime binding now has a non-zero value for 2 reasons:\n*  - plays nicer with bitwise operations (more consistent code, more explicit settings)\n*  - allows for potentially having something like BindingMode.oneTime | BindingMode.fromView, where an initial value is set once to the view but updates from the view also propagate back to the view model\n*\n* Furthermore, the \"default\" mode would be for simple \".bind\" expressions to make it explicit for our logic that the default is being used.\n* This essentially adds extra information which binding could use to do smarter things and allows bindingBehaviors that add a mode instead of simply overwriting it\n*/\nexport enum BindingMode {\n  oneTime  = 0b0001,\n  toView   = 0b0010,\n  fromView = 0b0100,\n  twoWay   = 0b0110,\n  default  = 0b1000\n}\n\nexport const enum LifecycleFlags {\n  none                          = 0b0000_000_00_0,\n  // Bitmask for flags that need to be stored on a binding during $bind for mutation\n  // callbacks outside of $bind\n  persistentBindingFlags        = 0b1111_000_00_1,\n  allowParentScopeTraversal     = 0b0001_000_00_0,\n  observeLeafPropertiesOnly     = 0b0010_000_00_0,\n  targetObserverFlags           = 0b1100_000_00_1,\n  noFlush                       = 0b0100_000_00_0,\n  persistentTargetObserverQueue = 0b1000_000_00_0,\n  bindingStrategy               = 0b0000_000_00_1,\n  isStrictBindingStrategy       = 0b0000_000_00_1,\n  fromBind                      = 0b0000_000_01_0,\n  fromUnbind                    = 0b0000_000_10_0,\n  mustEvaluate                  = 0b0000_001_00_0,\n  isTraversingParentScope       = 0b0000_010_00_0,\n  dispose                       = 0b0000_100_00_0,\n}\n\nexport interface IConnectable {\n  observe(obj: object, key: PropertyKey): void;\n  observeCollection(obj: Collection): void;\n  subscribeTo(subscribable: ISubscribable | ICollectionSubscribable): void;\n}\n\n/** @internal */\nexport const enum SubscriberFlags {\n  None            = 0,\n  Subscriber0     = 0b0001,\n  Subscriber1     = 0b0010,\n  Subscriber2     = 0b0100,\n  SubscribersRest = 0b1000,\n  Any             = 0b1111,\n}\n\nexport enum DelegationStrategy {\n  none      = 0,\n  capturing = 1,\n  bubbling  = 2,\n}\n\nexport interface IBatchable {\n  flushBatch(flags: LifecycleFlags): void;\n}\n\nexport interface ISubscriber<TValue = unknown> {\n  handleChange(newValue: TValue, previousValue: TValue, flags: LifecycleFlags): void;\n}\n\nexport interface ICollectionSubscriber {\n  handleCollectionChange(indexMap: IndexMap, flags: LifecycleFlags): void;\n}\n\nexport interface ISubscribable {\n  subscribe(subscriber: ISubscriber): void;\n  unsubscribe(subscriber: ISubscriber): void;\n}\n\nexport interface ICollectionSubscribable {\n  subscribe(subscriber: ICollectionSubscriber): void;\n  unsubscribe(subscriber: ICollectionSubscriber): void;\n}\n\n/**\n * An interface describing the contract of a subscriber list,\n * with the ability to propagate values to those subscribers\n */\nexport interface ISubscriberRecord<T extends ISubscriber | ICollectionSubscriber> {\n  readonly count: number;\n  add(subscriber: T): boolean;\n  has(subscriber: T): boolean;\n  remove(subscriber: T): boolean;\n  any(): boolean;\n  notify(value: unknown, oldValue: unknown, flags: LifecycleFlags): void;\n  notifyCollection(indexMap: IndexMap, flags: LifecycleFlags): void;\n}\n\n/**\n * An internal interface describing the implementation of a ISubscribable of Aurelia that supports batching\n *\n * This is usually mixed into a class via the import `subscriberCollection` import from Aurelia.\n * The `subscriberCollection` import can be used as either a decorator, or a function call.\n */\nexport interface ISubscriberCollection extends ISubscribable {\n  [key: number]: LifecycleFlags;\n  /**\n   * The backing subscriber record for all subscriber methods of this collection\n   */\n  readonly subs: ISubscriberRecord<ISubscriber>;\n}\n\n/**\n * An internal interface describing the implementation of a ICollectionSubscribable of Aurelia that supports batching\n *\n * This is usually mixed into a class via the import `subscriberCollection` import from Aurelia.\n * The `subscriberCollection` import can be used as either a decorator, or a function call.\n */\nexport interface ICollectionSubscriberCollection extends ICollectionSubscribable {\n  [key: number]: LifecycleFlags;\n  /**\n   * The backing subscriber record for all subscriber methods of this collection\n   */\n  readonly subs: ISubscriberRecord<ICollectionSubscriber>;\n}\n\n/**\n * A collection (array, set or map)\n */\nexport type Collection = unknown[] | Set<unknown> | Map<unknown, unknown>;\n\nexport const enum CollectionKind {\n  indexed = 0b1000,\n  keyed   = 0b0100,\n  array   = 0b1001,\n  map     = 0b0110,\n  set     = 0b0111,\n}\n\nexport type LengthPropertyName<T> =\n  T extends unknown[] ? 'length' :\n    T extends Set<unknown> ? 'size' :\n      T extends Map<unknown, unknown> ? 'size' :\n        never;\n\nexport type CollectionTypeToKind<T> =\n  T extends unknown[] ? CollectionKind.array | CollectionKind.indexed :\n    T extends Set<unknown> ? CollectionKind.set | CollectionKind.keyed :\n      T extends Map<unknown, unknown> ? CollectionKind.map | CollectionKind.keyed :\n        never;\n\nexport type CollectionKindToType<T> =\n  T extends CollectionKind.array ? unknown[] :\n    T extends CollectionKind.indexed ? unknown[] :\n      T extends CollectionKind.map ? Map<unknown, unknown> :\n        T extends CollectionKind.set ? Set<unknown> :\n          T extends CollectionKind.keyed ? Set<unknown> | Map<unknown, unknown> :\n            never;\n\nexport type ObservedCollectionKindToType<T> =\n  T extends CollectionKind.array ? unknown[] :\n    T extends CollectionKind.indexed ? unknown[] :\n      T extends CollectionKind.map ? Map<unknown, unknown> :\n        T extends CollectionKind.set ? Set<unknown> :\n          T extends CollectionKind.keyed ? Map<unknown, unknown> | Set<unknown> :\n            never;\n\nexport const enum AccessorType {\n  None          = 0b0_0000_0000,\n  Observer      = 0b0_0000_0001,\n\n  Node          = 0b0_0000_0010,\n\n  // misc characteristic of accessors/observers when update\n  //\n  // by default, everything is synchronous\n  // except changes that are supposed to cause reflow/heavy computation\n  // an observer can use this flag to signal binding that don't carelessly tell it to update\n  // queue it instead\n  // todo: https://gist.github.com/paulirish/5d52fb081b3570c81e3a\n  // todo: https://csstriggers.com/\n  Layout        = 0b0_0000_0100,\n  // by default, everything is an object\n  // eg: a property is accessed on an object\n  // unless explicitly not so\n  Primtive      = 0b0_0000_1000,\n\n  Array         = 0b0_0001_0010,\n  Set           = 0b0_0010_0010,\n  Map           = 0b0_0100_0010,\n}\n\n/**\n * Basic interface to normalize getting/setting a value of any property on any object\n */\nexport interface IAccessor<TValue = unknown> {\n  type: AccessorType;\n  getValue(obj?: object, key?: PropertyKey): TValue;\n  setValue(newValue: TValue, flags: LifecycleFlags, obj?: object, key?: PropertyKey): void;\n}\n\n/**\n * An interface describing a standard contract of an observer in Aurelia binding & observation system\n */\nexport interface IObserver extends IAccessor, ISubscribable {}\n\nexport type AccessorOrObserver = (IAccessor | IObserver) & {\n  doNotCache?: boolean;\n};\n\n/**\n * An array of indices, where the index of an element represents the index to map FROM, and the numeric value of the element itself represents the index to map TO\n *\n * The deletedItems property contains the items (in case of an array) or keys (in case of map or set) that have been deleted.\n */\nexport type IndexMap = number[] & {\n  deletedItems: number[];\n  isIndexMap: true;\n};\n\nexport function copyIndexMap(\n  existing: number[] & { deletedItems?: number[] },\n  deletedItems?: number[],\n): IndexMap {\n  const { length } = existing;\n  const arr = Array(length) as IndexMap;\n  let i = 0;\n  while (i < length) {\n    arr[i] = existing[i];\n    ++i;\n  }\n  if (deletedItems !== void 0) {\n    arr.deletedItems = deletedItems.slice(0);\n  } else if (existing.deletedItems !== void 0) {\n    arr.deletedItems = existing.deletedItems.slice(0);\n  } else {\n    arr.deletedItems = [];\n  }\n  arr.isIndexMap = true;\n  return arr;\n}\n\nexport function createIndexMap(length: number = 0): IndexMap {\n  const arr = Array(length) as IndexMap;\n  let i = 0;\n  while (i < length) {\n    arr[i] = i++;\n  }\n  arr.deletedItems = [];\n  arr.isIndexMap = true;\n  return arr;\n}\n\nexport function cloneIndexMap(indexMap: IndexMap): IndexMap {\n  const clone = indexMap.slice() as IndexMap;\n  clone.deletedItems = indexMap.deletedItems.slice();\n  clone.isIndexMap = true;\n  return clone;\n}\n\nexport function isIndexMap(value: unknown): value is IndexMap {\n  return value instanceof Array && (value as IndexMap).isIndexMap === true;\n}\n\nexport interface IArrayIndexObserver extends IObserver {\n  owner: ICollectionObserver<CollectionKind.array>;\n}\n\n/**\n * Describes a type that specifically tracks changes in a collection (map, set or array)\n */\nexport interface ICollectionChangeTracker<T extends Collection> {\n  collection: T;\n  indexMap: IndexMap;\n}\n\n/**\n * An observer that tracks collection mutations and notifies subscribers (either directly or in batches)\n */\nexport interface ICollectionObserver<T extends CollectionKind> extends\n  ICollectionChangeTracker<CollectionKindToType<T>>,\n  ICollectionSubscribable {\n  type: AccessorType;\n  collection: ObservedCollectionKindToType<T>;\n  getLengthObserver(): T extends CollectionKind.array ? CollectionLengthObserver : CollectionSizeObserver;\n  notify(): void;\n}\nexport type CollectionObserver = ICollectionObserver<CollectionKind>;\n\nexport interface IBindingContext {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any;\n}\n\nexport interface IOverrideContext {\n  [key: string]: unknown;\n\n  readonly bindingContext: IBindingContext;\n}\n\nexport type IObservable<T = IIndexable> = T & {\n  $observers?: IIndexable<{}, AccessorOrObserver>;\n};\n","import {\n  SubscriberFlags as SF,\n} from '../observation.js';\nimport { def, defineHiddenProp, ensureProto } from '../utilities-objects.js';\n\nimport type {\n  ICollectionSubscriber,\n  IndexMap,\n  ISubscriber,\n  ISubscriberCollection,\n  ISubscriberRecord,\n  LifecycleFlags as LF,\n} from '../observation.js';\n\nexport type IAnySubscriber = ISubscriber | ICollectionSubscriber;\n\n/* eslint-disable @typescript-eslint/ban-types */\nexport function subscriberCollection(): ClassDecorator;\nexport function subscriberCollection(target: Function): void;\nexport function subscriberCollection(target?: Function): ClassDecorator | void {\n  return target == null ? subscriberCollectionDeco : subscriberCollectionDeco(target);\n}\n\nfunction subscriberCollectionDeco(target: Function): void { // ClassDecorator expects it to be derived from Function\n  const proto = target.prototype as ISubscriberCollection;\n  // not configurable, as in devtool, the getter could be invoked on the prototype,\n  // and become permanently broken\n  def(proto, 'subs', { get: getSubscriberRecord });\n\n  ensureProto(proto, 'subscribe', addSubscriber);\n  ensureProto(proto, 'unsubscribe', removeSubscriber);\n}\n/* eslint-enable @typescript-eslint/ban-types */\n\nexport class SubscriberRecord<T extends IAnySubscriber> implements ISubscriberRecord<T> {\n  /**\n   * subscriber flags: bits indicating the existence status of the subscribers of this record\n   */\n  private sf: SF = SF.None;\n  private s0?: T;\n  private s1?: T;\n  private s2?: T;\n  /**\n   * subscriber rest: When there's more than 3 subscribers, use an array to store the subscriber references\n   */\n  private sr?: T[];\n\n  public count: number = 0;\n\n  public add(subscriber: T): boolean {\n    if (this.has(subscriber)) {\n      return false;\n    }\n    const subscriberFlags = this.sf;\n    if ((subscriberFlags & SF.Subscriber0) === 0) {\n      this.s0 = subscriber;\n      this.sf |= SF.Subscriber0;\n    } else if ((subscriberFlags & SF.Subscriber1) === 0) {\n      this.s1 = subscriber;\n      this.sf |= SF.Subscriber1;\n    } else if ((subscriberFlags & SF.Subscriber2) === 0) {\n      this.s2 = subscriber;\n      this.sf |= SF.Subscriber2;\n    } else if ((subscriberFlags & SF.SubscribersRest) === 0) {\n      this.sr = [subscriber];\n      this.sf |= SF.SubscribersRest;\n    } else {\n      this.sr!.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    ++this.count;\n    return true;\n  }\n\n  public has(subscriber: T): boolean {\n    // Flags here is just a perf tweak\n    // Compared to not using flags, it's a moderate speed-up when this collection does not have the subscriber;\n    // and minor slow-down when it does, and the former is more common than the latter.\n    const subscriberFlags = this.sf;\n    if ((subscriberFlags & SF.Subscriber0) > 0 && this.s0 === subscriber) {\n      return true;\n    }\n    if ((subscriberFlags & SF.Subscriber1) > 0 && this.s1 === subscriber) {\n      return true;\n    }\n    if ((subscriberFlags & SF.Subscriber2) > 0 && this.s2 === subscriber) {\n      return true;\n    }\n    if ((subscriberFlags & SF.SubscribersRest) > 0) {\n      const subscribers = this.sr!; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n      const ii = subscribers.length;\n      let i = 0;\n      for (; i < ii; ++i) {\n        if (subscribers[i] === subscriber) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  public any(): boolean {\n    return this.sf !== SF.None;\n  }\n\n  public remove(subscriber: T): boolean {\n    const subscriberFlags = this.sf;\n    if ((subscriberFlags & SF.Subscriber0) > 0 && this.s0 === subscriber) {\n      this.s0 = void 0;\n      this.sf = (this.sf | SF.Subscriber0) ^ SF.Subscriber0;\n      --this.count;\n      return true;\n    } else if ((subscriberFlags & SF.Subscriber1) > 0 && this.s1 === subscriber) {\n      this.s1 = void 0;\n      this.sf = (this.sf | SF.Subscriber1) ^ SF.Subscriber1;\n      --this.count;\n      return true;\n    } else if ((subscriberFlags & SF.Subscriber2) > 0 && this.s2 === subscriber) {\n      this.s2 = void 0;\n      this.sf = (this.sf | SF.Subscriber2) ^ SF.Subscriber2;\n      --this.count;\n      return true;\n    } else if ((subscriberFlags & SF.SubscribersRest) > 0) {\n      const subscribers = this.sr!; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n      const ii = subscribers.length;\n      let i = 0;\n      for (; i < ii; ++i) {\n        if (subscribers[i] === subscriber) {\n          subscribers.splice(i, 1);\n          if (ii === 1) {\n            this.sf = (this.sf | SF.SubscribersRest) ^ SF.SubscribersRest;\n          }\n          --this.count;\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  public notify(val: unknown, oldVal: unknown, flags: LF): void {\n    /**\n     * Note: change handlers may have the side-effect of adding/removing subscribers to this collection during this\n     * callSubscribers invocation, so we're caching them all before invoking any.\n     * Subscribers added during this invocation are not invoked (and they shouldn't be).\n     * Subscribers removed during this invocation will still be invoked (and they also shouldn't be,\n     * however this is accounted for via $isBound and similar flags on the subscriber objects)\n     */\n    const sub0 = this.s0 as ISubscriber;\n    const sub1 = this.s1 as ISubscriber;\n    const sub2 = this.s2 as ISubscriber;\n    let subs = this.sr as ISubscriber[];\n    if (subs !== void 0) {\n      subs = subs.slice();\n    }\n\n    if (sub0 !== void 0) {\n      sub0.handleChange(val, oldVal, flags);\n    }\n    if (sub1 !== void 0) {\n      sub1.handleChange(val, oldVal, flags);\n    }\n    if (sub2 !== void 0) {\n      sub2.handleChange(val, oldVal, flags);\n    }\n    if (subs !== void 0) {\n      const ii = subs.length;\n      let sub: ISubscriber | undefined;\n      let i = 0;\n      for (; i < ii; ++i) {\n        sub = subs[i];\n        if (sub !== void 0) {\n          sub.handleChange(val, oldVal, flags);\n        }\n      }\n    }\n  }\n\n  public notifyCollection(indexMap: IndexMap, flags: LF): void {\n    const sub0 = this.s0 as ICollectionSubscriber;\n    const sub1 = this.s1 as ICollectionSubscriber;\n    const sub2 = this.s2 as ICollectionSubscriber;\n    let subs = this.sr as ICollectionSubscriber[];\n    if (subs !== void 0) {\n      subs = subs.slice();\n    }\n\n    if (sub0 !== void 0) {\n      sub0.handleCollectionChange(indexMap, flags);\n    }\n    if (sub1 !== void 0) {\n      sub1.handleCollectionChange(indexMap, flags);\n    }\n    if (sub2 !== void 0) {\n      sub2.handleCollectionChange(indexMap, flags);\n    }\n    if (subs !== void 0) {\n      const ii = subs.length;\n      let sub: ICollectionSubscriber | undefined;\n      let i = 0;\n      for (; i < ii; ++i) {\n        sub = subs[i];\n        if (sub !== void 0) {\n          sub.handleCollectionChange(indexMap, flags);\n        }\n      }\n    }\n  }\n}\n\nfunction getSubscriberRecord(this: ISubscriberCollection) {\n  return defineHiddenProp(this, 'subs', new SubscriberRecord());\n}\n\nfunction addSubscriber(this: ISubscriberCollection, subscriber: IAnySubscriber): boolean {\n  return this.subs.add(subscriber as ISubscriber & ICollectionSubscriber);\n}\n\nfunction removeSubscriber(this: ISubscriberCollection, subscriber: IAnySubscriber): boolean {\n  return this.subs.remove(subscriber as ISubscriber & ICollectionSubscriber);\n}\n","import { def } from '../utilities-objects.js';\n\n/* eslint-disable @typescript-eslint/ban-types */\n/**\n * Add a readonly 'queue' property on the target class to return the default FlushQueue\n * implementation\n */\nexport function withFlushQueue(): ClassDecorator;\nexport function withFlushQueue(target: Function): void;\nexport function withFlushQueue(target?: Function): ClassDecorator | void {\n  return target == null ? queueableDeco : queueableDeco(target);\n}\n\nfunction queueableDeco(target: Function): void {\n  const proto = target.prototype as IWithFlushQueue;\n  def(proto, 'queue', { get: getFlushQueue });\n}\n/* eslint-enable @typescript-eslint/ban-types */\n\nexport interface IFlushable {\n  flush(): void;\n}\n\nexport interface IWithFlushQueue {\n  queue: FlushQueue;\n}\n\nexport class FlushQueue {\n  public static readonly instance: FlushQueue = new FlushQueue();\n\n  /** @internal */\n  private _flushing: boolean = false;\n  /** @internal */\n  private readonly _items: Set<IFlushable> = new Set();\n\n  public get count(): number {\n    return this._items.size;\n  }\n\n  public add(callable: IFlushable): void {\n    this._items.add(callable);\n    if (this._flushing) {\n      return;\n    }\n    this._flushing = true;\n    try {\n      this._items.forEach(flushItem);\n    } finally {\n      this._flushing = false;\n    }\n  }\n\n  public clear(): void {\n    this._items.clear();\n    this._flushing = false;\n  }\n}\n\nfunction getFlushQueue() {\n  return FlushQueue.instance;\n}\n\nfunction flushItem(item: IFlushable, _: IFlushable, items: Set<IFlushable>) {\n  items.delete(item);\n  item.flush();\n}\n","import { isArrayIndex } from '@aurelia/kernel';\nimport { AccessorType, CollectionKind, LifecycleFlags } from '../observation.js';\nimport { subscriberCollection } from './subscriber-collection.js';\nimport { ensureProto } from '../utilities-objects.js';\nimport { withFlushQueue } from './flush-queue.js';\n\nimport type { Constructable } from '@aurelia/kernel';\nimport type {\n  ICollectionObserver,\n  IndexMap,\n  ISubscriber,\n  ISubscriberCollection,\n  ICollectionSubscriber,\n} from '../observation.js';\nimport type { FlushQueue, IFlushable, IWithFlushQueue } from './flush-queue.js';\n\nexport interface CollectionLengthObserver extends ISubscriberCollection {}\n\nexport class CollectionLengthObserver implements IWithFlushQueue, ICollectionSubscriber, IFlushable {\n  public readonly type: AccessorType = AccessorType.Array;\n\n  /** @internal */\n  private _value: number;\n\n  /** @internal */\n  private _oldvalue: number;\n\n  /** @internal */\n  private f: LifecycleFlags = LifecycleFlags.none;\n\n  /** @internal */\n  private readonly _obj: unknown[];\n  // available via withFlushQueue mixin\n  public readonly queue!: FlushQueue;\n\n  public constructor(\n    public readonly owner: ICollectionObserver<CollectionKind.array>,\n  ) {\n    this._value = this._oldvalue = (this._obj = owner.collection).length;\n  }\n\n  public getValue(): number {\n    return this._obj.length;\n  }\n\n  public setValue(newValue: number, flags: LifecycleFlags): void {\n    const currentValue = this._value;\n    // if in the template, length is two-way bound directly\n    // then there's a chance that the new value is invalid\n    // add a guard so that we don't accidentally broadcast invalid values\n    if (newValue !== currentValue && isArrayIndex(newValue)) {\n      if ((flags & LifecycleFlags.noFlush) === 0) {\n        this._obj.length = newValue;\n      }\n      this._value = newValue;\n      this._oldvalue = currentValue;\n      this.f = flags;\n      this.queue.add(this);\n    }\n  }\n\n  public handleCollectionChange(_: IndexMap, flags: LifecycleFlags) {\n    const oldValue = this._value;\n    const value = this._obj.length;\n    if ((this._value = value) !== oldValue) {\n      this._oldvalue = oldValue;\n      this.f = flags;\n      this.queue.add(this);\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldvalue;\n    this._oldvalue = this._value;\n    this.subs.notify(this._value, oV, this.f);\n  }\n}\n\nexport interface CollectionSizeObserver extends ISubscriberCollection {}\n\nexport class CollectionSizeObserver implements ICollectionSubscriber, IFlushable {\n  public readonly type: AccessorType;\n\n  public readonly queue!: FlushQueue;\n\n  /** @internal */\n  private _value: number;\n\n  /** @internal */\n  private _oldvalue: number;\n\n  /** @internal */\n  private f: LifecycleFlags = LifecycleFlags.none;\n\n  /** @internal */\n  private readonly _obj: Set<unknown> | Map<unknown, unknown>;\n\n  public constructor(\n    public readonly owner: ICollectionObserver<CollectionKind.map | CollectionKind.set>,\n  ) {\n    this._value = this._oldvalue = (this._obj = owner.collection).size;\n    this.type = this._obj instanceof Map ? AccessorType.Map : AccessorType.Set;\n  }\n\n  public getValue(): number {\n    return this._obj.size;\n  }\n\n  public setValue(): void {\n    if (__DEV__)\n      throw new Error('Map/Set \"size\" is a readonly property');\n    else\n      throw new Error('AUR02');\n  }\n\n  public handleCollectionChange(_: IndexMap, flags: LifecycleFlags): void {\n    const oldValue = this._value;\n    const value = this._obj.size;\n    if ((this._value = value) !== oldValue) {\n      this._oldvalue = oldValue;\n      this.f = flags;\n      this.queue.add(this);\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldvalue;\n    this._oldvalue = this._value;\n    this.subs.notify(this._value, oV, this.f);\n  }\n}\n\ninterface CollectionLengthObserverImpl extends ISubscriberCollection, ICollectionSubscriber {\n  owner: ICollectionObserver<CollectionKind>;\n}\n\nfunction implementLengthObserver(klass: Constructable<ISubscriberCollection>) {\n  const proto = klass.prototype as ISubscriberCollection;\n  ensureProto(proto, 'subscribe', subscribe, true);\n  ensureProto(proto, 'unsubscribe', unsubscribe, true);\n  withFlushQueue(klass);\n  subscriberCollection(klass);\n}\n\nfunction subscribe(this: CollectionLengthObserverImpl, subscriber: ISubscriber): void {\n  if (this.subs.add(subscriber) && this.subs.count === 1) {\n    this.owner.subscribe(this);\n  }\n}\n\nfunction unsubscribe(this: CollectionLengthObserverImpl, subscriber: ISubscriber): void {\n  if (this.subs.remove(subscriber) && this.subs.count === 0) {\n    this.owner.subscribe(this);\n  }\n}\n\nimplementLengthObserver(CollectionLengthObserver);\nimplementLengthObserver(CollectionSizeObserver);\n\n// a reusable variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n","import {\n  createIndexMap,\n  LifecycleFlags,\n  AccessorType,\n  ISubscriberCollection,\n  ICollectionSubscriberCollection,\n} from '../observation.js';\nimport {\n  CollectionLengthObserver,\n} from './collection-length-observer.js';\nimport {\n  subscriberCollection,\n} from './subscriber-collection.js';\n\nimport type {\n  CollectionKind,\n  ICollectionObserver,\n  IArrayIndexObserver,\n  IndexMap,\n  ISubscriber,\n} from '../observation.js';\nimport { def, defineHiddenProp, isFunction } from '../utilities-objects.js';\n\nconst observerLookup = new WeakMap<unknown[], ArrayObserver>();\n\n// https://tc39.github.io/ecma262/#sec-sortcompare\nfunction sortCompare(x: unknown, y: unknown): number {\n  if (x === y) {\n    return 0;\n  }\n  x = x === null ? 'null' : (x as {}).toString();\n  y = y === null ? 'null' : (y as {}).toString();\n  return (x as {}) < (y as {}) ? -1 : 1;\n}\n\nfunction preSortCompare(x: unknown, y: unknown): number {\n  if (x === void 0) {\n    if (y === void 0) {\n      return 0;\n    } else {\n      return 1;\n    }\n  }\n  if (y === void 0) {\n    return -1;\n  }\n  return 0;\n}\n\nfunction insertionSort(arr: unknown[], indexMap: IndexMap, from: number, to: number, compareFn: (a: unknown, b: unknown) => number): void {\n  let velement, ielement, vtmp, itmp, order;\n  let i, j;\n  for (i = from + 1; i < to; i++) {\n    velement = arr[i];\n    ielement = indexMap[i];\n    for (j = i - 1; j >= from; j--) {\n      vtmp = arr[j];\n      itmp = indexMap[j];\n      order = compareFn(vtmp, velement);\n      if (order > 0) {\n        arr[j + 1] = vtmp;\n        indexMap[j + 1] = itmp;\n      } else {\n        break;\n      }\n    }\n    arr[j + 1] = velement;\n    indexMap[j + 1] = ielement;\n  }\n}\n\nfunction quickSort(arr: unknown[], indexMap: IndexMap, from: number, to: number, compareFn: (a: unknown, b: unknown) => number): void {\n  let thirdIndex = 0, i = 0;\n  let v0, v1, v2;\n  let i0, i1, i2;\n  let c01, c02, c12;\n  let vtmp, itmp;\n  let vpivot, ipivot, lowEnd, highStart;\n  let velement, ielement, order, vtopElement;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    if (to - from <= 10) {\n      insertionSort(arr, indexMap, from, to, compareFn);\n      return;\n    }\n\n    thirdIndex = from + ((to - from) >> 1);\n    v0 = arr[from];                i0 = indexMap[from];\n    v1 = arr[to - 1];              i1 = indexMap[to - 1];\n    v2 = arr[thirdIndex];          i2 = indexMap[thirdIndex];\n    c01 = compareFn(v0, v1);\n    if (c01 > 0) {\n      vtmp = v0;                   itmp = i0;\n      v0 = v1;                     i0 = i1;\n      v1 = vtmp;                   i1 = itmp;\n    }\n    c02 = compareFn(v0, v2);\n    if (c02 >= 0) {\n      vtmp = v0;                   itmp = i0;\n      v0 = v2;                     i0 = i2;\n      v2 = v1;                     i2 = i1;\n      v1 = vtmp;                   i1 = itmp;\n    } else {\n      c12 = compareFn(v1, v2);\n      if (c12 > 0) {\n        vtmp = v1;                 itmp = i1;\n        v1 = v2;                   i1 = i2;\n        v2 = vtmp;                 i2 = itmp;\n      }\n    }\n    arr[from] = v0;                indexMap[from] = i0;\n    arr[to - 1] = v2;              indexMap[to - 1] = i2;\n    vpivot = v1;                   ipivot = i1;\n    lowEnd = from + 1;\n    highStart = to - 1;\n    arr[thirdIndex] = arr[lowEnd]; indexMap[thirdIndex] = indexMap[lowEnd];\n    arr[lowEnd] = vpivot;          indexMap[lowEnd] = ipivot;\n\n    partition: for (i = lowEnd + 1; i < highStart; i++) {\n      velement = arr[i];           ielement = indexMap[i];\n      order = compareFn(velement, vpivot);\n      if (order < 0) {\n        arr[i] = arr[lowEnd];      indexMap[i] = indexMap[lowEnd];\n        arr[lowEnd] = velement;    indexMap[lowEnd] = ielement;\n        lowEnd++;\n      } else if (order > 0) {\n        do {\n          highStart--;\n          // eslint-disable-next-line eqeqeq\n          if (highStart == i) {\n            break partition;\n          }\n          vtopElement = arr[highStart]; order = compareFn(vtopElement, vpivot);\n        } while (order > 0);\n        arr[i] = arr[highStart];   indexMap[i] = indexMap[highStart];\n        arr[highStart] = velement; indexMap[highStart] = ielement;\n        if (order < 0) {\n          velement = arr[i];       ielement = indexMap[i];\n          arr[i] = arr[lowEnd];    indexMap[i] = indexMap[lowEnd];\n          arr[lowEnd] = velement;  indexMap[lowEnd] = ielement;\n          lowEnd++;\n        }\n      }\n    }\n\n    if (to - highStart < lowEnd - from) {\n      quickSort(arr, indexMap, highStart, to, compareFn);\n      to = lowEnd;\n    } else {\n      quickSort(arr, indexMap, from, lowEnd, compareFn);\n      from = highStart;\n    }\n  }\n}\n\nconst proto = Array.prototype as { [K in keyof any[]]: any[][K] & { observing?: boolean } };\n\nconst $push = proto.push;\nconst $unshift = proto.unshift;\nconst $pop = proto.pop;\nconst $shift = proto.shift;\nconst $splice = proto.splice;\nconst $reverse = proto.reverse;\nconst $sort = proto.sort;\n\nconst native = { push: $push, unshift: $unshift, pop: $pop, shift: $shift, splice: $splice, reverse: $reverse, sort: $sort };\nconst methods: ['push', 'unshift', 'pop', 'shift', 'splice', 'reverse', 'sort'] = ['push', 'unshift', 'pop', 'shift', 'splice', 'reverse', 'sort'];\n\nconst observe = {\n  // https://tc39.github.io/ecma262/#sec-array.prototype.push\n  push: function (this: unknown[], ...args: unknown[]): ReturnType<typeof Array.prototype.push> {\n    const o = observerLookup.get(this);\n    if (o === void 0) {\n      return $push.apply(this, args);\n    }\n    const len = this.length;\n    const argCount = args.length;\n    if (argCount === 0) {\n      return len;\n    }\n    this.length = o.indexMap.length = len + argCount;\n    let i = len;\n    while (i < this.length) {\n      this[i] = args[i - len];\n      o.indexMap[i] = - 2;\n      i++;\n    }\n    o.notify();\n    return this.length;\n  },\n  // https://tc39.github.io/ecma262/#sec-array.prototype.unshift\n  unshift: function (this: unknown[], ...args: unknown[]): ReturnType<typeof Array.prototype.unshift>  {\n    const o = observerLookup.get(this);\n    if (o === void 0) {\n      return $unshift.apply(this, args);\n    }\n    const argCount = args.length;\n    const inserts = new Array(argCount);\n    let i = 0;\n    while (i < argCount) {\n      inserts[i++] = - 2;\n    }\n    $unshift.apply(o.indexMap, inserts);\n    const len = $unshift.apply(this, args);\n    o.notify();\n    return len;\n  },\n  // https://tc39.github.io/ecma262/#sec-array.prototype.pop\n  pop: function (this: unknown[]): ReturnType<typeof Array.prototype.pop> {\n    const o = observerLookup.get(this);\n    if (o === void 0) {\n      return $pop.call(this);\n    }\n    const indexMap = o.indexMap;\n    const element = $pop.call(this);\n    // only mark indices as deleted if they actually existed in the original array\n    const index = indexMap.length - 1;\n    if (indexMap[index] > -1) {\n      indexMap.deletedItems.push(indexMap[index]);\n    }\n    $pop.call(indexMap);\n    o.notify();\n    return element;\n  },\n  // https://tc39.github.io/ecma262/#sec-array.prototype.shift\n  shift: function (this: unknown[]): ReturnType<typeof Array.prototype.shift> {\n    const o = observerLookup.get(this);\n    if (o === void 0) {\n      return $shift.call(this);\n    }\n    const indexMap = o.indexMap;\n    const element = $shift.call(this);\n    // only mark indices as deleted if they actually existed in the original array\n    if (indexMap[0] > -1) {\n      indexMap.deletedItems.push(indexMap[0]);\n    }\n    $shift.call(indexMap);\n    o.notify();\n    return element;\n  },\n  // https://tc39.github.io/ecma262/#sec-array.prototype.splice\n  splice: function (this: unknown[], ...args: [number, number, ...unknown[]]): ReturnType<typeof Array.prototype.splice> {\n    const start: number = args[0];\n    const deleteCount: number|undefined = args[1];\n    const o = observerLookup.get(this);\n    if (o === void 0) {\n      return $splice.apply(this, args);\n    }\n    const len = this.length;\n    const relativeStart = start | 0;\n    const actualStart = relativeStart < 0 ? Math.max((len + relativeStart), 0) : Math.min(relativeStart, len);\n    const indexMap = o.indexMap;\n    const argCount = args.length;\n    const actualDeleteCount = argCount === 0 ? 0 : argCount === 1 ? len - actualStart : deleteCount;\n    if (actualDeleteCount > 0) {\n      let i = actualStart;\n      const to = i + actualDeleteCount;\n      while (i < to) {\n        if (indexMap[i] > -1) {\n          indexMap.deletedItems.push(indexMap[i]);\n        }\n        i++;\n      }\n    }\n    if (argCount > 2) {\n      const itemCount = argCount - 2;\n      const inserts = new Array(itemCount);\n      let i = 0;\n      while (i < itemCount) {\n        inserts[i++] = - 2;\n      }\n      $splice.call(indexMap, start, deleteCount, ...inserts);\n    } else {\n      $splice.apply(indexMap, args);\n    }\n    const deleted = $splice.apply(this, args);\n    o.notify();\n    return deleted;\n  },\n  // https://tc39.github.io/ecma262/#sec-array.prototype.reverse\n  reverse: function (this: unknown[]): ReturnType<typeof Array.prototype.reverse> {\n    const o = observerLookup.get(this);\n    if (o === void 0) {\n      $reverse.call(this);\n      return this;\n    }\n    const len = this.length;\n    const middle = (len / 2) | 0;\n    let lower = 0;\n    while (lower !== middle) {\n      const upper = len - lower - 1;\n      const lowerValue = this[lower];  const lowerIndex = o.indexMap[lower];\n      const upperValue = this[upper];  const upperIndex = o.indexMap[upper];\n      this[lower] = upperValue;        o.indexMap[lower] = upperIndex;\n      this[upper] = lowerValue;        o.indexMap[upper] = lowerIndex;\n      lower++;\n    }\n    o.notify();\n    return this;\n  },\n  // https://tc39.github.io/ecma262/#sec-array.prototype.sort\n  // https://github.com/v8/v8/blob/master/src/js/array.js\n  sort: function (this: unknown[], compareFn?: (a: unknown, b: unknown) => number): unknown[] {\n    const o = observerLookup.get(this);\n    if (o === void 0) {\n      $sort.call(this, compareFn);\n      return this;\n    }\n    const len = this.length;\n    if (len < 2) {\n      return this;\n    }\n    quickSort(this, o.indexMap, 0, len, preSortCompare);\n    let i = 0;\n    while (i < len) {\n      if (this[i] === void 0) {\n        break;\n      }\n      i++;\n    }\n    if (compareFn === void 0 || !isFunction(compareFn)/* spec says throw a TypeError, should we do that too? */) {\n      compareFn = sortCompare;\n    }\n    quickSort(this, o.indexMap, 0, i, compareFn);\n    o.notify();\n    return this;\n  }\n};\n\nfor (const method of methods) {\n  def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\n\nlet enableArrayObservationCalled = false;\n\nexport function enableArrayObservation(): void {\n  for (const method of methods) {\n    if (proto[method].observing !== true) {\n      defineHiddenProp(proto, method, observe[method]);\n    }\n  }\n}\n\nexport function disableArrayObservation(): void {\n  for (const method of methods) {\n    if (proto[method].observing === true) {\n      defineHiddenProp(proto, method, native[method]);\n    }\n  }\n}\n\nexport interface ArrayObserver extends ICollectionObserver<CollectionKind.array>, ICollectionSubscriberCollection {}\n\nexport class ArrayObserver {\n  public type: AccessorType = AccessorType.Array;\n\n  private readonly indexObservers: Record<string | number, ArrayIndexObserver | undefined>;\n  private lenObs?: CollectionLengthObserver;\n\n  public constructor(array: unknown[]) {\n\n    if (!enableArrayObservationCalled) {\n      enableArrayObservationCalled = true;\n      enableArrayObservation();\n    }\n\n    this.indexObservers = {};\n\n    this.collection = array;\n    this.indexMap = createIndexMap(array.length);\n    this.lenObs = void 0;\n\n    observerLookup.set(array, this);\n  }\n\n  public notify(): void {\n    const indexMap = this.indexMap;\n    const length = this.collection.length;\n\n    this.indexMap = createIndexMap(length);\n    this.subs.notifyCollection(indexMap, LifecycleFlags.none);\n  }\n\n  public getLengthObserver(): CollectionLengthObserver {\n    return this.lenObs ??= new CollectionLengthObserver(this);\n  }\n\n  public getIndexObserver(index: number): IArrayIndexObserver {\n    // It's unnecessary to destroy/recreate index observer all the time,\n    // so just create once, and add/remove instead\n    return this.indexObservers[index] ??= new ArrayIndexObserver(this, index);\n  }\n}\n\nexport interface ArrayIndexObserver extends IArrayIndexObserver, ISubscriberCollection {}\n\nexport class ArrayIndexObserver implements IArrayIndexObserver {\n\n  public doNotCache: boolean = true;\n  public value: unknown;\n\n  public constructor(\n    public readonly owner: ArrayObserver,\n    public readonly index: number\n  ) {\n    this.value = this.getValue();\n  }\n\n  public getValue(): unknown {\n    return this.owner.collection[this.index];\n  }\n\n  public setValue(newValue: unknown, flags: LifecycleFlags): void {\n    if (newValue === this.getValue()) {\n      return;\n    }\n    const arrayObserver = this.owner;\n    const index = this.index;\n    const indexMap = arrayObserver.indexMap;\n\n    if (indexMap[index] > -1) {\n      indexMap.deletedItems.push(indexMap[index]);\n    }\n    indexMap[index] = -2;\n    // do not need to update current value here\n    // as it will be updated inside handle collection change\n    arrayObserver.collection[index] = newValue;\n    arrayObserver.notify();\n  }\n\n  /**\n   * From interface `ICollectionSubscriber`\n   */\n  public handleCollectionChange(indexMap: IndexMap, flags: LifecycleFlags): void {\n    const index = this.index;\n    const noChange = indexMap[index] === index;\n    if (noChange) {\n      return;\n    }\n    const prevValue = this.value;\n    const currValue = this.value = this.getValue();\n    // hmm\n    if (prevValue !== currValue) {\n      this.subs.notify(currValue, prevValue, flags);\n    }\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (this.subs.add(subscriber) && this.subs.count === 1) {\n      this.owner.subscribe(this);\n    }\n  }\n\n  public unsubscribe(subscriber: ISubscriber): void {\n    if (this.subs.remove(subscriber) && this.subs.count === 0) {\n      this.owner.unsubscribe(this);\n    }\n  }\n}\n\nsubscriberCollection(ArrayObserver);\nsubscriberCollection(ArrayIndexObserver);\n\nexport function getArrayObserver(array: unknown[]): ArrayObserver {\n  let observer = observerLookup.get(array);\n  if (observer === void 0) {\n    observer = new ArrayObserver(array);\n  }\n  return observer;\n}\n\n/**\n * Applies offsets to the non-negative indices in the IndexMap\n * based on added and deleted items relative to those indices.\n *\n * e.g. turn `[-2, 0, 1]` into `[-2, 1, 2]`, allowing the values at the indices to be\n * used for sorting/reordering items if needed\n */\nexport function applyMutationsToIndices(indexMap: IndexMap): void {\n  let offset = 0;\n  let j = 0;\n  const len = indexMap.length;\n  for (let i = 0; i < len; ++i) {\n    while (indexMap.deletedItems[j] <= i - offset) {\n      ++j;\n      --offset;\n    }\n    if (indexMap[i] === -2) {\n      ++offset;\n    } else {\n      indexMap[i] += offset;\n    }\n  }\n}\n\n/**\n * After `applyMutationsToIndices`, this function can be used to reorder items in a derived\n * array (e.g.  the items in the `views` in the repeater are derived from the `items` property)\n */\nexport function synchronizeIndices<T>(items: T[], indexMap: IndexMap): void {\n  const copy = items.slice();\n\n  const len = indexMap.length;\n  let to = 0;\n  let from = 0;\n  while (to < len) {\n    from = indexMap[to];\n    if (from !== -2) {\n      items[to] = copy[from];\n    }\n    ++to;\n  }\n}\n","import { createIndexMap, AccessorType, LifecycleFlags, ICollectionSubscriberCollection } from '../observation.js';\nimport { CollectionSizeObserver } from './collection-length-observer.js';\nimport { subscriberCollection } from './subscriber-collection.js';\nimport { def } from '../utilities-objects.js';\n\nimport type {\n  ICollectionObserver,\n  CollectionKind,\n} from '../observation.js';\n\nconst observerLookup = new WeakMap<Set<unknown>, SetObserver>();\n\nconst proto = Set.prototype as { [K in keyof Set<any>]: Set<any>[K] & { observing?: boolean } };\n\nconst $add = proto.add;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\n\nconst native = { add: $add, clear: $clear, delete: $delete };\nconst methods: ['add', 'clear', 'delete'] = ['add', 'clear', 'delete'];\n\n// note: we can't really do much with Set due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, add/delete/clear are easy to reconstruct for the indexMap\n\nconst observe = {\n  // https://tc39.github.io/ecma262/#sec-set.prototype.add\n  add: function (this: Set<unknown>, value: unknown): ReturnType<typeof $add> {\n    const o = observerLookup.get(this);\n    if (o === undefined) {\n      $add.call(this, value);\n      return this;\n    }\n    const oldSize = this.size;\n    $add.call(this, value);\n    const newSize = this.size;\n    if (newSize === oldSize) {\n      return this;\n    }\n    o.indexMap[oldSize] = -2;\n    o.notify();\n    return this;\n  },\n  // https://tc39.github.io/ecma262/#sec-set.prototype.clear\n  clear: function (this: Set<unknown>): ReturnType<typeof $clear>  {\n    const o = observerLookup.get(this);\n    if (o === undefined) {\n      return $clear.call(this);\n    }\n    const size = this.size;\n    if (size > 0) {\n      const indexMap = o.indexMap;\n      let i = 0;\n      // deepscan-disable-next-line\n      for (const _ of this.keys()) {\n        if (indexMap[i] > -1) {\n          indexMap.deletedItems.push(indexMap[i]);\n        }\n        i++;\n      }\n      $clear.call(this);\n      indexMap.length = 0;\n      o.notify();\n    }\n    return undefined;\n  },\n  // https://tc39.github.io/ecma262/#sec-set.prototype.delete\n  delete: function (this: Set<unknown>, value: unknown): ReturnType<typeof $delete> {\n    const o = observerLookup.get(this);\n    if (o === undefined) {\n      return $delete.call(this, value);\n    }\n    const size = this.size;\n    if (size === 0) {\n      return false;\n    }\n    let i = 0;\n    const indexMap = o.indexMap;\n    for (const entry of this.keys()) {\n      if (entry === value) {\n        if (indexMap[i] > -1) {\n          indexMap.deletedItems.push(indexMap[i]);\n        }\n        indexMap.splice(i, 1);\n        const deleteResult = $delete.call(this, value);\n        if (deleteResult === true) {\n          o.notify();\n        }\n        return deleteResult;\n      }\n      i++;\n    }\n    return false;\n  }\n};\n\nconst descriptorProps = {\n  writable: true,\n  enumerable: false,\n  configurable: true\n};\n\nfor (const method of methods) {\n  def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\n\nlet enableSetObservationCalled = false;\n\nexport function enableSetObservation(): void {\n  for (const method of methods) {\n    if (proto[method].observing !== true) {\n      def(proto, method, { ...descriptorProps, value: observe[method] });\n    }\n  }\n}\n\nexport function disableSetObservation(): void {\n  for (const method of methods) {\n    if (proto[method].observing === true) {\n      def(proto, method, { ...descriptorProps, value: native[method] });\n    }\n  }\n}\n\nexport interface SetObserver extends ICollectionObserver<CollectionKind.set>, ICollectionSubscriberCollection {}\n\nexport class SetObserver {\n  public type: AccessorType = AccessorType.Set;\n  private lenObs?: CollectionSizeObserver;\n\n  public constructor(observedSet: Set<unknown>) {\n\n    if (!enableSetObservationCalled) {\n      enableSetObservationCalled = true;\n      enableSetObservation();\n    }\n\n    this.collection = observedSet;\n    this.indexMap = createIndexMap(observedSet.size);\n    this.lenObs = void 0;\n\n    observerLookup.set(observedSet, this);\n  }\n\n  public notify(): void {\n    const indexMap = this.indexMap;\n    const size = this.collection.size;\n\n    this.indexMap = createIndexMap(size);\n    this.subs.notifyCollection(indexMap, LifecycleFlags.none);\n  }\n\n  public getLengthObserver(): CollectionSizeObserver {\n    return this.lenObs ??= new CollectionSizeObserver(this);\n  }\n}\n\nsubscriberCollection(SetObserver);\n\nexport function getSetObserver(observedSet: Set<unknown>): SetObserver {\n  let observer = observerLookup.get(observedSet);\n  if (observer === void 0) {\n    observer = new SetObserver(observedSet);\n  }\n  return observer;\n}\n","import { createIndexMap, AccessorType, LifecycleFlags } from '../observation.js';\nimport { CollectionSizeObserver } from './collection-length-observer.js';\nimport { subscriberCollection } from './subscriber-collection.js';\nimport { def } from '../utilities-objects.js';\n\nimport type {\n  CollectionKind,\n  ICollectionObserver,\n  ICollectionSubscriberCollection,\n} from '../observation.js';\n\nconst observerLookup = new WeakMap<Map<unknown, unknown>, MapObserver>();\n\nconst proto = Map.prototype as { [K in keyof Map<any, any>]: Map<any, any>[K] & { observing?: boolean } };\n\nconst $set = proto.set;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\n\nconst native = { set: $set, clear: $clear, delete: $delete };\nconst methods: ['set', 'clear', 'delete'] = ['set', 'clear', 'delete'];\n\n// note: we can't really do much with Map due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, map/delete/clear are easy to reconstruct for the indexMap\n\nconst observe = {\n  // https://tc39.github.io/ecma262/#sec-map.prototype.map\n  set: function (this: Map<unknown, unknown>, key: unknown, value: unknown): ReturnType<typeof $set> {\n    const o = observerLookup.get(this);\n    if (o === undefined) {\n      $set.call(this, key, value);\n      return this;\n    }\n    const oldValue = this.get(key);\n    const oldSize = this.size;\n    $set.call(this, key, value);\n    const newSize = this.size;\n    if (newSize === oldSize) {\n      let i = 0;\n      for (const entry of this.entries()) {\n        if (entry[0] === key) {\n          if (entry[1] !== oldValue) {\n            o.indexMap.deletedItems.push(o.indexMap[i]);\n            o.indexMap[i] = -2;\n            o.notify();\n          }\n          return this;\n        }\n        i++;\n      }\n      return this;\n    }\n    o.indexMap[oldSize] = -2;\n    o.notify();\n    return this;\n  },\n  // https://tc39.github.io/ecma262/#sec-map.prototype.clear\n  clear: function (this: Map<unknown, unknown>): ReturnType<typeof $clear>  {\n    const o = observerLookup.get(this);\n    if (o === undefined) {\n      return $clear.call(this);\n    }\n    const size = this.size;\n    if (size > 0) {\n      const indexMap = o.indexMap;\n      let i = 0;\n      // deepscan-disable-next-line\n      for (const _ of this.keys()) {\n        if (indexMap[i] > -1) {\n          indexMap.deletedItems.push(indexMap[i]);\n        }\n        i++;\n      }\n      $clear.call(this);\n      indexMap.length = 0;\n      o.notify();\n    }\n    return undefined;\n  },\n  // https://tc39.github.io/ecma262/#sec-map.prototype.delete\n  delete: function (this: Map<unknown, unknown>, value: unknown): ReturnType<typeof $delete> {\n    const o = observerLookup.get(this);\n    if (o === undefined) {\n      return $delete.call(this, value);\n    }\n    const size = this.size;\n    if (size === 0) {\n      return false;\n    }\n    let i = 0;\n    const indexMap = o.indexMap;\n    for (const entry of this.keys()) {\n      if (entry === value) {\n        if (indexMap[i] > -1) {\n          indexMap.deletedItems.push(indexMap[i]);\n        }\n        indexMap.splice(i, 1);\n        const deleteResult = $delete.call(this, value);\n        if (deleteResult === true) {\n          o.notify();\n        }\n        return deleteResult;\n      }\n      ++i;\n    }\n    return false;\n  }\n};\n\nconst descriptorProps = {\n  writable: true,\n  enumerable: false,\n  configurable: true\n};\n\nfor (const method of methods) {\n  def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\n\nlet enableMapObservationCalled = false;\n\nexport function enableMapObservation(): void {\n  for (const method of methods) {\n    if (proto[method].observing !== true) {\n      def(proto, method, { ...descriptorProps, value: observe[method] });\n    }\n  }\n}\n\nexport function disableMapObservation(): void {\n  for (const method of methods) {\n    if (proto[method].observing === true) {\n      def(proto, method, { ...descriptorProps, value: native[method] });\n    }\n  }\n}\n\nexport interface MapObserver extends ICollectionObserver<CollectionKind.map>, ICollectionSubscriberCollection {}\n\nexport class MapObserver {\n  public type: AccessorType = AccessorType.Map;\n  private lenObs?: CollectionSizeObserver;\n\n  public constructor(map: Map<unknown, unknown>) {\n\n    if (!enableMapObservationCalled) {\n      enableMapObservationCalled = true;\n      enableMapObservation();\n    }\n\n    this.collection = map;\n    this.indexMap = createIndexMap(map.size);\n    this.lenObs = void 0;\n\n    observerLookup.set(map, this);\n  }\n\n  public notify(): void {\n    const indexMap = this.indexMap;\n    const size = this.collection.size;\n\n    this.indexMap = createIndexMap(size);\n    this.subs.notifyCollection(indexMap, LifecycleFlags.none);\n  }\n\n  public getLengthObserver(): CollectionSizeObserver {\n    return this.lenObs ??= new CollectionSizeObserver(this);\n  }\n}\n\nsubscriberCollection(MapObserver);\n\nexport function getMapObserver(map: Map<unknown, unknown>): MapObserver {\n  let observer = observerLookup.get(map);\n  if (observer === void 0) {\n    observer = new MapObserver(map);\n  }\n  return observer;\n}\n","import { def, defineHiddenProp, ensureProto } from '../utilities-objects.js';\nimport { getArrayObserver } from '../observation/array-observer.js';\nimport { getSetObserver } from '../observation/set-observer.js';\nimport { getMapObserver } from '../observation/map-observer.js';\n\nimport type { Class, IServiceLocator } from '@aurelia/kernel';\nimport type {\n  IConnectable,\n  ISubscribable,\n  ISubscriber,\n  IBinding,\n  Collection,\n  CollectionObserver,\n  ICollectionSubscriber,\n  IndexMap,\n  ICollectionSubscribable,\n  LifecycleFlags,\n} from '../observation.js';\nimport type { IObserverLocator } from '../observation/observer-locator.js';\n\n// TODO: add connect-queue (or something similar) back in when everything else is working, to improve startup time\n\nexport interface IObserverLocatorBasedConnectable extends IBinding, ISubscriber, ICollectionSubscriber {\n  oL: IObserverLocator;\n}\n\nexport interface IConnectableBinding extends IObserverLocatorBasedConnectable, IConnectable {\n  /**\n   * A record storing observers that are currently subscribed to by this binding\n   */\n  obs: BindingObserverRecord;\n}\n\nfunction observe(this: IConnectableBinding, obj: object, key: PropertyKey): void {\n  const observer = this.oL.getObserver(obj, key);\n  /* Note: we need to cast here because we can indeed get an accessor instead of an observer,\n   *  in which case the call to observer.subscribe will throw. It's not very clean and we can solve this in 2 ways:\n   *  1. Fail earlier: only let the locator resolve observers from .getObserver, and throw if no branches are left (e.g. it would otherwise return an accessor)\n   *  2. Fail silently (without throwing): give all accessors a no-op subscribe method\n   *\n   * We'll probably want to implement some global configuration (like a \"strict\" toggle) so users can pick between enforced correctness vs. ease-of-use\n   */\n  this.obs.add(observer);\n}\nfunction getObserverRecord(this: IConnectableBinding): BindingObserverRecord {\n  return defineHiddenProp(this, 'obs', new BindingObserverRecord(this));\n}\n\nfunction observeCollection(this: IConnectableBinding, collection: Collection): void {\n  let obs: CollectionObserver;\n  if (collection instanceof Array) {\n    obs = getArrayObserver(collection);\n  } else if (collection instanceof Set) {\n    obs = getSetObserver(collection);\n  } else if (collection instanceof Map) {\n    obs = getMapObserver(collection);\n  } else {\n    if (__DEV__)\n      throw new Error('Unrecognised collection type.');\n    else\n      throw new Error('AUR0210');\n  }\n  this.obs.add(obs);\n}\n\nfunction subscribeTo(this: IConnectableBinding, subscribable: ISubscribable | ICollectionSubscribable): void {\n  this.obs.add(subscribable);\n}\n\nfunction noopHandleChange() {\n  if (__DEV__)\n    throw new Error('method \"handleChange\" not implemented');\n  else\n    throw new Error(`AUR2011:handleChange`);\n}\n\nfunction noopHandleCollectionChange() {\n  if (__DEV__)\n    throw new Error('method \"handleCollectionChange\" not implemented');\n  else\n    throw new Error('AUR2012:handleCollectionChange');\n}\n\ntype ObservationRecordImplType = {\n  version: number;\n  count: number;\n  binding: IConnectableBinding;\n} & Record<string, unknown>;\n\nexport interface BindingObserverRecord extends ObservationRecordImplType { }\nexport class BindingObserverRecord implements ISubscriber, ICollectionSubscriber {\n  public version: number = 0;\n  public count: number = 0;\n  /** @internal */\n  // a map of the observers (subscribables) that the owning binding of this record\n  // is currently subscribing to. The values are the version of the observers,\n  // as the observers version may need to be changed during different evaluation\n  public o = new Map<ISubscribable | ICollectionSubscribable, number>();\n  /** @internal */\n  private readonly b: IConnectableBinding;\n\n  public constructor(b: IConnectableBinding) {\n    this.b = b;\n  }\n\n  public handleChange(value: unknown, oldValue: unknown, flags: LifecycleFlags): unknown {\n    return this.b.interceptor.handleChange(value, oldValue, flags);\n  }\n\n  public handleCollectionChange(indexMap: IndexMap, flags: LifecycleFlags): void {\n    this.b.interceptor.handleCollectionChange(indexMap, flags);\n  }\n\n  /**\n   * Add, and subscribe to a given observer\n   */\n  public add(observer: ISubscribable | ICollectionSubscribable): void {\n    if (!this.o.has(observer)) {\n      observer.subscribe(this);\n      ++this.count;\n    }\n    this.o.set(observer, this.version);\n  }\n\n  /**\n   * Unsubscribe the observers that are not up to date with the record version\n   */\n  public clear(): void {\n    this.o.forEach(unsubscribeStale, this);\n    this.count = this.o.size;\n  }\n\n  public clearAll() {\n    this.o.forEach(unsubscribeAll, this);\n    this.o.clear();\n    this.count = 0;\n  }\n}\n\nfunction unsubscribeAll(this: BindingObserverRecord, version: number, subscribable: ISubscribable | ICollectionSubscribable) {\n  subscribable.unsubscribe(this);\n}\n\nfunction unsubscribeStale(this: BindingObserverRecord, version: number, subscribable: ISubscribable | ICollectionSubscribable) {\n  if (this.version !== version) {\n    subscribable.unsubscribe(this);\n    this.o.delete(subscribable);\n  }\n}\n\ntype Connectable = IConnectable & Partial<ISubscriber & ICollectionSubscriber>;\ntype DecoratableConnectable<TProto, TClass> = Class<TProto & Connectable, TClass>;\ntype DecoratedConnectable<TProto, TClass> = Class<TProto & Connectable, TClass>;\n\nfunction connectableDecorator<TProto, TClass>(target: DecoratableConnectable<TProto, TClass>): DecoratedConnectable<TProto, TClass> {\n  const proto = target.prototype;\n  ensureProto(proto, 'observe', observe, true);\n  ensureProto(proto, 'observeCollection', observeCollection, true);\n  ensureProto(proto, 'subscribeTo', subscribeTo, true);\n  def(proto, 'obs', { get: getObserverRecord });\n  // optionally add these two methods to normalize a connectable impl\n  ensureProto(proto, 'handleChange', noopHandleChange);\n  ensureProto(proto, 'handleCollectionChange', noopHandleCollectionChange);\n\n  return target;\n}\n\nexport function connectable(): typeof connectableDecorator;\nexport function connectable<TProto, TClass>(target: DecoratableConnectable<TProto, TClass>): DecoratedConnectable<TProto, TClass>;\nexport function connectable<TProto, TClass>(target?: DecoratableConnectable<TProto, TClass>): DecoratedConnectable<TProto, TClass> | typeof connectableDecorator {\n  return target == null ? connectableDecorator : connectableDecorator(target);\n}\n\nexport type MediatedBinding<K extends string> = {\n  [key in K]: (newValue: unknown, previousValue: unknown, flags: LifecycleFlags) => void;\n};\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport interface BindingMediator<K extends string> extends IConnectableBinding { }\nexport class BindingMediator<K extends string> implements IConnectableBinding {\n  public interceptor = this;\n\n  public constructor(\n    public readonly key: K,\n    public readonly binding: MediatedBinding<K>,\n    public oL: IObserverLocator,\n    public locator: IServiceLocator,\n  ) {\n  }\n\n  public $bind(): void {\n    if (__DEV__)\n      throw new Error('Method not implemented.');\n    else\n      throw new Error('AUR0213:$bind');\n  }\n\n  public $unbind(): void {\n    if (__DEV__)\n      throw new Error('Method not implemented.');\n    else\n      throw new Error('AUR0214:$unbind');\n  }\n\n  public handleChange(newValue: unknown, previousValue: unknown, flags: LifecycleFlags): void {\n    this.binding[this.key](newValue, previousValue, flags);\n  }\n}\n\nconnectableDecorator(BindingMediator);\n","import {\n  DI,\n} from '@aurelia/kernel';\nimport {\n  AccessKeyedExpression,\n  AccessMemberExpression,\n  AccessScopeExpression,\n  AccessThisExpression,\n  ArrayBindingPattern,\n  ArrayLiteralExpression,\n  AssignExpression,\n  BinaryExpression,\n  BindingBehaviorExpression,\n  BindingIdentifier,\n  CallFunctionExpression,\n  CallMemberExpression,\n  CallScopeExpression,\n  ConditionalExpression,\n  CustomExpression,\n  ForOfStatement,\n  Interpolation,\n  ObjectBindingPattern,\n  ObjectLiteralExpression,\n  PrimitiveLiteralExpression,\n  TaggedTemplateExpression,\n  TemplateExpression,\n  UnaryExpression,\n  ValueConverterExpression,\n  AnyBindingExpression,\n  BinaryOperator,\n  BindingIdentifierOrPattern,\n  IsAssign,\n  IsAssignable,\n  IsBinary,\n  IsBindingBehavior,\n  IsConditional,\n  IsExpressionOrStatement,\n  IsLeftHandSide,\n  IsPrimary,\n  IsUnary,\n  IsValueConverter,\n  UnaryOperator,\n  ExpressionKind,\n  DestructuringAssignmentSingleExpression as DASE,\n  DestructuringAssignmentExpression as DAE,\n} from './ast.js';\nimport { createLookup } from '../utilities-objects.js';\n\nexport interface IExpressionParser extends ExpressionParser {}\nexport const IExpressionParser = DI.createInterface<IExpressionParser>('IExpressionParser', x => x.singleton(ExpressionParser));\n\nexport class ExpressionParser {\n  /** @internal */ private readonly _expressionLookup: Record<string, IsBindingBehavior> = createLookup();\n  /** @internal */ private readonly _forOfLookup: Record<string, ForOfStatement> = createLookup();\n  /** @internal */ private readonly _interpolationLookup: Record<string, Interpolation> = createLookup();\n\n  public parse(expression: string, expressionType: ExpressionType.IsIterator): ForOfStatement;\n  public parse(expression: string, expressionType: ExpressionType.Interpolation): Interpolation;\n  public parse(expression: string, expressionType: Exclude<ExpressionType, ExpressionType.IsIterator | ExpressionType.Interpolation>): IsBindingBehavior;\n  public parse(expression: string, expressionType: ExpressionType): AnyBindingExpression;\n  public parse(expression: string, expressionType: ExpressionType): AnyBindingExpression {\n    let found: AnyBindingExpression;\n    switch (expressionType) {\n      case ExpressionType.IsCustom:\n        return new CustomExpression(expression) as AnyBindingExpression;\n      case ExpressionType.Interpolation:\n        found = this._interpolationLookup[expression];\n        if (found === void 0) {\n          found = this._interpolationLookup[expression] = this.$parse(expression, expressionType);\n        }\n        return found;\n      case ExpressionType.IsIterator:\n        found = this._forOfLookup[expression];\n        if (found === void 0) {\n          found = this._forOfLookup[expression] = this.$parse(expression, expressionType);\n        }\n        return found;\n      default: {\n        if (expression.length === 0) {\n          // only allow function to be empty\n          if ((expressionType & (ExpressionType.IsFunction | ExpressionType.IsProperty)) > 0) {\n            return PrimitiveLiteralExpression.$empty;\n          }\n          if (__DEV__)\n            throw new Error('Invalid expression. Empty expression is only valid in event bindings (trigger, delegate, capture etc...)');\n          else\n            throw new Error('AUR0169');\n        }\n        found = this._expressionLookup[expression];\n        if (found === void 0) {\n          found = this._expressionLookup[expression] = this.$parse(expression, expressionType);\n        }\n        return found;\n      }\n    }\n  }\n\n  private $parse(expression: string, expressionType: ExpressionType.IsIterator): ForOfStatement;\n  private $parse(expression: string, expressionType: ExpressionType.Interpolation): Interpolation;\n  private $parse(expression: string, expressionType: Exclude<ExpressionType, ExpressionType.IsIterator | ExpressionType.Interpolation>): IsBindingBehavior;\n  private $parse(expression: string, expressionType: ExpressionType): AnyBindingExpression {\n    $state.ip = expression;\n    $state.length = expression.length;\n    $state.index = 0;\n    $state._currentChar = expression.charCodeAt(0);\n    return parse($state, Access.Reset, Precedence.Variadic, expressionType === void 0 ? ExpressionType.IsProperty : expressionType);\n  }\n}\n\nexport const enum Char {\n  Null           = 0x00,\n  Backspace      = 0x08,\n  Tab            = 0x09,\n  LineFeed       = 0x0A,\n  VerticalTab    = 0x0B,\n  FormFeed       = 0x0C,\n  CarriageReturn = 0x0D,\n  Space          = 0x20,\n  Exclamation    = 0x21,\n  DoubleQuote    = 0x22,\n  Dollar         = 0x24,\n  Percent        = 0x25,\n  Ampersand      = 0x26,\n  SingleQuote    = 0x27,\n  OpenParen      = 0x28,\n  CloseParen     = 0x29,\n  Asterisk       = 0x2A,\n  Plus           = 0x2B,\n  Comma          = 0x2C,\n  Minus          = 0x2D,\n  Dot            = 0x2E,\n  Slash          = 0x2F,\n  Semicolon      = 0x3B,\n  Backtick       = 0x60,\n  OpenBracket    = 0x5B,\n  Backslash      = 0x5C,\n  CloseBracket   = 0x5D,\n  Caret          = 0x5E,\n  Underscore     = 0x5F,\n  OpenBrace      = 0x7B,\n  Bar            = 0x7C,\n  CloseBrace     = 0x7D,\n  Colon          = 0x3A,\n  LessThan       = 0x3C,\n  Equals         = 0x3D,\n  GreaterThan    = 0x3E,\n  Question       = 0x3F,\n\n  Zero   = 0x30,\n  One    = 0x31,\n  Two    = 0x32,\n  Three  = 0x33,\n  Four   = 0x34,\n  Five   = 0x35,\n  Six    = 0x36,\n  Seven  = 0x37,\n  Eight  = 0x38,\n  Nine   = 0x39,\n\n  UpperA = 0x41,\n  UpperB = 0x42,\n  UpperC = 0x43,\n  UpperD = 0x44,\n  UpperE = 0x45,\n  UpperF = 0x46,\n  UpperG = 0x47,\n  UpperH = 0x48,\n  UpperI = 0x49,\n  UpperJ = 0x4A,\n  UpperK = 0x4B,\n  UpperL = 0x4C,\n  UpperM = 0x4D,\n  UpperN = 0x4E,\n  UpperO = 0x4F,\n  UpperP = 0x50,\n  UpperQ = 0x51,\n  UpperR = 0x52,\n  UpperS = 0x53,\n  UpperT = 0x54,\n  UpperU = 0x55,\n  UpperV = 0x56,\n  UpperW = 0x57,\n  UpperX = 0x58,\n  UpperY = 0x59,\n  UpperZ = 0x5A,\n\n  LowerA  = 0x61,\n  LowerB  = 0x62,\n  LowerC  = 0x63,\n  LowerD  = 0x64,\n  LowerE  = 0x65,\n  LowerF  = 0x66,\n  LowerG  = 0x67,\n  LowerH  = 0x68,\n  LowerI  = 0x69,\n  LowerJ  = 0x6A,\n  LowerK  = 0x6B,\n  LowerL  = 0x6C,\n  LowerM  = 0x6D,\n  LowerN  = 0x6E,\n  LowerO  = 0x6F,\n  LowerP  = 0x70,\n  LowerQ  = 0x71,\n  LowerR  = 0x72,\n  LowerS  = 0x73,\n  LowerT  = 0x74,\n  LowerU  = 0x75,\n  LowerV  = 0x76,\n  LowerW  = 0x77,\n  LowerX  = 0x78,\n  LowerY  = 0x79,\n  LowerZ  = 0x7A\n}\n\nfunction unescapeCode(code: number): number {\n  switch (code) {\n    case Char.LowerB: return Char.Backspace;\n    case Char.LowerT: return Char.Tab;\n    case Char.LowerN: return Char.LineFeed;\n    case Char.LowerV: return Char.VerticalTab;\n    case Char.LowerF: return Char.FormFeed;\n    case Char.LowerR: return Char.CarriageReturn;\n    case Char.DoubleQuote: return Char.DoubleQuote;\n    case Char.SingleQuote: return Char.SingleQuote;\n    case Char.Backslash: return Char.Backslash;\n    default: return code;\n  }\n}\n\nexport const enum Access {\n  Reset                   = 0b0000000000000,\n  Ancestor                = 0b0000111111111,\n  This                    = 0b0001000000000,\n  Scope                   = 0b0010000000000,\n  Member                  = 0b0100000000000,\n  Keyed                   = 0b1000000000000\n}\n\nexport const enum Precedence {\n  Variadic                = 0b000111101,\n  Assign                  = 0b000111110,\n  Conditional             = 0b000111111,\n  LogicalOR               = 0b001000000,\n  LogicalAND              = 0b010000000,\n  Equality                = 0b011000000,\n  Relational              = 0b100000000,\n  Additive                = 0b101000000,\n  Multiplicative          = 0b110000000,\n  Binary                  = 0b111000000,\n  LeftHandSide            = 0b111000001,\n  Primary                 = 0b111000010,\n  Unary                   = 0b111000011,\n}\nconst enum Token {\n  EOF                     = 0b110000000000_000_000000,\n  ExpressionTerminal      = 0b100000000000_000_000000,\n  AccessScopeTerminal     = 0b010000000000_000_000000,\n  ClosingToken            = 0b001000000000_000_000000,\n  OpeningToken            = 0b000100000000_000_000000,\n  BinaryOp                = 0b000010000000_000_000000,\n  UnaryOp                 = 0b000001000000_000_000000,\n  LeftHandSide            = 0b000000100000_000_000000,\n  StringOrNumericLiteral  = 0b000000011000_000_000000,\n  NumericLiteral          = 0b000000010000_000_000000,\n  StringLiteral           = 0b000000001000_000_000000,\n  IdentifierName          = 0b000000000110_000_000000,\n  Keyword                 = 0b000000000100_000_000000,\n  Identifier              = 0b000000000010_000_000000,\n  Contextual              = 0b000000000001_000_000000,\n  Precedence              = 0b000000000000_111_000000,\n  Type                    = 0b000000000000_000_111111,\n  FalseKeyword            = 0b000000000100_000_000000,\n  TrueKeyword             = 0b000000000100_000_000001,\n  NullKeyword             = 0b000000000100_000_000010,\n  UndefinedKeyword        = 0b000000000100_000_000011,\n  ThisScope               = 0b000000000110_000_000100,\n  // HostScope               = 0b000000000110_000_000101,\n  ParentScope             = 0b000000000110_000_000110,\n  OpenParen               = 0b010100100000_000_000111,\n  OpenBrace               = 0b000100000000_000_001000,\n  Dot                     = 0b000000100000_000_001001,\n  CloseBrace              = 0b111000000000_000_001010,\n  CloseParen              = 0b111000000000_000_001011,\n  Comma                   = 0b110000000000_000_001100,\n  OpenBracket             = 0b010100100000_000_001101,\n  CloseBracket            = 0b111000000000_000_001110,\n  Colon                   = 0b110000000000_000_001111,\n  Question                = 0b110000000000_000_010000,\n  Ampersand               = 0b110000000000_000_010011,\n  Bar                     = 0b110000000000_000_010100,\n  BarBar                  = 0b110010000000_010_010101,\n  AmpersandAmpersand      = 0b110010000000_011_010110,\n  EqualsEquals            = 0b110010000000_100_010111,\n  ExclamationEquals       = 0b110010000000_100_011000,\n  EqualsEqualsEquals      = 0b110010000000_100_011001,\n  ExclamationEqualsEquals = 0b110010000000_100_011010,\n  LessThan                = 0b110010000000_101_011011,\n  GreaterThan             = 0b110010000000_101_011100,\n  LessThanEquals          = 0b110010000000_101_011101,\n  GreaterThanEquals       = 0b110010000000_101_011110,\n  InKeyword               = 0b110010000100_101_011111,\n  InstanceOfKeyword       = 0b110010000100_101_100000,\n  Plus                    = 0b010011000000_110_100001,\n  Minus                   = 0b010011000000_110_100010,\n  TypeofKeyword           = 0b000001000100_000_100011,\n  VoidKeyword             = 0b000001000100_000_100100,\n  Asterisk                = 0b110010000000_111_100101,\n  Percent                 = 0b110010000000_111_100110,\n  Slash                   = 0b110010000000_111_100111,\n  Equals                  = 0b100000000000_000_101000,\n  Exclamation             = 0b000001000000_000_101001,\n  TemplateTail            = 0b010000100000_000_101010,\n  TemplateContinuation    = 0b010000100000_000_101011,\n  OfKeyword               = 0b100000000101_000_101100\n}\n\nconst $false = PrimitiveLiteralExpression.$false;\nconst $true = PrimitiveLiteralExpression.$true;\nconst $null = PrimitiveLiteralExpression.$null;\nconst $undefined = PrimitiveLiteralExpression.$undefined;\nconst $this = AccessThisExpression.$this;\nconst $parent = AccessThisExpression.$parent;\n\nexport const enum ExpressionType {\n          None = 0,\n Interpolation = 0b0_00001,\n    IsIterator = 0b0_00010,\n    IsFunction = 0b0_00100,\n    IsProperty = 0b0_01000,\n    IsCustom   = 0b0_10000,\n}\n/* eslint-enable @typescript-eslint/indent */\n\nexport class ParserState {\n  public index: number = 0;\n  public length: number;\n  /** @internal */ public _startIndex: number = 0;\n  /** @internal */ public _lastIndex: number = 0;\n  /** @internal */ public _currentToken: Token = Token.EOF;\n  /** @internal */ public _tokenValue: string | number = '';\n  /** @internal */ public _currentChar: number;\n  /** @internal */ public _assignable: boolean = true;\n  /** @internal */ public get _tokenRaw(): string {\n    return this.ip.slice(this._startIndex, this.index);\n  }\n\n  public constructor(\n    public ip: string,\n  ) {\n    this.length = ip.length;\n    this._currentChar = ip.charCodeAt(0);\n  }\n}\n\nconst $state = new ParserState('');\n\nexport function parseExpression<TType extends ExpressionType = ExpressionType.IsProperty>(input: string, expressionType?: TType):\nTType extends ExpressionType.Interpolation ? Interpolation :\n  TType extends ExpressionType.IsIterator ? ForOfStatement :\n    IsBindingBehavior {\n\n  $state.ip = input;\n  $state.length = input.length;\n  $state.index = 0;\n  $state._currentChar = input.charCodeAt(0);\n  return parse($state, Access.Reset, Precedence.Variadic, expressionType === void 0 ? ExpressionType.IsProperty : expressionType);\n}\n\n// This is performance-critical code which follows a subset of the well-known ES spec.\n// Knowing the spec, or parsers in general, will help with understanding this code and it is therefore not the\n// single source of information for being able to figure it out.\n// It generally does not need to change unless the spec changes or spec violations are found, or optimization\n// opportunities are found (which would likely not fix these warnings in any case).\n// It's therefore not considered to have any tangible impact on the maintainability of the code base.\n// For reference, most of the parsing logic is based on: https://tc39.github.io/ecma262/#sec-ecmascript-language-expressions\n// eslint-disable-next-line max-lines-per-function\nexport function parse<TPrec extends Precedence, TType extends ExpressionType>(state: ParserState, access: Access, minPrecedence: TPrec, expressionType: TType):\nTPrec extends Precedence.Unary ? IsUnary :\n  TPrec extends Precedence.Binary ? IsBinary :\n    TPrec extends Precedence.LeftHandSide ? IsLeftHandSide :\n      TPrec extends Precedence.Assign ? IsAssign :\n        TPrec extends Precedence.Conditional ? IsConditional :\n          TPrec extends Precedence.Primary ? IsPrimary :\n            TPrec extends Precedence.Multiplicative ? IsBinary :\n              TPrec extends Precedence.Additive ? IsBinary :\n                TPrec extends Precedence.Relational ? IsBinary :\n                  TPrec extends Precedence.Equality ? IsBinary :\n                    TPrec extends Precedence.LogicalAND ? IsBinary :\n                      TPrec extends Precedence.LogicalOR ? IsBinary :\n                        TPrec extends Precedence.Variadic ?\n                          TType extends ExpressionType.Interpolation ? Interpolation :\n                            TType extends ExpressionType.IsIterator ? ForOfStatement :\n                              never : never {\n\n  if (expressionType === ExpressionType.IsCustom) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n    return new CustomExpression(state.ip) as any;\n  }\n\n  if (state.index === 0) {\n    if (expressionType & ExpressionType.Interpolation) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n      return parseInterpolation(state) as any;\n    }\n    nextToken(state);\n    if (state._currentToken & Token.ExpressionTerminal) {\n      if (__DEV__)\n        throw new Error(`Invalid start of expression: '${state.ip}'`);\n      else\n        throw new Error(`AUR0151:${state.ip}`);\n    }\n  }\n\n  state._assignable = Precedence.Binary > minPrecedence;\n  let result = void 0 as unknown as IsExpressionOrStatement;\n\n  if (state._currentToken & Token.UnaryOp) {\n    /**\n     * parseUnaryExpression\n     *\n     * https://tc39.github.io/ecma262/#sec-unary-operators\n     *\n     * UnaryExpression :\n     * 1. LeftHandSideExpression\n     * 2. void UnaryExpression\n     * 3. typeof UnaryExpression\n     * 4. + UnaryExpression\n     * 5. - UnaryExpression\n     * 6. ! UnaryExpression\n     *\n     * IsValidAssignmentTarget\n     * 2,3,4,5,6 = false\n     * 1 = see parseLeftHandSideExpression\n     *\n     * Note: technically we should throw on ++ / -- / +++ / ---, but there's nothing to gain from that\n     */\n    const op = TokenValues[state._currentToken & Token.Type] as UnaryOperator;\n    nextToken(state);\n    result = new UnaryExpression(op, parse(state, access, Precedence.LeftHandSide, expressionType));\n    state._assignable = false;\n  } else {\n    /**\n     * parsePrimaryExpression\n     *\n     * https://tc39.github.io/ecma262/#sec-primary-expression\n     *\n     * PrimaryExpression :\n     * 1. this\n     * 2. IdentifierName\n     * 3. Literal\n     * 4. ArrayLiteralExpression\n     * 5. ObjectLiteralExpression\n     * 6. TemplateLiteral\n     * 7. ParenthesizedExpression\n     *\n     * Literal :\n     * NullLiteral\n     * BooleanLiteral\n     * NumericLiteral\n     * StringLiteral\n     *\n     * ParenthesizedExpression :\n     * ( AssignmentExpression )\n     *\n     * IsValidAssignmentTarget\n     * 1,3,4,5,6,7 = false\n     * 2 = true\n     */\n    primary: switch (state._currentToken) {\n      case Token.ParentScope: // $parent\n        state._assignable = false;\n        do {\n          nextToken(state);\n          access++; // ancestor\n          if (consumeOpt(state, Token.Dot)) {\n            if ((state._currentToken as Token) === Token.Dot) {\n              if (__DEV__)\n                throw new Error(`Double dot and spread operators are not supported: '${state.ip}'`);\n              else\n                throw new Error(`AUR0152:${state.ip}`);\n            } else if ((state._currentToken as Token) === Token.EOF) {\n              if (__DEV__)\n                throw new Error(`Expected identifier: '${state.ip}'`);\n              else\n                throw new Error(`AUR0153:${state.ip}`);\n            }\n          } else if (state._currentToken & Token.AccessScopeTerminal) {\n            const ancestor = access & Access.Ancestor;\n            result = ancestor === 0 ? $this : ancestor === 1 ? $parent : new AccessThisExpression(ancestor);\n            access = Access.This;\n            break primary;\n          } else {\n            if (__DEV__)\n              throw new Error(`Invalid member expression: '${state.ip}'`);\n            else\n              throw new Error(`AUR0154:${state.ip}`);\n          }\n        } while (state._currentToken === Token.ParentScope);\n        // falls through\n      case Token.Identifier: // identifier\n        if (expressionType & ExpressionType.IsIterator) {\n          result = new BindingIdentifier(state._tokenValue as string);\n        } else {\n          result = new AccessScopeExpression(state._tokenValue as string, access & Access.Ancestor);\n          access = Access.Scope;\n        }\n        state._assignable = true;\n        nextToken(state);\n        break;\n      case Token.ThisScope: // $this\n        state._assignable = false;\n        nextToken(state);\n        result = $this;\n        access = Access.This;\n        break;\n      case Token.OpenParen: // parenthesized expression\n        nextToken(state);\n        result = parse(state, Access.Reset, Precedence.Assign, expressionType);\n        consume(state, Token.CloseParen);\n        access = Access.Reset;\n        break;\n      case Token.OpenBracket:\n        result = state.ip.search(/\\s+of\\s+/) > state.index ? parseArrayDestructuring(state) : parseArrayLiteralExpression(state, access, expressionType);\n        access = Access.Reset;\n        break;\n      case Token.OpenBrace:\n        result = parseObjectLiteralExpression(state, expressionType);\n        access = Access.Reset;\n        break;\n      case Token.TemplateTail:\n        result = new TemplateExpression([state._tokenValue as string]);\n        state._assignable = false;\n        nextToken(state);\n        access = Access.Reset;\n        break;\n      case Token.TemplateContinuation:\n        result = parseTemplate(state, access, expressionType, result as IsLeftHandSide, false);\n        access = Access.Reset;\n        break;\n      case Token.StringLiteral:\n      case Token.NumericLiteral:\n        result = new PrimitiveLiteralExpression(state._tokenValue);\n        state._assignable = false;\n        nextToken(state);\n        access = Access.Reset;\n        break;\n      case Token.NullKeyword:\n      case Token.UndefinedKeyword:\n      case Token.TrueKeyword:\n      case Token.FalseKeyword:\n        result = TokenValues[state._currentToken & Token.Type] as PrimitiveLiteralExpression;\n        state._assignable = false;\n        nextToken(state);\n        access = Access.Reset;\n        break;\n      default:\n        if (state.index >= state.length) {\n          if (__DEV__)\n            throw new Error(`Unexpected end of expression: '${state.ip}'`);\n          else\n            throw new Error(`AUR0155:${state.ip}`);\n        } else {\n          if (__DEV__)\n            throw new Error(`Unconsumed token: '${state.ip}'`);\n          else\n            throw new Error(`AUR0156:${state.ip}`);\n        }\n    }\n\n    if (expressionType & ExpressionType.IsIterator) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n      return parseForOfStatement(state, result as BindingIdentifierOrPattern) as any;\n    }\n    if (Precedence.LeftHandSide < minPrecedence) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n      return result as any;\n    }\n\n    /**\n     * parseMemberExpression (Token.Dot, Token.OpenBracket, Token.TemplateContinuation)\n     *\n     * MemberExpression :\n     * 1. PrimaryExpression\n     * 2. MemberExpression [ AssignmentExpression ]\n     * 3. MemberExpression . IdentifierName\n     * 4. MemberExpression TemplateLiteral\n     *\n     * IsValidAssignmentTarget\n     * 1,4 = false\n     * 2,3 = true\n     *\n     *\n     * parseCallExpression (Token.OpenParen)\n     * CallExpression :\n     * 1. MemberExpression Arguments\n     * 2. CallExpression Arguments\n     * 3. CallExpression [ AssignmentExpression ]\n     * 4. CallExpression . IdentifierName\n     * 5. CallExpression TemplateLiteral\n     *\n     * IsValidAssignmentTarget\n     * 1,2,5 = false\n     * 3,4 = true\n     */\n    let name = state._tokenValue as string;\n    while ((state._currentToken & Token.LeftHandSide) > 0) {\n      const args: IsAssign[] = [];\n      let strings: string[];\n      switch ((state._currentToken as Token)) {\n        case Token.Dot:\n          state._assignable = true;\n          nextToken(state);\n          if ((state._currentToken & Token.IdentifierName) === 0) {\n            if (__DEV__)\n              throw new Error(`Expected identifier: '${state.ip}'`);\n            else\n              throw new Error(`AUR0153:${state.ip}`);\n          }\n          name = state._tokenValue as string;\n          nextToken(state);\n          // Change $This to $Scope, change $Scope to $Member, keep $Member as-is, change $Keyed to $Member, disregard other flags\n          access = ((access & (Access.This | Access.Scope)) << 1) | (access & Access.Member) | ((access & Access.Keyed) >> 1);\n          if ((state._currentToken as Token) === Token.OpenParen) {\n            if (access === Access.Reset) { // if the left hand side is a literal, make sure we parse a CallMemberExpression\n              access = Access.Member;\n            }\n            continue;\n          }\n          if (access & Access.Scope) {\n            result = new AccessScopeExpression(name, (result as AccessScopeExpression | AccessThisExpression).ancestor);\n          } else { // if it's not $Scope, it's $Member\n            result = new AccessMemberExpression(result as IsLeftHandSide, name);\n          }\n          continue;\n        case Token.OpenBracket:\n          state._assignable = true;\n          nextToken(state);\n          access = Access.Keyed;\n          result = new AccessKeyedExpression(result as IsLeftHandSide, parse(state, Access.Reset, Precedence.Assign, expressionType));\n          consume(state, Token.CloseBracket);\n          break;\n        case Token.OpenParen:\n          state._assignable = false;\n          nextToken(state);\n          while ((state._currentToken as Token) !== Token.CloseParen) {\n            args.push(parse(state, Access.Reset, Precedence.Assign, expressionType));\n            if (!consumeOpt(state, Token.Comma)) {\n              break;\n            }\n          }\n          consume(state, Token.CloseParen);\n          if (access & Access.Scope) {\n            result = new CallScopeExpression(name, args, (result as AccessScopeExpression | AccessThisExpression).ancestor);\n          } else if (access & Access.Member) {\n            result = new CallMemberExpression(result as IsLeftHandSide, name, args);\n          } else {\n            result = new CallFunctionExpression(result as IsLeftHandSide, args);\n          }\n          access = 0;\n          break;\n        case Token.TemplateTail:\n          state._assignable = false;\n          strings = [state._tokenValue as string];\n          result = new TaggedTemplateExpression(strings, strings, result as IsLeftHandSide);\n          nextToken(state);\n          break;\n        case Token.TemplateContinuation:\n          result = parseTemplate(state, access, expressionType, result as IsLeftHandSide, true);\n      }\n    }\n  }\n\n  if (Precedence.Binary < minPrecedence) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n    return result as any;\n  }\n\n  /**\n   * parseBinaryExpression\n   *\n   * https://tc39.github.io/ecma262/#sec-multiplicative-operators\n   *\n   * MultiplicativeExpression : (local precedence 6)\n   * UnaryExpression\n   * MultiplicativeExpression * / % UnaryExpression\n   *\n   * AdditiveExpression : (local precedence 5)\n   * MultiplicativeExpression\n   * AdditiveExpression + - MultiplicativeExpression\n   *\n   * RelationalExpression : (local precedence 4)\n   * AdditiveExpression\n   * RelationalExpression < > <= >= instanceof in AdditiveExpression\n   *\n   * EqualityExpression : (local precedence 3)\n   * RelationalExpression\n   * EqualityExpression == != === !== RelationalExpression\n   *\n   * LogicalANDExpression : (local precedence 2)\n   * EqualityExpression\n   * LogicalANDExpression && EqualityExpression\n   *\n   * LogicalORExpression : (local precedence 1)\n   * LogicalANDExpression\n   * LogicalORExpression || LogicalANDExpression\n   */\n  while ((state._currentToken & Token.BinaryOp) > 0) {\n    const opToken = state._currentToken;\n    if ((opToken & Token.Precedence) <= minPrecedence) {\n      break;\n    }\n    nextToken(state);\n    result = new BinaryExpression(TokenValues[opToken & Token.Type] as BinaryOperator, result as IsBinary, parse(state, access, opToken & Token.Precedence, expressionType));\n    state._assignable = false;\n  }\n  if (Precedence.Conditional < minPrecedence) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n    return result as any;\n  }\n\n  /**\n   * parseConditionalExpression\n   * https://tc39.github.io/ecma262/#prod-ConditionalExpression\n   *\n   * ConditionalExpression :\n   * 1. BinaryExpression\n   * 2. BinaryExpression ? AssignmentExpression : AssignmentExpression\n   *\n   * IsValidAssignmentTarget\n   * 1,2 = false\n   */\n\n  if (consumeOpt(state, Token.Question)) {\n    const yes = parse(state, access, Precedence.Assign, expressionType);\n    consume(state, Token.Colon);\n    result = new ConditionalExpression(result as IsBinary, yes, parse(state, access, Precedence.Assign, expressionType));\n    state._assignable = false;\n  }\n  if (Precedence.Assign < minPrecedence) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n    return result as any;\n  }\n\n  /**\n   * parseAssignmentExpression\n   *\n   * https://tc39.github.io/ecma262/#prod-AssignmentExpression\n   * Note: AssignmentExpression here is equivalent to ES Expression because we don't parse the comma operator\n   *\n   * AssignmentExpression :\n   * 1. ConditionalExpression\n   * 2. LeftHandSideExpression = AssignmentExpression\n   *\n   * IsValidAssignmentTarget\n   * 1,2 = false\n   */\n  if (consumeOpt(state, Token.Equals)) {\n    if (!state._assignable) {\n      if (__DEV__)\n        throw new Error(`Left hand side of expression is not assignable: '${state.ip}'`);\n      else\n        throw new Error(`AUR0158:${state.ip}`);\n    }\n    result = new AssignExpression(result as IsAssignable, parse(state, access, Precedence.Assign, expressionType));\n  }\n  if (Precedence.Variadic < minPrecedence) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n    return result as any;\n  }\n\n  /**\n   * parseValueConverter\n   */\n  while (consumeOpt(state, Token.Bar)) {\n    if (state._currentToken === Token.EOF) {\n      if (__DEV__)\n        throw new Error(`Expected identifier to come after ValueConverter operator: '${state.ip}'`);\n      else\n        throw new Error(`AUR0159:${state.ip}`);\n    }\n    const name = state._tokenValue as string;\n    nextToken(state);\n    const args = new Array<IsAssign>();\n    while (consumeOpt(state, Token.Colon)) {\n      args.push(parse(state, access, Precedence.Assign, expressionType));\n    }\n    result = new ValueConverterExpression(result as IsValueConverter, name, args);\n  }\n\n  /**\n   * parseBindingBehavior\n   */\n  while (consumeOpt(state, Token.Ampersand)) {\n    if (state._currentToken === Token.EOF) {\n      if (__DEV__)\n        throw new Error(`Expected identifier to come after BindingBehavior operator: '${state.ip}'`);\n      else\n        throw new Error(`AUR0160:${state.ip}`);\n    }\n    const name = state._tokenValue as string;\n    nextToken(state);\n    const args = new Array<IsAssign>();\n    while (consumeOpt(state, Token.Colon)) {\n      args.push(parse(state, access, Precedence.Assign, expressionType));\n    }\n    result = new BindingBehaviorExpression(result as IsBindingBehavior, name, args);\n  }\n  if (state._currentToken !== Token.EOF) {\n    if (expressionType & ExpressionType.Interpolation) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n      return result as any;\n    }\n    if (state._tokenRaw === 'of') {\n      if (__DEV__)\n        throw new Error(`Unexpected keyword \"of\": '${state.ip}'`);\n      else\n        throw new Error(`AUR0161:${state.ip}`);\n    }\n    if (__DEV__)\n      throw new Error(`Unconsumed token: '${state.ip}'`);\n    else\n      throw new Error(`AUR0162:${state.ip}`);\n  }\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-explicit-any\n  return result as any;\n}\n\n/**\n * [key,]\n * [key]\n * [,value]\n * [key,value]\n */\nfunction parseArrayDestructuring(state: ParserState): DAE {\n  const items: DASE[] = [];\n  const dae = new DAE(ExpressionKind.ArrayDestructuring, items, void 0, void 0);\n  let target: string = '';\n  let $continue = true;\n  let index = 0;\n  while ($continue) {\n    nextToken(state);\n    switch (state._currentToken) {\n      case Token.CloseBracket:\n        $continue = false;\n        addItem();\n        break;\n      case Token.Comma:\n        addItem();\n        break;\n      case Token.Identifier:\n        target = state._tokenRaw;\n        break;\n      default:\n        if (__DEV__) {\n          throw new Error(`Unexpected '${state._tokenRaw}' at position ${state.index - 1} for destructuring assignment in ${state.ip}`);\n        } else {\n          throw new Error(`AUR0170:${state.ip}`);\n        }\n    }\n  }\n  consume(state, Token.CloseBracket);\n  return dae;\n\n  function addItem() {\n    if (target !== '') {\n      items.push(new DASE(new AccessMemberExpression($this, target), new AccessKeyedExpression($this, new PrimitiveLiteralExpression(index++)), void 0));\n      target = '';\n    } else {\n      index++;\n    }\n  }\n}\n\n/**\n * parseArrayLiteralExpression\n * https://tc39.github.io/ecma262/#prod-ArrayLiteralExpression\n *\n * ArrayLiteralExpression :\n * [ Elision(opt) ]\n * [ ElementList ]\n * [ ElementList, Elision(opt) ]\n *\n * ElementList :\n * Elision(opt) AssignmentExpression\n * ElementList, Elision(opt) AssignmentExpression\n *\n * Elision :\n * ,\n * Elision ,\n */\nfunction parseArrayLiteralExpression(state: ParserState, access: Access, expressionType: ExpressionType): ArrayBindingPattern | ArrayLiteralExpression {\n  nextToken(state);\n  const elements = new Array<IsAssign>();\n  while (state._currentToken !== Token.CloseBracket) {\n    if (consumeOpt(state, Token.Comma)) {\n      elements.push($undefined);\n      if ((state._currentToken as Token) === Token.CloseBracket) {\n        break;\n      }\n    } else {\n      elements.push(parse(state, access, Precedence.Assign, expressionType & ~ExpressionType.IsIterator));\n      if (consumeOpt(state, Token.Comma)) {\n        if ((state._currentToken as Token) === Token.CloseBracket) {\n          break;\n        }\n      } else {\n        break;\n      }\n    }\n  }\n  consume(state, Token.CloseBracket);\n  if (expressionType & ExpressionType.IsIterator) {\n    return new ArrayBindingPattern(elements);\n  } else {\n    state._assignable = false;\n    return new ArrayLiteralExpression(elements);\n  }\n}\n\nfunction parseForOfStatement(state: ParserState, result: BindingIdentifierOrPattern): ForOfStatement {\n  if ((result.$kind & ExpressionKind.IsForDeclaration) === 0) {\n    if (__DEV__)\n      throw new Error(`Invalid BindingIdentifier at left hand side of \"of\": '${state.ip}'`);\n    else\n      throw new Error(`AUR0163:${state.ip}`);\n  }\n  if (state._currentToken !== Token.OfKeyword) {\n    if (__DEV__)\n      throw new Error(`Invalid BindingIdentifier at left hand side of \"of\": '${state.ip}'`);\n    else\n      throw new Error(`AUR0163:${state.ip}`);\n  }\n  nextToken(state);\n  const declaration = result;\n  const statement = parse(state, Access.Reset, Precedence.Variadic, ExpressionType.None);\n  return new ForOfStatement(declaration, statement as IsBindingBehavior);\n}\n\n/**\n * parseObjectLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * ObjectLiteralExpression :\n * { }\n * { PropertyDefinitionList }\n *\n * PropertyDefinitionList :\n * PropertyDefinition\n * PropertyDefinitionList, PropertyDefinition\n *\n * PropertyDefinition :\n * IdentifierName\n * PropertyName : AssignmentExpression\n *\n * PropertyName :\n * IdentifierName\n * StringLiteral\n * NumericLiteral\n */\nfunction parseObjectLiteralExpression(state: ParserState, expressionType: ExpressionType): ObjectBindingPattern | ObjectLiteralExpression {\n  const keys = new Array<string | number>();\n  const values = new Array<IsAssign>();\n  nextToken(state);\n  while (state._currentToken !== Token.CloseBrace) {\n    keys.push(state._tokenValue);\n    // Literal = mandatory colon\n    if (state._currentToken & Token.StringOrNumericLiteral) {\n      nextToken(state);\n      consume(state, Token.Colon);\n      values.push(parse(state, Access.Reset, Precedence.Assign, expressionType & ~ExpressionType.IsIterator));\n    } else if (state._currentToken & Token.IdentifierName) {\n      // IdentifierName = optional colon\n      const { _currentChar: currentChar, _currentToken: currentToken, index: index } = state;\n      nextToken(state);\n      if (consumeOpt(state, Token.Colon)) {\n        values.push(parse(state, Access.Reset, Precedence.Assign, expressionType & ~ExpressionType.IsIterator));\n      } else {\n        // Shorthand\n        state._currentChar = currentChar;\n        state._currentToken = currentToken;\n        state.index = index;\n        values.push(parse(state, Access.Reset, Precedence.Primary, expressionType & ~ExpressionType.IsIterator));\n      }\n    } else {\n      if (__DEV__)\n        throw new Error(`Invalid or unsupported property definition in object literal: '${state.ip}'`);\n      else\n        throw new Error(`AUR0164:${state.ip}`);\n    }\n    if ((state._currentToken as Token) !== Token.CloseBrace) {\n      consume(state, Token.Comma);\n    }\n  }\n  consume(state, Token.CloseBrace);\n  if (expressionType & ExpressionType.IsIterator) {\n    return new ObjectBindingPattern(keys, values);\n  } else {\n    state._assignable = false;\n    return new ObjectLiteralExpression(keys, values);\n  }\n}\n\nfunction parseInterpolation(state: ParserState): Interpolation {\n  const parts = [];\n  const expressions: (IsBindingBehavior | Interpolation)[] = [];\n  const length = state.length;\n  let result = '';\n  while (state.index < length) {\n    switch (state._currentChar) {\n      case Char.Dollar:\n        if (state.ip.charCodeAt(state.index + 1) === Char.OpenBrace) {\n          parts.push(result);\n          result = '';\n\n          state.index += 2;\n          state._currentChar = state.ip.charCodeAt(state.index);\n          nextToken(state);\n          const expression = parse(state, Access.Reset, Precedence.Variadic, ExpressionType.Interpolation);\n          expressions.push(expression);\n          continue;\n        } else {\n          result += '$';\n        }\n        break;\n      case Char.Backslash:\n        result += String.fromCharCode(unescapeCode(nextChar(state)));\n        break;\n      default:\n        result += String.fromCharCode(state._currentChar);\n    }\n    nextChar(state);\n  }\n  if (expressions.length) {\n    parts.push(result);\n    return new Interpolation(parts, expressions as IsBindingBehavior[]);\n  }\n  return null!;\n}\n\n/**\n * parseTemplateLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * TemplateExpression :\n * NoSubstitutionTemplate\n * TemplateHead\n *\n * NoSubstitutionTemplate :\n * ` TemplateCharacters(opt) `\n *\n * TemplateHead :\n * ` TemplateCharacters(opt) ${\n *\n * TemplateSubstitutionTail :\n * TemplateMiddle\n * TemplateTail\n *\n * TemplateMiddle :\n * } TemplateCharacters(opt) ${\n *\n * TemplateTail :\n * } TemplateCharacters(opt) `\n *\n * TemplateCharacters :\n * TemplateCharacter TemplateCharacters(opt)\n *\n * TemplateCharacter :\n * $ [lookahead  {]\n * \\ EscapeSequence\n * SourceCharacter (but not one of ` or \\ or $)\n */\nfunction parseTemplate(state: ParserState, access: Access, expressionType: ExpressionType, result: IsLeftHandSide, tagged: boolean): TaggedTemplateExpression | TemplateExpression {\n  const cooked = [state._tokenValue as string];\n  // TODO: properly implement raw parts / decide whether we want this\n  consume(state, Token.TemplateContinuation);\n  const expressions = [parse(state, access, Precedence.Assign, expressionType)];\n  while ((state._currentToken = scanTemplateTail(state)) !== Token.TemplateTail) {\n    cooked.push(state._tokenValue as string);\n    consume(state, Token.TemplateContinuation);\n    expressions.push(parse(state, access, Precedence.Assign, expressionType));\n  }\n  cooked.push(state._tokenValue as string);\n  state._assignable = false;\n  if (tagged) {\n    nextToken(state);\n    return new TaggedTemplateExpression(cooked, cooked, result, expressions);\n  } else {\n    nextToken(state);\n    return new TemplateExpression(cooked, expressions);\n  }\n}\n\nfunction nextToken(state: ParserState): void {\n  while (state.index < state.length) {\n    state._startIndex = state.index;\n    if ((state._currentToken = (CharScanners[state._currentChar](state)) as Token) != null) { // a null token means the character must be skipped\n      return;\n    }\n  }\n  state._currentToken = Token.EOF;\n}\n\nfunction nextChar(state: ParserState): number {\n  return state._currentChar = state.ip.charCodeAt(++state.index);\n}\n\nfunction scanIdentifier(state: ParserState): Token {\n  // run to the next non-idPart\n  while (IdParts[nextChar(state)]);\n\n  const token: Token|undefined = KeywordLookup[state._tokenValue = state._tokenRaw];\n  return token === undefined ? Token.Identifier : token;\n}\n\nfunction scanNumber(state: ParserState, isFloat: boolean): Token {\n  let char = state._currentChar;\n  if (isFloat === false) {\n    do {\n      char = nextChar(state);\n    } while (char <= Char.Nine && char >= Char.Zero);\n\n    if (char !== Char.Dot) {\n      state._tokenValue = parseInt(state._tokenRaw, 10);\n      return Token.NumericLiteral;\n    }\n    // past this point it's always a float\n    char = nextChar(state);\n    if (state.index >= state.length) {\n      // unless the number ends with a dot - that behaves a little different in native ES expressions\n      // but in our AST that behavior has no effect because numbers are always stored in variables\n      state._tokenValue = parseInt(state._tokenRaw.slice(0, -1), 10);\n      return Token.NumericLiteral;\n    }\n  }\n\n  if (char <= Char.Nine && char >= Char.Zero) {\n    do {\n      char = nextChar(state);\n    } while (char <= Char.Nine && char >= Char.Zero);\n  } else {\n    state._currentChar = state.ip.charCodeAt(--state.index);\n  }\n\n  state._tokenValue = parseFloat(state._tokenRaw);\n  return Token.NumericLiteral;\n}\n\nfunction scanString(state: ParserState): Token {\n  const quote = state._currentChar;\n  nextChar(state); // Skip initial quote.\n\n  let unescaped = 0;\n  const buffer = new Array<string>();\n  let marker = state.index;\n\n  while (state._currentChar !== quote) {\n    if (state._currentChar === Char.Backslash) {\n      buffer.push(state.ip.slice(marker, state.index));\n      nextChar(state);\n      unescaped = unescapeCode(state._currentChar);\n      nextChar(state);\n      buffer.push(String.fromCharCode(unescaped));\n      marker = state.index;\n    } else if (state.index >= state.length) {\n      if (__DEV__)\n        throw new Error(`Unterminated quote in string literal: '${state.ip}'`);\n      else\n        throw new Error(`AUR0165:${state.ip}`);\n    } else {\n      nextChar(state);\n    }\n  }\n\n  const last = state.ip.slice(marker, state.index);\n  nextChar(state); // Skip terminating quote.\n\n  // Compute the unescaped string value.\n  buffer.push(last);\n  const unescapedStr = buffer.join('');\n\n  state._tokenValue = unescapedStr;\n  return Token.StringLiteral;\n}\n\nfunction scanTemplate(state: ParserState): Token {\n  let tail = true;\n  let result = '';\n\n  while (nextChar(state) !== Char.Backtick) {\n    if (state._currentChar === Char.Dollar) {\n      if ((state.index + 1) < state.length && state.ip.charCodeAt(state.index + 1) === Char.OpenBrace) {\n        state.index++;\n        tail = false;\n        break;\n      } else {\n        result += '$';\n      }\n    } else if (state._currentChar === Char.Backslash) {\n      result += String.fromCharCode(unescapeCode(nextChar(state)));\n    } else {\n      if (state.index >= state.length) {\n        if (__DEV__)\n          throw new Error(`Unterminated template string: '${state.ip}'`);\n        else\n          throw new Error(`AUR0166:${state.ip}`);\n      }\n      result += String.fromCharCode(state._currentChar);\n    }\n  }\n\n  nextChar(state);\n  state._tokenValue = result;\n  if (tail) {\n    return Token.TemplateTail;\n  }\n  return Token.TemplateContinuation;\n}\n\nfunction scanTemplateTail(state: ParserState): Token {\n  if (state.index >= state.length) {\n    if (__DEV__)\n      throw new Error(`Unterminated template string: '${state.ip}'`);\n    else\n      throw new Error(`AUR0166:${state.ip}`);\n  }\n  state.index--;\n  return scanTemplate(state);\n}\n\nfunction consumeOpt(state: ParserState, token: Token): boolean {\n  if (state._currentToken === token) {\n    nextToken(state);\n    return true;\n  }\n\n  return false;\n}\n\nfunction consume(state: ParserState, token: Token): void {\n  if (state._currentToken === token) {\n    nextToken(state);\n  } else {\n    if (__DEV__)\n      throw new Error(`Missing expected token: '${state.ip}'`);\n    else\n      throw new Error(`AUR0167:${state.ip}<${token}`);\n  }\n}\n\n/**\n * Array for mapping tokens to token values. The indices of the values\n * correspond to the token bits 0-38.\n * For this to work properly, the values in the array must be kept in\n * the same order as the token bits.\n * Usage: TokenValues[token & Token.Type]\n */\nconst TokenValues = [\n  $false, $true, $null, $undefined, '$this', null/* '$host' */, '$parent',\n\n  '(', '{', '.', '}', ')', ',', '[', ']', ':', '?', '\\'', '\"',\n\n  '&', '|', '||', '&&', '==', '!=', '===', '!==', '<', '>',\n  '<=', '>=', 'in', 'instanceof', '+', '-', 'typeof', 'void', '*', '%', '/', '=', '!',\n  Token.TemplateTail, Token.TemplateContinuation,\n  'of'\n];\n\nconst KeywordLookup: Record<string, Token> = createLookup();\nKeywordLookup.true = Token.TrueKeyword;\nKeywordLookup.null = Token.NullKeyword;\nKeywordLookup.false = Token.FalseKeyword;\nKeywordLookup.undefined = Token.UndefinedKeyword;\nKeywordLookup.$this = Token.ThisScope;\nKeywordLookup.$parent = Token.ParentScope;\nKeywordLookup.in = Token.InKeyword;\nKeywordLookup.instanceof = Token.InstanceOfKeyword;\nKeywordLookup.typeof = Token.TypeofKeyword;\nKeywordLookup.void = Token.VoidKeyword;\nKeywordLookup.of = Token.OfKeyword;\n\n/**\n * Ranges of code points in pairs of 2 (eg 0x41-0x5B, 0x61-0x7B, ...) where the second value is not inclusive (5-7 means 5 and 6)\n * Single values are denoted by the second value being a 0\n *\n * Copied from output generated with \"node build/generate-unicode.js\"\n *\n * See also: https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF\n */\nconst codes = {\n  /* [$0-9A-Za_a-z] */\n  AsciiIdPart: [0x24, 0, 0x30, 0x3A, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B],\n  IdStart: /* IdentifierStart */[0x24, 0, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B, 0xAA, 0, 0xBA, 0, 0xC0, 0xD7, 0xD8, 0xF7, 0xF8, 0x2B9, 0x2E0, 0x2E5, 0x1D00, 0x1D26, 0x1D2C, 0x1D5D, 0x1D62, 0x1D66, 0x1D6B, 0x1D78, 0x1D79, 0x1DBF, 0x1E00, 0x1F00, 0x2071, 0, 0x207F, 0, 0x2090, 0x209D, 0x212A, 0x212C, 0x2132, 0, 0x214E, 0, 0x2160, 0x2189, 0x2C60, 0x2C80, 0xA722, 0xA788, 0xA78B, 0xA7AF, 0xA7B0, 0xA7B8, 0xA7F7, 0xA800, 0xAB30, 0xAB5B, 0xAB5C, 0xAB65, 0xFB00, 0xFB07, 0xFF21, 0xFF3B, 0xFF41, 0xFF5B],\n  Digit: /* DecimalNumber */[0x30, 0x3A],\n  Skip: /* Skippable */[0, 0x21, 0x7F, 0xA1]\n};\n\n/**\n * Decompress the ranges into an array of numbers so that the char code\n * can be used as an index to the lookup\n */\nfunction decompress(lookup: (CharScanner | number)[] | null, $set: Set<number> | null, compressed: number[], value: CharScanner | number | boolean): void {\n  const rangeCount = compressed.length;\n  for (let i = 0; i < rangeCount; i += 2) {\n    const start = compressed[i];\n    let end = compressed[i + 1];\n    end = end > 0 ? end : start + 1;\n    if (lookup) {\n      lookup.fill(value as CharScanner | number, start, end);\n    }\n    if ($set) {\n      for (let ch = start; ch < end; ch++) {\n        $set.add(ch);\n      }\n    }\n  }\n}\n\n// CharFuncLookup functions\nfunction returnToken(token: Token): (s: ParserState) => Token {\n  return s => {\n    nextChar(s);\n    return token;\n  };\n}\nconst unexpectedCharacter: CharScanner = s => {\n  if (__DEV__)\n    throw new Error(`Unexpected character: '${s.ip}'`);\n  else\n    throw new Error(`AUR0168:${s.ip}`);\n};\nunexpectedCharacter.notMapped = true;\n\n// ASCII IdentifierPart lookup\nconst AsciiIdParts = new Set<number>();\ndecompress(null, AsciiIdParts, codes.AsciiIdPart, true);\n\n// IdentifierPart lookup\nconst IdParts = new Uint8Array(0xFFFF);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts as any, null, codes.IdStart, 1);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts as any, null, codes.Digit, 1);\n\ntype CharScanner = ((p: ParserState) => Token | null) & { notMapped?: boolean };\n\n// Character scanning function lookup\nconst CharScanners = new Array<CharScanner>(0xFFFF);\nCharScanners.fill(unexpectedCharacter, 0, 0xFFFF);\n\ndecompress(CharScanners, null, codes.Skip, s => {\n  nextChar(s);\n  return null;\n});\ndecompress(CharScanners, null, codes.IdStart, scanIdentifier);\ndecompress(CharScanners, null, codes.Digit, s => scanNumber(s, false));\n\nCharScanners[Char.DoubleQuote] =\nCharScanners[Char.SingleQuote] = s => {\n  return scanString(s);\n};\nCharScanners[Char.Backtick] = s => {\n  return scanTemplate(s);\n};\n\n// !, !=, !==\nCharScanners[Char.Exclamation] = s => {\n  if (nextChar(s) !== Char.Equals) {\n    return Token.Exclamation;\n  }\n  if (nextChar(s) !== Char.Equals) {\n    return Token.ExclamationEquals;\n  }\n  nextChar(s);\n  return Token.ExclamationEqualsEquals;\n};\n\n// =, ==, ===\nCharScanners[Char.Equals] =  s => {\n  if (nextChar(s) !== Char.Equals) {\n    return Token.Equals;\n  }\n  if (nextChar(s) !== Char.Equals) {\n    return Token.EqualsEquals;\n  }\n  nextChar(s);\n  return Token.EqualsEqualsEquals;\n};\n\n// &, &&\nCharScanners[Char.Ampersand] = s => {\n  if (nextChar(s) !== Char.Ampersand) {\n    return Token.Ampersand;\n  }\n  nextChar(s);\n  return Token.AmpersandAmpersand;\n};\n\n// |, ||\nCharScanners[Char.Bar] = s => {\n  if (nextChar(s) !== Char.Bar) {\n    return Token.Bar;\n  }\n  nextChar(s);\n  return Token.BarBar;\n};\n\n// .\nCharScanners[Char.Dot] = s => {\n  if (nextChar(s) <= Char.Nine && s._currentChar >= Char.Zero) {\n    return scanNumber(s, true);\n  }\n  return Token.Dot;\n};\n\n// <, <=\nCharScanners[Char.LessThan] =  s => {\n  if (nextChar(s) !== Char.Equals) {\n    return Token.LessThan;\n  }\n  nextChar(s);\n  return Token.LessThanEquals;\n};\n\n// >, >=\nCharScanners[Char.GreaterThan] =  s => {\n  if (nextChar(s) !== Char.Equals) {\n    return Token.GreaterThan;\n  }\n  nextChar(s);\n  return Token.GreaterThanEquals;\n};\n\nCharScanners[Char.Percent]      = returnToken(Token.Percent);\nCharScanners[Char.OpenParen]    = returnToken(Token.OpenParen);\nCharScanners[Char.CloseParen]   = returnToken(Token.CloseParen);\nCharScanners[Char.Asterisk]     = returnToken(Token.Asterisk);\nCharScanners[Char.Plus]         = returnToken(Token.Plus);\nCharScanners[Char.Comma]        = returnToken(Token.Comma);\nCharScanners[Char.Minus]        = returnToken(Token.Minus);\nCharScanners[Char.Slash]        = returnToken(Token.Slash);\nCharScanners[Char.Colon]        = returnToken(Token.Colon);\nCharScanners[Char.Question]     = returnToken(Token.Question);\nCharScanners[Char.OpenBracket]  = returnToken(Token.OpenBracket);\nCharScanners[Char.CloseBracket] = returnToken(Token.CloseBracket);\nCharScanners[Char.OpenBrace]    = returnToken(Token.OpenBrace);\nCharScanners[Char.CloseBrace]   = returnToken(Token.CloseBrace);\n","import type { IConnectable } from '../observation.js';\n\n/**\n * Current subscription collector\n */\nlet _connectable: IConnectable | null = null;\nconst connectables: IConnectable[] = [];\n// eslint-disable-next-line\nexport let connecting = false;\n\n// todo: layer based collection pause/resume?\nexport function pauseConnecting() {\n  connecting = false;\n}\n\nexport function resumeConnecting() {\n  connecting = true;\n}\n\nexport function currentConnectable(): IConnectable | null {\n  return _connectable;\n}\n\nexport function enterConnectable(connectable: IConnectable): void {\n  if (connectable == null) {\n    if (__DEV__)\n      throw new Error('Connectable cannot be null/undefined');\n    else\n      throw new Error('AUR0206');\n  }\n  if (_connectable == null) {\n    _connectable = connectable;\n    connectables[0] = _connectable;\n    connecting = true;\n    return;\n  }\n  if (_connectable === connectable) {\n    if (__DEV__)\n      throw new Error(`Trying to enter an active connectable`);\n    else\n      throw new Error('AUR0207');\n  }\n  connectables.push(connectable);\n  _connectable = connectable;\n  connecting = true;\n}\n\nexport function exitConnectable(connectable: IConnectable): void {\n  if (connectable == null) {\n    if (__DEV__)\n      throw new Error('Connectable cannot be null/undefined');\n    else\n      throw new Error('AUR0208');\n  }\n  if (_connectable !== connectable) {\n    if (__DEV__)\n      throw new Error(`Trying to exit an unactive connectable`);\n    else\n      throw new Error('AUR0209');\n  }\n\n  connectables.pop();\n  _connectable = connectables.length > 0 ? connectables[connectables.length - 1] : null;\n  connecting = _connectable != null;\n}\n\nexport const ConnectableSwitcher = Object.freeze({\n  get current() {\n    return _connectable;\n  },\n  get connecting() {\n    return connecting;\n  },\n  enter: enterConnectable,\n  exit: exitConnectable,\n  pause: pauseConnecting,\n  resume: resumeConnecting,\n});\n","import { IIndexable } from '@aurelia/kernel';\nimport { connecting, currentConnectable } from './connectable-switcher.js';\n\nconst R$get = Reflect.get;\nconst toStringTag = Object.prototype.toString;\nconst proxyMap = new WeakMap<object, object>();\n\nfunction canWrap(obj: unknown): obj is object {\n  switch (toStringTag.call(obj)) {\n    case '[object Object]':\n    case '[object Array]':\n    case '[object Map]':\n    case '[object Set]':\n    // it's unlikely that methods on the following 2 objects need to be observed for changes\n    // so while they are valid/ we don't wrap them either\n    // case '[object Math]':\n    // case '[object Reflect]':\n      return true;\n    default:\n      return false;\n  }\n}\n\nexport const rawKey = '__raw__';\n\nexport function wrap<T>(v: T): T {\n  return canWrap(v) ? getProxy(v) : v;\n}\nexport function getProxy<T extends object>(obj: T): T {\n  // deepscan-disable-next-line\n  return proxyMap.get(obj) as T ?? createProxy(obj);\n}\n\nexport function getRaw<T extends object>(obj: T): T {\n  // todo: get in a weakmap if null/undef\n  return (obj as IIndexable)[rawKey] as T ?? obj;\n}\nexport function unwrap<T>(v: T): T {\n  return canWrap(v) && (v as IIndexable)[rawKey] as T || v;\n}\n\nfunction doNotCollect(key: PropertyKey): boolean {\n  return key === 'constructor'\n    || key === '__proto__'\n    // probably should revert to v1 naming style for consistency with builtin?\n    // __o__ is shorters & less chance of conflict with other libs as well\n    || key === '$observers'\n    || key === Symbol.toPrimitive\n    || key === Symbol.toStringTag;\n}\n\nfunction createProxy<T extends object>(obj: T): T {\n  const handler: ProxyHandler<object> = obj instanceof Array\n    ? arrayHandler\n    : obj instanceof Map || obj instanceof Set\n      ? collectionHandler\n      : objectHandler;\n\n  const proxiedObj = new Proxy(obj, handler);\n  proxyMap.set(obj, proxiedObj);\n\n  return proxiedObj as T;\n}\n\nconst objectHandler: ProxyHandler<object> = {\n  get(target: IIndexable, key: PropertyKey, receiver: object): unknown {\n    // maybe use symbol?\n    if (key === rawKey) {\n      return target;\n    }\n\n    const connectable = currentConnectable();\n\n    if (!connecting || doNotCollect(key) || connectable == null) {\n      return R$get(target, key, receiver);\n    }\n\n    // todo: static\n    connectable.observe(target, key);\n\n    return wrap(R$get(target, key, receiver));\n  },\n};\n\nconst arrayHandler: ProxyHandler<unknown[]> = {\n  get(target: unknown[], key: PropertyKey, receiver: unknown): unknown {\n    // maybe use symbol?\n    if (key === rawKey) {\n      return target;\n    }\n\n    const connectable = currentConnectable();\n\n    if (!connecting || doNotCollect(key) || connectable == null) {\n      return R$get(target, key, receiver);\n    }\n\n    switch (key) {\n      case 'length':\n        connectable.observe(target, 'length');\n        return target.length;\n      case 'map':\n        return wrappedArrayMap;\n      case 'includes':\n        return wrappedArrayIncludes;\n      case 'indexOf':\n        return wrappedArrayIndexOf;\n      case 'lastIndexOf':\n        return wrappedArrayLastIndexOf;\n      case 'every':\n        return wrappedArrayEvery;\n      case 'filter':\n        return wrappedArrayFilter;\n      case 'find':\n        return wrappedArrayFind;\n      case 'findIndex':\n        return wrappedArrayFindIndex;\n      case 'flat':\n        return wrappedArrayFlat;\n      case 'flatMap':\n        return wrappedArrayFlatMap;\n      case 'join':\n        return wrappedArrayJoin;\n      case 'push':\n        return wrappedArrayPush;\n      case 'pop':\n        return wrappedArrayPop;\n      case 'reduce':\n        return wrappedReduce;\n      case 'reduceRight':\n        return wrappedReduceRight;\n      case 'reverse':\n        return wrappedArrayReverse;\n      case 'shift':\n        return wrappedArrayShift;\n      case 'unshift':\n        return wrappedArrayUnshift;\n      case 'slice':\n        return wrappedArraySlice;\n      case 'splice':\n        return wrappedArraySplice;\n      case 'some':\n        return wrappedArraySome;\n      case 'sort':\n        return wrappedArraySort;\n      case 'keys':\n        return wrappedKeys;\n      case 'values':\n      case Symbol.iterator:\n        return wrappedValues;\n      case 'entries':\n        return wrappedEntries;\n    }\n\n    connectable.observe(target, key);\n\n    return wrap(R$get(target, key, receiver));\n  },\n  // for (let i in array) ...\n  ownKeys(target: unknown[]): (string | symbol)[] {\n    currentConnectable()?.observe(target, 'length');\n    return Reflect.ownKeys(target);\n  },\n};\n\nfunction wrappedArrayMap(this: unknown[], cb: (v: unknown, i: number, arr: unknown[]) => unknown, thisArg?: unknown): unknown {\n  const raw = getRaw(this);\n  const res = raw.map((v, i) =>\n    // do we wrap `thisArg`?\n    unwrap(cb.call(thisArg, wrap(v), i, this))\n  );\n  currentConnectable()?.observeCollection(raw);\n  return wrap(res);\n}\n\nfunction wrappedArrayEvery(this: unknown[], cb: (v: unknown, i: number, arr: unknown[]) => unknown, thisArg?: unknown): boolean {\n  const raw = getRaw(this);\n  const res = raw.every((v, i) => cb.call(thisArg, wrap(v), i, this));\n  currentConnectable()?.observeCollection(raw);\n  return res;\n}\n\nfunction wrappedArrayFilter(this: unknown[], cb: (v: unknown, i: number, arr: unknown[]) => boolean, thisArg?: unknown): unknown[] {\n  const raw = getRaw(this);\n  const res = raw.filter((v, i) =>\n    // do we wrap `thisArg`?\n    unwrap(cb.call(thisArg, wrap(v), i, this))\n  );\n  currentConnectable()?.observeCollection(raw);\n  return wrap(res);\n}\n\nfunction wrappedArrayIncludes(this: unknown[], v: unknown): boolean {\n  const raw = getRaw(this);\n  const res = raw.includes(unwrap(v));\n  currentConnectable()?.observeCollection(raw);\n  return res;\n}\n\nfunction wrappedArrayIndexOf(this: unknown[], v: unknown): number {\n  const raw = getRaw(this);\n  const res = raw.indexOf(unwrap(v));\n  currentConnectable()?.observeCollection(raw);\n  return res;\n}\nfunction wrappedArrayLastIndexOf(this: unknown[], v: unknown): number {\n  const raw = getRaw(this);\n  const res = raw.lastIndexOf(unwrap(v));\n  currentConnectable()?.observeCollection(raw);\n  return res;\n}\nfunction wrappedArrayFindIndex(this: unknown[], cb: (v: unknown, i: number, arr: unknown[]) => boolean, thisArg?: unknown): number {\n  const raw = getRaw(this);\n  const res = raw.findIndex((v, i) => unwrap(cb.call(thisArg, wrap(v), i, this)));\n  currentConnectable()?.observeCollection(raw);\n  return res;\n}\n\nfunction wrappedArrayFind(this: unknown[], cb: (v: unknown, i: number, arr: unknown[]) => boolean, thisArg?: unknown): unknown {\n  const raw = getRaw(this);\n  const res = raw.find((v, i) => cb(wrap(v), i, this), thisArg);\n  currentConnectable()?.observeCollection(raw);\n  return wrap(res);\n}\n\nfunction wrappedArrayFlat(this: unknown[]): unknown[] {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  return wrap(raw.flat());\n}\nfunction wrappedArrayFlatMap(this: unknown[], cb: (v: unknown, i: number, arr: unknown[]) => unknown, thisArg?: unknown): unknown[] {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  return getProxy(raw.flatMap((v, i) =>\n    wrap(cb.call(thisArg, wrap(v), i, this)))\n  );\n}\nfunction wrappedArrayJoin(this: unknown[], separator?: string): string {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  return raw.join(separator);\n}\n\nfunction wrappedArrayPop(this: unknown[]): unknown {\n  return wrap(getRaw(this).pop());\n}\nfunction wrappedArrayPush(this: unknown[], ...args: unknown[]): number {\n  return getRaw(this).push(...args);\n}\nfunction wrappedArrayShift(this: unknown[]): unknown {\n  return wrap(getRaw(this).shift());\n}\nfunction wrappedArrayUnshift(this: unknown[], ...args: unknown[]): unknown {\n  return getRaw(this).unshift(...args);\n}\nfunction wrappedArraySplice(this: unknown[], ...args: [number, number, ...unknown[]]): unknown {\n  return wrap(getRaw(this).splice(...args));\n}\nfunction wrappedArrayReverse(this: unknown[], ..._args: unknown[]): unknown[] {\n  const raw = getRaw(this);\n  const res = raw.reverse();\n  currentConnectable()?.observeCollection(raw);\n  return wrap(res);\n}\n\nfunction wrappedArraySome(this: unknown[], cb: (v: unknown, i: number, arr: unknown[]) => boolean, thisArg?: unknown): boolean {\n  const raw = getRaw(this);\n  const res = raw.some((v, i) => unwrap(cb.call(thisArg, wrap(v), i, this)));\n  currentConnectable()?.observeCollection(raw);\n  return res;\n}\n\nfunction wrappedArraySort(this: unknown[], cb?: (a: unknown, b: unknown) => number): unknown[] {\n  const raw = getRaw(this);\n  const res = raw.sort(cb);\n  currentConnectable()?.observeCollection(raw);\n  return wrap(res);\n}\n\nfunction wrappedArraySlice(this: unknown[], start?: number, end?: number): unknown[] {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  return getProxy(raw.slice(start, end));\n}\n\nfunction wrappedReduce(this: unknown[], cb: (curr: unknown, v: unknown, i: number, arr: unknown[]) => unknown, initValue: unknown): unknown {\n  const raw = getRaw(this);\n  const res = raw.reduce((curr, v, i) => cb(curr, wrap(v), i, this), initValue);\n  currentConnectable()?.observeCollection(raw);\n  return wrap(res);\n}\n\nfunction wrappedReduceRight(this: unknown[], cb: (curr: unknown, v: unknown, i: number, arr: unknown[]) => unknown, initValue: unknown): unknown {\n  const raw = getRaw(this);\n  const res = raw.reduceRight((curr, v, i) => cb(curr, wrap(v), i, this), initValue);\n  currentConnectable()?.observeCollection(raw);\n  return wrap(res);\n}\n\n// the below logic takes inspiration from Vue, Mobx\n// much thanks to them for working out this\nconst collectionHandler: ProxyHandler<$MapOrSet> = {\n  get(target: $MapOrSet, key: PropertyKey, receiver?): unknown {\n    // maybe use symbol?\n    if (key === rawKey) {\n      return target;\n    }\n\n    const connectable = currentConnectable();\n\n    if (!connecting || doNotCollect(key) || connectable == null) {\n      return R$get(target, key, receiver);\n    }\n\n    switch (key) {\n      case 'size':\n        connectable.observe(target, 'size');\n        return target.size;\n      case 'clear':\n        return wrappedClear;\n      case 'delete':\n        return wrappedDelete;\n      case 'forEach':\n        return wrappedForEach;\n      case 'add':\n        if (target instanceof Set) {\n          return wrappedAdd;\n        }\n        break;\n      case 'get':\n        if (target instanceof Map) {\n          return wrappedGet;\n        }\n        break;\n      case 'set':\n        if (target instanceof Map) {\n          return wrappedSet;\n        }\n        break;\n      case 'has':\n        return wrappedHas;\n      case 'keys':\n        return wrappedKeys;\n      case 'values':\n        return wrappedValues;\n      case 'entries':\n        return wrappedEntries;\n      case Symbol.iterator:\n        return target instanceof Map ? wrappedEntries : wrappedValues;\n    }\n\n    return wrap(R$get(target, key, receiver));\n  },\n};\n\ntype $MapOrSet = Map<unknown, unknown> | Set<unknown>;\ntype CollectionMethod = (this: unknown, ...args: unknown[]) => unknown;\n\nfunction wrappedForEach(this: $MapOrSet, cb: CollectionMethod, thisArg?: unknown): void {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  return raw.forEach((v: unknown, key: unknown) => {\n    cb.call(/* should wrap or not?? */thisArg, wrap(v), wrap(key), this);\n  });\n}\n\nfunction wrappedHas(this: $MapOrSet, v: unknown): boolean {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  return raw.has(unwrap(v));\n}\n\nfunction wrappedGet(this: Map<unknown, unknown>, k: unknown): unknown {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  return wrap(raw.get(unwrap(k)));\n}\nfunction wrappedSet(this: Map<unknown, unknown>, k: unknown, v: unknown): Map<unknown, unknown> {\n  return wrap(getRaw(this).set(unwrap(k), unwrap(v)));\n}\n\nfunction wrappedAdd(this: Set<unknown>, v: unknown): Set<unknown> {\n  return wrap(getRaw(this).add(unwrap(v)));\n}\n\nfunction wrappedClear(this: $MapOrSet): void {\n  return wrap(getRaw(this).clear());\n}\n\nfunction wrappedDelete(this: $MapOrSet, k: unknown): boolean {\n  return wrap(getRaw(this).delete(unwrap(k)));\n}\n\nfunction wrappedKeys(this: $MapOrSet | unknown[]): IterableIterator<unknown> {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  const iterator = raw.keys();\n\n  return {\n    next(): IteratorResult<unknown, unknown> {\n      const next = iterator.next();\n      const value = next.value;\n      const done = next.done;\n\n      return done\n        ? { value: void 0, done }\n        : { value: wrap(value), done };\n    },\n    [Symbol.iterator]() {\n      return this;\n    },\n  };\n}\n\nfunction wrappedValues(this: $MapOrSet | unknown[]): IterableIterator<unknown> {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  const iterator = raw.values();\n\n  return {\n    next(): IteratorResult<unknown, unknown> {\n      const next = iterator.next();\n      const value = next.value;\n      const done = next.done;\n\n      return done\n        ? { value: void 0, done }\n        : { value: wrap(value), done };\n    },\n    [Symbol.iterator]() {\n      return this;\n    },\n  };\n}\n\nfunction wrappedEntries(this: $MapOrSet | unknown[]): IterableIterator<unknown> {\n  const raw = getRaw(this);\n  currentConnectable()?.observeCollection(raw);\n  const iterator = raw.entries();\n\n  // return a wrapped iterator which returns observed versions of the\n  // values emitted from the real iterator\n  return {\n    next(): IteratorResult<unknown, unknown> {\n      const next = iterator.next();\n      const value = next.value;\n      const done = next.done;\n\n      return done\n        ? { value: void 0, done }\n        : { value: [wrap(value[0]), wrap(value[1])], done };\n    },\n    [Symbol.iterator]() {\n      return this;\n    },\n  };\n}\n\nexport const ProxyObservable = Object.freeze({\n  getProxy,\n  getRaw,\n  wrap,\n  unwrap,\n  rawKey,\n});\n","import {\n  LifecycleFlags,\n  AccessorType,\n  IObserver,\n} from '../observation.js';\nimport { subscriberCollection } from './subscriber-collection.js';\nimport { enterConnectable, exitConnectable } from './connectable-switcher.js';\nimport { connectable } from '../binding/connectable.js';\nimport { wrap, unwrap } from './proxy-observation.js';\nimport { def, isFunction } from '../utilities-objects.js';\nimport { withFlushQueue } from './flush-queue.js';\n\nimport type {\n  ISubscriber,\n  ICollectionSubscriber,\n  ISubscriberCollection,\n  IConnectable,\n} from '../observation.js';\nimport type { IConnectableBinding } from '../binding/connectable.js';\nimport type { IObserverLocator, ObservableGetter } from './observer-locator.js';\nimport type { FlushQueue, IFlushable, IWithFlushQueue } from './flush-queue.js';\n\nexport interface ComputedObserver extends IConnectableBinding, ISubscriberCollection { }\n\nexport class ComputedObserver implements\n  IObserver,\n  IConnectableBinding,\n  ISubscriber,\n  ICollectionSubscriber,\n  ISubscriberCollection,\n  IWithFlushQueue,\n  IFlushable {\n\n  public static create(\n    obj: object,\n    key: PropertyKey,\n    descriptor: PropertyDescriptor,\n    observerLocator: IObserverLocator,\n    useProxy: boolean,\n  ): ComputedObserver {\n    const getter = descriptor.get!;\n    const setter = descriptor.set;\n    const observer = new ComputedObserver(obj, getter, setter, useProxy, observerLocator);\n    const $get = ((/* Computed Observer */) => observer.getValue()) as ObservableGetter;\n    $get.getObserver = () => observer;\n    def(obj, key, {\n      enumerable: descriptor.enumerable,\n      configurable: true,\n      get: $get,\n      set: (/* Computed Observer */v) => {\n        observer.setValue(v, LifecycleFlags.none);\n      },\n    });\n\n    return observer;\n  }\n\n  public interceptor = this;\n\n  public type: AccessorType = AccessorType.Observer;\n  public readonly queue!: FlushQueue;\n\n  /** @internal */\n  private _value: unknown = void 0;\n  /** @internal */\n  private _oldValue: unknown = void 0;\n\n  // todo: maybe use a counter allow recursive call to a certain level\n  /** @internal */\n  private _isRunning: boolean = false;\n\n  /** @internal */\n  private _isDirty: boolean = false;\n\n  /** @internal */\n  private readonly _obj: object;\n\n  public readonly get: (watcher: IConnectable) => unknown;\n\n  public readonly set: undefined | ((v: unknown) => void);\n\n  /** @internal */\n  private readonly _useProxy: boolean;\n\n  /**\n   * A semi-private property used by connectable mixin\n   */\n  public readonly oL: IObserverLocator;\n\n  public constructor(\n    obj: object,\n    get: (watcher: IConnectable) => unknown,\n    set: undefined | ((v: unknown) => void),\n    useProxy: boolean,\n    observerLocator: IObserverLocator,\n  ) {\n    this._obj = obj;\n    this.get = get;\n    this.set = set;\n    this._useProxy = useProxy;\n    this.oL = observerLocator;\n  }\n\n  public getValue() {\n    if (this.subs.count === 0) {\n      return this.get.call(this._obj, this);\n    }\n    if (this._isDirty) {\n      this.compute();\n      this._isDirty = false;\n    }\n    return this._value;\n  }\n\n  // deepscan-disable-next-line\n  public setValue(v: unknown, _flags: LifecycleFlags): void {\n    if (isFunction(this.set)) {\n      if (v !== this._value) {\n        // setting running true as a form of batching\n        this._isRunning = true;\n        this.set.call(this._obj, v);\n        this._isRunning = false;\n\n        this.run();\n      }\n    } else {\n      if (__DEV__)\n        throw new Error('Property is readonly');\n      else\n        throw new Error('AUR0221');\n    }\n  }\n\n  public handleChange(): void {\n    this._isDirty = true;\n    if (this.subs.count > 0) {\n      this.run();\n    }\n  }\n\n  public handleCollectionChange(): void {\n    this._isDirty = true;\n    if (this.subs.count > 0) {\n      this.run();\n    }\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    // in theory, a collection subscriber could be added before a property subscriber\n    // and it should be handled similarly in subscribeToCollection\n    // though not handling for now, and wait until the merge of normal + collection subscription\n    if (this.subs.add(subscriber) && this.subs.count === 1) {\n      this.compute();\n      this._isDirty = false;\n    }\n  }\n\n  public unsubscribe(subscriber: ISubscriber): void {\n    if (this.subs.remove(subscriber) && this.subs.count === 0) {\n      this._isDirty = true;\n      this.obs.clearAll();\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, LifecycleFlags.none);\n  }\n\n  private run(): void {\n    if (this._isRunning) {\n      return;\n    }\n    const oldValue = this._value;\n    const newValue = this.compute();\n\n    this._isDirty = false;\n\n    if (!Object.is(newValue, oldValue)) {\n      this._oldValue = oldValue;\n      this.queue.add(this);\n    }\n  }\n\n  private compute(): unknown {\n    this._isRunning = true;\n    this.obs.version++;\n    try {\n      enterConnectable(this);\n      return this._value = unwrap(this.get.call(this._useProxy ? wrap(this._obj) : this._obj, this));\n    } finally {\n      this.obs.clear();\n      this._isRunning = false;\n      exitConnectable(this);\n    }\n  }\n}\n\nconnectable(ComputedObserver);\nsubscriberCollection(ComputedObserver);\nwithFlushQueue(ComputedObserver);\n\n// a reusable variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n","import { DI, IPlatform } from '@aurelia/kernel';\nimport { AccessorType, IObserver, ISubscriberCollection, LifecycleFlags } from '../observation.js';\nimport { subscriberCollection } from './subscriber-collection.js';\n\nimport type { IIndexable, ITask, QueueTaskOptions } from '@aurelia/kernel';\nimport type { IObservable, ISubscriber } from '../observation';\nimport { FlushQueue, IFlushable, IWithFlushQueue, withFlushQueue } from './flush-queue.js';\n\nexport interface IDirtyChecker extends DirtyChecker {}\nexport const IDirtyChecker = DI.createInterface<IDirtyChecker>('IDirtyChecker', x => x.singleton(DirtyChecker));\n\nexport const DirtyCheckSettings = {\n  /**\n   * Default: `6`\n   *\n   * Adjust the global dirty check frequency.\n   * Measures in \"timeouts per check\", such that (given a default of 250 timeouts per second in modern browsers):\n   * - A value of 1 will result in 250 dirty checks per second (or 1 dirty check per second for an inactive tab)\n   * - A value of 25 will result in 10 dirty checks per second (or 1 dirty check per 25 seconds for an inactive tab)\n   */\n  timeoutsPerCheck: 25,\n  /**\n   * Default: `false`\n   *\n   * Disable dirty-checking entirely. Properties that cannot be observed without dirty checking\n   * or an adapter, will simply not be observed.\n   */\n  disabled: false,\n  /**\n   * Default: `false`\n   *\n   * Throw an error if a property is being dirty-checked.\n   */\n  throw: false,\n  /**\n   * Resets all dirty checking settings to the framework's defaults.\n   */\n  resetToDefault(): void {\n    this.timeoutsPerCheck = 6;\n    this.disabled = false;\n    this.throw = false;\n  }\n};\n\nconst queueTaskOpts: QueueTaskOptions = {\n  persistent: true,\n};\n\nexport class DirtyChecker implements IWithFlushQueue {\n  /**\n   * @internal\n   */\n  public static inject = [IPlatform];\n  public readonly queue!: FlushQueue;\n  private readonly tracked: DirtyCheckProperty[] = [];\n\n  private _task: ITask | null = null;\n  private _elapsedFrames: number = 0;\n\n  public constructor(\n    private readonly p: IPlatform,\n  ) {}\n\n  public createProperty(obj: object, key: string): DirtyCheckProperty {\n    if (DirtyCheckSettings.throw) {\n      if (__DEV__)\n        throw new Error(`Property '${key}' is being dirty-checked.`);\n      else\n        throw new Error(`AUR0222:${key}`);\n    }\n    return new DirtyCheckProperty(this, obj as IIndexable, key);\n  }\n\n  public addProperty(property: DirtyCheckProperty): void {\n    this.tracked.push(property);\n\n    if (this.tracked.length === 1) {\n      this._task = this.p.taskQueue.queueTask(this.check, queueTaskOpts);\n    }\n  }\n\n  public removeProperty(property: DirtyCheckProperty): void {\n    this.tracked.splice(this.tracked.indexOf(property), 1);\n    if (this.tracked.length === 0) {\n      this._task!.cancel();\n      this._task = null;\n    }\n  }\n\n  private readonly check = () => {\n    if (DirtyCheckSettings.disabled) {\n      return;\n    }\n    if (++this._elapsedFrames < DirtyCheckSettings.timeoutsPerCheck) {\n      return;\n    }\n    this._elapsedFrames = 0;\n    const tracked = this.tracked;\n    const len = tracked.length;\n    let current: DirtyCheckProperty;\n    let i = 0;\n    for (; i < len; ++i) {\n      current = tracked[i];\n      if (current.isDirty()) {\n        this.queue.add(current);\n      }\n    }\n  };\n}\n\nwithFlushQueue(DirtyChecker);\n\nexport interface DirtyCheckProperty extends IObserver, ISubscriberCollection { }\n\nexport class DirtyCheckProperty implements DirtyCheckProperty, IFlushable {\n  public type: AccessorType = AccessorType.None;\n\n  /** @internal */\n  private _oldValue: unknown = void 0;\n  /** @internal */\n  private readonly _dirtyChecker: IDirtyChecker;\n\n  public constructor(\n    dirtyChecker: IDirtyChecker,\n    public obj: IObservable & IIndexable,\n    public key: string,\n  ) {\n    this._dirtyChecker = dirtyChecker;\n  }\n\n  public getValue() {\n    return this.obj[this.key];\n  }\n\n  public setValue(v: unknown, f: LifecycleFlags) {\n    // todo: this should be allowed, probably\n    // but the construction of dirty checker should throw instead\n    throw new Error(`Trying to set value for property ${this.key} in dirty checker`);\n  }\n\n  public isDirty(): boolean {\n    return this._oldValue !== this.obj[this.key];\n  }\n\n  public flush(): void {\n    const oldValue = this._oldValue;\n    const newValue = this.getValue();\n\n    this._oldValue = newValue;\n    this.subs.notify(newValue, oldValue, LifecycleFlags.none);\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (this.subs.add(subscriber) && this.subs.count === 1) {\n      this._oldValue = this.obj[this.key];\n      this._dirtyChecker.addProperty(this);\n    }\n  }\n\n  public unsubscribe(subscriber: ISubscriber): void {\n    if (this.subs.remove(subscriber) && this.subs.count === 0) {\n      this._dirtyChecker.removeProperty(this);\n    }\n  }\n}\n\nsubscriberCollection(DirtyCheckProperty);\n","import { Primitive } from '@aurelia/kernel';\nimport { AccessorType } from '../observation.js';\n\nimport type { IAccessor, ISubscribable } from '../observation.js';\n\nexport class PrimitiveObserver implements IAccessor, ISubscribable {\n  public get doNotCache(): true { return true; }\n  public type: AccessorType = AccessorType.None;\n  /** @internal */\n  private readonly _obj: Primitive;\n  /** @internal */\n  private readonly _key: PropertyKey;\n\n  public constructor(\n    obj: Primitive,\n    key: PropertyKey,\n  ) {\n    this._obj = obj;\n    this._key = key;\n  }\n\n  public getValue(): unknown {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-explicit-any\n    return (this._obj as any)[this._key];\n  }\n  public setValue(): void { /* do nothing */ }\n  public subscribe(): void { /* do nothing */ }\n  public unsubscribe(): void { /* do nothing */ }\n}\n","import { AccessorType, LifecycleFlags } from '../observation.js';\nimport type { IAccessor, IObservable } from '../observation.js';\n\nexport class PropertyAccessor implements IAccessor {\n  // the only thing can be guaranteed is it's an object\n  // even if this property accessor is used to access an element\n  public type: AccessorType = AccessorType.None;\n\n  public getValue(obj: object, key: string): unknown {\n    return (obj as IObservable)[key];\n  }\n\n  public setValue(value: unknown, flags: LifecycleFlags, obj: object, key: string): void {\n    (obj as IObservable)[key] = value;\n  }\n}\n","import { AccessorType, LifecycleFlags } from '../observation.js';\nimport { subscriberCollection } from './subscriber-collection.js';\nimport { def, isFunction } from '../utilities-objects.js';\n\nimport type { IIndexable } from '@aurelia/kernel';\nimport type {\n  IAccessor,\n  InterceptorFunc,\n  ISubscriber,\n  ISubscriberCollection,\n} from '../observation.js';\nimport { FlushQueue, IFlushable, IWithFlushQueue, withFlushQueue } from './flush-queue.js';\n\n// a reusable variable for `.flush()` methods of observers\n// so that there doesn't need to create an env record for every call\nlet oV: unknown = void 0;\n\nexport interface SetterObserver extends IAccessor, ISubscriberCollection {}\n\n/**\n * Observer for the mutation of object property value employing getter-setter strategy.\n * This is used for observing object properties that has no decorator.\n */\nexport class SetterObserver implements IWithFlushQueue, IFlushable {\n  // todo(bigopon): tweak the flag based on typeof obj (array/set/map/iterator/proxy etc...)\n  public type: AccessorType = AccessorType.Observer;\n\n  /** @internal */\n  private _value: unknown = void 0;\n  /** @internal */\n  private _oldValue: unknown = void 0;\n  /** @internal */\n  private _observing: boolean = false;\n  public readonly queue!: FlushQueue;\n\n  /** @internal */\n  private f: LifecycleFlags = LifecycleFlags.none;\n  private readonly _obj: IIndexable;\n  private readonly _key: string;\n\n  public constructor(\n    obj: IIndexable,\n    key: string,\n  ) {\n    this._obj = obj;\n    this._key = key;\n  }\n\n  public getValue(): unknown {\n    return this._value;\n  }\n\n  public setValue(newValue: unknown, flags: LifecycleFlags): void {\n    if (this._observing) {\n      if (Object.is(newValue, this._value)) {\n        return;\n      }\n      this._oldValue = this._value;\n      this._value = newValue;\n      this.f = flags;\n      this.queue.add(this);\n    } else {\n      // If subscribe() has been called, the target property descriptor is replaced by these getter/setter methods,\n      // so calling obj[propertyKey] will actually return this.value.\n      // However, if subscribe() was not yet called (indicated by !this.observing), the target descriptor\n      // is unmodified and we need to explicitly set the property value.\n      // This will happen in one-time, to-view and two-way bindings during $bind, meaning that the $bind will not actually update the target value.\n      // This wasn't visible in vCurrent due to connect-queue always doing a delayed update, so in many cases it didn't matter whether $bind updated the target or not.\n      this._obj[this._key] = newValue;\n    }\n  }\n\n  public subscribe(subscriber: ISubscriber): void {\n    if (this._observing === false) {\n      this.start();\n    }\n\n    this.subs.add(subscriber);\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, this.f);\n  }\n\n  public start(): this {\n    if (this._observing === false) {\n      this._observing = true;\n      this._value = this._obj[this._key];\n      def(\n        this._obj,\n        this._key,\n        {\n          enumerable: true,\n          configurable: true,\n          get: (/* Setter Observer */) => this.getValue(),\n          set: (/* Setter Observer */value) => {\n            this.setValue(value, LifecycleFlags.none);\n          },\n        },\n      );\n    }\n    return this;\n  }\n\n  public stop(): this {\n    if (this._observing) {\n      def(this._obj, this._key, {\n        enumerable: true,\n        configurable: true,\n        writable: true,\n        value: this._value,\n      });\n      this._observing = false;\n      // todo(bigopon/fred): add .removeAllSubscribers()\n    }\n    return this;\n  }\n}\n\ntype ChangeHandlerCallback = (this: object, value: unknown, oldValue: unknown, flags: LifecycleFlags) => void;\n\nexport interface SetterNotifier extends IAccessor, ISubscriberCollection {}\n\nexport class SetterNotifier implements IAccessor, IWithFlushQueue, IFlushable {\n  public readonly type: AccessorType = AccessorType.Observer;\n  public readonly queue!: FlushQueue;\n\n  /** @internal */\n  private _value: unknown = void 0;\n  /** @internal */\n  private _oldValue: unknown = void 0;\n  /** @internal */\n  private f: LifecycleFlags = LifecycleFlags.none;\n  /** @internal */\n  private readonly cb?: ChangeHandlerCallback;\n  /** @internal */\n  private readonly _obj: object;\n  /** @internal */\n  private readonly _setter: InterceptorFunc | undefined;\n  /** @internal */\n  private readonly _hasSetter: boolean;\n\n  public constructor(\n    obj: object,\n    callbackKey: PropertyKey,\n    set: InterceptorFunc | undefined,\n    initialValue: unknown,\n  ) {\n    this._obj = obj;\n    this._setter = set;\n    this._hasSetter = isFunction(set);\n    const callback = (obj as IIndexable)[callbackKey as string];\n    this.cb = isFunction(callback) ? callback as ChangeHandlerCallback : void 0;\n    this._value = initialValue;\n  }\n\n  public getValue(): unknown {\n    return this._value;\n  }\n\n  public setValue(value: unknown, flags: LifecycleFlags): void {\n    if (this._hasSetter) {\n      value = this._setter!(value, null);\n    }\n    if (!Object.is(value, this._value)) {\n      this._oldValue = this._value;\n      this._value = value;\n      this.f = flags;\n      this.cb?.call(this._obj, this._value, this._oldValue, flags);\n      this.queue.add(this);\n    }\n  }\n\n  public flush(): void {\n    oV = this._oldValue;\n    this._oldValue = this._value;\n    this.subs.notify(this._value, oV, this.f);\n  }\n}\n\nsubscriberCollection(SetterObserver);\nsubscriberCollection(SetterNotifier);\nwithFlushQueue(SetterObserver);\nwithFlushQueue(SetterNotifier);\n","import { DI, Primitive, isArrayIndex, ILogger } from '@aurelia/kernel';\nimport { getArrayObserver } from './array-observer.js';\nimport { ComputedObserver } from './computed-observer.js';\nimport { IDirtyChecker } from './dirty-checker.js';\nimport { getMapObserver } from './map-observer.js';\nimport { PrimitiveObserver } from './primitive-observer.js';\nimport { PropertyAccessor } from './property-accessor.js';\nimport { getSetObserver } from './set-observer.js';\nimport { SetterObserver } from './setter-observer.js';\nimport { def, hasOwnProp } from '../utilities-objects.js';\n\nimport type {\n  Collection,\n  IAccessor,\n  ICollectionObserver,\n  IObservable,\n  IObserver,\n  AccessorOrObserver,\n  CollectionKind,\n  CollectionObserver,\n} from '../observation.js';\n\nexport const propertyAccessor = new PropertyAccessor();\n\nexport interface IObjectObservationAdapter {\n  getObserver(object: unknown, propertyName: string, descriptor: PropertyDescriptor, requestor: IObserverLocator): AccessorOrObserver | null;\n}\n\nexport interface IObserverLocator extends ObserverLocator {}\nexport const IObserverLocator = DI.createInterface<IObserverLocator>('IObserverLocator', x => x.singleton(ObserverLocator));\n\nexport interface INodeObserverLocator {\n  handles(obj: unknown, key: PropertyKey, requestor: IObserverLocator): boolean;\n  getObserver(obj: object, key: PropertyKey, requestor: IObserverLocator): IAccessor | IObserver;\n  getAccessor(obj: object, key: PropertyKey, requestor: IObserverLocator): IAccessor | IObserver;\n}\nexport const INodeObserverLocator = DI\n  .createInterface<INodeObserverLocator>('INodeObserverLocator', x => x.cachedCallback(handler => {\n    handler.getAll(ILogger).forEach(logger => {\n      logger.error('Using default INodeObserverLocator implementation. Will not be able to observe nodes (HTML etc...).');\n    });\n    return new DefaultNodeObserverLocator();\n  }));\n\nclass DefaultNodeObserverLocator implements INodeObserverLocator {\n  public handles(): boolean {\n    return false;\n  }\n  public getObserver(): IAccessor | IObserver {\n    return propertyAccessor;\n  }\n  public getAccessor(): IAccessor | IObserver {\n    return propertyAccessor;\n  }\n}\n\nexport type ExtendedPropertyDescriptor = PropertyDescriptor & {\n  get?: ObservableGetter;\n  set?: ObservableSetter;\n};\nexport type ObservableGetter = PropertyDescriptor['get'] & {\n  getObserver?(obj: unknown, requestor: IObserverLocator): IObserver;\n};\nexport type ObservableSetter = PropertyDescriptor['set'] & {\n  getObserver?(obj: unknown, requestor: IObserverLocator): IObserver;\n};\n\nexport class ObserverLocator {\n  protected static readonly inject = [IDirtyChecker, INodeObserverLocator];\n\n  private readonly _adapters: IObjectObservationAdapter[] = [];\n\n  public constructor(\n    private readonly _dirtyChecker: IDirtyChecker,\n    private readonly _nodeObserverLocator: INodeObserverLocator,\n  ) {}\n\n  public addAdapter(adapter: IObjectObservationAdapter): void {\n    this._adapters.push(adapter);\n  }\n\n  public getObserver(obj: object, key: PropertyKey): IObserver {\n    return (obj as IObservable).$observers?.[key as string] as IObserver | undefined\n      ?? this._cache((obj as IObservable), key as string, this.createObserver((obj as IObservable), key as string)) as IObserver;\n  }\n\n  public getAccessor(obj: object, key: string): AccessorOrObserver {\n    const cached = (obj as IObservable).$observers?.[key];\n    if (cached !== void 0) {\n      return cached;\n    }\n    if (this._nodeObserverLocator.handles(obj, key, this)) {\n      return this._nodeObserverLocator.getAccessor(obj, key, this) as AccessorOrObserver;\n    }\n\n    return propertyAccessor;\n  }\n\n  public getArrayObserver(observedArray: unknown[]): ICollectionObserver<CollectionKind.array> {\n    return getArrayObserver(observedArray);\n  }\n\n  public getMapObserver(observedMap: Map<unknown, unknown>): ICollectionObserver<CollectionKind.map>  {\n    return getMapObserver(observedMap);\n  }\n\n  public getSetObserver(observedSet: Set<unknown>): ICollectionObserver<CollectionKind.set>  {\n    return getSetObserver(observedSet);\n  }\n\n  private createObserver(obj: IObservable, key: string): AccessorOrObserver {\n    if (!(obj instanceof Object)) {\n      return new PrimitiveObserver(obj as unknown as Primitive, key);\n    }\n\n    if (this._nodeObserverLocator.handles(obj, key, this)) {\n      return this._nodeObserverLocator.getObserver(obj, key, this) as AccessorOrObserver;\n    }\n\n    switch (key) {\n      case 'length':\n        if (obj instanceof Array) {\n          return getArrayObserver(obj).getLengthObserver();\n        }\n        break;\n      case 'size':\n        if (obj instanceof Map) {\n          return getMapObserver(obj).getLengthObserver();\n        } else if (obj instanceof Set) {\n          return getSetObserver(obj).getLengthObserver();\n        }\n        break;\n      default:\n        if (obj instanceof Array && isArrayIndex(key)) {\n          return getArrayObserver(obj).getIndexObserver(Number(key));\n        }\n        break;\n    }\n\n    let pd = getOwnPropDesc(obj, key) as ExtendedPropertyDescriptor;\n    // Only instance properties will yield a descriptor here, otherwise walk up the proto chain\n    if (pd === void 0) {\n      let proto = getProto(obj) as object | null;\n      while (proto !== null) {\n        pd = getOwnPropDesc(proto, key) as ExtendedPropertyDescriptor;\n        if (pd === void 0) {\n          proto = getProto(proto) as object | null;\n        } else {\n          break;\n        }\n      }\n    }\n\n    // If the descriptor does not have a 'value' prop, it must have a getter and/or setter\n    if (pd !== void 0 && !hasOwnProp.call(pd, 'value')) {\n      let obs: AccessorOrObserver | undefined | null = this._getAdapterObserver(obj, key, pd);\n      if (obs == null) {\n        obs = (pd.get?.getObserver ?? pd.set?.getObserver)?.(obj, this) as AccessorOrObserver;\n      }\n\n      return obs == null\n        ? pd.configurable\n          ? ComputedObserver.create(obj, key, pd, this, /* AOT: not true for IE11 */ true)\n          : this._dirtyChecker.createProperty(obj, key)\n        : obs;\n    }\n\n    // Ordinary get/set observation (the common use case)\n    // TODO: think about how to handle a data property that does not sit on the instance (should we do anything different?)\n    return new SetterObserver(obj, key);\n  }\n\n  private _getAdapterObserver(obj: IObservable, propertyName: string, pd: PropertyDescriptor): AccessorOrObserver | null {\n    if (this._adapters.length > 0) {\n      for (const adapter of this._adapters) {\n        const observer = adapter.getObserver(obj, propertyName, pd, this);\n        if (observer != null) {\n          return observer;\n        }\n      }\n    }\n    return null;\n  }\n\n  private _cache(obj: IObservable, key: string, observer: AccessorOrObserver): AccessorOrObserver {\n    if (observer.doNotCache === true) {\n      return observer;\n    }\n    if (obj.$observers === void 0) {\n      def(obj, '$observers', { value: { [key]: observer } });\n      return observer;\n    }\n    return obj.$observers[key] = observer;\n  }\n}\n\nexport type RepeatableCollection = Collection | null | undefined | number;\n\nexport function getCollectionObserver(collection: RepeatableCollection): CollectionObserver | undefined {\n  let obs: CollectionObserver | undefined;\n  if (collection instanceof Array) {\n    obs = getArrayObserver(collection);\n  } else if (collection instanceof Map) {\n    obs = getMapObserver(collection);\n  } else if (collection instanceof Set) {\n    obs = getSetObserver(collection);\n  }\n  return obs;\n}\n\nconst getProto = Object.getPrototypeOf;\nconst getOwnPropDesc = Object.getOwnPropertyDescriptor;\n","import { DI } from '@aurelia/kernel';\nimport { connectable } from '../binding/connectable.js';\nimport { enterConnectable, exitConnectable } from './connectable-switcher.js';\nimport { IObserverLocator } from './observer-locator.js';\n\nimport type { ICollectionSubscriber, IConnectable, ISubscriber } from '../observation.js';\nimport type { BindingObserverRecord } from '../binding/connectable.js';\n\nexport interface IObservation extends Observation {}\nexport const IObservation = DI.createInterface<IObservation>('IObservation', x => x.singleton(Observation));\n\nexport class Observation implements IObservation {\n\n  public static get inject() { return [IObserverLocator]; }\n\n  public constructor(\n    private readonly oL: IObserverLocator,\n  ) {}\n\n  /**\n   * Run an effect function an track the dependencies inside it,\n   * to re-run whenever a dependency has changed\n   */\n  public run(fn: EffectFunc): IEffect {\n    const effect = new Effect(this.oL, fn);\n    // todo: batch effect run after it's in\n    effect.run();\n    return effect;\n  }\n}\n\nexport type EffectFunc = (runner: IConnectable) => void;\nexport interface IEffect extends IConnectable {\n  run(): void;\n  stop(): void;\n}\n\ninterface Effect extends IConnectable {}\nclass Effect implements IEffect, ISubscriber, ICollectionSubscriber {\n\n  public readonly interceptor: this = this;\n  public readonly obs!: BindingObserverRecord;\n  // to configure this, potentially a 2nd parameter is needed for run\n  public maxRunCount: number = 10;\n  private queued: boolean = false;\n  private running: boolean = false;\n  private runCount: number = 0;\n  private stopped: boolean = false;\n\n  public constructor(\n    public readonly oL: IObserverLocator,\n    public readonly fn: EffectFunc,\n  ) {\n  }\n\n  public handleChange(): void {\n    this.queued = true;\n    this.run();\n  }\n\n  public handleCollectionChange(): void {\n    this.queued = true;\n    this.run();\n  }\n\n  public run(): void {\n    if (this.stopped) {\n      if (__DEV__)\n        throw new Error('Effect has already been stopped');\n      else\n        throw new Error('AUR0225');\n    }\n    if (this.running) {\n      return;\n    }\n    ++this.runCount;\n    this.running = true;\n    this.queued = false;\n    ++this.obs.version;\n    try {\n      enterConnectable(this);\n      this.fn(this);\n    } finally {\n      this.obs.clear();\n      this.running = false;\n      exitConnectable(this);\n    }\n    // when doing this.fn(this), there's a chance that it has recursive effect\n    // continue to run for a certain number before bailing\n    // whenever there's a dependency change while running, this.queued will be true\n    // so we use it as an indicator to continue to run the effect\n    if (this.queued) {\n      if (this.runCount > this.maxRunCount) {\n        this.runCount = 0;\n        if (__DEV__)\n          throw new Error('Maximum number of recursive effect run reached. Consider handle effect dependencies differently.');\n        else\n          throw new Error(`AUR0226`);\n      }\n      this.run();\n    } else {\n      this.runCount = 0;\n    }\n  }\n\n  public stop(): void {\n    this.stopped = true;\n    this.obs.clearAll();\n  }\n}\n\nconnectable(Effect);\n","import { IObserver, LifecycleFlags } from '../observation.js';\nimport { SetterNotifier } from './setter-observer.js';\nimport { def } from '../utilities-objects.js';\nimport { currentConnectable } from './connectable-switcher.js';\n\nimport type { Constructable, IIndexable } from '@aurelia/kernel';\nimport type { IBindingContext, InterceptorFunc, IObservable } from '../observation.js';\nimport type { ObservableGetter } from './observer-locator.js';\nimport type { SetterObserver } from './setter-observer.js';\n\nexport interface IObservableDefinition {\n  name?: PropertyKey;\n  callback?: PropertyKey;\n  set?: InterceptorFunc;\n}\n\nfunction getObserversLookup(obj: IObservable): IIndexable<{}, SetterObserver | SetterNotifier> {\n  if (obj.$observers === void 0) {\n    def(obj, '$observers', { value: {} });\n    // todo: define in a weakmap\n  }\n  return obj.$observers as IIndexable<{}, SetterObserver | SetterNotifier>;\n}\n\nconst noValue: unknown = {};\n\ntype SetterObserverOwningObject = IIndexable<IBindingContext, IObserver>;\n\n// for\n//    class {\n//      @observable prop\n//    }\nexport function observable(target: Constructable['prototype'], key: PropertyKey, descriptor?: PropertyDescriptor & { initializer?: () => unknown }): void;\n// for\n//    @observable({...})\n//    class {}\n// and\n//    class {\n//      @observable({...}) prop\n//    }\nexport function observable(config: IObservableDefinition): (target: Constructable | Constructable['prototype'], ...args: unknown[]) => void;\n// for\n//    @observable('') class {}\n//    @observable(5) class {}\n//    @observable(Symbol()) class {}\nexport function observable(key: PropertyKey): ClassDecorator;\n// for:\n//    class {\n//      @observable() prop\n//    }\nexport function observable(): PropertyDecorator;\n// impl, wont be seen\nexport function observable(\n  targetOrConfig?: Constructable | Constructable['prototype'] | PropertyKey | IObservableDefinition,\n  key?: PropertyKey,\n  descriptor?: PropertyDescriptor\n): ClassDecorator | PropertyDecorator {\n  // either this check, or arguments.length === 3\n  // or could be both, so can throw against user error for better DX\n  if (key == null) {\n    // for:\n    //    @observable('prop')\n    //    class {}\n    //\n    //    @observable({ name: 'prop', callback: ... })\n    //    class {}\n    //\n    //    class {\n    //      @observable() prop\n    //      @observable({ callback: ... }) prop2\n    //    }\n    return ((t: Constructable, k: PropertyKey, d: PropertyDescriptor) => deco(t, k, d, targetOrConfig as PropertyKey | IObservableDefinition)) as ClassDecorator;\n  }\n  // for:\n  //    class {\n  //      @observable prop\n  //    }\n  return deco(targetOrConfig, key, descriptor) as PropertyDecorator;\n\n  function deco(\n    target: Constructable | Constructable['prototype'],\n    key?: PropertyKey,\n    descriptor?: PropertyDescriptor & { initializer?: CallableFunction },\n    config?: PropertyKey | IObservableDefinition,\n  ): void | PropertyDescriptor {\n    // class decorator?\n    const isClassDecorator = key === void 0;\n    config = typeof config !== 'object'\n      ? { name: config }\n      // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n      : (config || {});\n\n    if (isClassDecorator) {\n      key = config.name;\n    }\n\n    if (key == null || key === '') {\n      if (__DEV__)\n        throw new Error('Invalid usage, cannot determine property name for @observable');\n      else\n        throw new Error('AUR0224');\n    }\n\n    // determine callback name based on config or convention.\n    // eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing, @typescript-eslint/strict-boolean-expressions\n    const callback = config.callback || `${String(key)}Changed`;\n    let initialValue = noValue;\n    if (descriptor) {\n      // we're adding a getter and setter which means the property descriptor\n      // cannot have a \"value\" or \"writable\" attribute\n      delete descriptor.value;\n      delete descriptor.writable;\n      initialValue = descriptor.initializer?.();\n      delete descriptor.initializer;\n    } else {\n      descriptor = { configurable: true };\n    }\n\n    // make the accessor enumerable by default, as fields are enumerable\n    if (!('enumerable' in descriptor)) {\n      descriptor.enumerable = true;\n    }\n\n    // todo(bigopon/fred): discuss string api for converter\n    const $set = config.set;\n    descriptor.get = function g(/* @observable */this: SetterObserverOwningObject) {\n      const notifier = getNotifier(this, key!, callback, initialValue, $set);\n      currentConnectable()?.subscribeTo(notifier);\n      return notifier.getValue();\n    };\n    descriptor.set = function s(/* @observable */this: SetterObserverOwningObject, newValue: unknown) {\n      getNotifier(this, key!, callback, initialValue, $set).setValue(newValue, LifecycleFlags.none);\n    };\n    (descriptor.get as ObservableGetter).getObserver = function gO(/* @observable */obj: SetterObserverOwningObject) {\n      return getNotifier(obj, key!, callback, initialValue, $set);\n    };\n\n    if (isClassDecorator) {\n      def((target as Constructable).prototype as object, key, descriptor);\n    } else {\n      return descriptor;\n    }\n  }\n}\n\nfunction getNotifier(\n  obj: SetterObserverOwningObject,\n  key: PropertyKey,\n  callbackKey: PropertyKey,\n  initialValue: unknown,\n  set: InterceptorFunc | undefined,\n): SetterNotifier {\n  const lookup = getObserversLookup(obj) as unknown as Record<PropertyKey, SetterObserver | SetterNotifier>;\n  let notifier = lookup[key as string] as SetterNotifier;\n  if (notifier == null) {\n    notifier = new SetterNotifier(obj, callbackKey, set, initialValue === noValue ? void 0 : initialValue);\n    lookup[key as string] = notifier;\n  }\n  return notifier;\n}\n\n/*\n          | typescript       | babel\n----------|------------------|-------------------------\nproperty  | config           | config\nw/parens  | target, key      | target, key, descriptor\n----------|------------------|-------------------------\nproperty  | target, key      | target, key, descriptor\nno parens | n/a              | n/a\n----------|------------------|-------------------------\nclass     | config           | config\n          | target           | target\n*/\n",null,"/*!\n * Quill Editor v1.3.7\n * https://quilljs.com/\n * Copyright (c) 2014, Jason Chen\n * Copyright (c) 2013, salesforce.com\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Quill\"] = factory();\n\telse\n\t\troot[\"Quill\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 109);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar container_1 = __webpack_require__(17);\nvar format_1 = __webpack_require__(18);\nvar leaf_1 = __webpack_require__(19);\nvar scroll_1 = __webpack_require__(45);\nvar inline_1 = __webpack_require__(46);\nvar block_1 = __webpack_require__(47);\nvar embed_1 = __webpack_require__(48);\nvar text_1 = __webpack_require__(49);\nvar attributor_1 = __webpack_require__(12);\nvar class_1 = __webpack_require__(32);\nvar style_1 = __webpack_require__(33);\nvar store_1 = __webpack_require__(31);\nvar Registry = __webpack_require__(1);\nvar Parchment = {\n    Scope: Registry.Scope,\n    create: Registry.create,\n    find: Registry.find,\n    query: Registry.query,\n    register: Registry.register,\n    Container: container_1.default,\n    Format: format_1.default,\n    Leaf: leaf_1.default,\n    Embed: embed_1.default,\n    Scroll: scroll_1.default,\n    Block: block_1.default,\n    Inline: inline_1.default,\n    Text: text_1.default,\n    Attributor: {\n        Attribute: attributor_1.default,\n        Class: class_1.default,\n        Style: style_1.default,\n        Store: store_1.default,\n    },\n};\nexports.default = Parchment;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ParchmentError = /** @class */ (function (_super) {\n    __extends(ParchmentError, _super);\n    function ParchmentError(message) {\n        var _this = this;\n        message = '[Parchment] ' + message;\n        _this = _super.call(this, message) || this;\n        _this.message = message;\n        _this.name = _this.constructor.name;\n        return _this;\n    }\n    return ParchmentError;\n}(Error));\nexports.ParchmentError = ParchmentError;\nvar attributes = {};\nvar classes = {};\nvar tags = {};\nvar types = {};\nexports.DATA_KEY = '__blot';\nvar Scope;\n(function (Scope) {\n    Scope[Scope[\"TYPE\"] = 3] = \"TYPE\";\n    Scope[Scope[\"LEVEL\"] = 12] = \"LEVEL\";\n    Scope[Scope[\"ATTRIBUTE\"] = 13] = \"ATTRIBUTE\";\n    Scope[Scope[\"BLOT\"] = 14] = \"BLOT\";\n    Scope[Scope[\"INLINE\"] = 7] = \"INLINE\";\n    Scope[Scope[\"BLOCK\"] = 11] = \"BLOCK\";\n    Scope[Scope[\"BLOCK_BLOT\"] = 10] = \"BLOCK_BLOT\";\n    Scope[Scope[\"INLINE_BLOT\"] = 6] = \"INLINE_BLOT\";\n    Scope[Scope[\"BLOCK_ATTRIBUTE\"] = 9] = \"BLOCK_ATTRIBUTE\";\n    Scope[Scope[\"INLINE_ATTRIBUTE\"] = 5] = \"INLINE_ATTRIBUTE\";\n    Scope[Scope[\"ANY\"] = 15] = \"ANY\";\n})(Scope = exports.Scope || (exports.Scope = {}));\nfunction create(input, value) {\n    var match = query(input);\n    if (match == null) {\n        throw new ParchmentError(\"Unable to create \" + input + \" blot\");\n    }\n    var BlotClass = match;\n    var node = \n    // @ts-ignore\n    input instanceof Node || input['nodeType'] === Node.TEXT_NODE ? input : BlotClass.create(value);\n    return new BlotClass(node, value);\n}\nexports.create = create;\nfunction find(node, bubble) {\n    if (bubble === void 0) { bubble = false; }\n    if (node == null)\n        return null;\n    // @ts-ignore\n    if (node[exports.DATA_KEY] != null)\n        return node[exports.DATA_KEY].blot;\n    if (bubble)\n        return find(node.parentNode, bubble);\n    return null;\n}\nexports.find = find;\nfunction query(query, scope) {\n    if (scope === void 0) { scope = Scope.ANY; }\n    var match;\n    if (typeof query === 'string') {\n        match = types[query] || attributes[query];\n        // @ts-ignore\n    }\n    else if (query instanceof Text || query['nodeType'] === Node.TEXT_NODE) {\n        match = types['text'];\n    }\n    else if (typeof query === 'number') {\n        if (query & Scope.LEVEL & Scope.BLOCK) {\n            match = types['block'];\n        }\n        else if (query & Scope.LEVEL & Scope.INLINE) {\n            match = types['inline'];\n        }\n    }\n    else if (query instanceof HTMLElement) {\n        var names = (query.getAttribute('class') || '').split(/\\s+/);\n        for (var i in names) {\n            match = classes[names[i]];\n            if (match)\n                break;\n        }\n        match = match || tags[query.tagName];\n    }\n    if (match == null)\n        return null;\n    // @ts-ignore\n    if (scope & Scope.LEVEL & match.scope && scope & Scope.TYPE & match.scope)\n        return match;\n    return null;\n}\nexports.query = query;\nfunction register() {\n    var Definitions = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        Definitions[_i] = arguments[_i];\n    }\n    if (Definitions.length > 1) {\n        return Definitions.map(function (d) {\n            return register(d);\n        });\n    }\n    var Definition = Definitions[0];\n    if (typeof Definition.blotName !== 'string' && typeof Definition.attrName !== 'string') {\n        throw new ParchmentError('Invalid definition');\n    }\n    else if (Definition.blotName === 'abstract') {\n        throw new ParchmentError('Cannot register abstract class');\n    }\n    types[Definition.blotName || Definition.attrName] = Definition;\n    if (typeof Definition.keyName === 'string') {\n        attributes[Definition.keyName] = Definition;\n    }\n    else {\n        if (Definition.className != null) {\n            classes[Definition.className] = Definition;\n        }\n        if (Definition.tagName != null) {\n            if (Array.isArray(Definition.tagName)) {\n                Definition.tagName = Definition.tagName.map(function (tagName) {\n                    return tagName.toUpperCase();\n                });\n            }\n            else {\n                Definition.tagName = Definition.tagName.toUpperCase();\n            }\n            var tagNames = Array.isArray(Definition.tagName) ? Definition.tagName : [Definition.tagName];\n            tagNames.forEach(function (tag) {\n                if (tags[tag] == null || Definition.className == null) {\n                    tags[tag] = Definition;\n                }\n            });\n        }\n    }\n    return Definition;\n}\nexports.register = register;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar diff = __webpack_require__(51);\nvar equal = __webpack_require__(11);\nvar extend = __webpack_require__(3);\nvar op = __webpack_require__(20);\n\n\nvar NULL_CHARACTER = String.fromCharCode(0);  // Placeholder char for embed in diff()\n\n\nvar Delta = function (ops) {\n  // Assume we are given a well formed ops\n  if (Array.isArray(ops)) {\n    this.ops = ops;\n  } else if (ops != null && Array.isArray(ops.ops)) {\n    this.ops = ops.ops;\n  } else {\n    this.ops = [];\n  }\n};\n\n\nDelta.prototype.insert = function (text, attributes) {\n  var newOp = {};\n  if (text.length === 0) return this;\n  newOp.insert = text;\n  if (attributes != null && typeof attributes === 'object' && Object.keys(attributes).length > 0) {\n    newOp.attributes = attributes;\n  }\n  return this.push(newOp);\n};\n\nDelta.prototype['delete'] = function (length) {\n  if (length <= 0) return this;\n  return this.push({ 'delete': length });\n};\n\nDelta.prototype.retain = function (length, attributes) {\n  if (length <= 0) return this;\n  var newOp = { retain: length };\n  if (attributes != null && typeof attributes === 'object' && Object.keys(attributes).length > 0) {\n    newOp.attributes = attributes;\n  }\n  return this.push(newOp);\n};\n\nDelta.prototype.push = function (newOp) {\n  var index = this.ops.length;\n  var lastOp = this.ops[index - 1];\n  newOp = extend(true, {}, newOp);\n  if (typeof lastOp === 'object') {\n    if (typeof newOp['delete'] === 'number' && typeof lastOp['delete'] === 'number') {\n      this.ops[index - 1] = { 'delete': lastOp['delete'] + newOp['delete'] };\n      return this;\n    }\n    // Since it does not matter if we insert before or after deleting at the same index,\n    // always prefer to insert first\n    if (typeof lastOp['delete'] === 'number' && newOp.insert != null) {\n      index -= 1;\n      lastOp = this.ops[index - 1];\n      if (typeof lastOp !== 'object') {\n        this.ops.unshift(newOp);\n        return this;\n      }\n    }\n    if (equal(newOp.attributes, lastOp.attributes)) {\n      if (typeof newOp.insert === 'string' && typeof lastOp.insert === 'string') {\n        this.ops[index - 1] = { insert: lastOp.insert + newOp.insert };\n        if (typeof newOp.attributes === 'object') this.ops[index - 1].attributes = newOp.attributes\n        return this;\n      } else if (typeof newOp.retain === 'number' && typeof lastOp.retain === 'number') {\n        this.ops[index - 1] = { retain: lastOp.retain + newOp.retain };\n        if (typeof newOp.attributes === 'object') this.ops[index - 1].attributes = newOp.attributes\n        return this;\n      }\n    }\n  }\n  if (index === this.ops.length) {\n    this.ops.push(newOp);\n  } else {\n    this.ops.splice(index, 0, newOp);\n  }\n  return this;\n};\n\nDelta.prototype.chop = function () {\n  var lastOp = this.ops[this.ops.length - 1];\n  if (lastOp && lastOp.retain && !lastOp.attributes) {\n    this.ops.pop();\n  }\n  return this;\n};\n\nDelta.prototype.filter = function (predicate) {\n  return this.ops.filter(predicate);\n};\n\nDelta.prototype.forEach = function (predicate) {\n  this.ops.forEach(predicate);\n};\n\nDelta.prototype.map = function (predicate) {\n  return this.ops.map(predicate);\n};\n\nDelta.prototype.partition = function (predicate) {\n  var passed = [], failed = [];\n  this.forEach(function(op) {\n    var target = predicate(op) ? passed : failed;\n    target.push(op);\n  });\n  return [passed, failed];\n};\n\nDelta.prototype.reduce = function (predicate, initial) {\n  return this.ops.reduce(predicate, initial);\n};\n\nDelta.prototype.changeLength = function () {\n  return this.reduce(function (length, elem) {\n    if (elem.insert) {\n      return length + op.length(elem);\n    } else if (elem.delete) {\n      return length - elem.delete;\n    }\n    return length;\n  }, 0);\n};\n\nDelta.prototype.length = function () {\n  return this.reduce(function (length, elem) {\n    return length + op.length(elem);\n  }, 0);\n};\n\nDelta.prototype.slice = function (start, end) {\n  start = start || 0;\n  if (typeof end !== 'number') end = Infinity;\n  var ops = [];\n  var iter = op.iterator(this.ops);\n  var index = 0;\n  while (index < end && iter.hasNext()) {\n    var nextOp;\n    if (index < start) {\n      nextOp = iter.next(start - index);\n    } else {\n      nextOp = iter.next(end - index);\n      ops.push(nextOp);\n    }\n    index += op.length(nextOp);\n  }\n  return new Delta(ops);\n};\n\n\nDelta.prototype.compose = function (other) {\n  var thisIter = op.iterator(this.ops);\n  var otherIter = op.iterator(other.ops);\n  var ops = [];\n  var firstOther = otherIter.peek();\n  if (firstOther != null && typeof firstOther.retain === 'number' && firstOther.attributes == null) {\n    var firstLeft = firstOther.retain;\n    while (thisIter.peekType() === 'insert' && thisIter.peekLength() <= firstLeft) {\n      firstLeft -= thisIter.peekLength();\n      ops.push(thisIter.next());\n    }\n    if (firstOther.retain - firstLeft > 0) {\n      otherIter.next(firstOther.retain - firstLeft);\n    }\n  }\n  var delta = new Delta(ops);\n  while (thisIter.hasNext() || otherIter.hasNext()) {\n    if (otherIter.peekType() === 'insert') {\n      delta.push(otherIter.next());\n    } else if (thisIter.peekType() === 'delete') {\n      delta.push(thisIter.next());\n    } else {\n      var length = Math.min(thisIter.peekLength(), otherIter.peekLength());\n      var thisOp = thisIter.next(length);\n      var otherOp = otherIter.next(length);\n      if (typeof otherOp.retain === 'number') {\n        var newOp = {};\n        if (typeof thisOp.retain === 'number') {\n          newOp.retain = length;\n        } else {\n          newOp.insert = thisOp.insert;\n        }\n        // Preserve null when composing with a retain, otherwise remove it for inserts\n        var attributes = op.attributes.compose(thisOp.attributes, otherOp.attributes, typeof thisOp.retain === 'number');\n        if (attributes) newOp.attributes = attributes;\n        delta.push(newOp);\n\n        // Optimization if rest of other is just retain\n        if (!otherIter.hasNext() && equal(delta.ops[delta.ops.length - 1], newOp)) {\n          var rest = new Delta(thisIter.rest());\n          return delta.concat(rest).chop();\n        }\n\n      // Other op should be delete, we could be an insert or retain\n      // Insert + delete cancels out\n      } else if (typeof otherOp['delete'] === 'number' && typeof thisOp.retain === 'number') {\n        delta.push(otherOp);\n      }\n    }\n  }\n  return delta.chop();\n};\n\nDelta.prototype.concat = function (other) {\n  var delta = new Delta(this.ops.slice());\n  if (other.ops.length > 0) {\n    delta.push(other.ops[0]);\n    delta.ops = delta.ops.concat(other.ops.slice(1));\n  }\n  return delta;\n};\n\nDelta.prototype.diff = function (other, index) {\n  if (this.ops === other.ops) {\n    return new Delta();\n  }\n  var strings = [this, other].map(function (delta) {\n    return delta.map(function (op) {\n      if (op.insert != null) {\n        return typeof op.insert === 'string' ? op.insert : NULL_CHARACTER;\n      }\n      var prep = (delta === other) ? 'on' : 'with';\n      throw new Error('diff() called ' + prep + ' non-document');\n    }).join('');\n  });\n  var delta = new Delta();\n  var diffResult = diff(strings[0], strings[1], index);\n  var thisIter = op.iterator(this.ops);\n  var otherIter = op.iterator(other.ops);\n  diffResult.forEach(function (component) {\n    var length = component[1].length;\n    while (length > 0) {\n      var opLength = 0;\n      switch (component[0]) {\n        case diff.INSERT:\n          opLength = Math.min(otherIter.peekLength(), length);\n          delta.push(otherIter.next(opLength));\n          break;\n        case diff.DELETE:\n          opLength = Math.min(length, thisIter.peekLength());\n          thisIter.next(opLength);\n          delta['delete'](opLength);\n          break;\n        case diff.EQUAL:\n          opLength = Math.min(thisIter.peekLength(), otherIter.peekLength(), length);\n          var thisOp = thisIter.next(opLength);\n          var otherOp = otherIter.next(opLength);\n          if (equal(thisOp.insert, otherOp.insert)) {\n            delta.retain(opLength, op.attributes.diff(thisOp.attributes, otherOp.attributes));\n          } else {\n            delta.push(otherOp)['delete'](opLength);\n          }\n          break;\n      }\n      length -= opLength;\n    }\n  });\n  return delta.chop();\n};\n\nDelta.prototype.eachLine = function (predicate, newline) {\n  newline = newline || '\\n';\n  var iter = op.iterator(this.ops);\n  var line = new Delta();\n  var i = 0;\n  while (iter.hasNext()) {\n    if (iter.peekType() !== 'insert') return;\n    var thisOp = iter.peek();\n    var start = op.length(thisOp) - iter.peekLength();\n    var index = typeof thisOp.insert === 'string' ?\n      thisOp.insert.indexOf(newline, start) - start : -1;\n    if (index < 0) {\n      line.push(iter.next());\n    } else if (index > 0) {\n      line.push(iter.next(index));\n    } else {\n      if (predicate(line, iter.next(1).attributes || {}, i) === false) {\n        return;\n      }\n      i += 1;\n      line = new Delta();\n    }\n  }\n  if (line.length() > 0) {\n    predicate(line, {}, i);\n  }\n};\n\nDelta.prototype.transform = function (other, priority) {\n  priority = !!priority;\n  if (typeof other === 'number') {\n    return this.transformPosition(other, priority);\n  }\n  var thisIter = op.iterator(this.ops);\n  var otherIter = op.iterator(other.ops);\n  var delta = new Delta();\n  while (thisIter.hasNext() || otherIter.hasNext()) {\n    if (thisIter.peekType() === 'insert' && (priority || otherIter.peekType() !== 'insert')) {\n      delta.retain(op.length(thisIter.next()));\n    } else if (otherIter.peekType() === 'insert') {\n      delta.push(otherIter.next());\n    } else {\n      var length = Math.min(thisIter.peekLength(), otherIter.peekLength());\n      var thisOp = thisIter.next(length);\n      var otherOp = otherIter.next(length);\n      if (thisOp['delete']) {\n        // Our delete either makes their delete redundant or removes their retain\n        continue;\n      } else if (otherOp['delete']) {\n        delta.push(otherOp);\n      } else {\n        // We retain either their retain or insert\n        delta.retain(length, op.attributes.transform(thisOp.attributes, otherOp.attributes, priority));\n      }\n    }\n  }\n  return delta.chop();\n};\n\nDelta.prototype.transformPosition = function (index, priority) {\n  priority = !!priority;\n  var thisIter = op.iterator(this.ops);\n  var offset = 0;\n  while (thisIter.hasNext() && offset <= index) {\n    var length = thisIter.peekLength();\n    var nextType = thisIter.peekType();\n    thisIter.next();\n    if (nextType === 'delete') {\n      index -= Math.min(length, index - offset);\n      continue;\n    } else if (nextType === 'insert' && (offset < index || !priority)) {\n      index += length;\n    }\n    offset += length;\n  }\n  return index;\n};\n\n\nmodule.exports = Delta;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\n'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\nvar defineProperty = Object.defineProperty;\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\n// If name is '__proto__', and Object.defineProperty is available, define __proto__ as an own property on target\nvar setProperty = function setProperty(target, options) {\n\tif (defineProperty && options.name === '__proto__') {\n\t\tdefineProperty(target, options.name, {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true,\n\t\t\tvalue: options.newValue,\n\t\t\twritable: true\n\t\t});\n\t} else {\n\t\ttarget[options.name] = options.newValue;\n\t}\n};\n\n// Return undefined instead of __proto__ if '__proto__' is not an own property\nvar getProperty = function getProperty(obj, name) {\n\tif (name === '__proto__') {\n\t\tif (!hasOwn.call(obj, name)) {\n\t\t\treturn void 0;\n\t\t} else if (gOPD) {\n\t\t\t// In early versions of node, obj['__proto__'] is buggy when obj has\n\t\t\t// __proto__ as an own property. Object.getOwnPropertyDescriptor() works.\n\t\t\treturn gOPD(obj, name).value;\n\t\t}\n\t}\n\n\treturn obj[name];\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = getProperty(target, name);\n\t\t\t\tcopy = getProperty(options, name);\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: extend(deep, clone, copy) });\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: copy });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.BlockEmbed = exports.bubbleFormats = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _extend = __webpack_require__(3);\n\nvar _extend2 = _interopRequireDefault(_extend);\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _break = __webpack_require__(16);\n\nvar _break2 = _interopRequireDefault(_break);\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nvar _text = __webpack_require__(7);\n\nvar _text2 = _interopRequireDefault(_text);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar NEWLINE_LENGTH = 1;\n\nvar BlockEmbed = function (_Parchment$Embed) {\n  _inherits(BlockEmbed, _Parchment$Embed);\n\n  function BlockEmbed() {\n    _classCallCheck(this, BlockEmbed);\n\n    return _possibleConstructorReturn(this, (BlockEmbed.__proto__ || Object.getPrototypeOf(BlockEmbed)).apply(this, arguments));\n  }\n\n  _createClass(BlockEmbed, [{\n    key: 'attach',\n    value: function attach() {\n      _get(BlockEmbed.prototype.__proto__ || Object.getPrototypeOf(BlockEmbed.prototype), 'attach', this).call(this);\n      this.attributes = new _parchment2.default.Attributor.Store(this.domNode);\n    }\n  }, {\n    key: 'delta',\n    value: function delta() {\n      return new _quillDelta2.default().insert(this.value(), (0, _extend2.default)(this.formats(), this.attributes.values()));\n    }\n  }, {\n    key: 'format',\n    value: function format(name, value) {\n      var attribute = _parchment2.default.query(name, _parchment2.default.Scope.BLOCK_ATTRIBUTE);\n      if (attribute != null) {\n        this.attributes.attribute(attribute, value);\n      }\n    }\n  }, {\n    key: 'formatAt',\n    value: function formatAt(index, length, name, value) {\n      this.format(name, value);\n    }\n  }, {\n    key: 'insertAt',\n    value: function insertAt(index, value, def) {\n      if (typeof value === 'string' && value.endsWith('\\n')) {\n        var block = _parchment2.default.create(Block.blotName);\n        this.parent.insertBefore(block, index === 0 ? this : this.next);\n        block.insertAt(0, value.slice(0, -1));\n      } else {\n        _get(BlockEmbed.prototype.__proto__ || Object.getPrototypeOf(BlockEmbed.prototype), 'insertAt', this).call(this, index, value, def);\n      }\n    }\n  }]);\n\n  return BlockEmbed;\n}(_parchment2.default.Embed);\n\nBlockEmbed.scope = _parchment2.default.Scope.BLOCK_BLOT;\n// It is important for cursor behavior BlockEmbeds use tags that are block level elements\n\n\nvar Block = function (_Parchment$Block) {\n  _inherits(Block, _Parchment$Block);\n\n  function Block(domNode) {\n    _classCallCheck(this, Block);\n\n    var _this2 = _possibleConstructorReturn(this, (Block.__proto__ || Object.getPrototypeOf(Block)).call(this, domNode));\n\n    _this2.cache = {};\n    return _this2;\n  }\n\n  _createClass(Block, [{\n    key: 'delta',\n    value: function delta() {\n      if (this.cache.delta == null) {\n        this.cache.delta = this.descendants(_parchment2.default.Leaf).reduce(function (delta, leaf) {\n          if (leaf.length() === 0) {\n            return delta;\n          } else {\n            return delta.insert(leaf.value(), bubbleFormats(leaf));\n          }\n        }, new _quillDelta2.default()).insert('\\n', bubbleFormats(this));\n      }\n      return this.cache.delta;\n    }\n  }, {\n    key: 'deleteAt',\n    value: function deleteAt(index, length) {\n      _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'deleteAt', this).call(this, index, length);\n      this.cache = {};\n    }\n  }, {\n    key: 'formatAt',\n    value: function formatAt(index, length, name, value) {\n      if (length <= 0) return;\n      if (_parchment2.default.query(name, _parchment2.default.Scope.BLOCK)) {\n        if (index + length === this.length()) {\n          this.format(name, value);\n        }\n      } else {\n        _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'formatAt', this).call(this, index, Math.min(length, this.length() - index - 1), name, value);\n      }\n      this.cache = {};\n    }\n  }, {\n    key: 'insertAt',\n    value: function insertAt(index, value, def) {\n      if (def != null) return _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'insertAt', this).call(this, index, value, def);\n      if (value.length === 0) return;\n      var lines = value.split('\\n');\n      var text = lines.shift();\n      if (text.length > 0) {\n        if (index < this.length() - 1 || this.children.tail == null) {\n          _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'insertAt', this).call(this, Math.min(index, this.length() - 1), text);\n        } else {\n          this.children.tail.insertAt(this.children.tail.length(), text);\n        }\n        this.cache = {};\n      }\n      var block = this;\n      lines.reduce(function (index, line) {\n        block = block.split(index, true);\n        block.insertAt(0, line);\n        return line.length;\n      }, index + text.length);\n    }\n  }, {\n    key: 'insertBefore',\n    value: function insertBefore(blot, ref) {\n      var head = this.children.head;\n      _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'insertBefore', this).call(this, blot, ref);\n      if (head instanceof _break2.default) {\n        head.remove();\n      }\n      this.cache = {};\n    }\n  }, {\n    key: 'length',\n    value: function length() {\n      if (this.cache.length == null) {\n        this.cache.length = _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'length', this).call(this) + NEWLINE_LENGTH;\n      }\n      return this.cache.length;\n    }\n  }, {\n    key: 'moveChildren',\n    value: function moveChildren(target, ref) {\n      _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'moveChildren', this).call(this, target, ref);\n      this.cache = {};\n    }\n  }, {\n    key: 'optimize',\n    value: function optimize(context) {\n      _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'optimize', this).call(this, context);\n      this.cache = {};\n    }\n  }, {\n    key: 'path',\n    value: function path(index) {\n      return _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'path', this).call(this, index, true);\n    }\n  }, {\n    key: 'removeChild',\n    value: function removeChild(child) {\n      _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'removeChild', this).call(this, child);\n      this.cache = {};\n    }\n  }, {\n    key: 'split',\n    value: function split(index) {\n      var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (force && (index === 0 || index >= this.length() - NEWLINE_LENGTH)) {\n        var clone = this.clone();\n        if (index === 0) {\n          this.parent.insertBefore(clone, this);\n          return this;\n        } else {\n          this.parent.insertBefore(clone, this.next);\n          return clone;\n        }\n      } else {\n        var next = _get(Block.prototype.__proto__ || Object.getPrototypeOf(Block.prototype), 'split', this).call(this, index, force);\n        this.cache = {};\n        return next;\n      }\n    }\n  }]);\n\n  return Block;\n}(_parchment2.default.Block);\n\nBlock.blotName = 'block';\nBlock.tagName = 'P';\nBlock.defaultChild = 'break';\nBlock.allowedChildren = [_inline2.default, _parchment2.default.Embed, _text2.default];\n\nfunction bubbleFormats(blot) {\n  var formats = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (blot == null) return formats;\n  if (typeof blot.formats === 'function') {\n    formats = (0, _extend2.default)(formats, blot.formats());\n  }\n  if (blot.parent == null || blot.parent.blotName == 'scroll' || blot.parent.statics.scope !== blot.statics.scope) {\n    return formats;\n  }\n  return bubbleFormats(blot.parent, formats);\n}\n\nexports.bubbleFormats = bubbleFormats;\nexports.BlockEmbed = BlockEmbed;\nexports.default = Block;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.overload = exports.expandConfig = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n__webpack_require__(50);\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _editor = __webpack_require__(14);\n\nvar _editor2 = _interopRequireDefault(_editor);\n\nvar _emitter3 = __webpack_require__(8);\n\nvar _emitter4 = _interopRequireDefault(_emitter3);\n\nvar _module = __webpack_require__(9);\n\nvar _module2 = _interopRequireDefault(_module);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _selection = __webpack_require__(15);\n\nvar _selection2 = _interopRequireDefault(_selection);\n\nvar _extend = __webpack_require__(3);\n\nvar _extend2 = _interopRequireDefault(_extend);\n\nvar _logger = __webpack_require__(10);\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _theme = __webpack_require__(34);\n\nvar _theme2 = _interopRequireDefault(_theme);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar debug = (0, _logger2.default)('quill');\n\nvar Quill = function () {\n  _createClass(Quill, null, [{\n    key: 'debug',\n    value: function debug(limit) {\n      if (limit === true) {\n        limit = 'log';\n      }\n      _logger2.default.level(limit);\n    }\n  }, {\n    key: 'find',\n    value: function find(node) {\n      return node.__quill || _parchment2.default.find(node);\n    }\n  }, {\n    key: 'import',\n    value: function _import(name) {\n      if (this.imports[name] == null) {\n        debug.error('Cannot import ' + name + '. Are you sure it was registered?');\n      }\n      return this.imports[name];\n    }\n  }, {\n    key: 'register',\n    value: function register(path, target) {\n      var _this = this;\n\n      var overwrite = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (typeof path !== 'string') {\n        var name = path.attrName || path.blotName;\n        if (typeof name === 'string') {\n          // register(Blot | Attributor, overwrite)\n          this.register('formats/' + name, path, target);\n        } else {\n          Object.keys(path).forEach(function (key) {\n            _this.register(key, path[key], target);\n          });\n        }\n      } else {\n        if (this.imports[path] != null && !overwrite) {\n          debug.warn('Overwriting ' + path + ' with', target);\n        }\n        this.imports[path] = target;\n        if ((path.startsWith('blots/') || path.startsWith('formats/')) && target.blotName !== 'abstract') {\n          _parchment2.default.register(target);\n        } else if (path.startsWith('modules') && typeof target.register === 'function') {\n          target.register();\n        }\n      }\n    }\n  }]);\n\n  function Quill(container) {\n    var _this2 = this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Quill);\n\n    this.options = expandConfig(container, options);\n    this.container = this.options.container;\n    if (this.container == null) {\n      return debug.error('Invalid Quill container', container);\n    }\n    if (this.options.debug) {\n      Quill.debug(this.options.debug);\n    }\n    var html = this.container.innerHTML.trim();\n    this.container.classList.add('ql-container');\n    this.container.innerHTML = '';\n    this.container.__quill = this;\n    this.root = this.addContainer('ql-editor');\n    this.root.classList.add('ql-blank');\n    this.root.setAttribute('data-gramm', false);\n    this.scrollingContainer = this.options.scrollingContainer || this.root;\n    this.emitter = new _emitter4.default();\n    this.scroll = _parchment2.default.create(this.root, {\n      emitter: this.emitter,\n      whitelist: this.options.formats\n    });\n    this.editor = new _editor2.default(this.scroll);\n    this.selection = new _selection2.default(this.scroll, this.emitter);\n    this.theme = new this.options.theme(this, this.options);\n    this.keyboard = this.theme.addModule('keyboard');\n    this.clipboard = this.theme.addModule('clipboard');\n    this.history = this.theme.addModule('history');\n    this.theme.init();\n    this.emitter.on(_emitter4.default.events.EDITOR_CHANGE, function (type) {\n      if (type === _emitter4.default.events.TEXT_CHANGE) {\n        _this2.root.classList.toggle('ql-blank', _this2.editor.isBlank());\n      }\n    });\n    this.emitter.on(_emitter4.default.events.SCROLL_UPDATE, function (source, mutations) {\n      var range = _this2.selection.lastRange;\n      var index = range && range.length === 0 ? range.index : undefined;\n      modify.call(_this2, function () {\n        return _this2.editor.update(null, mutations, index);\n      }, source);\n    });\n    var contents = this.clipboard.convert('<div class=\\'ql-editor\\' style=\"white-space: normal;\">' + html + '<p><br></p></div>');\n    this.setContents(contents);\n    this.history.clear();\n    if (this.options.placeholder) {\n      this.root.setAttribute('data-placeholder', this.options.placeholder);\n    }\n    if (this.options.readOnly) {\n      this.disable();\n    }\n  }\n\n  _createClass(Quill, [{\n    key: 'addContainer',\n    value: function addContainer(container) {\n      var refNode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n      if (typeof container === 'string') {\n        var className = container;\n        container = document.createElement('div');\n        container.classList.add(className);\n      }\n      this.container.insertBefore(container, refNode);\n      return container;\n    }\n  }, {\n    key: 'blur',\n    value: function blur() {\n      this.selection.setRange(null);\n    }\n  }, {\n    key: 'deleteText',\n    value: function deleteText(index, length, source) {\n      var _this3 = this;\n\n      var _overload = overload(index, length, source);\n\n      var _overload2 = _slicedToArray(_overload, 4);\n\n      index = _overload2[0];\n      length = _overload2[1];\n      source = _overload2[3];\n\n      return modify.call(this, function () {\n        return _this3.editor.deleteText(index, length);\n      }, source, index, -1 * length);\n    }\n  }, {\n    key: 'disable',\n    value: function disable() {\n      this.enable(false);\n    }\n  }, {\n    key: 'enable',\n    value: function enable() {\n      var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n      this.scroll.enable(enabled);\n      this.container.classList.toggle('ql-disabled', !enabled);\n    }\n  }, {\n    key: 'focus',\n    value: function focus() {\n      var scrollTop = this.scrollingContainer.scrollTop;\n      this.selection.focus();\n      this.scrollingContainer.scrollTop = scrollTop;\n      this.scrollIntoView();\n    }\n  }, {\n    key: 'format',\n    value: function format(name, value) {\n      var _this4 = this;\n\n      var source = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : _emitter4.default.sources.API;\n\n      return modify.call(this, function () {\n        var range = _this4.getSelection(true);\n        var change = new _quillDelta2.default();\n        if (range == null) {\n          return change;\n        } else if (_parchment2.default.query(name, _parchment2.default.Scope.BLOCK)) {\n          change = _this4.editor.formatLine(range.index, range.length, _defineProperty({}, name, value));\n        } else if (range.length === 0) {\n          _this4.selection.format(name, value);\n          return change;\n        } else {\n          change = _this4.editor.formatText(range.index, range.length, _defineProperty({}, name, value));\n        }\n        _this4.setSelection(range, _emitter4.default.sources.SILENT);\n        return change;\n      }, source);\n    }\n  }, {\n    key: 'formatLine',\n    value: function formatLine(index, length, name, value, source) {\n      var _this5 = this;\n\n      var formats = void 0;\n\n      var _overload3 = overload(index, length, name, value, source);\n\n      var _overload4 = _slicedToArray(_overload3, 4);\n\n      index = _overload4[0];\n      length = _overload4[1];\n      formats = _overload4[2];\n      source = _overload4[3];\n\n      return modify.call(this, function () {\n        return _this5.editor.formatLine(index, length, formats);\n      }, source, index, 0);\n    }\n  }, {\n    key: 'formatText',\n    value: function formatText(index, length, name, value, source) {\n      var _this6 = this;\n\n      var formats = void 0;\n\n      var _overload5 = overload(index, length, name, value, source);\n\n      var _overload6 = _slicedToArray(_overload5, 4);\n\n      index = _overload6[0];\n      length = _overload6[1];\n      formats = _overload6[2];\n      source = _overload6[3];\n\n      return modify.call(this, function () {\n        return _this6.editor.formatText(index, length, formats);\n      }, source, index, 0);\n    }\n  }, {\n    key: 'getBounds',\n    value: function getBounds(index) {\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var bounds = void 0;\n      if (typeof index === 'number') {\n        bounds = this.selection.getBounds(index, length);\n      } else {\n        bounds = this.selection.getBounds(index.index, index.length);\n      }\n      var containerBounds = this.container.getBoundingClientRect();\n      return {\n        bottom: bounds.bottom - containerBounds.top,\n        height: bounds.height,\n        left: bounds.left - containerBounds.left,\n        right: bounds.right - containerBounds.left,\n        top: bounds.top - containerBounds.top,\n        width: bounds.width\n      };\n    }\n  }, {\n    key: 'getContents',\n    value: function getContents() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getLength() - index;\n\n      var _overload7 = overload(index, length);\n\n      var _overload8 = _slicedToArray(_overload7, 2);\n\n      index = _overload8[0];\n      length = _overload8[1];\n\n      return this.editor.getContents(index, length);\n    }\n  }, {\n    key: 'getFormat',\n    value: function getFormat() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.getSelection(true);\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      if (typeof index === 'number') {\n        return this.editor.getFormat(index, length);\n      } else {\n        return this.editor.getFormat(index.index, index.length);\n      }\n    }\n  }, {\n    key: 'getIndex',\n    value: function getIndex(blot) {\n      return blot.offset(this.scroll);\n    }\n  }, {\n    key: 'getLength',\n    value: function getLength() {\n      return this.scroll.length();\n    }\n  }, {\n    key: 'getLeaf',\n    value: function getLeaf(index) {\n      return this.scroll.leaf(index);\n    }\n  }, {\n    key: 'getLine',\n    value: function getLine(index) {\n      return this.scroll.line(index);\n    }\n  }, {\n    key: 'getLines',\n    value: function getLines() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Number.MAX_VALUE;\n\n      if (typeof index !== 'number') {\n        return this.scroll.lines(index.index, index.length);\n      } else {\n        return this.scroll.lines(index, length);\n      }\n    }\n  }, {\n    key: 'getModule',\n    value: function getModule(name) {\n      return this.theme.modules[name];\n    }\n  }, {\n    key: 'getSelection',\n    value: function getSelection() {\n      var focus = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (focus) this.focus();\n      this.update(); // Make sure we access getRange with editor in consistent state\n      return this.selection.getRange()[0];\n    }\n  }, {\n    key: 'getText',\n    value: function getText() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getLength() - index;\n\n      var _overload9 = overload(index, length);\n\n      var _overload10 = _slicedToArray(_overload9, 2);\n\n      index = _overload10[0];\n      length = _overload10[1];\n\n      return this.editor.getText(index, length);\n    }\n  }, {\n    key: 'hasFocus',\n    value: function hasFocus() {\n      return this.selection.hasFocus();\n    }\n  }, {\n    key: 'insertEmbed',\n    value: function insertEmbed(index, embed, value) {\n      var _this7 = this;\n\n      var source = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Quill.sources.API;\n\n      return modify.call(this, function () {\n        return _this7.editor.insertEmbed(index, embed, value);\n      }, source, index);\n    }\n  }, {\n    key: 'insertText',\n    value: function insertText(index, text, name, value, source) {\n      var _this8 = this;\n\n      var formats = void 0;\n\n      var _overload11 = overload(index, 0, name, value, source);\n\n      var _overload12 = _slicedToArray(_overload11, 4);\n\n      index = _overload12[0];\n      formats = _overload12[2];\n      source = _overload12[3];\n\n      return modify.call(this, function () {\n        return _this8.editor.insertText(index, text, formats);\n      }, source, index, text.length);\n    }\n  }, {\n    key: 'isEnabled',\n    value: function isEnabled() {\n      return !this.container.classList.contains('ql-disabled');\n    }\n  }, {\n    key: 'off',\n    value: function off() {\n      return this.emitter.off.apply(this.emitter, arguments);\n    }\n  }, {\n    key: 'on',\n    value: function on() {\n      return this.emitter.on.apply(this.emitter, arguments);\n    }\n  }, {\n    key: 'once',\n    value: function once() {\n      return this.emitter.once.apply(this.emitter, arguments);\n    }\n  }, {\n    key: 'pasteHTML',\n    value: function pasteHTML(index, html, source) {\n      this.clipboard.dangerouslyPasteHTML(index, html, source);\n    }\n  }, {\n    key: 'removeFormat',\n    value: function removeFormat(index, length, source) {\n      var _this9 = this;\n\n      var _overload13 = overload(index, length, source);\n\n      var _overload14 = _slicedToArray(_overload13, 4);\n\n      index = _overload14[0];\n      length = _overload14[1];\n      source = _overload14[3];\n\n      return modify.call(this, function () {\n        return _this9.editor.removeFormat(index, length);\n      }, source, index);\n    }\n  }, {\n    key: 'scrollIntoView',\n    value: function scrollIntoView() {\n      this.selection.scrollIntoView(this.scrollingContainer);\n    }\n  }, {\n    key: 'setContents',\n    value: function setContents(delta) {\n      var _this10 = this;\n\n      var source = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _emitter4.default.sources.API;\n\n      return modify.call(this, function () {\n        delta = new _quillDelta2.default(delta);\n        var length = _this10.getLength();\n        var deleted = _this10.editor.deleteText(0, length);\n        var applied = _this10.editor.applyDelta(delta);\n        var lastOp = applied.ops[applied.ops.length - 1];\n        if (lastOp != null && typeof lastOp.insert === 'string' && lastOp.insert[lastOp.insert.length - 1] === '\\n') {\n          _this10.editor.deleteText(_this10.getLength() - 1, 1);\n          applied.delete(1);\n        }\n        var ret = deleted.compose(applied);\n        return ret;\n      }, source);\n    }\n  }, {\n    key: 'setSelection',\n    value: function setSelection(index, length, source) {\n      if (index == null) {\n        this.selection.setRange(null, length || Quill.sources.API);\n      } else {\n        var _overload15 = overload(index, length, source);\n\n        var _overload16 = _slicedToArray(_overload15, 4);\n\n        index = _overload16[0];\n        length = _overload16[1];\n        source = _overload16[3];\n\n        this.selection.setRange(new _selection.Range(index, length), source);\n        if (source !== _emitter4.default.sources.SILENT) {\n          this.selection.scrollIntoView(this.scrollingContainer);\n        }\n      }\n    }\n  }, {\n    key: 'setText',\n    value: function setText(text) {\n      var source = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _emitter4.default.sources.API;\n\n      var delta = new _quillDelta2.default().insert(text);\n      return this.setContents(delta, source);\n    }\n  }, {\n    key: 'update',\n    value: function update() {\n      var source = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _emitter4.default.sources.USER;\n\n      var change = this.scroll.update(source); // Will update selection before selection.update() does if text changes\n      this.selection.update(source);\n      return change;\n    }\n  }, {\n    key: 'updateContents',\n    value: function updateContents(delta) {\n      var _this11 = this;\n\n      var source = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _emitter4.default.sources.API;\n\n      return modify.call(this, function () {\n        delta = new _quillDelta2.default(delta);\n        return _this11.editor.applyDelta(delta, source);\n      }, source, true);\n    }\n  }]);\n\n  return Quill;\n}();\n\nQuill.DEFAULTS = {\n  bounds: null,\n  formats: null,\n  modules: {},\n  placeholder: '',\n  readOnly: false,\n  scrollingContainer: null,\n  strict: true,\n  theme: 'default'\n};\nQuill.events = _emitter4.default.events;\nQuill.sources = _emitter4.default.sources;\n// eslint-disable-next-line no-undef\nQuill.version =  false ? 'dev' : \"1.3.7\";\n\nQuill.imports = {\n  'delta': _quillDelta2.default,\n  'parchment': _parchment2.default,\n  'core/module': _module2.default,\n  'core/theme': _theme2.default\n};\n\nfunction expandConfig(container, userConfig) {\n  userConfig = (0, _extend2.default)(true, {\n    container: container,\n    modules: {\n      clipboard: true,\n      keyboard: true,\n      history: true\n    }\n  }, userConfig);\n  if (!userConfig.theme || userConfig.theme === Quill.DEFAULTS.theme) {\n    userConfig.theme = _theme2.default;\n  } else {\n    userConfig.theme = Quill.import('themes/' + userConfig.theme);\n    if (userConfig.theme == null) {\n      throw new Error('Invalid theme ' + userConfig.theme + '. Did you register it?');\n    }\n  }\n  var themeConfig = (0, _extend2.default)(true, {}, userConfig.theme.DEFAULTS);\n  [themeConfig, userConfig].forEach(function (config) {\n    config.modules = config.modules || {};\n    Object.keys(config.modules).forEach(function (module) {\n      if (config.modules[module] === true) {\n        config.modules[module] = {};\n      }\n    });\n  });\n  var moduleNames = Object.keys(themeConfig.modules).concat(Object.keys(userConfig.modules));\n  var moduleConfig = moduleNames.reduce(function (config, name) {\n    var moduleClass = Quill.import('modules/' + name);\n    if (moduleClass == null) {\n      debug.error('Cannot load ' + name + ' module. Are you sure you registered it?');\n    } else {\n      config[name] = moduleClass.DEFAULTS || {};\n    }\n    return config;\n  }, {});\n  // Special case toolbar shorthand\n  if (userConfig.modules != null && userConfig.modules.toolbar && userConfig.modules.toolbar.constructor !== Object) {\n    userConfig.modules.toolbar = {\n      container: userConfig.modules.toolbar\n    };\n  }\n  userConfig = (0, _extend2.default)(true, {}, Quill.DEFAULTS, { modules: moduleConfig }, themeConfig, userConfig);\n  ['bounds', 'container', 'scrollingContainer'].forEach(function (key) {\n    if (typeof userConfig[key] === 'string') {\n      userConfig[key] = document.querySelector(userConfig[key]);\n    }\n  });\n  userConfig.modules = Object.keys(userConfig.modules).reduce(function (config, name) {\n    if (userConfig.modules[name]) {\n      config[name] = userConfig.modules[name];\n    }\n    return config;\n  }, {});\n  return userConfig;\n}\n\n// Handle selection preservation and TEXT_CHANGE emission\n// common to modification APIs\nfunction modify(modifier, source, index, shift) {\n  if (this.options.strict && !this.isEnabled() && source === _emitter4.default.sources.USER) {\n    return new _quillDelta2.default();\n  }\n  var range = index == null ? null : this.getSelection();\n  var oldDelta = this.editor.delta;\n  var change = modifier();\n  if (range != null) {\n    if (index === true) index = range.index;\n    if (shift == null) {\n      range = shiftRange(range, change, source);\n    } else if (shift !== 0) {\n      range = shiftRange(range, index, shift, source);\n    }\n    this.setSelection(range, _emitter4.default.sources.SILENT);\n  }\n  if (change.length() > 0) {\n    var _emitter;\n\n    var args = [_emitter4.default.events.TEXT_CHANGE, change, oldDelta, source];\n    (_emitter = this.emitter).emit.apply(_emitter, [_emitter4.default.events.EDITOR_CHANGE].concat(args));\n    if (source !== _emitter4.default.sources.SILENT) {\n      var _emitter2;\n\n      (_emitter2 = this.emitter).emit.apply(_emitter2, args);\n    }\n  }\n  return change;\n}\n\nfunction overload(index, length, name, value, source) {\n  var formats = {};\n  if (typeof index.index === 'number' && typeof index.length === 'number') {\n    // Allow for throwaway end (used by insertText/insertEmbed)\n    if (typeof length !== 'number') {\n      source = value, value = name, name = length, length = index.length, index = index.index;\n    } else {\n      length = index.length, index = index.index;\n    }\n  } else if (typeof length !== 'number') {\n    source = value, value = name, name = length, length = 0;\n  }\n  // Handle format being object, two format name/value strings or excluded\n  if ((typeof name === 'undefined' ? 'undefined' : _typeof(name)) === 'object') {\n    formats = name;\n    source = value;\n  } else if (typeof name === 'string') {\n    if (value != null) {\n      formats[name] = value;\n    } else {\n      source = name;\n    }\n  }\n  // Handle optional source\n  source = source || _emitter4.default.sources.API;\n  return [index, length, formats, source];\n}\n\nfunction shiftRange(range, index, length, source) {\n  if (range == null) return null;\n  var start = void 0,\n      end = void 0;\n  if (index instanceof _quillDelta2.default) {\n    var _map = [range.index, range.index + range.length].map(function (pos) {\n      return index.transformPosition(pos, source !== _emitter4.default.sources.USER);\n    });\n\n    var _map2 = _slicedToArray(_map, 2);\n\n    start = _map2[0];\n    end = _map2[1];\n  } else {\n    var _map3 = [range.index, range.index + range.length].map(function (pos) {\n      if (pos < index || pos === index && source === _emitter4.default.sources.USER) return pos;\n      if (length >= 0) {\n        return pos + length;\n      } else {\n        return Math.max(index, pos + length);\n      }\n    });\n\n    var _map4 = _slicedToArray(_map3, 2);\n\n    start = _map4[0];\n    end = _map4[1];\n  }\n  return new _selection.Range(start, end - start);\n}\n\nexports.expandConfig = expandConfig;\nexports.overload = overload;\nexports.default = Quill;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _text = __webpack_require__(7);\n\nvar _text2 = _interopRequireDefault(_text);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Inline = function (_Parchment$Inline) {\n  _inherits(Inline, _Parchment$Inline);\n\n  function Inline() {\n    _classCallCheck(this, Inline);\n\n    return _possibleConstructorReturn(this, (Inline.__proto__ || Object.getPrototypeOf(Inline)).apply(this, arguments));\n  }\n\n  _createClass(Inline, [{\n    key: 'formatAt',\n    value: function formatAt(index, length, name, value) {\n      if (Inline.compare(this.statics.blotName, name) < 0 && _parchment2.default.query(name, _parchment2.default.Scope.BLOT)) {\n        var blot = this.isolate(index, length);\n        if (value) {\n          blot.wrap(name, value);\n        }\n      } else {\n        _get(Inline.prototype.__proto__ || Object.getPrototypeOf(Inline.prototype), 'formatAt', this).call(this, index, length, name, value);\n      }\n    }\n  }, {\n    key: 'optimize',\n    value: function optimize(context) {\n      _get(Inline.prototype.__proto__ || Object.getPrototypeOf(Inline.prototype), 'optimize', this).call(this, context);\n      if (this.parent instanceof Inline && Inline.compare(this.statics.blotName, this.parent.statics.blotName) > 0) {\n        var parent = this.parent.isolate(this.offset(), this.length());\n        this.moveChildren(parent);\n        parent.wrap(this);\n      }\n    }\n  }], [{\n    key: 'compare',\n    value: function compare(self, other) {\n      var selfIndex = Inline.order.indexOf(self);\n      var otherIndex = Inline.order.indexOf(other);\n      if (selfIndex >= 0 || otherIndex >= 0) {\n        return selfIndex - otherIndex;\n      } else if (self === other) {\n        return 0;\n      } else if (self < other) {\n        return -1;\n      } else {\n        return 1;\n      }\n    }\n  }]);\n\n  return Inline;\n}(_parchment2.default.Inline);\n\nInline.allowedChildren = [Inline, _parchment2.default.Embed, _text2.default];\n// Lower index means deeper in the DOM tree, since not found (-1) is for embeds\nInline.order = ['cursor', 'inline', // Must be lower\n'underline', 'strike', 'italic', 'bold', 'script', 'link', 'code' // Must be higher\n];\n\nexports.default = Inline;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar TextBlot = function (_Parchment$Text) {\n  _inherits(TextBlot, _Parchment$Text);\n\n  function TextBlot() {\n    _classCallCheck(this, TextBlot);\n\n    return _possibleConstructorReturn(this, (TextBlot.__proto__ || Object.getPrototypeOf(TextBlot)).apply(this, arguments));\n  }\n\n  return TextBlot;\n}(_parchment2.default.Text);\n\nexports.default = TextBlot;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _eventemitter = __webpack_require__(54);\n\nvar _eventemitter2 = _interopRequireDefault(_eventemitter);\n\nvar _logger = __webpack_require__(10);\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar debug = (0, _logger2.default)('quill:events');\n\nvar EVENTS = ['selectionchange', 'mousedown', 'mouseup', 'click'];\n\nEVENTS.forEach(function (eventName) {\n  document.addEventListener(eventName, function () {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    [].slice.call(document.querySelectorAll('.ql-container')).forEach(function (node) {\n      // TODO use WeakMap\n      if (node.__quill && node.__quill.emitter) {\n        var _node$__quill$emitter;\n\n        (_node$__quill$emitter = node.__quill.emitter).handleDOM.apply(_node$__quill$emitter, args);\n      }\n    });\n  });\n});\n\nvar Emitter = function (_EventEmitter) {\n  _inherits(Emitter, _EventEmitter);\n\n  function Emitter() {\n    _classCallCheck(this, Emitter);\n\n    var _this = _possibleConstructorReturn(this, (Emitter.__proto__ || Object.getPrototypeOf(Emitter)).call(this));\n\n    _this.listeners = {};\n    _this.on('error', debug.error);\n    return _this;\n  }\n\n  _createClass(Emitter, [{\n    key: 'emit',\n    value: function emit() {\n      debug.log.apply(debug, arguments);\n      _get(Emitter.prototype.__proto__ || Object.getPrototypeOf(Emitter.prototype), 'emit', this).apply(this, arguments);\n    }\n  }, {\n    key: 'handleDOM',\n    value: function handleDOM(event) {\n      for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      (this.listeners[event.type] || []).forEach(function (_ref) {\n        var node = _ref.node,\n            handler = _ref.handler;\n\n        if (event.target === node || node.contains(event.target)) {\n          handler.apply(undefined, [event].concat(args));\n        }\n      });\n    }\n  }, {\n    key: 'listenDOM',\n    value: function listenDOM(eventName, node, handler) {\n      if (!this.listeners[eventName]) {\n        this.listeners[eventName] = [];\n      }\n      this.listeners[eventName].push({ node: node, handler: handler });\n    }\n  }]);\n\n  return Emitter;\n}(_eventemitter2.default);\n\nEmitter.events = {\n  EDITOR_CHANGE: 'editor-change',\n  SCROLL_BEFORE_UPDATE: 'scroll-before-update',\n  SCROLL_OPTIMIZE: 'scroll-optimize',\n  SCROLL_UPDATE: 'scroll-update',\n  SELECTION_CHANGE: 'selection-change',\n  TEXT_CHANGE: 'text-change'\n};\nEmitter.sources = {\n  API: 'api',\n  SILENT: 'silent',\n  USER: 'user'\n};\n\nexports.default = Emitter;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Module = function Module(quill) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  _classCallCheck(this, Module);\n\n  this.quill = quill;\n  this.options = options;\n};\n\nModule.DEFAULTS = {};\n\nexports.default = Module;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar levels = ['error', 'warn', 'log', 'info'];\nvar level = 'warn';\n\nfunction debug(method) {\n  if (levels.indexOf(method) <= levels.indexOf(level)) {\n    var _console;\n\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    (_console = console)[method].apply(_console, args); // eslint-disable-line no-console\n  }\n}\n\nfunction namespace(ns) {\n  return levels.reduce(function (logger, method) {\n    logger[method] = debug.bind(console, method, ns);\n    return logger;\n  }, {});\n}\n\ndebug.level = namespace.level = function (newLevel) {\n  level = newLevel;\n};\n\nexports.default = namespace;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar pSlice = Array.prototype.slice;\nvar objectKeys = __webpack_require__(52);\nvar isArguments = __webpack_require__(53);\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!actual || !expected || typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return typeof a === typeof b;\n}\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Registry = __webpack_require__(1);\nvar Attributor = /** @class */ (function () {\n    function Attributor(attrName, keyName, options) {\n        if (options === void 0) { options = {}; }\n        this.attrName = attrName;\n        this.keyName = keyName;\n        var attributeBit = Registry.Scope.TYPE & Registry.Scope.ATTRIBUTE;\n        if (options.scope != null) {\n            // Ignore type bits, force attribute bit\n            this.scope = (options.scope & Registry.Scope.LEVEL) | attributeBit;\n        }\n        else {\n            this.scope = Registry.Scope.ATTRIBUTE;\n        }\n        if (options.whitelist != null)\n            this.whitelist = options.whitelist;\n    }\n    Attributor.keys = function (node) {\n        return [].map.call(node.attributes, function (item) {\n            return item.name;\n        });\n    };\n    Attributor.prototype.add = function (node, value) {\n        if (!this.canAdd(node, value))\n            return false;\n        node.setAttribute(this.keyName, value);\n        return true;\n    };\n    Attributor.prototype.canAdd = function (node, value) {\n        var match = Registry.query(node, Registry.Scope.BLOT & (this.scope | Registry.Scope.TYPE));\n        if (match == null)\n            return false;\n        if (this.whitelist == null)\n            return true;\n        if (typeof value === 'string') {\n            return this.whitelist.indexOf(value.replace(/[\"']/g, '')) > -1;\n        }\n        else {\n            return this.whitelist.indexOf(value) > -1;\n        }\n    };\n    Attributor.prototype.remove = function (node) {\n        node.removeAttribute(this.keyName);\n    };\n    Attributor.prototype.value = function (node) {\n        var value = node.getAttribute(this.keyName);\n        if (this.canAdd(node, value) && value) {\n            return value;\n        }\n        return '';\n    };\n    return Attributor;\n}());\nexports.default = Attributor;\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.Code = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nvar _text = __webpack_require__(7);\n\nvar _text2 = _interopRequireDefault(_text);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Code = function (_Inline) {\n  _inherits(Code, _Inline);\n\n  function Code() {\n    _classCallCheck(this, Code);\n\n    return _possibleConstructorReturn(this, (Code.__proto__ || Object.getPrototypeOf(Code)).apply(this, arguments));\n  }\n\n  return Code;\n}(_inline2.default);\n\nCode.blotName = 'code';\nCode.tagName = 'CODE';\n\nvar CodeBlock = function (_Block) {\n  _inherits(CodeBlock, _Block);\n\n  function CodeBlock() {\n    _classCallCheck(this, CodeBlock);\n\n    return _possibleConstructorReturn(this, (CodeBlock.__proto__ || Object.getPrototypeOf(CodeBlock)).apply(this, arguments));\n  }\n\n  _createClass(CodeBlock, [{\n    key: 'delta',\n    value: function delta() {\n      var _this3 = this;\n\n      var text = this.domNode.textContent;\n      if (text.endsWith('\\n')) {\n        // Should always be true\n        text = text.slice(0, -1);\n      }\n      return text.split('\\n').reduce(function (delta, frag) {\n        return delta.insert(frag).insert('\\n', _this3.formats());\n      }, new _quillDelta2.default());\n    }\n  }, {\n    key: 'format',\n    value: function format(name, value) {\n      if (name === this.statics.blotName && value) return;\n\n      var _descendant = this.descendant(_text2.default, this.length() - 1),\n          _descendant2 = _slicedToArray(_descendant, 1),\n          text = _descendant2[0];\n\n      if (text != null) {\n        text.deleteAt(text.length() - 1, 1);\n      }\n      _get(CodeBlock.prototype.__proto__ || Object.getPrototypeOf(CodeBlock.prototype), 'format', this).call(this, name, value);\n    }\n  }, {\n    key: 'formatAt',\n    value: function formatAt(index, length, name, value) {\n      if (length === 0) return;\n      if (_parchment2.default.query(name, _parchment2.default.Scope.BLOCK) == null || name === this.statics.blotName && value === this.statics.formats(this.domNode)) {\n        return;\n      }\n      var nextNewline = this.newlineIndex(index);\n      if (nextNewline < 0 || nextNewline >= index + length) return;\n      var prevNewline = this.newlineIndex(index, true) + 1;\n      var isolateLength = nextNewline - prevNewline + 1;\n      var blot = this.isolate(prevNewline, isolateLength);\n      var next = blot.next;\n      blot.format(name, value);\n      if (next instanceof CodeBlock) {\n        next.formatAt(0, index - prevNewline + length - isolateLength, name, value);\n      }\n    }\n  }, {\n    key: 'insertAt',\n    value: function insertAt(index, value, def) {\n      if (def != null) return;\n\n      var _descendant3 = this.descendant(_text2.default, index),\n          _descendant4 = _slicedToArray(_descendant3, 2),\n          text = _descendant4[0],\n          offset = _descendant4[1];\n\n      text.insertAt(offset, value);\n    }\n  }, {\n    key: 'length',\n    value: function length() {\n      var length = this.domNode.textContent.length;\n      if (!this.domNode.textContent.endsWith('\\n')) {\n        return length + 1;\n      }\n      return length;\n    }\n  }, {\n    key: 'newlineIndex',\n    value: function newlineIndex(searchIndex) {\n      var reverse = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!reverse) {\n        var offset = this.domNode.textContent.slice(searchIndex).indexOf('\\n');\n        return offset > -1 ? searchIndex + offset : -1;\n      } else {\n        return this.domNode.textContent.slice(0, searchIndex).lastIndexOf('\\n');\n      }\n    }\n  }, {\n    key: 'optimize',\n    value: function optimize(context) {\n      if (!this.domNode.textContent.endsWith('\\n')) {\n        this.appendChild(_parchment2.default.create('text', '\\n'));\n      }\n      _get(CodeBlock.prototype.__proto__ || Object.getPrototypeOf(CodeBlock.prototype), 'optimize', this).call(this, context);\n      var next = this.next;\n      if (next != null && next.prev === this && next.statics.blotName === this.statics.blotName && this.statics.formats(this.domNode) === next.statics.formats(next.domNode)) {\n        next.optimize(context);\n        next.moveChildren(this);\n        next.remove();\n      }\n    }\n  }, {\n    key: 'replace',\n    value: function replace(target) {\n      _get(CodeBlock.prototype.__proto__ || Object.getPrototypeOf(CodeBlock.prototype), 'replace', this).call(this, target);\n      [].slice.call(this.domNode.querySelectorAll('*')).forEach(function (node) {\n        var blot = _parchment2.default.find(node);\n        if (blot == null) {\n          node.parentNode.removeChild(node);\n        } else if (blot instanceof _parchment2.default.Embed) {\n          blot.remove();\n        } else {\n          blot.unwrap();\n        }\n      });\n    }\n  }], [{\n    key: 'create',\n    value: function create(value) {\n      var domNode = _get(CodeBlock.__proto__ || Object.getPrototypeOf(CodeBlock), 'create', this).call(this, value);\n      domNode.setAttribute('spellcheck', false);\n      return domNode;\n    }\n  }, {\n    key: 'formats',\n    value: function formats() {\n      return true;\n    }\n  }]);\n\n  return CodeBlock;\n}(_block2.default);\n\nCodeBlock.blotName = 'code-block';\nCodeBlock.tagName = 'PRE';\nCodeBlock.TAB = '  ';\n\nexports.Code = Code;\nexports.default = CodeBlock;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _op = __webpack_require__(20);\n\nvar _op2 = _interopRequireDefault(_op);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _code = __webpack_require__(13);\n\nvar _code2 = _interopRequireDefault(_code);\n\nvar _cursor = __webpack_require__(24);\n\nvar _cursor2 = _interopRequireDefault(_cursor);\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nvar _break = __webpack_require__(16);\n\nvar _break2 = _interopRequireDefault(_break);\n\nvar _clone = __webpack_require__(21);\n\nvar _clone2 = _interopRequireDefault(_clone);\n\nvar _deepEqual = __webpack_require__(11);\n\nvar _deepEqual2 = _interopRequireDefault(_deepEqual);\n\nvar _extend = __webpack_require__(3);\n\nvar _extend2 = _interopRequireDefault(_extend);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ASCII = /^[ -~]*$/;\n\nvar Editor = function () {\n  function Editor(scroll) {\n    _classCallCheck(this, Editor);\n\n    this.scroll = scroll;\n    this.delta = this.getDelta();\n  }\n\n  _createClass(Editor, [{\n    key: 'applyDelta',\n    value: function applyDelta(delta) {\n      var _this = this;\n\n      var consumeNextNewline = false;\n      this.scroll.update();\n      var scrollLength = this.scroll.length();\n      this.scroll.batchStart();\n      delta = normalizeDelta(delta);\n      delta.reduce(function (index, op) {\n        var length = op.retain || op.delete || op.insert.length || 1;\n        var attributes = op.attributes || {};\n        if (op.insert != null) {\n          if (typeof op.insert === 'string') {\n            var text = op.insert;\n            if (text.endsWith('\\n') && consumeNextNewline) {\n              consumeNextNewline = false;\n              text = text.slice(0, -1);\n            }\n            if (index >= scrollLength && !text.endsWith('\\n')) {\n              consumeNextNewline = true;\n            }\n            _this.scroll.insertAt(index, text);\n\n            var _scroll$line = _this.scroll.line(index),\n                _scroll$line2 = _slicedToArray(_scroll$line, 2),\n                line = _scroll$line2[0],\n                offset = _scroll$line2[1];\n\n            var formats = (0, _extend2.default)({}, (0, _block.bubbleFormats)(line));\n            if (line instanceof _block2.default) {\n              var _line$descendant = line.descendant(_parchment2.default.Leaf, offset),\n                  _line$descendant2 = _slicedToArray(_line$descendant, 1),\n                  leaf = _line$descendant2[0];\n\n              formats = (0, _extend2.default)(formats, (0, _block.bubbleFormats)(leaf));\n            }\n            attributes = _op2.default.attributes.diff(formats, attributes) || {};\n          } else if (_typeof(op.insert) === 'object') {\n            var key = Object.keys(op.insert)[0]; // There should only be one key\n            if (key == null) return index;\n            _this.scroll.insertAt(index, key, op.insert[key]);\n          }\n          scrollLength += length;\n        }\n        Object.keys(attributes).forEach(function (name) {\n          _this.scroll.formatAt(index, length, name, attributes[name]);\n        });\n        return index + length;\n      }, 0);\n      delta.reduce(function (index, op) {\n        if (typeof op.delete === 'number') {\n          _this.scroll.deleteAt(index, op.delete);\n          return index;\n        }\n        return index + (op.retain || op.insert.length || 1);\n      }, 0);\n      this.scroll.batchEnd();\n      return this.update(delta);\n    }\n  }, {\n    key: 'deleteText',\n    value: function deleteText(index, length) {\n      this.scroll.deleteAt(index, length);\n      return this.update(new _quillDelta2.default().retain(index).delete(length));\n    }\n  }, {\n    key: 'formatLine',\n    value: function formatLine(index, length) {\n      var _this2 = this;\n\n      var formats = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      this.scroll.update();\n      Object.keys(formats).forEach(function (format) {\n        if (_this2.scroll.whitelist != null && !_this2.scroll.whitelist[format]) return;\n        var lines = _this2.scroll.lines(index, Math.max(length, 1));\n        var lengthRemaining = length;\n        lines.forEach(function (line) {\n          var lineLength = line.length();\n          if (!(line instanceof _code2.default)) {\n            line.format(format, formats[format]);\n          } else {\n            var codeIndex = index - line.offset(_this2.scroll);\n            var codeLength = line.newlineIndex(codeIndex + lengthRemaining) - codeIndex + 1;\n            line.formatAt(codeIndex, codeLength, format, formats[format]);\n          }\n          lengthRemaining -= lineLength;\n        });\n      });\n      this.scroll.optimize();\n      return this.update(new _quillDelta2.default().retain(index).retain(length, (0, _clone2.default)(formats)));\n    }\n  }, {\n    key: 'formatText',\n    value: function formatText(index, length) {\n      var _this3 = this;\n\n      var formats = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      Object.keys(formats).forEach(function (format) {\n        _this3.scroll.formatAt(index, length, format, formats[format]);\n      });\n      return this.update(new _quillDelta2.default().retain(index).retain(length, (0, _clone2.default)(formats)));\n    }\n  }, {\n    key: 'getContents',\n    value: function getContents(index, length) {\n      return this.delta.slice(index, index + length);\n    }\n  }, {\n    key: 'getDelta',\n    value: function getDelta() {\n      return this.scroll.lines().reduce(function (delta, line) {\n        return delta.concat(line.delta());\n      }, new _quillDelta2.default());\n    }\n  }, {\n    key: 'getFormat',\n    value: function getFormat(index) {\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var lines = [],\n          leaves = [];\n      if (length === 0) {\n        this.scroll.path(index).forEach(function (path) {\n          var _path = _slicedToArray(path, 1),\n              blot = _path[0];\n\n          if (blot instanceof _block2.default) {\n            lines.push(blot);\n          } else if (blot instanceof _parchment2.default.Leaf) {\n            leaves.push(blot);\n          }\n        });\n      } else {\n        lines = this.scroll.lines(index, length);\n        leaves = this.scroll.descendants(_parchment2.default.Leaf, index, length);\n      }\n      var formatsArr = [lines, leaves].map(function (blots) {\n        if (blots.length === 0) return {};\n        var formats = (0, _block.bubbleFormats)(blots.shift());\n        while (Object.keys(formats).length > 0) {\n          var blot = blots.shift();\n          if (blot == null) return formats;\n          formats = combineFormats((0, _block.bubbleFormats)(blot), formats);\n        }\n        return formats;\n      });\n      return _extend2.default.apply(_extend2.default, formatsArr);\n    }\n  }, {\n    key: 'getText',\n    value: function getText(index, length) {\n      return this.getContents(index, length).filter(function (op) {\n        return typeof op.insert === 'string';\n      }).map(function (op) {\n        return op.insert;\n      }).join('');\n    }\n  }, {\n    key: 'insertEmbed',\n    value: function insertEmbed(index, embed, value) {\n      this.scroll.insertAt(index, embed, value);\n      return this.update(new _quillDelta2.default().retain(index).insert(_defineProperty({}, embed, value)));\n    }\n  }, {\n    key: 'insertText',\n    value: function insertText(index, text) {\n      var _this4 = this;\n\n      var formats = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      text = text.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n      this.scroll.insertAt(index, text);\n      Object.keys(formats).forEach(function (format) {\n        _this4.scroll.formatAt(index, text.length, format, formats[format]);\n      });\n      return this.update(new _quillDelta2.default().retain(index).insert(text, (0, _clone2.default)(formats)));\n    }\n  }, {\n    key: 'isBlank',\n    value: function isBlank() {\n      if (this.scroll.children.length == 0) return true;\n      if (this.scroll.children.length > 1) return false;\n      var block = this.scroll.children.head;\n      if (block.statics.blotName !== _block2.default.blotName) return false;\n      if (block.children.length > 1) return false;\n      return block.children.head instanceof _break2.default;\n    }\n  }, {\n    key: 'removeFormat',\n    value: function removeFormat(index, length) {\n      var text = this.getText(index, length);\n\n      var _scroll$line3 = this.scroll.line(index + length),\n          _scroll$line4 = _slicedToArray(_scroll$line3, 2),\n          line = _scroll$line4[0],\n          offset = _scroll$line4[1];\n\n      var suffixLength = 0,\n          suffix = new _quillDelta2.default();\n      if (line != null) {\n        if (!(line instanceof _code2.default)) {\n          suffixLength = line.length() - offset;\n        } else {\n          suffixLength = line.newlineIndex(offset) - offset + 1;\n        }\n        suffix = line.delta().slice(offset, offset + suffixLength - 1).insert('\\n');\n      }\n      var contents = this.getContents(index, length + suffixLength);\n      var diff = contents.diff(new _quillDelta2.default().insert(text).concat(suffix));\n      var delta = new _quillDelta2.default().retain(index).concat(diff);\n      return this.applyDelta(delta);\n    }\n  }, {\n    key: 'update',\n    value: function update(change) {\n      var mutations = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var cursorIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n\n      var oldDelta = this.delta;\n      if (mutations.length === 1 && mutations[0].type === 'characterData' && mutations[0].target.data.match(ASCII) && _parchment2.default.find(mutations[0].target)) {\n        // Optimization for character changes\n        var textBlot = _parchment2.default.find(mutations[0].target);\n        var formats = (0, _block.bubbleFormats)(textBlot);\n        var index = textBlot.offset(this.scroll);\n        var oldValue = mutations[0].oldValue.replace(_cursor2.default.CONTENTS, '');\n        var oldText = new _quillDelta2.default().insert(oldValue);\n        var newText = new _quillDelta2.default().insert(textBlot.value());\n        var diffDelta = new _quillDelta2.default().retain(index).concat(oldText.diff(newText, cursorIndex));\n        change = diffDelta.reduce(function (delta, op) {\n          if (op.insert) {\n            return delta.insert(op.insert, formats);\n          } else {\n            return delta.push(op);\n          }\n        }, new _quillDelta2.default());\n        this.delta = oldDelta.compose(change);\n      } else {\n        this.delta = this.getDelta();\n        if (!change || !(0, _deepEqual2.default)(oldDelta.compose(change), this.delta)) {\n          change = oldDelta.diff(this.delta, cursorIndex);\n        }\n      }\n      return change;\n    }\n  }]);\n\n  return Editor;\n}();\n\nfunction combineFormats(formats, combined) {\n  return Object.keys(combined).reduce(function (merged, name) {\n    if (formats[name] == null) return merged;\n    if (combined[name] === formats[name]) {\n      merged[name] = combined[name];\n    } else if (Array.isArray(combined[name])) {\n      if (combined[name].indexOf(formats[name]) < 0) {\n        merged[name] = combined[name].concat([formats[name]]);\n      }\n    } else {\n      merged[name] = [combined[name], formats[name]];\n    }\n    return merged;\n  }, {});\n}\n\nfunction normalizeDelta(delta) {\n  return delta.reduce(function (delta, op) {\n    if (op.insert === 1) {\n      var attributes = (0, _clone2.default)(op.attributes);\n      delete attributes['image'];\n      return delta.insert({ image: op.attributes.image }, attributes);\n    }\n    if (op.attributes != null && (op.attributes.list === true || op.attributes.bullet === true)) {\n      op = (0, _clone2.default)(op);\n      if (op.attributes.list) {\n        op.attributes.list = 'ordered';\n      } else {\n        op.attributes.list = 'bullet';\n        delete op.attributes.bullet;\n      }\n    }\n    if (typeof op.insert === 'string') {\n      var text = op.insert.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n      return delta.insert(text, op.attributes);\n    }\n    return delta.push(op);\n  }, new _quillDelta2.default());\n}\n\nexports.default = Editor;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.Range = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _clone = __webpack_require__(21);\n\nvar _clone2 = _interopRequireDefault(_clone);\n\nvar _deepEqual = __webpack_require__(11);\n\nvar _deepEqual2 = _interopRequireDefault(_deepEqual);\n\nvar _emitter3 = __webpack_require__(8);\n\nvar _emitter4 = _interopRequireDefault(_emitter3);\n\nvar _logger = __webpack_require__(10);\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar debug = (0, _logger2.default)('quill:selection');\n\nvar Range = function Range(index) {\n  var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  _classCallCheck(this, Range);\n\n  this.index = index;\n  this.length = length;\n};\n\nvar Selection = function () {\n  function Selection(scroll, emitter) {\n    var _this = this;\n\n    _classCallCheck(this, Selection);\n\n    this.emitter = emitter;\n    this.scroll = scroll;\n    this.composing = false;\n    this.mouseDown = false;\n    this.root = this.scroll.domNode;\n    this.cursor = _parchment2.default.create('cursor', this);\n    // savedRange is last non-null range\n    this.lastRange = this.savedRange = new Range(0, 0);\n    this.handleComposition();\n    this.handleDragging();\n    this.emitter.listenDOM('selectionchange', document, function () {\n      if (!_this.mouseDown) {\n        setTimeout(_this.update.bind(_this, _emitter4.default.sources.USER), 1);\n      }\n    });\n    this.emitter.on(_emitter4.default.events.EDITOR_CHANGE, function (type, delta) {\n      if (type === _emitter4.default.events.TEXT_CHANGE && delta.length() > 0) {\n        _this.update(_emitter4.default.sources.SILENT);\n      }\n    });\n    this.emitter.on(_emitter4.default.events.SCROLL_BEFORE_UPDATE, function () {\n      if (!_this.hasFocus()) return;\n      var native = _this.getNativeRange();\n      if (native == null) return;\n      if (native.start.node === _this.cursor.textNode) return; // cursor.restore() will handle\n      // TODO unclear if this has negative side effects\n      _this.emitter.once(_emitter4.default.events.SCROLL_UPDATE, function () {\n        try {\n          _this.setNativeRange(native.start.node, native.start.offset, native.end.node, native.end.offset);\n        } catch (ignored) {}\n      });\n    });\n    this.emitter.on(_emitter4.default.events.SCROLL_OPTIMIZE, function (mutations, context) {\n      if (context.range) {\n        var _context$range = context.range,\n            startNode = _context$range.startNode,\n            startOffset = _context$range.startOffset,\n            endNode = _context$range.endNode,\n            endOffset = _context$range.endOffset;\n\n        _this.setNativeRange(startNode, startOffset, endNode, endOffset);\n      }\n    });\n    this.update(_emitter4.default.sources.SILENT);\n  }\n\n  _createClass(Selection, [{\n    key: 'handleComposition',\n    value: function handleComposition() {\n      var _this2 = this;\n\n      this.root.addEventListener('compositionstart', function () {\n        _this2.composing = true;\n      });\n      this.root.addEventListener('compositionend', function () {\n        _this2.composing = false;\n        if (_this2.cursor.parent) {\n          var range = _this2.cursor.restore();\n          if (!range) return;\n          setTimeout(function () {\n            _this2.setNativeRange(range.startNode, range.startOffset, range.endNode, range.endOffset);\n          }, 1);\n        }\n      });\n    }\n  }, {\n    key: 'handleDragging',\n    value: function handleDragging() {\n      var _this3 = this;\n\n      this.emitter.listenDOM('mousedown', document.body, function () {\n        _this3.mouseDown = true;\n      });\n      this.emitter.listenDOM('mouseup', document.body, function () {\n        _this3.mouseDown = false;\n        _this3.update(_emitter4.default.sources.USER);\n      });\n    }\n  }, {\n    key: 'focus',\n    value: function focus() {\n      if (this.hasFocus()) return;\n      this.root.focus();\n      this.setRange(this.savedRange);\n    }\n  }, {\n    key: 'format',\n    value: function format(_format, value) {\n      if (this.scroll.whitelist != null && !this.scroll.whitelist[_format]) return;\n      this.scroll.update();\n      var nativeRange = this.getNativeRange();\n      if (nativeRange == null || !nativeRange.native.collapsed || _parchment2.default.query(_format, _parchment2.default.Scope.BLOCK)) return;\n      if (nativeRange.start.node !== this.cursor.textNode) {\n        var blot = _parchment2.default.find(nativeRange.start.node, false);\n        if (blot == null) return;\n        // TODO Give blot ability to not split\n        if (blot instanceof _parchment2.default.Leaf) {\n          var after = blot.split(nativeRange.start.offset);\n          blot.parent.insertBefore(this.cursor, after);\n        } else {\n          blot.insertBefore(this.cursor, nativeRange.start.node); // Should never happen\n        }\n        this.cursor.attach();\n      }\n      this.cursor.format(_format, value);\n      this.scroll.optimize();\n      this.setNativeRange(this.cursor.textNode, this.cursor.textNode.data.length);\n      this.update();\n    }\n  }, {\n    key: 'getBounds',\n    value: function getBounds(index) {\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var scrollLength = this.scroll.length();\n      index = Math.min(index, scrollLength - 1);\n      length = Math.min(index + length, scrollLength - 1) - index;\n      var node = void 0,\n          _scroll$leaf = this.scroll.leaf(index),\n          _scroll$leaf2 = _slicedToArray(_scroll$leaf, 2),\n          leaf = _scroll$leaf2[0],\n          offset = _scroll$leaf2[1];\n      if (leaf == null) return null;\n\n      var _leaf$position = leaf.position(offset, true);\n\n      var _leaf$position2 = _slicedToArray(_leaf$position, 2);\n\n      node = _leaf$position2[0];\n      offset = _leaf$position2[1];\n\n      var range = document.createRange();\n      if (length > 0) {\n        range.setStart(node, offset);\n\n        var _scroll$leaf3 = this.scroll.leaf(index + length);\n\n        var _scroll$leaf4 = _slicedToArray(_scroll$leaf3, 2);\n\n        leaf = _scroll$leaf4[0];\n        offset = _scroll$leaf4[1];\n\n        if (leaf == null) return null;\n\n        var _leaf$position3 = leaf.position(offset, true);\n\n        var _leaf$position4 = _slicedToArray(_leaf$position3, 2);\n\n        node = _leaf$position4[0];\n        offset = _leaf$position4[1];\n\n        range.setEnd(node, offset);\n        return range.getBoundingClientRect();\n      } else {\n        var side = 'left';\n        var rect = void 0;\n        if (node instanceof Text) {\n          if (offset < node.data.length) {\n            range.setStart(node, offset);\n            range.setEnd(node, offset + 1);\n          } else {\n            range.setStart(node, offset - 1);\n            range.setEnd(node, offset);\n            side = 'right';\n          }\n          rect = range.getBoundingClientRect();\n        } else {\n          rect = leaf.domNode.getBoundingClientRect();\n          if (offset > 0) side = 'right';\n        }\n        return {\n          bottom: rect.top + rect.height,\n          height: rect.height,\n          left: rect[side],\n          right: rect[side],\n          top: rect.top,\n          width: 0\n        };\n      }\n    }\n  }, {\n    key: 'getNativeRange',\n    value: function getNativeRange() {\n      var selection = document.getSelection();\n      if (selection == null || selection.rangeCount <= 0) return null;\n      var nativeRange = selection.getRangeAt(0);\n      if (nativeRange == null) return null;\n      var range = this.normalizeNative(nativeRange);\n      debug.info('getNativeRange', range);\n      return range;\n    }\n  }, {\n    key: 'getRange',\n    value: function getRange() {\n      var normalized = this.getNativeRange();\n      if (normalized == null) return [null, null];\n      var range = this.normalizedToRange(normalized);\n      return [range, normalized];\n    }\n  }, {\n    key: 'hasFocus',\n    value: function hasFocus() {\n      return document.activeElement === this.root;\n    }\n  }, {\n    key: 'normalizedToRange',\n    value: function normalizedToRange(range) {\n      var _this4 = this;\n\n      var positions = [[range.start.node, range.start.offset]];\n      if (!range.native.collapsed) {\n        positions.push([range.end.node, range.end.offset]);\n      }\n      var indexes = positions.map(function (position) {\n        var _position = _slicedToArray(position, 2),\n            node = _position[0],\n            offset = _position[1];\n\n        var blot = _parchment2.default.find(node, true);\n        var index = blot.offset(_this4.scroll);\n        if (offset === 0) {\n          return index;\n        } else if (blot instanceof _parchment2.default.Container) {\n          return index + blot.length();\n        } else {\n          return index + blot.index(node, offset);\n        }\n      });\n      var end = Math.min(Math.max.apply(Math, _toConsumableArray(indexes)), this.scroll.length() - 1);\n      var start = Math.min.apply(Math, [end].concat(_toConsumableArray(indexes)));\n      return new Range(start, end - start);\n    }\n  }, {\n    key: 'normalizeNative',\n    value: function normalizeNative(nativeRange) {\n      if (!contains(this.root, nativeRange.startContainer) || !nativeRange.collapsed && !contains(this.root, nativeRange.endContainer)) {\n        return null;\n      }\n      var range = {\n        start: { node: nativeRange.startContainer, offset: nativeRange.startOffset },\n        end: { node: nativeRange.endContainer, offset: nativeRange.endOffset },\n        native: nativeRange\n      };\n      [range.start, range.end].forEach(function (position) {\n        var node = position.node,\n            offset = position.offset;\n        while (!(node instanceof Text) && node.childNodes.length > 0) {\n          if (node.childNodes.length > offset) {\n            node = node.childNodes[offset];\n            offset = 0;\n          } else if (node.childNodes.length === offset) {\n            node = node.lastChild;\n            offset = node instanceof Text ? node.data.length : node.childNodes.length + 1;\n          } else {\n            break;\n          }\n        }\n        position.node = node, position.offset = offset;\n      });\n      return range;\n    }\n  }, {\n    key: 'rangeToNative',\n    value: function rangeToNative(range) {\n      var _this5 = this;\n\n      var indexes = range.collapsed ? [range.index] : [range.index, range.index + range.length];\n      var args = [];\n      var scrollLength = this.scroll.length();\n      indexes.forEach(function (index, i) {\n        index = Math.min(scrollLength - 1, index);\n        var node = void 0,\n            _scroll$leaf5 = _this5.scroll.leaf(index),\n            _scroll$leaf6 = _slicedToArray(_scroll$leaf5, 2),\n            leaf = _scroll$leaf6[0],\n            offset = _scroll$leaf6[1];\n        var _leaf$position5 = leaf.position(offset, i !== 0);\n\n        var _leaf$position6 = _slicedToArray(_leaf$position5, 2);\n\n        node = _leaf$position6[0];\n        offset = _leaf$position6[1];\n\n        args.push(node, offset);\n      });\n      if (args.length < 2) {\n        args = args.concat(args);\n      }\n      return args;\n    }\n  }, {\n    key: 'scrollIntoView',\n    value: function scrollIntoView(scrollingContainer) {\n      var range = this.lastRange;\n      if (range == null) return;\n      var bounds = this.getBounds(range.index, range.length);\n      if (bounds == null) return;\n      var limit = this.scroll.length() - 1;\n\n      var _scroll$line = this.scroll.line(Math.min(range.index, limit)),\n          _scroll$line2 = _slicedToArray(_scroll$line, 1),\n          first = _scroll$line2[0];\n\n      var last = first;\n      if (range.length > 0) {\n        var _scroll$line3 = this.scroll.line(Math.min(range.index + range.length, limit));\n\n        var _scroll$line4 = _slicedToArray(_scroll$line3, 1);\n\n        last = _scroll$line4[0];\n      }\n      if (first == null || last == null) return;\n      var scrollBounds = scrollingContainer.getBoundingClientRect();\n      if (bounds.top < scrollBounds.top) {\n        scrollingContainer.scrollTop -= scrollBounds.top - bounds.top;\n      } else if (bounds.bottom > scrollBounds.bottom) {\n        scrollingContainer.scrollTop += bounds.bottom - scrollBounds.bottom;\n      }\n    }\n  }, {\n    key: 'setNativeRange',\n    value: function setNativeRange(startNode, startOffset) {\n      var endNode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : startNode;\n      var endOffset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : startOffset;\n      var force = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n\n      debug.info('setNativeRange', startNode, startOffset, endNode, endOffset);\n      if (startNode != null && (this.root.parentNode == null || startNode.parentNode == null || endNode.parentNode == null)) {\n        return;\n      }\n      var selection = document.getSelection();\n      if (selection == null) return;\n      if (startNode != null) {\n        if (!this.hasFocus()) this.root.focus();\n        var native = (this.getNativeRange() || {}).native;\n        if (native == null || force || startNode !== native.startContainer || startOffset !== native.startOffset || endNode !== native.endContainer || endOffset !== native.endOffset) {\n\n          if (startNode.tagName == \"BR\") {\n            startOffset = [].indexOf.call(startNode.parentNode.childNodes, startNode);\n            startNode = startNode.parentNode;\n          }\n          if (endNode.tagName == \"BR\") {\n            endOffset = [].indexOf.call(endNode.parentNode.childNodes, endNode);\n            endNode = endNode.parentNode;\n          }\n          var range = document.createRange();\n          range.setStart(startNode, startOffset);\n          range.setEnd(endNode, endOffset);\n          selection.removeAllRanges();\n          selection.addRange(range);\n        }\n      } else {\n        selection.removeAllRanges();\n        this.root.blur();\n        document.body.focus(); // root.blur() not enough on IE11+Travis+SauceLabs (but not local VMs)\n      }\n    }\n  }, {\n    key: 'setRange',\n    value: function setRange(range) {\n      var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var source = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : _emitter4.default.sources.API;\n\n      if (typeof force === 'string') {\n        source = force;\n        force = false;\n      }\n      debug.info('setRange', range);\n      if (range != null) {\n        var args = this.rangeToNative(range);\n        this.setNativeRange.apply(this, _toConsumableArray(args).concat([force]));\n      } else {\n        this.setNativeRange(null);\n      }\n      this.update(source);\n    }\n  }, {\n    key: 'update',\n    value: function update() {\n      var source = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _emitter4.default.sources.USER;\n\n      var oldRange = this.lastRange;\n\n      var _getRange = this.getRange(),\n          _getRange2 = _slicedToArray(_getRange, 2),\n          lastRange = _getRange2[0],\n          nativeRange = _getRange2[1];\n\n      this.lastRange = lastRange;\n      if (this.lastRange != null) {\n        this.savedRange = this.lastRange;\n      }\n      if (!(0, _deepEqual2.default)(oldRange, this.lastRange)) {\n        var _emitter;\n\n        if (!this.composing && nativeRange != null && nativeRange.native.collapsed && nativeRange.start.node !== this.cursor.textNode) {\n          this.cursor.restore();\n        }\n        var args = [_emitter4.default.events.SELECTION_CHANGE, (0, _clone2.default)(this.lastRange), (0, _clone2.default)(oldRange), source];\n        (_emitter = this.emitter).emit.apply(_emitter, [_emitter4.default.events.EDITOR_CHANGE].concat(args));\n        if (source !== _emitter4.default.sources.SILENT) {\n          var _emitter2;\n\n          (_emitter2 = this.emitter).emit.apply(_emitter2, args);\n        }\n      }\n    }\n  }]);\n\n  return Selection;\n}();\n\nfunction contains(parent, descendant) {\n  try {\n    // Firefox inserts inaccessible nodes around video elements\n    descendant.parentNode;\n  } catch (e) {\n    return false;\n  }\n  // IE11 has bug with Text nodes\n  // https://connect.microsoft.com/IE/feedback/details/780874/node-contains-is-incorrect\n  if (descendant instanceof Text) {\n    descendant = descendant.parentNode;\n  }\n  return parent.contains(descendant);\n}\n\nexports.Range = Range;\nexports.default = Selection;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Break = function (_Parchment$Embed) {\n  _inherits(Break, _Parchment$Embed);\n\n  function Break() {\n    _classCallCheck(this, Break);\n\n    return _possibleConstructorReturn(this, (Break.__proto__ || Object.getPrototypeOf(Break)).apply(this, arguments));\n  }\n\n  _createClass(Break, [{\n    key: 'insertInto',\n    value: function insertInto(parent, ref) {\n      if (parent.children.length === 0) {\n        _get(Break.prototype.__proto__ || Object.getPrototypeOf(Break.prototype), 'insertInto', this).call(this, parent, ref);\n      } else {\n        this.remove();\n      }\n    }\n  }, {\n    key: 'length',\n    value: function length() {\n      return 0;\n    }\n  }, {\n    key: 'value',\n    value: function value() {\n      return '';\n    }\n  }], [{\n    key: 'value',\n    value: function value() {\n      return undefined;\n    }\n  }]);\n\n  return Break;\n}(_parchment2.default.Embed);\n\nBreak.blotName = 'break';\nBreak.tagName = 'BR';\n\nexports.default = Break;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar linked_list_1 = __webpack_require__(44);\nvar shadow_1 = __webpack_require__(30);\nvar Registry = __webpack_require__(1);\nvar ContainerBlot = /** @class */ (function (_super) {\n    __extends(ContainerBlot, _super);\n    function ContainerBlot(domNode) {\n        var _this = _super.call(this, domNode) || this;\n        _this.build();\n        return _this;\n    }\n    ContainerBlot.prototype.appendChild = function (other) {\n        this.insertBefore(other);\n    };\n    ContainerBlot.prototype.attach = function () {\n        _super.prototype.attach.call(this);\n        this.children.forEach(function (child) {\n            child.attach();\n        });\n    };\n    ContainerBlot.prototype.build = function () {\n        var _this = this;\n        this.children = new linked_list_1.default();\n        // Need to be reversed for if DOM nodes already in order\n        [].slice\n            .call(this.domNode.childNodes)\n            .reverse()\n            .forEach(function (node) {\n            try {\n                var child = makeBlot(node);\n                _this.insertBefore(child, _this.children.head || undefined);\n            }\n            catch (err) {\n                if (err instanceof Registry.ParchmentError)\n                    return;\n                else\n                    throw err;\n            }\n        });\n    };\n    ContainerBlot.prototype.deleteAt = function (index, length) {\n        if (index === 0 && length === this.length()) {\n            return this.remove();\n        }\n        this.children.forEachAt(index, length, function (child, offset, length) {\n            child.deleteAt(offset, length);\n        });\n    };\n    ContainerBlot.prototype.descendant = function (criteria, index) {\n        var _a = this.children.find(index), child = _a[0], offset = _a[1];\n        if ((criteria.blotName == null && criteria(child)) ||\n            (criteria.blotName != null && child instanceof criteria)) {\n            return [child, offset];\n        }\n        else if (child instanceof ContainerBlot) {\n            return child.descendant(criteria, offset);\n        }\n        else {\n            return [null, -1];\n        }\n    };\n    ContainerBlot.prototype.descendants = function (criteria, index, length) {\n        if (index === void 0) { index = 0; }\n        if (length === void 0) { length = Number.MAX_VALUE; }\n        var descendants = [];\n        var lengthLeft = length;\n        this.children.forEachAt(index, length, function (child, index, length) {\n            if ((criteria.blotName == null && criteria(child)) ||\n                (criteria.blotName != null && child instanceof criteria)) {\n                descendants.push(child);\n            }\n            if (child instanceof ContainerBlot) {\n                descendants = descendants.concat(child.descendants(criteria, index, lengthLeft));\n            }\n            lengthLeft -= length;\n        });\n        return descendants;\n    };\n    ContainerBlot.prototype.detach = function () {\n        this.children.forEach(function (child) {\n            child.detach();\n        });\n        _super.prototype.detach.call(this);\n    };\n    ContainerBlot.prototype.formatAt = function (index, length, name, value) {\n        this.children.forEachAt(index, length, function (child, offset, length) {\n            child.formatAt(offset, length, name, value);\n        });\n    };\n    ContainerBlot.prototype.insertAt = function (index, value, def) {\n        var _a = this.children.find(index), child = _a[0], offset = _a[1];\n        if (child) {\n            child.insertAt(offset, value, def);\n        }\n        else {\n            var blot = def == null ? Registry.create('text', value) : Registry.create(value, def);\n            this.appendChild(blot);\n        }\n    };\n    ContainerBlot.prototype.insertBefore = function (childBlot, refBlot) {\n        if (this.statics.allowedChildren != null &&\n            !this.statics.allowedChildren.some(function (child) {\n                return childBlot instanceof child;\n            })) {\n            throw new Registry.ParchmentError(\"Cannot insert \" + childBlot.statics.blotName + \" into \" + this.statics.blotName);\n        }\n        childBlot.insertInto(this, refBlot);\n    };\n    ContainerBlot.prototype.length = function () {\n        return this.children.reduce(function (memo, child) {\n            return memo + child.length();\n        }, 0);\n    };\n    ContainerBlot.prototype.moveChildren = function (targetParent, refNode) {\n        this.children.forEach(function (child) {\n            targetParent.insertBefore(child, refNode);\n        });\n    };\n    ContainerBlot.prototype.optimize = function (context) {\n        _super.prototype.optimize.call(this, context);\n        if (this.children.length === 0) {\n            if (this.statics.defaultChild != null) {\n                var child = Registry.create(this.statics.defaultChild);\n                this.appendChild(child);\n                child.optimize(context);\n            }\n            else {\n                this.remove();\n            }\n        }\n    };\n    ContainerBlot.prototype.path = function (index, inclusive) {\n        if (inclusive === void 0) { inclusive = false; }\n        var _a = this.children.find(index, inclusive), child = _a[0], offset = _a[1];\n        var position = [[this, index]];\n        if (child instanceof ContainerBlot) {\n            return position.concat(child.path(offset, inclusive));\n        }\n        else if (child != null) {\n            position.push([child, offset]);\n        }\n        return position;\n    };\n    ContainerBlot.prototype.removeChild = function (child) {\n        this.children.remove(child);\n    };\n    ContainerBlot.prototype.replace = function (target) {\n        if (target instanceof ContainerBlot) {\n            target.moveChildren(this);\n        }\n        _super.prototype.replace.call(this, target);\n    };\n    ContainerBlot.prototype.split = function (index, force) {\n        if (force === void 0) { force = false; }\n        if (!force) {\n            if (index === 0)\n                return this;\n            if (index === this.length())\n                return this.next;\n        }\n        var after = this.clone();\n        this.parent.insertBefore(after, this.next);\n        this.children.forEachAt(index, this.length(), function (child, offset, length) {\n            child = child.split(offset, force);\n            after.appendChild(child);\n        });\n        return after;\n    };\n    ContainerBlot.prototype.unwrap = function () {\n        this.moveChildren(this.parent, this.next);\n        this.remove();\n    };\n    ContainerBlot.prototype.update = function (mutations, context) {\n        var _this = this;\n        var addedNodes = [];\n        var removedNodes = [];\n        mutations.forEach(function (mutation) {\n            if (mutation.target === _this.domNode && mutation.type === 'childList') {\n                addedNodes.push.apply(addedNodes, mutation.addedNodes);\n                removedNodes.push.apply(removedNodes, mutation.removedNodes);\n            }\n        });\n        removedNodes.forEach(function (node) {\n            // Check node has actually been removed\n            // One exception is Chrome does not immediately remove IFRAMEs\n            // from DOM but MutationRecord is correct in its reported removal\n            if (node.parentNode != null &&\n                // @ts-ignore\n                node.tagName !== 'IFRAME' &&\n                document.body.compareDocumentPosition(node) & Node.DOCUMENT_POSITION_CONTAINED_BY) {\n                return;\n            }\n            var blot = Registry.find(node);\n            if (blot == null)\n                return;\n            if (blot.domNode.parentNode == null || blot.domNode.parentNode === _this.domNode) {\n                blot.detach();\n            }\n        });\n        addedNodes\n            .filter(function (node) {\n            return node.parentNode == _this.domNode;\n        })\n            .sort(function (a, b) {\n            if (a === b)\n                return 0;\n            if (a.compareDocumentPosition(b) & Node.DOCUMENT_POSITION_FOLLOWING) {\n                return 1;\n            }\n            return -1;\n        })\n            .forEach(function (node) {\n            var refBlot = null;\n            if (node.nextSibling != null) {\n                refBlot = Registry.find(node.nextSibling);\n            }\n            var blot = makeBlot(node);\n            if (blot.next != refBlot || blot.next == null) {\n                if (blot.parent != null) {\n                    blot.parent.removeChild(_this);\n                }\n                _this.insertBefore(blot, refBlot || undefined);\n            }\n        });\n    };\n    return ContainerBlot;\n}(shadow_1.default));\nfunction makeBlot(node) {\n    var blot = Registry.find(node);\n    if (blot == null) {\n        try {\n            blot = Registry.create(node);\n        }\n        catch (e) {\n            blot = Registry.create(Registry.Scope.INLINE);\n            [].slice.call(node.childNodes).forEach(function (child) {\n                // @ts-ignore\n                blot.domNode.appendChild(child);\n            });\n            if (node.parentNode) {\n                node.parentNode.replaceChild(blot.domNode, node);\n            }\n            blot.attach();\n        }\n    }\n    return blot;\n}\nexports.default = ContainerBlot;\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar attributor_1 = __webpack_require__(12);\nvar store_1 = __webpack_require__(31);\nvar container_1 = __webpack_require__(17);\nvar Registry = __webpack_require__(1);\nvar FormatBlot = /** @class */ (function (_super) {\n    __extends(FormatBlot, _super);\n    function FormatBlot(domNode) {\n        var _this = _super.call(this, domNode) || this;\n        _this.attributes = new store_1.default(_this.domNode);\n        return _this;\n    }\n    FormatBlot.formats = function (domNode) {\n        if (typeof this.tagName === 'string') {\n            return true;\n        }\n        else if (Array.isArray(this.tagName)) {\n            return domNode.tagName.toLowerCase();\n        }\n        return undefined;\n    };\n    FormatBlot.prototype.format = function (name, value) {\n        var format = Registry.query(name);\n        if (format instanceof attributor_1.default) {\n            this.attributes.attribute(format, value);\n        }\n        else if (value) {\n            if (format != null && (name !== this.statics.blotName || this.formats()[name] !== value)) {\n                this.replaceWith(name, value);\n            }\n        }\n    };\n    FormatBlot.prototype.formats = function () {\n        var formats = this.attributes.values();\n        var format = this.statics.formats(this.domNode);\n        if (format != null) {\n            formats[this.statics.blotName] = format;\n        }\n        return formats;\n    };\n    FormatBlot.prototype.replaceWith = function (name, value) {\n        var replacement = _super.prototype.replaceWith.call(this, name, value);\n        this.attributes.copy(replacement);\n        return replacement;\n    };\n    FormatBlot.prototype.update = function (mutations, context) {\n        var _this = this;\n        _super.prototype.update.call(this, mutations, context);\n        if (mutations.some(function (mutation) {\n            return mutation.target === _this.domNode && mutation.type === 'attributes';\n        })) {\n            this.attributes.build();\n        }\n    };\n    FormatBlot.prototype.wrap = function (name, value) {\n        var wrapper = _super.prototype.wrap.call(this, name, value);\n        if (wrapper instanceof FormatBlot && wrapper.statics.scope === this.statics.scope) {\n            this.attributes.move(wrapper);\n        }\n        return wrapper;\n    };\n    return FormatBlot;\n}(container_1.default));\nexports.default = FormatBlot;\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar shadow_1 = __webpack_require__(30);\nvar Registry = __webpack_require__(1);\nvar LeafBlot = /** @class */ (function (_super) {\n    __extends(LeafBlot, _super);\n    function LeafBlot() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    LeafBlot.value = function (domNode) {\n        return true;\n    };\n    LeafBlot.prototype.index = function (node, offset) {\n        if (this.domNode === node ||\n            this.domNode.compareDocumentPosition(node) & Node.DOCUMENT_POSITION_CONTAINED_BY) {\n            return Math.min(offset, 1);\n        }\n        return -1;\n    };\n    LeafBlot.prototype.position = function (index, inclusive) {\n        var offset = [].indexOf.call(this.parent.domNode.childNodes, this.domNode);\n        if (index > 0)\n            offset += 1;\n        return [this.parent.domNode, offset];\n    };\n    LeafBlot.prototype.value = function () {\n        var _a;\n        return _a = {}, _a[this.statics.blotName] = this.statics.value(this.domNode) || true, _a;\n    };\n    LeafBlot.scope = Registry.Scope.INLINE_BLOT;\n    return LeafBlot;\n}(shadow_1.default));\nexports.default = LeafBlot;\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar equal = __webpack_require__(11);\nvar extend = __webpack_require__(3);\n\n\nvar lib = {\n  attributes: {\n    compose: function (a, b, keepNull) {\n      if (typeof a !== 'object') a = {};\n      if (typeof b !== 'object') b = {};\n      var attributes = extend(true, {}, b);\n      if (!keepNull) {\n        attributes = Object.keys(attributes).reduce(function (copy, key) {\n          if (attributes[key] != null) {\n            copy[key] = attributes[key];\n          }\n          return copy;\n        }, {});\n      }\n      for (var key in a) {\n        if (a[key] !== undefined && b[key] === undefined) {\n          attributes[key] = a[key];\n        }\n      }\n      return Object.keys(attributes).length > 0 ? attributes : undefined;\n    },\n\n    diff: function(a, b) {\n      if (typeof a !== 'object') a = {};\n      if (typeof b !== 'object') b = {};\n      var attributes = Object.keys(a).concat(Object.keys(b)).reduce(function (attributes, key) {\n        if (!equal(a[key], b[key])) {\n          attributes[key] = b[key] === undefined ? null : b[key];\n        }\n        return attributes;\n      }, {});\n      return Object.keys(attributes).length > 0 ? attributes : undefined;\n    },\n\n    transform: function (a, b, priority) {\n      if (typeof a !== 'object') return b;\n      if (typeof b !== 'object') return undefined;\n      if (!priority) return b;  // b simply overwrites us without priority\n      var attributes = Object.keys(b).reduce(function (attributes, key) {\n        if (a[key] === undefined) attributes[key] = b[key];  // null is a valid value\n        return attributes;\n      }, {});\n      return Object.keys(attributes).length > 0 ? attributes : undefined;\n    }\n  },\n\n  iterator: function (ops) {\n    return new Iterator(ops);\n  },\n\n  length: function (op) {\n    if (typeof op['delete'] === 'number') {\n      return op['delete'];\n    } else if (typeof op.retain === 'number') {\n      return op.retain;\n    } else {\n      return typeof op.insert === 'string' ? op.insert.length : 1;\n    }\n  }\n};\n\n\nfunction Iterator(ops) {\n  this.ops = ops;\n  this.index = 0;\n  this.offset = 0;\n};\n\nIterator.prototype.hasNext = function () {\n  return this.peekLength() < Infinity;\n};\n\nIterator.prototype.next = function (length) {\n  if (!length) length = Infinity;\n  var nextOp = this.ops[this.index];\n  if (nextOp) {\n    var offset = this.offset;\n    var opLength = lib.length(nextOp)\n    if (length >= opLength - offset) {\n      length = opLength - offset;\n      this.index += 1;\n      this.offset = 0;\n    } else {\n      this.offset += length;\n    }\n    if (typeof nextOp['delete'] === 'number') {\n      return { 'delete': length };\n    } else {\n      var retOp = {};\n      if (nextOp.attributes) {\n        retOp.attributes = nextOp.attributes;\n      }\n      if (typeof nextOp.retain === 'number') {\n        retOp.retain = length;\n      } else if (typeof nextOp.insert === 'string') {\n        retOp.insert = nextOp.insert.substr(offset, length);\n      } else {\n        // offset should === 0, length should === 1\n        retOp.insert = nextOp.insert;\n      }\n      return retOp;\n    }\n  } else {\n    return { retain: Infinity };\n  }\n};\n\nIterator.prototype.peek = function () {\n  return this.ops[this.index];\n};\n\nIterator.prototype.peekLength = function () {\n  if (this.ops[this.index]) {\n    // Should never return 0 if our index is being managed correctly\n    return lib.length(this.ops[this.index]) - this.offset;\n  } else {\n    return Infinity;\n  }\n};\n\nIterator.prototype.peekType = function () {\n  if (this.ops[this.index]) {\n    if (typeof this.ops[this.index]['delete'] === 'number') {\n      return 'delete';\n    } else if (typeof this.ops[this.index].retain === 'number') {\n      return 'retain';\n    } else {\n      return 'insert';\n    }\n  }\n  return 'retain';\n};\n\nIterator.prototype.rest = function () {\n  if (!this.hasNext()) {\n    return [];\n  } else if (this.offset === 0) {\n    return this.ops.slice(this.index);\n  } else {\n    var offset = this.offset;\n    var index = this.index;\n    var next = this.next();\n    var rest = this.ops.slice(this.index);\n    this.offset = offset;\n    this.index = index;\n    return [next].concat(rest);\n  }\n};\n\n\nmodule.exports = lib;\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports) {\n\nvar clone = (function() {\n'use strict';\n\nfunction _instanceof(obj, type) {\n  return type != null && obj instanceof type;\n}\n\nvar nativeMap;\ntry {\n  nativeMap = Map;\n} catch(_) {\n  // maybe a reference error because no `Map`. Give it a dummy value that no\n  // value will ever be an instanceof.\n  nativeMap = function() {};\n}\n\nvar nativeSet;\ntry {\n  nativeSet = Set;\n} catch(_) {\n  nativeSet = function() {};\n}\n\nvar nativePromise;\ntry {\n  nativePromise = Promise;\n} catch(_) {\n  nativePromise = function() {};\n}\n\n/**\n * Clones (copies) an Object using deep copying.\n *\n * This function supports circular references by default, but if you are certain\n * there are no circular references in your object, you can save some CPU time\n * by calling clone(obj, false).\n *\n * Caution: if `circular` is false and `parent` contains circular references,\n * your program may enter an infinite loop and crash.\n *\n * @param `parent` - the object to be cloned\n * @param `circular` - set to true if the object to be cloned may contain\n *    circular references. (optional - true by default)\n * @param `depth` - set to a number if the object is only to be cloned to\n *    a particular depth. (optional - defaults to Infinity)\n * @param `prototype` - sets the prototype to be used when cloning an object.\n *    (optional - defaults to parent prototype).\n * @param `includeNonEnumerable` - set to true if the non-enumerable properties\n *    should be cloned as well. Non-enumerable properties on the prototype\n *    chain will be ignored. (optional - false by default)\n*/\nfunction clone(parent, circular, depth, prototype, includeNonEnumerable) {\n  if (typeof circular === 'object') {\n    depth = circular.depth;\n    prototype = circular.prototype;\n    includeNonEnumerable = circular.includeNonEnumerable;\n    circular = circular.circular;\n  }\n  // maintain two arrays for circular references, where corresponding parents\n  // and children have the same index\n  var allParents = [];\n  var allChildren = [];\n\n  var useBuffer = typeof Buffer != 'undefined';\n\n  if (typeof circular == 'undefined')\n    circular = true;\n\n  if (typeof depth == 'undefined')\n    depth = Infinity;\n\n  // recurse this function so we don't reset allParents and allChildren\n  function _clone(parent, depth) {\n    // cloning null always returns null\n    if (parent === null)\n      return null;\n\n    if (depth === 0)\n      return parent;\n\n    var child;\n    var proto;\n    if (typeof parent != 'object') {\n      return parent;\n    }\n\n    if (_instanceof(parent, nativeMap)) {\n      child = new nativeMap();\n    } else if (_instanceof(parent, nativeSet)) {\n      child = new nativeSet();\n    } else if (_instanceof(parent, nativePromise)) {\n      child = new nativePromise(function (resolve, reject) {\n        parent.then(function(value) {\n          resolve(_clone(value, depth - 1));\n        }, function(err) {\n          reject(_clone(err, depth - 1));\n        });\n      });\n    } else if (clone.__isArray(parent)) {\n      child = [];\n    } else if (clone.__isRegExp(parent)) {\n      child = new RegExp(parent.source, __getRegExpFlags(parent));\n      if (parent.lastIndex) child.lastIndex = parent.lastIndex;\n    } else if (clone.__isDate(parent)) {\n      child = new Date(parent.getTime());\n    } else if (useBuffer && Buffer.isBuffer(parent)) {\n      if (Buffer.allocUnsafe) {\n        // Node.js >= 4.5.0\n        child = Buffer.allocUnsafe(parent.length);\n      } else {\n        // Older Node.js versions\n        child = new Buffer(parent.length);\n      }\n      parent.copy(child);\n      return child;\n    } else if (_instanceof(parent, Error)) {\n      child = Object.create(parent);\n    } else {\n      if (typeof prototype == 'undefined') {\n        proto = Object.getPrototypeOf(parent);\n        child = Object.create(proto);\n      }\n      else {\n        child = Object.create(prototype);\n        proto = prototype;\n      }\n    }\n\n    if (circular) {\n      var index = allParents.indexOf(parent);\n\n      if (index != -1) {\n        return allChildren[index];\n      }\n      allParents.push(parent);\n      allChildren.push(child);\n    }\n\n    if (_instanceof(parent, nativeMap)) {\n      parent.forEach(function(value, key) {\n        var keyChild = _clone(key, depth - 1);\n        var valueChild = _clone(value, depth - 1);\n        child.set(keyChild, valueChild);\n      });\n    }\n    if (_instanceof(parent, nativeSet)) {\n      parent.forEach(function(value) {\n        var entryChild = _clone(value, depth - 1);\n        child.add(entryChild);\n      });\n    }\n\n    for (var i in parent) {\n      var attrs;\n      if (proto) {\n        attrs = Object.getOwnPropertyDescriptor(proto, i);\n      }\n\n      if (attrs && attrs.set == null) {\n        continue;\n      }\n      child[i] = _clone(parent[i], depth - 1);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(parent);\n      for (var i = 0; i < symbols.length; i++) {\n        // Don't need to worry about cloning a symbol because it is a primitive,\n        // like a number or string.\n        var symbol = symbols[i];\n        var descriptor = Object.getOwnPropertyDescriptor(parent, symbol);\n        if (descriptor && !descriptor.enumerable && !includeNonEnumerable) {\n          continue;\n        }\n        child[symbol] = _clone(parent[symbol], depth - 1);\n        if (!descriptor.enumerable) {\n          Object.defineProperty(child, symbol, {\n            enumerable: false\n          });\n        }\n      }\n    }\n\n    if (includeNonEnumerable) {\n      var allPropertyNames = Object.getOwnPropertyNames(parent);\n      for (var i = 0; i < allPropertyNames.length; i++) {\n        var propertyName = allPropertyNames[i];\n        var descriptor = Object.getOwnPropertyDescriptor(parent, propertyName);\n        if (descriptor && descriptor.enumerable) {\n          continue;\n        }\n        child[propertyName] = _clone(parent[propertyName], depth - 1);\n        Object.defineProperty(child, propertyName, {\n          enumerable: false\n        });\n      }\n    }\n\n    return child;\n  }\n\n  return _clone(parent, depth);\n}\n\n/**\n * Simple flat clone using prototype, accepts only objects, usefull for property\n * override on FLAT configuration object (no nested props).\n *\n * USE WITH CAUTION! This may not behave as you wish if you do not know how this\n * works.\n */\nclone.clonePrototype = function clonePrototype(parent) {\n  if (parent === null)\n    return null;\n\n  var c = function () {};\n  c.prototype = parent;\n  return new c();\n};\n\n// private utility functions\n\nfunction __objToStr(o) {\n  return Object.prototype.toString.call(o);\n}\nclone.__objToStr = __objToStr;\n\nfunction __isDate(o) {\n  return typeof o === 'object' && __objToStr(o) === '[object Date]';\n}\nclone.__isDate = __isDate;\n\nfunction __isArray(o) {\n  return typeof o === 'object' && __objToStr(o) === '[object Array]';\n}\nclone.__isArray = __isArray;\n\nfunction __isRegExp(o) {\n  return typeof o === 'object' && __objToStr(o) === '[object RegExp]';\n}\nclone.__isRegExp = __isRegExp;\n\nfunction __getRegExpFlags(re) {\n  var flags = '';\n  if (re.global) flags += 'g';\n  if (re.ignoreCase) flags += 'i';\n  if (re.multiline) flags += 'm';\n  return flags;\n}\nclone.__getRegExpFlags = __getRegExpFlags;\n\nreturn clone;\n})();\n\nif (typeof module === 'object' && module.exports) {\n  module.exports = clone;\n}\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _emitter = __webpack_require__(8);\n\nvar _emitter2 = _interopRequireDefault(_emitter);\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nvar _break = __webpack_require__(16);\n\nvar _break2 = _interopRequireDefault(_break);\n\nvar _code = __webpack_require__(13);\n\nvar _code2 = _interopRequireDefault(_code);\n\nvar _container = __webpack_require__(25);\n\nvar _container2 = _interopRequireDefault(_container);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction isLine(blot) {\n  return blot instanceof _block2.default || blot instanceof _block.BlockEmbed;\n}\n\nvar Scroll = function (_Parchment$Scroll) {\n  _inherits(Scroll, _Parchment$Scroll);\n\n  function Scroll(domNode, config) {\n    _classCallCheck(this, Scroll);\n\n    var _this = _possibleConstructorReturn(this, (Scroll.__proto__ || Object.getPrototypeOf(Scroll)).call(this, domNode));\n\n    _this.emitter = config.emitter;\n    if (Array.isArray(config.whitelist)) {\n      _this.whitelist = config.whitelist.reduce(function (whitelist, format) {\n        whitelist[format] = true;\n        return whitelist;\n      }, {});\n    }\n    // Some reason fixes composition issues with character languages in Windows/Chrome, Safari\n    _this.domNode.addEventListener('DOMNodeInserted', function () {});\n    _this.optimize();\n    _this.enable();\n    return _this;\n  }\n\n  _createClass(Scroll, [{\n    key: 'batchStart',\n    value: function batchStart() {\n      this.batch = true;\n    }\n  }, {\n    key: 'batchEnd',\n    value: function batchEnd() {\n      this.batch = false;\n      this.optimize();\n    }\n  }, {\n    key: 'deleteAt',\n    value: function deleteAt(index, length) {\n      var _line = this.line(index),\n          _line2 = _slicedToArray(_line, 2),\n          first = _line2[0],\n          offset = _line2[1];\n\n      var _line3 = this.line(index + length),\n          _line4 = _slicedToArray(_line3, 1),\n          last = _line4[0];\n\n      _get(Scroll.prototype.__proto__ || Object.getPrototypeOf(Scroll.prototype), 'deleteAt', this).call(this, index, length);\n      if (last != null && first !== last && offset > 0) {\n        if (first instanceof _block.BlockEmbed || last instanceof _block.BlockEmbed) {\n          this.optimize();\n          return;\n        }\n        if (first instanceof _code2.default) {\n          var newlineIndex = first.newlineIndex(first.length(), true);\n          if (newlineIndex > -1) {\n            first = first.split(newlineIndex + 1);\n            if (first === last) {\n              this.optimize();\n              return;\n            }\n          }\n        } else if (last instanceof _code2.default) {\n          var _newlineIndex = last.newlineIndex(0);\n          if (_newlineIndex > -1) {\n            last.split(_newlineIndex + 1);\n          }\n        }\n        var ref = last.children.head instanceof _break2.default ? null : last.children.head;\n        first.moveChildren(last, ref);\n        first.remove();\n      }\n      this.optimize();\n    }\n  }, {\n    key: 'enable',\n    value: function enable() {\n      var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n      this.domNode.setAttribute('contenteditable', enabled);\n    }\n  }, {\n    key: 'formatAt',\n    value: function formatAt(index, length, format, value) {\n      if (this.whitelist != null && !this.whitelist[format]) return;\n      _get(Scroll.prototype.__proto__ || Object.getPrototypeOf(Scroll.prototype), 'formatAt', this).call(this, index, length, format, value);\n      this.optimize();\n    }\n  }, {\n    key: 'insertAt',\n    value: function insertAt(index, value, def) {\n      if (def != null && this.whitelist != null && !this.whitelist[value]) return;\n      if (index >= this.length()) {\n        if (def == null || _parchment2.default.query(value, _parchment2.default.Scope.BLOCK) == null) {\n          var blot = _parchment2.default.create(this.statics.defaultChild);\n          this.appendChild(blot);\n          if (def == null && value.endsWith('\\n')) {\n            value = value.slice(0, -1);\n          }\n          blot.insertAt(0, value, def);\n        } else {\n          var embed = _parchment2.default.create(value, def);\n          this.appendChild(embed);\n        }\n      } else {\n        _get(Scroll.prototype.__proto__ || Object.getPrototypeOf(Scroll.prototype), 'insertAt', this).call(this, index, value, def);\n      }\n      this.optimize();\n    }\n  }, {\n    key: 'insertBefore',\n    value: function insertBefore(blot, ref) {\n      if (blot.statics.scope === _parchment2.default.Scope.INLINE_BLOT) {\n        var wrapper = _parchment2.default.create(this.statics.defaultChild);\n        wrapper.appendChild(blot);\n        blot = wrapper;\n      }\n      _get(Scroll.prototype.__proto__ || Object.getPrototypeOf(Scroll.prototype), 'insertBefore', this).call(this, blot, ref);\n    }\n  }, {\n    key: 'leaf',\n    value: function leaf(index) {\n      return this.path(index).pop() || [null, -1];\n    }\n  }, {\n    key: 'line',\n    value: function line(index) {\n      if (index === this.length()) {\n        return this.line(index - 1);\n      }\n      return this.descendant(isLine, index);\n    }\n  }, {\n    key: 'lines',\n    value: function lines() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Number.MAX_VALUE;\n\n      var getLines = function getLines(blot, index, length) {\n        var lines = [],\n            lengthLeft = length;\n        blot.children.forEachAt(index, length, function (child, index, length) {\n          if (isLine(child)) {\n            lines.push(child);\n          } else if (child instanceof _parchment2.default.Container) {\n            lines = lines.concat(getLines(child, index, lengthLeft));\n          }\n          lengthLeft -= length;\n        });\n        return lines;\n      };\n      return getLines(this, index, length);\n    }\n  }, {\n    key: 'optimize',\n    value: function optimize() {\n      var mutations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (this.batch === true) return;\n      _get(Scroll.prototype.__proto__ || Object.getPrototypeOf(Scroll.prototype), 'optimize', this).call(this, mutations, context);\n      if (mutations.length > 0) {\n        this.emitter.emit(_emitter2.default.events.SCROLL_OPTIMIZE, mutations, context);\n      }\n    }\n  }, {\n    key: 'path',\n    value: function path(index) {\n      return _get(Scroll.prototype.__proto__ || Object.getPrototypeOf(Scroll.prototype), 'path', this).call(this, index).slice(1); // Exclude self\n    }\n  }, {\n    key: 'update',\n    value: function update(mutations) {\n      if (this.batch === true) return;\n      var source = _emitter2.default.sources.USER;\n      if (typeof mutations === 'string') {\n        source = mutations;\n      }\n      if (!Array.isArray(mutations)) {\n        mutations = this.observer.takeRecords();\n      }\n      if (mutations.length > 0) {\n        this.emitter.emit(_emitter2.default.events.SCROLL_BEFORE_UPDATE, source, mutations);\n      }\n      _get(Scroll.prototype.__proto__ || Object.getPrototypeOf(Scroll.prototype), 'update', this).call(this, mutations.concat([])); // pass copy\n      if (mutations.length > 0) {\n        this.emitter.emit(_emitter2.default.events.SCROLL_UPDATE, source, mutations);\n      }\n    }\n  }]);\n\n  return Scroll;\n}(_parchment2.default.Scroll);\n\nScroll.blotName = 'scroll';\nScroll.className = 'ql-editor';\nScroll.tagName = 'DIV';\nScroll.defaultChild = 'block';\nScroll.allowedChildren = [_block2.default, _block.BlockEmbed, _container2.default];\n\nexports.default = Scroll;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SHORTKEY = exports.default = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _clone = __webpack_require__(21);\n\nvar _clone2 = _interopRequireDefault(_clone);\n\nvar _deepEqual = __webpack_require__(11);\n\nvar _deepEqual2 = _interopRequireDefault(_deepEqual);\n\nvar _extend = __webpack_require__(3);\n\nvar _extend2 = _interopRequireDefault(_extend);\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _op = __webpack_require__(20);\n\nvar _op2 = _interopRequireDefault(_op);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _quill = __webpack_require__(5);\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _logger = __webpack_require__(10);\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _module = __webpack_require__(9);\n\nvar _module2 = _interopRequireDefault(_module);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar debug = (0, _logger2.default)('quill:keyboard');\n\nvar SHORTKEY = /Mac/i.test(navigator.platform) ? 'metaKey' : 'ctrlKey';\n\nvar Keyboard = function (_Module) {\n  _inherits(Keyboard, _Module);\n\n  _createClass(Keyboard, null, [{\n    key: 'match',\n    value: function match(evt, binding) {\n      binding = normalize(binding);\n      if (['altKey', 'ctrlKey', 'metaKey', 'shiftKey'].some(function (key) {\n        return !!binding[key] !== evt[key] && binding[key] !== null;\n      })) {\n        return false;\n      }\n      return binding.key === (evt.which || evt.keyCode);\n    }\n  }]);\n\n  function Keyboard(quill, options) {\n    _classCallCheck(this, Keyboard);\n\n    var _this = _possibleConstructorReturn(this, (Keyboard.__proto__ || Object.getPrototypeOf(Keyboard)).call(this, quill, options));\n\n    _this.bindings = {};\n    Object.keys(_this.options.bindings).forEach(function (name) {\n      if (name === 'list autofill' && quill.scroll.whitelist != null && !quill.scroll.whitelist['list']) {\n        return;\n      }\n      if (_this.options.bindings[name]) {\n        _this.addBinding(_this.options.bindings[name]);\n      }\n    });\n    _this.addBinding({ key: Keyboard.keys.ENTER, shiftKey: null }, handleEnter);\n    _this.addBinding({ key: Keyboard.keys.ENTER, metaKey: null, ctrlKey: null, altKey: null }, function () {});\n    if (/Firefox/i.test(navigator.userAgent)) {\n      // Need to handle delete and backspace for Firefox in the general case #1171\n      _this.addBinding({ key: Keyboard.keys.BACKSPACE }, { collapsed: true }, handleBackspace);\n      _this.addBinding({ key: Keyboard.keys.DELETE }, { collapsed: true }, handleDelete);\n    } else {\n      _this.addBinding({ key: Keyboard.keys.BACKSPACE }, { collapsed: true, prefix: /^.?$/ }, handleBackspace);\n      _this.addBinding({ key: Keyboard.keys.DELETE }, { collapsed: true, suffix: /^.?$/ }, handleDelete);\n    }\n    _this.addBinding({ key: Keyboard.keys.BACKSPACE }, { collapsed: false }, handleDeleteRange);\n    _this.addBinding({ key: Keyboard.keys.DELETE }, { collapsed: false }, handleDeleteRange);\n    _this.addBinding({ key: Keyboard.keys.BACKSPACE, altKey: null, ctrlKey: null, metaKey: null, shiftKey: null }, { collapsed: true, offset: 0 }, handleBackspace);\n    _this.listen();\n    return _this;\n  }\n\n  _createClass(Keyboard, [{\n    key: 'addBinding',\n    value: function addBinding(key) {\n      var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var handler = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      var binding = normalize(key);\n      if (binding == null || binding.key == null) {\n        return debug.warn('Attempted to add invalid keyboard binding', binding);\n      }\n      if (typeof context === 'function') {\n        context = { handler: context };\n      }\n      if (typeof handler === 'function') {\n        handler = { handler: handler };\n      }\n      binding = (0, _extend2.default)(binding, context, handler);\n      this.bindings[binding.key] = this.bindings[binding.key] || [];\n      this.bindings[binding.key].push(binding);\n    }\n  }, {\n    key: 'listen',\n    value: function listen() {\n      var _this2 = this;\n\n      this.quill.root.addEventListener('keydown', function (evt) {\n        if (evt.defaultPrevented) return;\n        var which = evt.which || evt.keyCode;\n        var bindings = (_this2.bindings[which] || []).filter(function (binding) {\n          return Keyboard.match(evt, binding);\n        });\n        if (bindings.length === 0) return;\n        var range = _this2.quill.getSelection();\n        if (range == null || !_this2.quill.hasFocus()) return;\n\n        var _quill$getLine = _this2.quill.getLine(range.index),\n            _quill$getLine2 = _slicedToArray(_quill$getLine, 2),\n            line = _quill$getLine2[0],\n            offset = _quill$getLine2[1];\n\n        var _quill$getLeaf = _this2.quill.getLeaf(range.index),\n            _quill$getLeaf2 = _slicedToArray(_quill$getLeaf, 2),\n            leafStart = _quill$getLeaf2[0],\n            offsetStart = _quill$getLeaf2[1];\n\n        var _ref = range.length === 0 ? [leafStart, offsetStart] : _this2.quill.getLeaf(range.index + range.length),\n            _ref2 = _slicedToArray(_ref, 2),\n            leafEnd = _ref2[0],\n            offsetEnd = _ref2[1];\n\n        var prefixText = leafStart instanceof _parchment2.default.Text ? leafStart.value().slice(0, offsetStart) : '';\n        var suffixText = leafEnd instanceof _parchment2.default.Text ? leafEnd.value().slice(offsetEnd) : '';\n        var curContext = {\n          collapsed: range.length === 0,\n          empty: range.length === 0 && line.length() <= 1,\n          format: _this2.quill.getFormat(range),\n          offset: offset,\n          prefix: prefixText,\n          suffix: suffixText\n        };\n        var prevented = bindings.some(function (binding) {\n          if (binding.collapsed != null && binding.collapsed !== curContext.collapsed) return false;\n          if (binding.empty != null && binding.empty !== curContext.empty) return false;\n          if (binding.offset != null && binding.offset !== curContext.offset) return false;\n          if (Array.isArray(binding.format)) {\n            // any format is present\n            if (binding.format.every(function (name) {\n              return curContext.format[name] == null;\n            })) {\n              return false;\n            }\n          } else if (_typeof(binding.format) === 'object') {\n            // all formats must match\n            if (!Object.keys(binding.format).every(function (name) {\n              if (binding.format[name] === true) return curContext.format[name] != null;\n              if (binding.format[name] === false) return curContext.format[name] == null;\n              return (0, _deepEqual2.default)(binding.format[name], curContext.format[name]);\n            })) {\n              return false;\n            }\n          }\n          if (binding.prefix != null && !binding.prefix.test(curContext.prefix)) return false;\n          if (binding.suffix != null && !binding.suffix.test(curContext.suffix)) return false;\n          return binding.handler.call(_this2, range, curContext) !== true;\n        });\n        if (prevented) {\n          evt.preventDefault();\n        }\n      });\n    }\n  }]);\n\n  return Keyboard;\n}(_module2.default);\n\nKeyboard.keys = {\n  BACKSPACE: 8,\n  TAB: 9,\n  ENTER: 13,\n  ESCAPE: 27,\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40,\n  DELETE: 46\n};\n\nKeyboard.DEFAULTS = {\n  bindings: {\n    'bold': makeFormatHandler('bold'),\n    'italic': makeFormatHandler('italic'),\n    'underline': makeFormatHandler('underline'),\n    'indent': {\n      // highlight tab or tab at beginning of list, indent or blockquote\n      key: Keyboard.keys.TAB,\n      format: ['blockquote', 'indent', 'list'],\n      handler: function handler(range, context) {\n        if (context.collapsed && context.offset !== 0) return true;\n        this.quill.format('indent', '+1', _quill2.default.sources.USER);\n      }\n    },\n    'outdent': {\n      key: Keyboard.keys.TAB,\n      shiftKey: true,\n      format: ['blockquote', 'indent', 'list'],\n      // highlight tab or tab at beginning of list, indent or blockquote\n      handler: function handler(range, context) {\n        if (context.collapsed && context.offset !== 0) return true;\n        this.quill.format('indent', '-1', _quill2.default.sources.USER);\n      }\n    },\n    'outdent backspace': {\n      key: Keyboard.keys.BACKSPACE,\n      collapsed: true,\n      shiftKey: null,\n      metaKey: null,\n      ctrlKey: null,\n      altKey: null,\n      format: ['indent', 'list'],\n      offset: 0,\n      handler: function handler(range, context) {\n        if (context.format.indent != null) {\n          this.quill.format('indent', '-1', _quill2.default.sources.USER);\n        } else if (context.format.list != null) {\n          this.quill.format('list', false, _quill2.default.sources.USER);\n        }\n      }\n    },\n    'indent code-block': makeCodeBlockHandler(true),\n    'outdent code-block': makeCodeBlockHandler(false),\n    'remove tab': {\n      key: Keyboard.keys.TAB,\n      shiftKey: true,\n      collapsed: true,\n      prefix: /\\t$/,\n      handler: function handler(range) {\n        this.quill.deleteText(range.index - 1, 1, _quill2.default.sources.USER);\n      }\n    },\n    'tab': {\n      key: Keyboard.keys.TAB,\n      handler: function handler(range) {\n        this.quill.history.cutoff();\n        var delta = new _quillDelta2.default().retain(range.index).delete(range.length).insert('\\t');\n        this.quill.updateContents(delta, _quill2.default.sources.USER);\n        this.quill.history.cutoff();\n        this.quill.setSelection(range.index + 1, _quill2.default.sources.SILENT);\n      }\n    },\n    'list empty enter': {\n      key: Keyboard.keys.ENTER,\n      collapsed: true,\n      format: ['list'],\n      empty: true,\n      handler: function handler(range, context) {\n        this.quill.format('list', false, _quill2.default.sources.USER);\n        if (context.format.indent) {\n          this.quill.format('indent', false, _quill2.default.sources.USER);\n        }\n      }\n    },\n    'checklist enter': {\n      key: Keyboard.keys.ENTER,\n      collapsed: true,\n      format: { list: 'checked' },\n      handler: function handler(range) {\n        var _quill$getLine3 = this.quill.getLine(range.index),\n            _quill$getLine4 = _slicedToArray(_quill$getLine3, 2),\n            line = _quill$getLine4[0],\n            offset = _quill$getLine4[1];\n\n        var formats = (0, _extend2.default)({}, line.formats(), { list: 'checked' });\n        var delta = new _quillDelta2.default().retain(range.index).insert('\\n', formats).retain(line.length() - offset - 1).retain(1, { list: 'unchecked' });\n        this.quill.updateContents(delta, _quill2.default.sources.USER);\n        this.quill.setSelection(range.index + 1, _quill2.default.sources.SILENT);\n        this.quill.scrollIntoView();\n      }\n    },\n    'header enter': {\n      key: Keyboard.keys.ENTER,\n      collapsed: true,\n      format: ['header'],\n      suffix: /^$/,\n      handler: function handler(range, context) {\n        var _quill$getLine5 = this.quill.getLine(range.index),\n            _quill$getLine6 = _slicedToArray(_quill$getLine5, 2),\n            line = _quill$getLine6[0],\n            offset = _quill$getLine6[1];\n\n        var delta = new _quillDelta2.default().retain(range.index).insert('\\n', context.format).retain(line.length() - offset - 1).retain(1, { header: null });\n        this.quill.updateContents(delta, _quill2.default.sources.USER);\n        this.quill.setSelection(range.index + 1, _quill2.default.sources.SILENT);\n        this.quill.scrollIntoView();\n      }\n    },\n    'list autofill': {\n      key: ' ',\n      collapsed: true,\n      format: { list: false },\n      prefix: /^\\s*?(\\d+\\.|-|\\*|\\[ ?\\]|\\[x\\])$/,\n      handler: function handler(range, context) {\n        var length = context.prefix.length;\n\n        var _quill$getLine7 = this.quill.getLine(range.index),\n            _quill$getLine8 = _slicedToArray(_quill$getLine7, 2),\n            line = _quill$getLine8[0],\n            offset = _quill$getLine8[1];\n\n        if (offset > length) return true;\n        var value = void 0;\n        switch (context.prefix.trim()) {\n          case '[]':case '[ ]':\n            value = 'unchecked';\n            break;\n          case '[x]':\n            value = 'checked';\n            break;\n          case '-':case '*':\n            value = 'bullet';\n            break;\n          default:\n            value = 'ordered';\n        }\n        this.quill.insertText(range.index, ' ', _quill2.default.sources.USER);\n        this.quill.history.cutoff();\n        var delta = new _quillDelta2.default().retain(range.index - offset).delete(length + 1).retain(line.length() - 2 - offset).retain(1, { list: value });\n        this.quill.updateContents(delta, _quill2.default.sources.USER);\n        this.quill.history.cutoff();\n        this.quill.setSelection(range.index - length, _quill2.default.sources.SILENT);\n      }\n    },\n    'code exit': {\n      key: Keyboard.keys.ENTER,\n      collapsed: true,\n      format: ['code-block'],\n      prefix: /\\n\\n$/,\n      suffix: /^\\s+$/,\n      handler: function handler(range) {\n        var _quill$getLine9 = this.quill.getLine(range.index),\n            _quill$getLine10 = _slicedToArray(_quill$getLine9, 2),\n            line = _quill$getLine10[0],\n            offset = _quill$getLine10[1];\n\n        var delta = new _quillDelta2.default().retain(range.index + line.length() - offset - 2).retain(1, { 'code-block': null }).delete(1);\n        this.quill.updateContents(delta, _quill2.default.sources.USER);\n      }\n    },\n    'embed left': makeEmbedArrowHandler(Keyboard.keys.LEFT, false),\n    'embed left shift': makeEmbedArrowHandler(Keyboard.keys.LEFT, true),\n    'embed right': makeEmbedArrowHandler(Keyboard.keys.RIGHT, false),\n    'embed right shift': makeEmbedArrowHandler(Keyboard.keys.RIGHT, true)\n  }\n};\n\nfunction makeEmbedArrowHandler(key, shiftKey) {\n  var _ref3;\n\n  var where = key === Keyboard.keys.LEFT ? 'prefix' : 'suffix';\n  return _ref3 = {\n    key: key,\n    shiftKey: shiftKey,\n    altKey: null\n  }, _defineProperty(_ref3, where, /^$/), _defineProperty(_ref3, 'handler', function handler(range) {\n    var index = range.index;\n    if (key === Keyboard.keys.RIGHT) {\n      index += range.length + 1;\n    }\n\n    var _quill$getLeaf3 = this.quill.getLeaf(index),\n        _quill$getLeaf4 = _slicedToArray(_quill$getLeaf3, 1),\n        leaf = _quill$getLeaf4[0];\n\n    if (!(leaf instanceof _parchment2.default.Embed)) return true;\n    if (key === Keyboard.keys.LEFT) {\n      if (shiftKey) {\n        this.quill.setSelection(range.index - 1, range.length + 1, _quill2.default.sources.USER);\n      } else {\n        this.quill.setSelection(range.index - 1, _quill2.default.sources.USER);\n      }\n    } else {\n      if (shiftKey) {\n        this.quill.setSelection(range.index, range.length + 1, _quill2.default.sources.USER);\n      } else {\n        this.quill.setSelection(range.index + range.length + 1, _quill2.default.sources.USER);\n      }\n    }\n    return false;\n  }), _ref3;\n}\n\nfunction handleBackspace(range, context) {\n  if (range.index === 0 || this.quill.getLength() <= 1) return;\n\n  var _quill$getLine11 = this.quill.getLine(range.index),\n      _quill$getLine12 = _slicedToArray(_quill$getLine11, 1),\n      line = _quill$getLine12[0];\n\n  var formats = {};\n  if (context.offset === 0) {\n    var _quill$getLine13 = this.quill.getLine(range.index - 1),\n        _quill$getLine14 = _slicedToArray(_quill$getLine13, 1),\n        prev = _quill$getLine14[0];\n\n    if (prev != null && prev.length() > 1) {\n      var curFormats = line.formats();\n      var prevFormats = this.quill.getFormat(range.index - 1, 1);\n      formats = _op2.default.attributes.diff(curFormats, prevFormats) || {};\n    }\n  }\n  // Check for astral symbols\n  var length = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]$/.test(context.prefix) ? 2 : 1;\n  this.quill.deleteText(range.index - length, length, _quill2.default.sources.USER);\n  if (Object.keys(formats).length > 0) {\n    this.quill.formatLine(range.index - length, length, formats, _quill2.default.sources.USER);\n  }\n  this.quill.focus();\n}\n\nfunction handleDelete(range, context) {\n  // Check for astral symbols\n  var length = /^[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/.test(context.suffix) ? 2 : 1;\n  if (range.index >= this.quill.getLength() - length) return;\n  var formats = {},\n      nextLength = 0;\n\n  var _quill$getLine15 = this.quill.getLine(range.index),\n      _quill$getLine16 = _slicedToArray(_quill$getLine15, 1),\n      line = _quill$getLine16[0];\n\n  if (context.offset >= line.length() - 1) {\n    var _quill$getLine17 = this.quill.getLine(range.index + 1),\n        _quill$getLine18 = _slicedToArray(_quill$getLine17, 1),\n        next = _quill$getLine18[0];\n\n    if (next) {\n      var curFormats = line.formats();\n      var nextFormats = this.quill.getFormat(range.index, 1);\n      formats = _op2.default.attributes.diff(curFormats, nextFormats) || {};\n      nextLength = next.length();\n    }\n  }\n  this.quill.deleteText(range.index, length, _quill2.default.sources.USER);\n  if (Object.keys(formats).length > 0) {\n    this.quill.formatLine(range.index + nextLength - 1, length, formats, _quill2.default.sources.USER);\n  }\n}\n\nfunction handleDeleteRange(range) {\n  var lines = this.quill.getLines(range);\n  var formats = {};\n  if (lines.length > 1) {\n    var firstFormats = lines[0].formats();\n    var lastFormats = lines[lines.length - 1].formats();\n    formats = _op2.default.attributes.diff(lastFormats, firstFormats) || {};\n  }\n  this.quill.deleteText(range, _quill2.default.sources.USER);\n  if (Object.keys(formats).length > 0) {\n    this.quill.formatLine(range.index, 1, formats, _quill2.default.sources.USER);\n  }\n  this.quill.setSelection(range.index, _quill2.default.sources.SILENT);\n  this.quill.focus();\n}\n\nfunction handleEnter(range, context) {\n  var _this3 = this;\n\n  if (range.length > 0) {\n    this.quill.scroll.deleteAt(range.index, range.length); // So we do not trigger text-change\n  }\n  var lineFormats = Object.keys(context.format).reduce(function (lineFormats, format) {\n    if (_parchment2.default.query(format, _parchment2.default.Scope.BLOCK) && !Array.isArray(context.format[format])) {\n      lineFormats[format] = context.format[format];\n    }\n    return lineFormats;\n  }, {});\n  this.quill.insertText(range.index, '\\n', lineFormats, _quill2.default.sources.USER);\n  // Earlier scroll.deleteAt might have messed up our selection,\n  // so insertText's built in selection preservation is not reliable\n  this.quill.setSelection(range.index + 1, _quill2.default.sources.SILENT);\n  this.quill.focus();\n  Object.keys(context.format).forEach(function (name) {\n    if (lineFormats[name] != null) return;\n    if (Array.isArray(context.format[name])) return;\n    if (name === 'link') return;\n    _this3.quill.format(name, context.format[name], _quill2.default.sources.USER);\n  });\n}\n\nfunction makeCodeBlockHandler(indent) {\n  return {\n    key: Keyboard.keys.TAB,\n    shiftKey: !indent,\n    format: { 'code-block': true },\n    handler: function handler(range) {\n      var CodeBlock = _parchment2.default.query('code-block');\n      var index = range.index,\n          length = range.length;\n\n      var _quill$scroll$descend = this.quill.scroll.descendant(CodeBlock, index),\n          _quill$scroll$descend2 = _slicedToArray(_quill$scroll$descend, 2),\n          block = _quill$scroll$descend2[0],\n          offset = _quill$scroll$descend2[1];\n\n      if (block == null) return;\n      var scrollIndex = this.quill.getIndex(block);\n      var start = block.newlineIndex(offset, true) + 1;\n      var end = block.newlineIndex(scrollIndex + offset + length);\n      var lines = block.domNode.textContent.slice(start, end).split('\\n');\n      offset = 0;\n      lines.forEach(function (line, i) {\n        if (indent) {\n          block.insertAt(start + offset, CodeBlock.TAB);\n          offset += CodeBlock.TAB.length;\n          if (i === 0) {\n            index += CodeBlock.TAB.length;\n          } else {\n            length += CodeBlock.TAB.length;\n          }\n        } else if (line.startsWith(CodeBlock.TAB)) {\n          block.deleteAt(start + offset, CodeBlock.TAB.length);\n          offset -= CodeBlock.TAB.length;\n          if (i === 0) {\n            index -= CodeBlock.TAB.length;\n          } else {\n            length -= CodeBlock.TAB.length;\n          }\n        }\n        offset += line.length + 1;\n      });\n      this.quill.update(_quill2.default.sources.USER);\n      this.quill.setSelection(index, length, _quill2.default.sources.SILENT);\n    }\n  };\n}\n\nfunction makeFormatHandler(format) {\n  return {\n    key: format[0].toUpperCase(),\n    shortKey: true,\n    handler: function handler(range, context) {\n      this.quill.format(format, !context.format[format], _quill2.default.sources.USER);\n    }\n  };\n}\n\nfunction normalize(binding) {\n  if (typeof binding === 'string' || typeof binding === 'number') {\n    return normalize({ key: binding });\n  }\n  if ((typeof binding === 'undefined' ? 'undefined' : _typeof(binding)) === 'object') {\n    binding = (0, _clone2.default)(binding, false);\n  }\n  if (typeof binding.key === 'string') {\n    if (Keyboard.keys[binding.key.toUpperCase()] != null) {\n      binding.key = Keyboard.keys[binding.key.toUpperCase()];\n    } else if (binding.key.length === 1) {\n      binding.key = binding.key.toUpperCase().charCodeAt(0);\n    } else {\n      return null;\n    }\n  }\n  if (binding.shortKey) {\n    binding[SHORTKEY] = binding.shortKey;\n    delete binding.shortKey;\n  }\n  return binding;\n}\n\nexports.default = Keyboard;\nexports.SHORTKEY = SHORTKEY;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _text = __webpack_require__(7);\n\nvar _text2 = _interopRequireDefault(_text);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Cursor = function (_Parchment$Embed) {\n  _inherits(Cursor, _Parchment$Embed);\n\n  _createClass(Cursor, null, [{\n    key: 'value',\n    value: function value() {\n      return undefined;\n    }\n  }]);\n\n  function Cursor(domNode, selection) {\n    _classCallCheck(this, Cursor);\n\n    var _this = _possibleConstructorReturn(this, (Cursor.__proto__ || Object.getPrototypeOf(Cursor)).call(this, domNode));\n\n    _this.selection = selection;\n    _this.textNode = document.createTextNode(Cursor.CONTENTS);\n    _this.domNode.appendChild(_this.textNode);\n    _this._length = 0;\n    return _this;\n  }\n\n  _createClass(Cursor, [{\n    key: 'detach',\n    value: function detach() {\n      // super.detach() will also clear domNode.__blot\n      if (this.parent != null) this.parent.removeChild(this);\n    }\n  }, {\n    key: 'format',\n    value: function format(name, value) {\n      if (this._length !== 0) {\n        return _get(Cursor.prototype.__proto__ || Object.getPrototypeOf(Cursor.prototype), 'format', this).call(this, name, value);\n      }\n      var target = this,\n          index = 0;\n      while (target != null && target.statics.scope !== _parchment2.default.Scope.BLOCK_BLOT) {\n        index += target.offset(target.parent);\n        target = target.parent;\n      }\n      if (target != null) {\n        this._length = Cursor.CONTENTS.length;\n        target.optimize();\n        target.formatAt(index, Cursor.CONTENTS.length, name, value);\n        this._length = 0;\n      }\n    }\n  }, {\n    key: 'index',\n    value: function index(node, offset) {\n      if (node === this.textNode) return 0;\n      return _get(Cursor.prototype.__proto__ || Object.getPrototypeOf(Cursor.prototype), 'index', this).call(this, node, offset);\n    }\n  }, {\n    key: 'length',\n    value: function length() {\n      return this._length;\n    }\n  }, {\n    key: 'position',\n    value: function position() {\n      return [this.textNode, this.textNode.data.length];\n    }\n  }, {\n    key: 'remove',\n    value: function remove() {\n      _get(Cursor.prototype.__proto__ || Object.getPrototypeOf(Cursor.prototype), 'remove', this).call(this);\n      this.parent = null;\n    }\n  }, {\n    key: 'restore',\n    value: function restore() {\n      if (this.selection.composing || this.parent == null) return;\n      var textNode = this.textNode;\n      var range = this.selection.getNativeRange();\n      var restoreText = void 0,\n          start = void 0,\n          end = void 0;\n      if (range != null && range.start.node === textNode && range.end.node === textNode) {\n        var _ref = [textNode, range.start.offset, range.end.offset];\n        restoreText = _ref[0];\n        start = _ref[1];\n        end = _ref[2];\n      }\n      // Link format will insert text outside of anchor tag\n      while (this.domNode.lastChild != null && this.domNode.lastChild !== this.textNode) {\n        this.domNode.parentNode.insertBefore(this.domNode.lastChild, this.domNode);\n      }\n      if (this.textNode.data !== Cursor.CONTENTS) {\n        var text = this.textNode.data.split(Cursor.CONTENTS).join('');\n        if (this.next instanceof _text2.default) {\n          restoreText = this.next.domNode;\n          this.next.insertAt(0, text);\n          this.textNode.data = Cursor.CONTENTS;\n        } else {\n          this.textNode.data = text;\n          this.parent.insertBefore(_parchment2.default.create(this.textNode), this);\n          this.textNode = document.createTextNode(Cursor.CONTENTS);\n          this.domNode.appendChild(this.textNode);\n        }\n      }\n      this.remove();\n      if (start != null) {\n        var _map = [start, end].map(function (offset) {\n          return Math.max(0, Math.min(restoreText.data.length, offset - 1));\n        });\n\n        var _map2 = _slicedToArray(_map, 2);\n\n        start = _map2[0];\n        end = _map2[1];\n\n        return {\n          startNode: restoreText,\n          startOffset: start,\n          endNode: restoreText,\n          endOffset: end\n        };\n      }\n    }\n  }, {\n    key: 'update',\n    value: function update(mutations, context) {\n      var _this2 = this;\n\n      if (mutations.some(function (mutation) {\n        return mutation.type === 'characterData' && mutation.target === _this2.textNode;\n      })) {\n        var range = this.restore();\n        if (range) context.range = range;\n      }\n    }\n  }, {\n    key: 'value',\n    value: function value() {\n      return '';\n    }\n  }]);\n\n  return Cursor;\n}(_parchment2.default.Embed);\n\nCursor.blotName = 'cursor';\nCursor.className = 'ql-cursor';\nCursor.tagName = 'span';\nCursor.CONTENTS = '\\uFEFF'; // Zero width no break space\n\n\nexports.default = Cursor;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Container = function (_Parchment$Container) {\n  _inherits(Container, _Parchment$Container);\n\n  function Container() {\n    _classCallCheck(this, Container);\n\n    return _possibleConstructorReturn(this, (Container.__proto__ || Object.getPrototypeOf(Container)).apply(this, arguments));\n  }\n\n  return Container;\n}(_parchment2.default.Container);\n\nContainer.allowedChildren = [_block2.default, _block.BlockEmbed, Container];\n\nexports.default = Container;\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ColorStyle = exports.ColorClass = exports.ColorAttributor = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ColorAttributor = function (_Parchment$Attributor) {\n  _inherits(ColorAttributor, _Parchment$Attributor);\n\n  function ColorAttributor() {\n    _classCallCheck(this, ColorAttributor);\n\n    return _possibleConstructorReturn(this, (ColorAttributor.__proto__ || Object.getPrototypeOf(ColorAttributor)).apply(this, arguments));\n  }\n\n  _createClass(ColorAttributor, [{\n    key: 'value',\n    value: function value(domNode) {\n      var value = _get(ColorAttributor.prototype.__proto__ || Object.getPrototypeOf(ColorAttributor.prototype), 'value', this).call(this, domNode);\n      if (!value.startsWith('rgb(')) return value;\n      value = value.replace(/^[^\\d]+/, '').replace(/[^\\d]+$/, '');\n      return '#' + value.split(',').map(function (component) {\n        return ('00' + parseInt(component).toString(16)).slice(-2);\n      }).join('');\n    }\n  }]);\n\n  return ColorAttributor;\n}(_parchment2.default.Attributor.Style);\n\nvar ColorClass = new _parchment2.default.Attributor.Class('color', 'ql-color', {\n  scope: _parchment2.default.Scope.INLINE\n});\nvar ColorStyle = new ColorAttributor('color', 'color', {\n  scope: _parchment2.default.Scope.INLINE\n});\n\nexports.ColorAttributor = ColorAttributor;\nexports.ColorClass = ColorClass;\nexports.ColorStyle = ColorStyle;\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sanitize = exports.default = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Link = function (_Inline) {\n  _inherits(Link, _Inline);\n\n  function Link() {\n    _classCallCheck(this, Link);\n\n    return _possibleConstructorReturn(this, (Link.__proto__ || Object.getPrototypeOf(Link)).apply(this, arguments));\n  }\n\n  _createClass(Link, [{\n    key: 'format',\n    value: function format(name, value) {\n      if (name !== this.statics.blotName || !value) return _get(Link.prototype.__proto__ || Object.getPrototypeOf(Link.prototype), 'format', this).call(this, name, value);\n      value = this.constructor.sanitize(value);\n      this.domNode.setAttribute('href', value);\n    }\n  }], [{\n    key: 'create',\n    value: function create(value) {\n      var node = _get(Link.__proto__ || Object.getPrototypeOf(Link), 'create', this).call(this, value);\n      value = this.sanitize(value);\n      node.setAttribute('href', value);\n      node.setAttribute('rel', 'noopener noreferrer');\n      node.setAttribute('target', '_blank');\n      return node;\n    }\n  }, {\n    key: 'formats',\n    value: function formats(domNode) {\n      return domNode.getAttribute('href');\n    }\n  }, {\n    key: 'sanitize',\n    value: function sanitize(url) {\n      return _sanitize(url, this.PROTOCOL_WHITELIST) ? url : this.SANITIZED_URL;\n    }\n  }]);\n\n  return Link;\n}(_inline2.default);\n\nLink.blotName = 'link';\nLink.tagName = 'A';\nLink.SANITIZED_URL = 'about:blank';\nLink.PROTOCOL_WHITELIST = ['http', 'https', 'mailto', 'tel'];\n\nfunction _sanitize(url, protocols) {\n  var anchor = document.createElement('a');\n  anchor.href = url;\n  var protocol = anchor.href.slice(0, anchor.href.indexOf(':'));\n  return protocols.indexOf(protocol) > -1;\n}\n\nexports.default = Link;\nexports.sanitize = _sanitize;\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _keyboard = __webpack_require__(23);\n\nvar _keyboard2 = _interopRequireDefault(_keyboard);\n\nvar _dropdown = __webpack_require__(107);\n\nvar _dropdown2 = _interopRequireDefault(_dropdown);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar optionsCounter = 0;\n\nfunction toggleAriaAttribute(element, attribute) {\n  element.setAttribute(attribute, !(element.getAttribute(attribute) === 'true'));\n}\n\nvar Picker = function () {\n  function Picker(select) {\n    var _this = this;\n\n    _classCallCheck(this, Picker);\n\n    this.select = select;\n    this.container = document.createElement('span');\n    this.buildPicker();\n    this.select.style.display = 'none';\n    this.select.parentNode.insertBefore(this.container, this.select);\n\n    this.label.addEventListener('mousedown', function () {\n      _this.togglePicker();\n    });\n    this.label.addEventListener('keydown', function (event) {\n      switch (event.keyCode) {\n        // Allows the \"Enter\" key to open the picker\n        case _keyboard2.default.keys.ENTER:\n          _this.togglePicker();\n          break;\n\n        // Allows the \"Escape\" key to close the picker\n        case _keyboard2.default.keys.ESCAPE:\n          _this.escape();\n          event.preventDefault();\n          break;\n        default:\n      }\n    });\n    this.select.addEventListener('change', this.update.bind(this));\n  }\n\n  _createClass(Picker, [{\n    key: 'togglePicker',\n    value: function togglePicker() {\n      this.container.classList.toggle('ql-expanded');\n      // Toggle aria-expanded and aria-hidden to make the picker accessible\n      toggleAriaAttribute(this.label, 'aria-expanded');\n      toggleAriaAttribute(this.options, 'aria-hidden');\n    }\n  }, {\n    key: 'buildItem',\n    value: function buildItem(option) {\n      var _this2 = this;\n\n      var item = document.createElement('span');\n      item.tabIndex = '0';\n      item.setAttribute('role', 'button');\n\n      item.classList.add('ql-picker-item');\n      if (option.hasAttribute('value')) {\n        item.setAttribute('data-value', option.getAttribute('value'));\n      }\n      if (option.textContent) {\n        item.setAttribute('data-label', option.textContent);\n      }\n      item.addEventListener('click', function () {\n        _this2.selectItem(item, true);\n      });\n      item.addEventListener('keydown', function (event) {\n        switch (event.keyCode) {\n          // Allows the \"Enter\" key to select an item\n          case _keyboard2.default.keys.ENTER:\n            _this2.selectItem(item, true);\n            event.preventDefault();\n            break;\n\n          // Allows the \"Escape\" key to close the picker\n          case _keyboard2.default.keys.ESCAPE:\n            _this2.escape();\n            event.preventDefault();\n            break;\n          default:\n        }\n      });\n\n      return item;\n    }\n  }, {\n    key: 'buildLabel',\n    value: function buildLabel() {\n      var label = document.createElement('span');\n      label.classList.add('ql-picker-label');\n      label.innerHTML = _dropdown2.default;\n      label.tabIndex = '0';\n      label.setAttribute('role', 'button');\n      label.setAttribute('aria-expanded', 'false');\n      this.container.appendChild(label);\n      return label;\n    }\n  }, {\n    key: 'buildOptions',\n    value: function buildOptions() {\n      var _this3 = this;\n\n      var options = document.createElement('span');\n      options.classList.add('ql-picker-options');\n\n      // Don't want screen readers to read this until options are visible\n      options.setAttribute('aria-hidden', 'true');\n      options.tabIndex = '-1';\n\n      // Need a unique id for aria-controls\n      options.id = 'ql-picker-options-' + optionsCounter;\n      optionsCounter += 1;\n      this.label.setAttribute('aria-controls', options.id);\n\n      this.options = options;\n\n      [].slice.call(this.select.options).forEach(function (option) {\n        var item = _this3.buildItem(option);\n        options.appendChild(item);\n        if (option.selected === true) {\n          _this3.selectItem(item);\n        }\n      });\n      this.container.appendChild(options);\n    }\n  }, {\n    key: 'buildPicker',\n    value: function buildPicker() {\n      var _this4 = this;\n\n      [].slice.call(this.select.attributes).forEach(function (item) {\n        _this4.container.setAttribute(item.name, item.value);\n      });\n      this.container.classList.add('ql-picker');\n      this.label = this.buildLabel();\n      this.buildOptions();\n    }\n  }, {\n    key: 'escape',\n    value: function escape() {\n      var _this5 = this;\n\n      // Close menu and return focus to trigger label\n      this.close();\n      // Need setTimeout for accessibility to ensure that the browser executes\n      // focus on the next process thread and after any DOM content changes\n      setTimeout(function () {\n        return _this5.label.focus();\n      }, 1);\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      this.container.classList.remove('ql-expanded');\n      this.label.setAttribute('aria-expanded', 'false');\n      this.options.setAttribute('aria-hidden', 'true');\n    }\n  }, {\n    key: 'selectItem',\n    value: function selectItem(item) {\n      var trigger = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var selected = this.container.querySelector('.ql-selected');\n      if (item === selected) return;\n      if (selected != null) {\n        selected.classList.remove('ql-selected');\n      }\n      if (item == null) return;\n      item.classList.add('ql-selected');\n      this.select.selectedIndex = [].indexOf.call(item.parentNode.children, item);\n      if (item.hasAttribute('data-value')) {\n        this.label.setAttribute('data-value', item.getAttribute('data-value'));\n      } else {\n        this.label.removeAttribute('data-value');\n      }\n      if (item.hasAttribute('data-label')) {\n        this.label.setAttribute('data-label', item.getAttribute('data-label'));\n      } else {\n        this.label.removeAttribute('data-label');\n      }\n      if (trigger) {\n        if (typeof Event === 'function') {\n          this.select.dispatchEvent(new Event('change'));\n        } else if ((typeof Event === 'undefined' ? 'undefined' : _typeof(Event)) === 'object') {\n          // IE11\n          var event = document.createEvent('Event');\n          event.initEvent('change', true, true);\n          this.select.dispatchEvent(event);\n        }\n        this.close();\n      }\n    }\n  }, {\n    key: 'update',\n    value: function update() {\n      var option = void 0;\n      if (this.select.selectedIndex > -1) {\n        var item = this.container.querySelector('.ql-picker-options').children[this.select.selectedIndex];\n        option = this.select.options[this.select.selectedIndex];\n        this.selectItem(item);\n      } else {\n        this.selectItem(null);\n      }\n      var isActive = option != null && option !== this.select.querySelector('option[selected]');\n      this.label.classList.toggle('ql-active', isActive);\n    }\n  }]);\n\n  return Picker;\n}();\n\nexports.default = Picker;\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _quill = __webpack_require__(5);\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nvar _break = __webpack_require__(16);\n\nvar _break2 = _interopRequireDefault(_break);\n\nvar _container = __webpack_require__(25);\n\nvar _container2 = _interopRequireDefault(_container);\n\nvar _cursor = __webpack_require__(24);\n\nvar _cursor2 = _interopRequireDefault(_cursor);\n\nvar _embed = __webpack_require__(35);\n\nvar _embed2 = _interopRequireDefault(_embed);\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nvar _scroll = __webpack_require__(22);\n\nvar _scroll2 = _interopRequireDefault(_scroll);\n\nvar _text = __webpack_require__(7);\n\nvar _text2 = _interopRequireDefault(_text);\n\nvar _clipboard = __webpack_require__(55);\n\nvar _clipboard2 = _interopRequireDefault(_clipboard);\n\nvar _history = __webpack_require__(42);\n\nvar _history2 = _interopRequireDefault(_history);\n\nvar _keyboard = __webpack_require__(23);\n\nvar _keyboard2 = _interopRequireDefault(_keyboard);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_quill2.default.register({\n  'blots/block': _block2.default,\n  'blots/block/embed': _block.BlockEmbed,\n  'blots/break': _break2.default,\n  'blots/container': _container2.default,\n  'blots/cursor': _cursor2.default,\n  'blots/embed': _embed2.default,\n  'blots/inline': _inline2.default,\n  'blots/scroll': _scroll2.default,\n  'blots/text': _text2.default,\n\n  'modules/clipboard': _clipboard2.default,\n  'modules/history': _history2.default,\n  'modules/keyboard': _keyboard2.default\n});\n\n_parchment2.default.register(_block2.default, _break2.default, _cursor2.default, _inline2.default, _scroll2.default, _text2.default);\n\nexports.default = _quill2.default;\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Registry = __webpack_require__(1);\nvar ShadowBlot = /** @class */ (function () {\n    function ShadowBlot(domNode) {\n        this.domNode = domNode;\n        // @ts-ignore\n        this.domNode[Registry.DATA_KEY] = { blot: this };\n    }\n    Object.defineProperty(ShadowBlot.prototype, \"statics\", {\n        // Hack for accessing inherited static methods\n        get: function () {\n            return this.constructor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ShadowBlot.create = function (value) {\n        if (this.tagName == null) {\n            throw new Registry.ParchmentError('Blot definition missing tagName');\n        }\n        var node;\n        if (Array.isArray(this.tagName)) {\n            if (typeof value === 'string') {\n                value = value.toUpperCase();\n                if (parseInt(value).toString() === value) {\n                    value = parseInt(value);\n                }\n            }\n            if (typeof value === 'number') {\n                node = document.createElement(this.tagName[value - 1]);\n            }\n            else if (this.tagName.indexOf(value) > -1) {\n                node = document.createElement(value);\n            }\n            else {\n                node = document.createElement(this.tagName[0]);\n            }\n        }\n        else {\n            node = document.createElement(this.tagName);\n        }\n        if (this.className) {\n            node.classList.add(this.className);\n        }\n        return node;\n    };\n    ShadowBlot.prototype.attach = function () {\n        if (this.parent != null) {\n            this.scroll = this.parent.scroll;\n        }\n    };\n    ShadowBlot.prototype.clone = function () {\n        var domNode = this.domNode.cloneNode(false);\n        return Registry.create(domNode);\n    };\n    ShadowBlot.prototype.detach = function () {\n        if (this.parent != null)\n            this.parent.removeChild(this);\n        // @ts-ignore\n        delete this.domNode[Registry.DATA_KEY];\n    };\n    ShadowBlot.prototype.deleteAt = function (index, length) {\n        var blot = this.isolate(index, length);\n        blot.remove();\n    };\n    ShadowBlot.prototype.formatAt = function (index, length, name, value) {\n        var blot = this.isolate(index, length);\n        if (Registry.query(name, Registry.Scope.BLOT) != null && value) {\n            blot.wrap(name, value);\n        }\n        else if (Registry.query(name, Registry.Scope.ATTRIBUTE) != null) {\n            var parent = Registry.create(this.statics.scope);\n            blot.wrap(parent);\n            parent.format(name, value);\n        }\n    };\n    ShadowBlot.prototype.insertAt = function (index, value, def) {\n        var blot = def == null ? Registry.create('text', value) : Registry.create(value, def);\n        var ref = this.split(index);\n        this.parent.insertBefore(blot, ref);\n    };\n    ShadowBlot.prototype.insertInto = function (parentBlot, refBlot) {\n        if (refBlot === void 0) { refBlot = null; }\n        if (this.parent != null) {\n            this.parent.children.remove(this);\n        }\n        var refDomNode = null;\n        parentBlot.children.insertBefore(this, refBlot);\n        if (refBlot != null) {\n            refDomNode = refBlot.domNode;\n        }\n        if (this.domNode.parentNode != parentBlot.domNode ||\n            this.domNode.nextSibling != refDomNode) {\n            parentBlot.domNode.insertBefore(this.domNode, refDomNode);\n        }\n        this.parent = parentBlot;\n        this.attach();\n    };\n    ShadowBlot.prototype.isolate = function (index, length) {\n        var target = this.split(index);\n        target.split(length);\n        return target;\n    };\n    ShadowBlot.prototype.length = function () {\n        return 1;\n    };\n    ShadowBlot.prototype.offset = function (root) {\n        if (root === void 0) { root = this.parent; }\n        if (this.parent == null || this == root)\n            return 0;\n        return this.parent.children.offset(this) + this.parent.offset(root);\n    };\n    ShadowBlot.prototype.optimize = function (context) {\n        // TODO clean up once we use WeakMap\n        // @ts-ignore\n        if (this.domNode[Registry.DATA_KEY] != null) {\n            // @ts-ignore\n            delete this.domNode[Registry.DATA_KEY].mutations;\n        }\n    };\n    ShadowBlot.prototype.remove = function () {\n        if (this.domNode.parentNode != null) {\n            this.domNode.parentNode.removeChild(this.domNode);\n        }\n        this.detach();\n    };\n    ShadowBlot.prototype.replace = function (target) {\n        if (target.parent == null)\n            return;\n        target.parent.insertBefore(this, target.next);\n        target.remove();\n    };\n    ShadowBlot.prototype.replaceWith = function (name, value) {\n        var replacement = typeof name === 'string' ? Registry.create(name, value) : name;\n        replacement.replace(this);\n        return replacement;\n    };\n    ShadowBlot.prototype.split = function (index, force) {\n        return index === 0 ? this : this.next;\n    };\n    ShadowBlot.prototype.update = function (mutations, context) {\n        // Nothing to do by default\n    };\n    ShadowBlot.prototype.wrap = function (name, value) {\n        var wrapper = typeof name === 'string' ? Registry.create(name, value) : name;\n        if (this.parent != null) {\n            this.parent.insertBefore(wrapper, this.next);\n        }\n        wrapper.appendChild(this);\n        return wrapper;\n    };\n    ShadowBlot.blotName = 'abstract';\n    return ShadowBlot;\n}());\nexports.default = ShadowBlot;\n\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar attributor_1 = __webpack_require__(12);\nvar class_1 = __webpack_require__(32);\nvar style_1 = __webpack_require__(33);\nvar Registry = __webpack_require__(1);\nvar AttributorStore = /** @class */ (function () {\n    function AttributorStore(domNode) {\n        this.attributes = {};\n        this.domNode = domNode;\n        this.build();\n    }\n    AttributorStore.prototype.attribute = function (attribute, value) {\n        // verb\n        if (value) {\n            if (attribute.add(this.domNode, value)) {\n                if (attribute.value(this.domNode) != null) {\n                    this.attributes[attribute.attrName] = attribute;\n                }\n                else {\n                    delete this.attributes[attribute.attrName];\n                }\n            }\n        }\n        else {\n            attribute.remove(this.domNode);\n            delete this.attributes[attribute.attrName];\n        }\n    };\n    AttributorStore.prototype.build = function () {\n        var _this = this;\n        this.attributes = {};\n        var attributes = attributor_1.default.keys(this.domNode);\n        var classes = class_1.default.keys(this.domNode);\n        var styles = style_1.default.keys(this.domNode);\n        attributes\n            .concat(classes)\n            .concat(styles)\n            .forEach(function (name) {\n            var attr = Registry.query(name, Registry.Scope.ATTRIBUTE);\n            if (attr instanceof attributor_1.default) {\n                _this.attributes[attr.attrName] = attr;\n            }\n        });\n    };\n    AttributorStore.prototype.copy = function (target) {\n        var _this = this;\n        Object.keys(this.attributes).forEach(function (key) {\n            var value = _this.attributes[key].value(_this.domNode);\n            target.format(key, value);\n        });\n    };\n    AttributorStore.prototype.move = function (target) {\n        var _this = this;\n        this.copy(target);\n        Object.keys(this.attributes).forEach(function (key) {\n            _this.attributes[key].remove(_this.domNode);\n        });\n        this.attributes = {};\n    };\n    AttributorStore.prototype.values = function () {\n        var _this = this;\n        return Object.keys(this.attributes).reduce(function (attributes, name) {\n            attributes[name] = _this.attributes[name].value(_this.domNode);\n            return attributes;\n        }, {});\n    };\n    return AttributorStore;\n}());\nexports.default = AttributorStore;\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar attributor_1 = __webpack_require__(12);\nfunction match(node, prefix) {\n    var className = node.getAttribute('class') || '';\n    return className.split(/\\s+/).filter(function (name) {\n        return name.indexOf(prefix + \"-\") === 0;\n    });\n}\nvar ClassAttributor = /** @class */ (function (_super) {\n    __extends(ClassAttributor, _super);\n    function ClassAttributor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ClassAttributor.keys = function (node) {\n        return (node.getAttribute('class') || '').split(/\\s+/).map(function (name) {\n            return name\n                .split('-')\n                .slice(0, -1)\n                .join('-');\n        });\n    };\n    ClassAttributor.prototype.add = function (node, value) {\n        if (!this.canAdd(node, value))\n            return false;\n        this.remove(node);\n        node.classList.add(this.keyName + \"-\" + value);\n        return true;\n    };\n    ClassAttributor.prototype.remove = function (node) {\n        var matches = match(node, this.keyName);\n        matches.forEach(function (name) {\n            node.classList.remove(name);\n        });\n        if (node.classList.length === 0) {\n            node.removeAttribute('class');\n        }\n    };\n    ClassAttributor.prototype.value = function (node) {\n        var result = match(node, this.keyName)[0] || '';\n        var value = result.slice(this.keyName.length + 1); // +1 for hyphen\n        return this.canAdd(node, value) ? value : '';\n    };\n    return ClassAttributor;\n}(attributor_1.default));\nexports.default = ClassAttributor;\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar attributor_1 = __webpack_require__(12);\nfunction camelize(name) {\n    var parts = name.split('-');\n    var rest = parts\n        .slice(1)\n        .map(function (part) {\n        return part[0].toUpperCase() + part.slice(1);\n    })\n        .join('');\n    return parts[0] + rest;\n}\nvar StyleAttributor = /** @class */ (function (_super) {\n    __extends(StyleAttributor, _super);\n    function StyleAttributor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    StyleAttributor.keys = function (node) {\n        return (node.getAttribute('style') || '').split(';').map(function (value) {\n            var arr = value.split(':');\n            return arr[0].trim();\n        });\n    };\n    StyleAttributor.prototype.add = function (node, value) {\n        if (!this.canAdd(node, value))\n            return false;\n        // @ts-ignore\n        node.style[camelize(this.keyName)] = value;\n        return true;\n    };\n    StyleAttributor.prototype.remove = function (node) {\n        // @ts-ignore\n        node.style[camelize(this.keyName)] = '';\n        if (!node.getAttribute('style')) {\n            node.removeAttribute('style');\n        }\n    };\n    StyleAttributor.prototype.value = function (node) {\n        // @ts-ignore\n        var value = node.style[camelize(this.keyName)];\n        return this.canAdd(node, value) ? value : '';\n    };\n    return StyleAttributor;\n}(attributor_1.default));\nexports.default = StyleAttributor;\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Theme = function () {\n  function Theme(quill, options) {\n    _classCallCheck(this, Theme);\n\n    this.quill = quill;\n    this.options = options;\n    this.modules = {};\n  }\n\n  _createClass(Theme, [{\n    key: 'init',\n    value: function init() {\n      var _this = this;\n\n      Object.keys(this.options.modules).forEach(function (name) {\n        if (_this.modules[name] == null) {\n          _this.addModule(name);\n        }\n      });\n    }\n  }, {\n    key: 'addModule',\n    value: function addModule(name) {\n      var moduleClass = this.quill.constructor.import('modules/' + name);\n      this.modules[name] = new moduleClass(this.quill, this.options.modules[name] || {});\n      return this.modules[name];\n    }\n  }]);\n\n  return Theme;\n}();\n\nTheme.DEFAULTS = {\n  modules: {}\n};\nTheme.themes = {\n  'default': Theme\n};\n\nexports.default = Theme;\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _text = __webpack_require__(7);\n\nvar _text2 = _interopRequireDefault(_text);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar GUARD_TEXT = '\\uFEFF';\n\nvar Embed = function (_Parchment$Embed) {\n  _inherits(Embed, _Parchment$Embed);\n\n  function Embed(node) {\n    _classCallCheck(this, Embed);\n\n    var _this = _possibleConstructorReturn(this, (Embed.__proto__ || Object.getPrototypeOf(Embed)).call(this, node));\n\n    _this.contentNode = document.createElement('span');\n    _this.contentNode.setAttribute('contenteditable', false);\n    [].slice.call(_this.domNode.childNodes).forEach(function (childNode) {\n      _this.contentNode.appendChild(childNode);\n    });\n    _this.leftGuard = document.createTextNode(GUARD_TEXT);\n    _this.rightGuard = document.createTextNode(GUARD_TEXT);\n    _this.domNode.appendChild(_this.leftGuard);\n    _this.domNode.appendChild(_this.contentNode);\n    _this.domNode.appendChild(_this.rightGuard);\n    return _this;\n  }\n\n  _createClass(Embed, [{\n    key: 'index',\n    value: function index(node, offset) {\n      if (node === this.leftGuard) return 0;\n      if (node === this.rightGuard) return 1;\n      return _get(Embed.prototype.__proto__ || Object.getPrototypeOf(Embed.prototype), 'index', this).call(this, node, offset);\n    }\n  }, {\n    key: 'restore',\n    value: function restore(node) {\n      var range = void 0,\n          textNode = void 0;\n      var text = node.data.split(GUARD_TEXT).join('');\n      if (node === this.leftGuard) {\n        if (this.prev instanceof _text2.default) {\n          var prevLength = this.prev.length();\n          this.prev.insertAt(prevLength, text);\n          range = {\n            startNode: this.prev.domNode,\n            startOffset: prevLength + text.length\n          };\n        } else {\n          textNode = document.createTextNode(text);\n          this.parent.insertBefore(_parchment2.default.create(textNode), this);\n          range = {\n            startNode: textNode,\n            startOffset: text.length\n          };\n        }\n      } else if (node === this.rightGuard) {\n        if (this.next instanceof _text2.default) {\n          this.next.insertAt(0, text);\n          range = {\n            startNode: this.next.domNode,\n            startOffset: text.length\n          };\n        } else {\n          textNode = document.createTextNode(text);\n          this.parent.insertBefore(_parchment2.default.create(textNode), this.next);\n          range = {\n            startNode: textNode,\n            startOffset: text.length\n          };\n        }\n      }\n      node.data = GUARD_TEXT;\n      return range;\n    }\n  }, {\n    key: 'update',\n    value: function update(mutations, context) {\n      var _this2 = this;\n\n      mutations.forEach(function (mutation) {\n        if (mutation.type === 'characterData' && (mutation.target === _this2.leftGuard || mutation.target === _this2.rightGuard)) {\n          var range = _this2.restore(mutation.target);\n          if (range) context.range = range;\n        }\n      });\n    }\n  }]);\n\n  return Embed;\n}(_parchment2.default.Embed);\n\nexports.default = Embed;\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AlignStyle = exports.AlignClass = exports.AlignAttribute = undefined;\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar config = {\n  scope: _parchment2.default.Scope.BLOCK,\n  whitelist: ['right', 'center', 'justify']\n};\n\nvar AlignAttribute = new _parchment2.default.Attributor.Attribute('align', 'align', config);\nvar AlignClass = new _parchment2.default.Attributor.Class('align', 'ql-align', config);\nvar AlignStyle = new _parchment2.default.Attributor.Style('align', 'text-align', config);\n\nexports.AlignAttribute = AlignAttribute;\nexports.AlignClass = AlignClass;\nexports.AlignStyle = AlignStyle;\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BackgroundStyle = exports.BackgroundClass = undefined;\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _color = __webpack_require__(26);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar BackgroundClass = new _parchment2.default.Attributor.Class('background', 'ql-bg', {\n  scope: _parchment2.default.Scope.INLINE\n});\nvar BackgroundStyle = new _color.ColorAttributor('background', 'background-color', {\n  scope: _parchment2.default.Scope.INLINE\n});\n\nexports.BackgroundClass = BackgroundClass;\nexports.BackgroundStyle = BackgroundStyle;\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DirectionStyle = exports.DirectionClass = exports.DirectionAttribute = undefined;\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar config = {\n  scope: _parchment2.default.Scope.BLOCK,\n  whitelist: ['rtl']\n};\n\nvar DirectionAttribute = new _parchment2.default.Attributor.Attribute('direction', 'dir', config);\nvar DirectionClass = new _parchment2.default.Attributor.Class('direction', 'ql-direction', config);\nvar DirectionStyle = new _parchment2.default.Attributor.Style('direction', 'direction', config);\n\nexports.DirectionAttribute = DirectionAttribute;\nexports.DirectionClass = DirectionClass;\nexports.DirectionStyle = DirectionStyle;\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FontClass = exports.FontStyle = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar config = {\n  scope: _parchment2.default.Scope.INLINE,\n  whitelist: ['serif', 'monospace']\n};\n\nvar FontClass = new _parchment2.default.Attributor.Class('font', 'ql-font', config);\n\nvar FontStyleAttributor = function (_Parchment$Attributor) {\n  _inherits(FontStyleAttributor, _Parchment$Attributor);\n\n  function FontStyleAttributor() {\n    _classCallCheck(this, FontStyleAttributor);\n\n    return _possibleConstructorReturn(this, (FontStyleAttributor.__proto__ || Object.getPrototypeOf(FontStyleAttributor)).apply(this, arguments));\n  }\n\n  _createClass(FontStyleAttributor, [{\n    key: 'value',\n    value: function value(node) {\n      return _get(FontStyleAttributor.prototype.__proto__ || Object.getPrototypeOf(FontStyleAttributor.prototype), 'value', this).call(this, node).replace(/[\"']/g, '');\n    }\n  }]);\n\n  return FontStyleAttributor;\n}(_parchment2.default.Attributor.Style);\n\nvar FontStyle = new FontStyleAttributor('font', 'font-family', config);\n\nexports.FontStyle = FontStyle;\nexports.FontClass = FontClass;\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SizeStyle = exports.SizeClass = undefined;\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SizeClass = new _parchment2.default.Attributor.Class('size', 'ql-size', {\n  scope: _parchment2.default.Scope.INLINE,\n  whitelist: ['small', 'large', 'huge']\n});\nvar SizeStyle = new _parchment2.default.Attributor.Style('size', 'font-size', {\n  scope: _parchment2.default.Scope.INLINE,\n  whitelist: ['10px', '18px', '32px']\n});\n\nexports.SizeClass = SizeClass;\nexports.SizeStyle = SizeStyle;\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = {\n  'align': {\n    '': __webpack_require__(76),\n    'center': __webpack_require__(77),\n    'right': __webpack_require__(78),\n    'justify': __webpack_require__(79)\n  },\n  'background': __webpack_require__(80),\n  'blockquote': __webpack_require__(81),\n  'bold': __webpack_require__(82),\n  'clean': __webpack_require__(83),\n  'code': __webpack_require__(58),\n  'code-block': __webpack_require__(58),\n  'color': __webpack_require__(84),\n  'direction': {\n    '': __webpack_require__(85),\n    'rtl': __webpack_require__(86)\n  },\n  'float': {\n    'center': __webpack_require__(87),\n    'full': __webpack_require__(88),\n    'left': __webpack_require__(89),\n    'right': __webpack_require__(90)\n  },\n  'formula': __webpack_require__(91),\n  'header': {\n    '1': __webpack_require__(92),\n    '2': __webpack_require__(93)\n  },\n  'italic': __webpack_require__(94),\n  'image': __webpack_require__(95),\n  'indent': {\n    '+1': __webpack_require__(96),\n    '-1': __webpack_require__(97)\n  },\n  'link': __webpack_require__(98),\n  'list': {\n    'ordered': __webpack_require__(99),\n    'bullet': __webpack_require__(100),\n    'check': __webpack_require__(101)\n  },\n  'script': {\n    'sub': __webpack_require__(102),\n    'super': __webpack_require__(103)\n  },\n  'strike': __webpack_require__(104),\n  'underline': __webpack_require__(105),\n  'video': __webpack_require__(106)\n};\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getLastChangeIndex = exports.default = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _quill = __webpack_require__(5);\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _module = __webpack_require__(9);\n\nvar _module2 = _interopRequireDefault(_module);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar History = function (_Module) {\n  _inherits(History, _Module);\n\n  function History(quill, options) {\n    _classCallCheck(this, History);\n\n    var _this = _possibleConstructorReturn(this, (History.__proto__ || Object.getPrototypeOf(History)).call(this, quill, options));\n\n    _this.lastRecorded = 0;\n    _this.ignoreChange = false;\n    _this.clear();\n    _this.quill.on(_quill2.default.events.EDITOR_CHANGE, function (eventName, delta, oldDelta, source) {\n      if (eventName !== _quill2.default.events.TEXT_CHANGE || _this.ignoreChange) return;\n      if (!_this.options.userOnly || source === _quill2.default.sources.USER) {\n        _this.record(delta, oldDelta);\n      } else {\n        _this.transform(delta);\n      }\n    });\n    _this.quill.keyboard.addBinding({ key: 'Z', shortKey: true }, _this.undo.bind(_this));\n    _this.quill.keyboard.addBinding({ key: 'Z', shortKey: true, shiftKey: true }, _this.redo.bind(_this));\n    if (/Win/i.test(navigator.platform)) {\n      _this.quill.keyboard.addBinding({ key: 'Y', shortKey: true }, _this.redo.bind(_this));\n    }\n    return _this;\n  }\n\n  _createClass(History, [{\n    key: 'change',\n    value: function change(source, dest) {\n      if (this.stack[source].length === 0) return;\n      var delta = this.stack[source].pop();\n      this.stack[dest].push(delta);\n      this.lastRecorded = 0;\n      this.ignoreChange = true;\n      this.quill.updateContents(delta[source], _quill2.default.sources.USER);\n      this.ignoreChange = false;\n      var index = getLastChangeIndex(delta[source]);\n      this.quill.setSelection(index);\n    }\n  }, {\n    key: 'clear',\n    value: function clear() {\n      this.stack = { undo: [], redo: [] };\n    }\n  }, {\n    key: 'cutoff',\n    value: function cutoff() {\n      this.lastRecorded = 0;\n    }\n  }, {\n    key: 'record',\n    value: function record(changeDelta, oldDelta) {\n      if (changeDelta.ops.length === 0) return;\n      this.stack.redo = [];\n      var undoDelta = this.quill.getContents().diff(oldDelta);\n      var timestamp = Date.now();\n      if (this.lastRecorded + this.options.delay > timestamp && this.stack.undo.length > 0) {\n        var delta = this.stack.undo.pop();\n        undoDelta = undoDelta.compose(delta.undo);\n        changeDelta = delta.redo.compose(changeDelta);\n      } else {\n        this.lastRecorded = timestamp;\n      }\n      this.stack.undo.push({\n        redo: changeDelta,\n        undo: undoDelta\n      });\n      if (this.stack.undo.length > this.options.maxStack) {\n        this.stack.undo.shift();\n      }\n    }\n  }, {\n    key: 'redo',\n    value: function redo() {\n      this.change('redo', 'undo');\n    }\n  }, {\n    key: 'transform',\n    value: function transform(delta) {\n      this.stack.undo.forEach(function (change) {\n        change.undo = delta.transform(change.undo, true);\n        change.redo = delta.transform(change.redo, true);\n      });\n      this.stack.redo.forEach(function (change) {\n        change.undo = delta.transform(change.undo, true);\n        change.redo = delta.transform(change.redo, true);\n      });\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.change('undo', 'redo');\n    }\n  }]);\n\n  return History;\n}(_module2.default);\n\nHistory.DEFAULTS = {\n  delay: 1000,\n  maxStack: 100,\n  userOnly: false\n};\n\nfunction endsWithNewlineChange(delta) {\n  var lastOp = delta.ops[delta.ops.length - 1];\n  if (lastOp == null) return false;\n  if (lastOp.insert != null) {\n    return typeof lastOp.insert === 'string' && lastOp.insert.endsWith('\\n');\n  }\n  if (lastOp.attributes != null) {\n    return Object.keys(lastOp.attributes).some(function (attr) {\n      return _parchment2.default.query(attr, _parchment2.default.Scope.BLOCK) != null;\n    });\n  }\n  return false;\n}\n\nfunction getLastChangeIndex(delta) {\n  var deleteLength = delta.reduce(function (length, op) {\n    length += op.delete || 0;\n    return length;\n  }, 0);\n  var changeIndex = delta.length() - deleteLength;\n  if (endsWithNewlineChange(delta)) {\n    changeIndex -= 1;\n  }\n  return changeIndex;\n}\n\nexports.default = History;\nexports.getLastChangeIndex = getLastChangeIndex;\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.BaseTooltip = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _extend = __webpack_require__(3);\n\nvar _extend2 = _interopRequireDefault(_extend);\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _emitter = __webpack_require__(8);\n\nvar _emitter2 = _interopRequireDefault(_emitter);\n\nvar _keyboard = __webpack_require__(23);\n\nvar _keyboard2 = _interopRequireDefault(_keyboard);\n\nvar _theme = __webpack_require__(34);\n\nvar _theme2 = _interopRequireDefault(_theme);\n\nvar _colorPicker = __webpack_require__(59);\n\nvar _colorPicker2 = _interopRequireDefault(_colorPicker);\n\nvar _iconPicker = __webpack_require__(60);\n\nvar _iconPicker2 = _interopRequireDefault(_iconPicker);\n\nvar _picker = __webpack_require__(28);\n\nvar _picker2 = _interopRequireDefault(_picker);\n\nvar _tooltip = __webpack_require__(61);\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ALIGNS = [false, 'center', 'right', 'justify'];\n\nvar COLORS = [\"#000000\", \"#e60000\", \"#ff9900\", \"#ffff00\", \"#008a00\", \"#0066cc\", \"#9933ff\", \"#ffffff\", \"#facccc\", \"#ffebcc\", \"#ffffcc\", \"#cce8cc\", \"#cce0f5\", \"#ebd6ff\", \"#bbbbbb\", \"#f06666\", \"#ffc266\", \"#ffff66\", \"#66b966\", \"#66a3e0\", \"#c285ff\", \"#888888\", \"#a10000\", \"#b26b00\", \"#b2b200\", \"#006100\", \"#0047b2\", \"#6b24b2\", \"#444444\", \"#5c0000\", \"#663d00\", \"#666600\", \"#003700\", \"#002966\", \"#3d1466\"];\n\nvar FONTS = [false, 'serif', 'monospace'];\n\nvar HEADERS = ['1', '2', '3', false];\n\nvar SIZES = ['small', false, 'large', 'huge'];\n\nvar BaseTheme = function (_Theme) {\n  _inherits(BaseTheme, _Theme);\n\n  function BaseTheme(quill, options) {\n    _classCallCheck(this, BaseTheme);\n\n    var _this = _possibleConstructorReturn(this, (BaseTheme.__proto__ || Object.getPrototypeOf(BaseTheme)).call(this, quill, options));\n\n    var listener = function listener(e) {\n      if (!document.body.contains(quill.root)) {\n        return document.body.removeEventListener('click', listener);\n      }\n      if (_this.tooltip != null && !_this.tooltip.root.contains(e.target) && document.activeElement !== _this.tooltip.textbox && !_this.quill.hasFocus()) {\n        _this.tooltip.hide();\n      }\n      if (_this.pickers != null) {\n        _this.pickers.forEach(function (picker) {\n          if (!picker.container.contains(e.target)) {\n            picker.close();\n          }\n        });\n      }\n    };\n    quill.emitter.listenDOM('click', document.body, listener);\n    return _this;\n  }\n\n  _createClass(BaseTheme, [{\n    key: 'addModule',\n    value: function addModule(name) {\n      var module = _get(BaseTheme.prototype.__proto__ || Object.getPrototypeOf(BaseTheme.prototype), 'addModule', this).call(this, name);\n      if (name === 'toolbar') {\n        this.extendToolbar(module);\n      }\n      return module;\n    }\n  }, {\n    key: 'buildButtons',\n    value: function buildButtons(buttons, icons) {\n      buttons.forEach(function (button) {\n        var className = button.getAttribute('class') || '';\n        className.split(/\\s+/).forEach(function (name) {\n          if (!name.startsWith('ql-')) return;\n          name = name.slice('ql-'.length);\n          if (icons[name] == null) return;\n          if (name === 'direction') {\n            button.innerHTML = icons[name][''] + icons[name]['rtl'];\n          } else if (typeof icons[name] === 'string') {\n            button.innerHTML = icons[name];\n          } else {\n            var value = button.value || '';\n            if (value != null && icons[name][value]) {\n              button.innerHTML = icons[name][value];\n            }\n          }\n        });\n      });\n    }\n  }, {\n    key: 'buildPickers',\n    value: function buildPickers(selects, icons) {\n      var _this2 = this;\n\n      this.pickers = selects.map(function (select) {\n        if (select.classList.contains('ql-align')) {\n          if (select.querySelector('option') == null) {\n            fillSelect(select, ALIGNS);\n          }\n          return new _iconPicker2.default(select, icons.align);\n        } else if (select.classList.contains('ql-background') || select.classList.contains('ql-color')) {\n          var format = select.classList.contains('ql-background') ? 'background' : 'color';\n          if (select.querySelector('option') == null) {\n            fillSelect(select, COLORS, format === 'background' ? '#ffffff' : '#000000');\n          }\n          return new _colorPicker2.default(select, icons[format]);\n        } else {\n          if (select.querySelector('option') == null) {\n            if (select.classList.contains('ql-font')) {\n              fillSelect(select, FONTS);\n            } else if (select.classList.contains('ql-header')) {\n              fillSelect(select, HEADERS);\n            } else if (select.classList.contains('ql-size')) {\n              fillSelect(select, SIZES);\n            }\n          }\n          return new _picker2.default(select);\n        }\n      });\n      var update = function update() {\n        _this2.pickers.forEach(function (picker) {\n          picker.update();\n        });\n      };\n      this.quill.on(_emitter2.default.events.EDITOR_CHANGE, update);\n    }\n  }]);\n\n  return BaseTheme;\n}(_theme2.default);\n\nBaseTheme.DEFAULTS = (0, _extend2.default)(true, {}, _theme2.default.DEFAULTS, {\n  modules: {\n    toolbar: {\n      handlers: {\n        formula: function formula() {\n          this.quill.theme.tooltip.edit('formula');\n        },\n        image: function image() {\n          var _this3 = this;\n\n          var fileInput = this.container.querySelector('input.ql-image[type=file]');\n          if (fileInput == null) {\n            fileInput = document.createElement('input');\n            fileInput.setAttribute('type', 'file');\n            fileInput.setAttribute('accept', 'image/png, image/gif, image/jpeg, image/bmp, image/x-icon');\n            fileInput.classList.add('ql-image');\n            fileInput.addEventListener('change', function () {\n              if (fileInput.files != null && fileInput.files[0] != null) {\n                var reader = new FileReader();\n                reader.onload = function (e) {\n                  var range = _this3.quill.getSelection(true);\n                  _this3.quill.updateContents(new _quillDelta2.default().retain(range.index).delete(range.length).insert({ image: e.target.result }), _emitter2.default.sources.USER);\n                  _this3.quill.setSelection(range.index + 1, _emitter2.default.sources.SILENT);\n                  fileInput.value = \"\";\n                };\n                reader.readAsDataURL(fileInput.files[0]);\n              }\n            });\n            this.container.appendChild(fileInput);\n          }\n          fileInput.click();\n        },\n        video: function video() {\n          this.quill.theme.tooltip.edit('video');\n        }\n      }\n    }\n  }\n});\n\nvar BaseTooltip = function (_Tooltip) {\n  _inherits(BaseTooltip, _Tooltip);\n\n  function BaseTooltip(quill, boundsContainer) {\n    _classCallCheck(this, BaseTooltip);\n\n    var _this4 = _possibleConstructorReturn(this, (BaseTooltip.__proto__ || Object.getPrototypeOf(BaseTooltip)).call(this, quill, boundsContainer));\n\n    _this4.textbox = _this4.root.querySelector('input[type=\"text\"]');\n    _this4.listen();\n    return _this4;\n  }\n\n  _createClass(BaseTooltip, [{\n    key: 'listen',\n    value: function listen() {\n      var _this5 = this;\n\n      this.textbox.addEventListener('keydown', function (event) {\n        if (_keyboard2.default.match(event, 'enter')) {\n          _this5.save();\n          event.preventDefault();\n        } else if (_keyboard2.default.match(event, 'escape')) {\n          _this5.cancel();\n          event.preventDefault();\n        }\n      });\n    }\n  }, {\n    key: 'cancel',\n    value: function cancel() {\n      this.hide();\n    }\n  }, {\n    key: 'edit',\n    value: function edit() {\n      var mode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'link';\n      var preview = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n      this.root.classList.remove('ql-hidden');\n      this.root.classList.add('ql-editing');\n      if (preview != null) {\n        this.textbox.value = preview;\n      } else if (mode !== this.root.getAttribute('data-mode')) {\n        this.textbox.value = '';\n      }\n      this.position(this.quill.getBounds(this.quill.selection.savedRange));\n      this.textbox.select();\n      this.textbox.setAttribute('placeholder', this.textbox.getAttribute('data-' + mode) || '');\n      this.root.setAttribute('data-mode', mode);\n    }\n  }, {\n    key: 'restoreFocus',\n    value: function restoreFocus() {\n      var scrollTop = this.quill.scrollingContainer.scrollTop;\n      this.quill.focus();\n      this.quill.scrollingContainer.scrollTop = scrollTop;\n    }\n  }, {\n    key: 'save',\n    value: function save() {\n      var value = this.textbox.value;\n      switch (this.root.getAttribute('data-mode')) {\n        case 'link':\n          {\n            var scrollTop = this.quill.root.scrollTop;\n            if (this.linkRange) {\n              this.quill.formatText(this.linkRange, 'link', value, _emitter2.default.sources.USER);\n              delete this.linkRange;\n            } else {\n              this.restoreFocus();\n              this.quill.format('link', value, _emitter2.default.sources.USER);\n            }\n            this.quill.root.scrollTop = scrollTop;\n            break;\n          }\n        case 'video':\n          {\n            value = extractVideoUrl(value);\n          } // eslint-disable-next-line no-fallthrough\n        case 'formula':\n          {\n            if (!value) break;\n            var range = this.quill.getSelection(true);\n            if (range != null) {\n              var index = range.index + range.length;\n              this.quill.insertEmbed(index, this.root.getAttribute('data-mode'), value, _emitter2.default.sources.USER);\n              if (this.root.getAttribute('data-mode') === 'formula') {\n                this.quill.insertText(index + 1, ' ', _emitter2.default.sources.USER);\n              }\n              this.quill.setSelection(index + 2, _emitter2.default.sources.USER);\n            }\n            break;\n          }\n        default:\n      }\n      this.textbox.value = '';\n      this.hide();\n    }\n  }]);\n\n  return BaseTooltip;\n}(_tooltip2.default);\n\nfunction extractVideoUrl(url) {\n  var match = url.match(/^(?:(https?):\\/\\/)?(?:(?:www|m)\\.)?youtube\\.com\\/watch.*v=([a-zA-Z0-9_-]+)/) || url.match(/^(?:(https?):\\/\\/)?(?:(?:www|m)\\.)?youtu\\.be\\/([a-zA-Z0-9_-]+)/);\n  if (match) {\n    return (match[1] || 'https') + '://www.youtube.com/embed/' + match[2] + '?showinfo=0';\n  }\n  if (match = url.match(/^(?:(https?):\\/\\/)?(?:www\\.)?vimeo\\.com\\/(\\d+)/)) {\n    // eslint-disable-line no-cond-assign\n    return (match[1] || 'https') + '://player.vimeo.com/video/' + match[2] + '/';\n  }\n  return url;\n}\n\nfunction fillSelect(select, values) {\n  var defaultValue = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n  values.forEach(function (value) {\n    var option = document.createElement('option');\n    if (value === defaultValue) {\n      option.setAttribute('selected', 'selected');\n    } else {\n      option.setAttribute('value', value);\n    }\n    select.appendChild(option);\n  });\n}\n\nexports.BaseTooltip = BaseTooltip;\nexports.default = BaseTheme;\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LinkedList = /** @class */ (function () {\n    function LinkedList() {\n        this.head = this.tail = null;\n        this.length = 0;\n    }\n    LinkedList.prototype.append = function () {\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        this.insertBefore(nodes[0], null);\n        if (nodes.length > 1) {\n            this.append.apply(this, nodes.slice(1));\n        }\n    };\n    LinkedList.prototype.contains = function (node) {\n        var cur, next = this.iterator();\n        while ((cur = next())) {\n            if (cur === node)\n                return true;\n        }\n        return false;\n    };\n    LinkedList.prototype.insertBefore = function (node, refNode) {\n        if (!node)\n            return;\n        node.next = refNode;\n        if (refNode != null) {\n            node.prev = refNode.prev;\n            if (refNode.prev != null) {\n                refNode.prev.next = node;\n            }\n            refNode.prev = node;\n            if (refNode === this.head) {\n                this.head = node;\n            }\n        }\n        else if (this.tail != null) {\n            this.tail.next = node;\n            node.prev = this.tail;\n            this.tail = node;\n        }\n        else {\n            node.prev = null;\n            this.head = this.tail = node;\n        }\n        this.length += 1;\n    };\n    LinkedList.prototype.offset = function (target) {\n        var index = 0, cur = this.head;\n        while (cur != null) {\n            if (cur === target)\n                return index;\n            index += cur.length();\n            cur = cur.next;\n        }\n        return -1;\n    };\n    LinkedList.prototype.remove = function (node) {\n        if (!this.contains(node))\n            return;\n        if (node.prev != null)\n            node.prev.next = node.next;\n        if (node.next != null)\n            node.next.prev = node.prev;\n        if (node === this.head)\n            this.head = node.next;\n        if (node === this.tail)\n            this.tail = node.prev;\n        this.length -= 1;\n    };\n    LinkedList.prototype.iterator = function (curNode) {\n        if (curNode === void 0) { curNode = this.head; }\n        // TODO use yield when we can\n        return function () {\n            var ret = curNode;\n            if (curNode != null)\n                curNode = curNode.next;\n            return ret;\n        };\n    };\n    LinkedList.prototype.find = function (index, inclusive) {\n        if (inclusive === void 0) { inclusive = false; }\n        var cur, next = this.iterator();\n        while ((cur = next())) {\n            var length = cur.length();\n            if (index < length ||\n                (inclusive && index === length && (cur.next == null || cur.next.length() !== 0))) {\n                return [cur, index];\n            }\n            index -= length;\n        }\n        return [null, 0];\n    };\n    LinkedList.prototype.forEach = function (callback) {\n        var cur, next = this.iterator();\n        while ((cur = next())) {\n            callback(cur);\n        }\n    };\n    LinkedList.prototype.forEachAt = function (index, length, callback) {\n        if (length <= 0)\n            return;\n        var _a = this.find(index), startNode = _a[0], offset = _a[1];\n        var cur, curIndex = index - offset, next = this.iterator(startNode);\n        while ((cur = next()) && curIndex < index + length) {\n            var curLength = cur.length();\n            if (index > curIndex) {\n                callback(cur, index - curIndex, Math.min(length, curIndex + curLength - index));\n            }\n            else {\n                callback(cur, 0, Math.min(curLength, index + length - curIndex));\n            }\n            curIndex += curLength;\n        }\n    };\n    LinkedList.prototype.map = function (callback) {\n        return this.reduce(function (memo, cur) {\n            memo.push(callback(cur));\n            return memo;\n        }, []);\n    };\n    LinkedList.prototype.reduce = function (callback, memo) {\n        var cur, next = this.iterator();\n        while ((cur = next())) {\n            memo = callback(memo, cur);\n        }\n        return memo;\n    };\n    return LinkedList;\n}());\nexports.default = LinkedList;\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar container_1 = __webpack_require__(17);\nvar Registry = __webpack_require__(1);\nvar OBSERVER_CONFIG = {\n    attributes: true,\n    characterData: true,\n    characterDataOldValue: true,\n    childList: true,\n    subtree: true,\n};\nvar MAX_OPTIMIZE_ITERATIONS = 100;\nvar ScrollBlot = /** @class */ (function (_super) {\n    __extends(ScrollBlot, _super);\n    function ScrollBlot(node) {\n        var _this = _super.call(this, node) || this;\n        _this.scroll = _this;\n        _this.observer = new MutationObserver(function (mutations) {\n            _this.update(mutations);\n        });\n        _this.observer.observe(_this.domNode, OBSERVER_CONFIG);\n        _this.attach();\n        return _this;\n    }\n    ScrollBlot.prototype.detach = function () {\n        _super.prototype.detach.call(this);\n        this.observer.disconnect();\n    };\n    ScrollBlot.prototype.deleteAt = function (index, length) {\n        this.update();\n        if (index === 0 && length === this.length()) {\n            this.children.forEach(function (child) {\n                child.remove();\n            });\n        }\n        else {\n            _super.prototype.deleteAt.call(this, index, length);\n        }\n    };\n    ScrollBlot.prototype.formatAt = function (index, length, name, value) {\n        this.update();\n        _super.prototype.formatAt.call(this, index, length, name, value);\n    };\n    ScrollBlot.prototype.insertAt = function (index, value, def) {\n        this.update();\n        _super.prototype.insertAt.call(this, index, value, def);\n    };\n    ScrollBlot.prototype.optimize = function (mutations, context) {\n        var _this = this;\n        if (mutations === void 0) { mutations = []; }\n        if (context === void 0) { context = {}; }\n        _super.prototype.optimize.call(this, context);\n        // We must modify mutations directly, cannot make copy and then modify\n        var records = [].slice.call(this.observer.takeRecords());\n        // Array.push currently seems to be implemented by a non-tail recursive function\n        // so we cannot just mutations.push.apply(mutations, this.observer.takeRecords());\n        while (records.length > 0)\n            mutations.push(records.pop());\n        // TODO use WeakMap\n        var mark = function (blot, markParent) {\n            if (markParent === void 0) { markParent = true; }\n            if (blot == null || blot === _this)\n                return;\n            if (blot.domNode.parentNode == null)\n                return;\n            // @ts-ignore\n            if (blot.domNode[Registry.DATA_KEY].mutations == null) {\n                // @ts-ignore\n                blot.domNode[Registry.DATA_KEY].mutations = [];\n            }\n            if (markParent)\n                mark(blot.parent);\n        };\n        var optimize = function (blot) {\n            // Post-order traversal\n            if (\n            // @ts-ignore\n            blot.domNode[Registry.DATA_KEY] == null ||\n                // @ts-ignore\n                blot.domNode[Registry.DATA_KEY].mutations == null) {\n                return;\n            }\n            if (blot instanceof container_1.default) {\n                blot.children.forEach(optimize);\n            }\n            blot.optimize(context);\n        };\n        var remaining = mutations;\n        for (var i = 0; remaining.length > 0; i += 1) {\n            if (i >= MAX_OPTIMIZE_ITERATIONS) {\n                throw new Error('[Parchment] Maximum optimize iterations reached');\n            }\n            remaining.forEach(function (mutation) {\n                var blot = Registry.find(mutation.target, true);\n                if (blot == null)\n                    return;\n                if (blot.domNode === mutation.target) {\n                    if (mutation.type === 'childList') {\n                        mark(Registry.find(mutation.previousSibling, false));\n                        [].forEach.call(mutation.addedNodes, function (node) {\n                            var child = Registry.find(node, false);\n                            mark(child, false);\n                            if (child instanceof container_1.default) {\n                                child.children.forEach(function (grandChild) {\n                                    mark(grandChild, false);\n                                });\n                            }\n                        });\n                    }\n                    else if (mutation.type === 'attributes') {\n                        mark(blot.prev);\n                    }\n                }\n                mark(blot);\n            });\n            this.children.forEach(optimize);\n            remaining = [].slice.call(this.observer.takeRecords());\n            records = remaining.slice();\n            while (records.length > 0)\n                mutations.push(records.pop());\n        }\n    };\n    ScrollBlot.prototype.update = function (mutations, context) {\n        var _this = this;\n        if (context === void 0) { context = {}; }\n        mutations = mutations || this.observer.takeRecords();\n        // TODO use WeakMap\n        mutations\n            .map(function (mutation) {\n            var blot = Registry.find(mutation.target, true);\n            if (blot == null)\n                return null;\n            // @ts-ignore\n            if (blot.domNode[Registry.DATA_KEY].mutations == null) {\n                // @ts-ignore\n                blot.domNode[Registry.DATA_KEY].mutations = [mutation];\n                return blot;\n            }\n            else {\n                // @ts-ignore\n                blot.domNode[Registry.DATA_KEY].mutations.push(mutation);\n                return null;\n            }\n        })\n            .forEach(function (blot) {\n            if (blot == null ||\n                blot === _this ||\n                //@ts-ignore\n                blot.domNode[Registry.DATA_KEY] == null)\n                return;\n            // @ts-ignore\n            blot.update(blot.domNode[Registry.DATA_KEY].mutations || [], context);\n        });\n        // @ts-ignore\n        if (this.domNode[Registry.DATA_KEY].mutations != null) {\n            // @ts-ignore\n            _super.prototype.update.call(this, this.domNode[Registry.DATA_KEY].mutations, context);\n        }\n        this.optimize(mutations, context);\n    };\n    ScrollBlot.blotName = 'scroll';\n    ScrollBlot.defaultChild = 'block';\n    ScrollBlot.scope = Registry.Scope.BLOCK_BLOT;\n    ScrollBlot.tagName = 'DIV';\n    return ScrollBlot;\n}(container_1.default));\nexports.default = ScrollBlot;\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar format_1 = __webpack_require__(18);\nvar Registry = __webpack_require__(1);\n// Shallow object comparison\nfunction isEqual(obj1, obj2) {\n    if (Object.keys(obj1).length !== Object.keys(obj2).length)\n        return false;\n    // @ts-ignore\n    for (var prop in obj1) {\n        // @ts-ignore\n        if (obj1[prop] !== obj2[prop])\n            return false;\n    }\n    return true;\n}\nvar InlineBlot = /** @class */ (function (_super) {\n    __extends(InlineBlot, _super);\n    function InlineBlot() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    InlineBlot.formats = function (domNode) {\n        if (domNode.tagName === InlineBlot.tagName)\n            return undefined;\n        return _super.formats.call(this, domNode);\n    };\n    InlineBlot.prototype.format = function (name, value) {\n        var _this = this;\n        if (name === this.statics.blotName && !value) {\n            this.children.forEach(function (child) {\n                if (!(child instanceof format_1.default)) {\n                    child = child.wrap(InlineBlot.blotName, true);\n                }\n                _this.attributes.copy(child);\n            });\n            this.unwrap();\n        }\n        else {\n            _super.prototype.format.call(this, name, value);\n        }\n    };\n    InlineBlot.prototype.formatAt = function (index, length, name, value) {\n        if (this.formats()[name] != null || Registry.query(name, Registry.Scope.ATTRIBUTE)) {\n            var blot = this.isolate(index, length);\n            blot.format(name, value);\n        }\n        else {\n            _super.prototype.formatAt.call(this, index, length, name, value);\n        }\n    };\n    InlineBlot.prototype.optimize = function (context) {\n        _super.prototype.optimize.call(this, context);\n        var formats = this.formats();\n        if (Object.keys(formats).length === 0) {\n            return this.unwrap(); // unformatted span\n        }\n        var next = this.next;\n        if (next instanceof InlineBlot && next.prev === this && isEqual(formats, next.formats())) {\n            next.moveChildren(this);\n            next.remove();\n        }\n    };\n    InlineBlot.blotName = 'inline';\n    InlineBlot.scope = Registry.Scope.INLINE_BLOT;\n    InlineBlot.tagName = 'SPAN';\n    return InlineBlot;\n}(format_1.default));\nexports.default = InlineBlot;\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar format_1 = __webpack_require__(18);\nvar Registry = __webpack_require__(1);\nvar BlockBlot = /** @class */ (function (_super) {\n    __extends(BlockBlot, _super);\n    function BlockBlot() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    BlockBlot.formats = function (domNode) {\n        var tagName = Registry.query(BlockBlot.blotName).tagName;\n        if (domNode.tagName === tagName)\n            return undefined;\n        return _super.formats.call(this, domNode);\n    };\n    BlockBlot.prototype.format = function (name, value) {\n        if (Registry.query(name, Registry.Scope.BLOCK) == null) {\n            return;\n        }\n        else if (name === this.statics.blotName && !value) {\n            this.replaceWith(BlockBlot.blotName);\n        }\n        else {\n            _super.prototype.format.call(this, name, value);\n        }\n    };\n    BlockBlot.prototype.formatAt = function (index, length, name, value) {\n        if (Registry.query(name, Registry.Scope.BLOCK) != null) {\n            this.format(name, value);\n        }\n        else {\n            _super.prototype.formatAt.call(this, index, length, name, value);\n        }\n    };\n    BlockBlot.prototype.insertAt = function (index, value, def) {\n        if (def == null || Registry.query(value, Registry.Scope.INLINE) != null) {\n            // Insert text or inline\n            _super.prototype.insertAt.call(this, index, value, def);\n        }\n        else {\n            var after = this.split(index);\n            var blot = Registry.create(value, def);\n            after.parent.insertBefore(blot, after);\n        }\n    };\n    BlockBlot.prototype.update = function (mutations, context) {\n        if (navigator.userAgent.match(/Trident/)) {\n            this.build();\n        }\n        else {\n            _super.prototype.update.call(this, mutations, context);\n        }\n    };\n    BlockBlot.blotName = 'block';\n    BlockBlot.scope = Registry.Scope.BLOCK_BLOT;\n    BlockBlot.tagName = 'P';\n    return BlockBlot;\n}(format_1.default));\nexports.default = BlockBlot;\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar leaf_1 = __webpack_require__(19);\nvar EmbedBlot = /** @class */ (function (_super) {\n    __extends(EmbedBlot, _super);\n    function EmbedBlot() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    EmbedBlot.formats = function (domNode) {\n        return undefined;\n    };\n    EmbedBlot.prototype.format = function (name, value) {\n        // super.formatAt wraps, which is what we want in general,\n        // but this allows subclasses to overwrite for formats\n        // that just apply to particular embeds\n        _super.prototype.formatAt.call(this, 0, this.length(), name, value);\n    };\n    EmbedBlot.prototype.formatAt = function (index, length, name, value) {\n        if (index === 0 && length === this.length()) {\n            this.format(name, value);\n        }\n        else {\n            _super.prototype.formatAt.call(this, index, length, name, value);\n        }\n    };\n    EmbedBlot.prototype.formats = function () {\n        return this.statics.formats(this.domNode);\n    };\n    return EmbedBlot;\n}(leaf_1.default));\nexports.default = EmbedBlot;\n\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar leaf_1 = __webpack_require__(19);\nvar Registry = __webpack_require__(1);\nvar TextBlot = /** @class */ (function (_super) {\n    __extends(TextBlot, _super);\n    function TextBlot(node) {\n        var _this = _super.call(this, node) || this;\n        _this.text = _this.statics.value(_this.domNode);\n        return _this;\n    }\n    TextBlot.create = function (value) {\n        return document.createTextNode(value);\n    };\n    TextBlot.value = function (domNode) {\n        var text = domNode.data;\n        // @ts-ignore\n        if (text['normalize'])\n            text = text['normalize']();\n        return text;\n    };\n    TextBlot.prototype.deleteAt = function (index, length) {\n        this.domNode.data = this.text = this.text.slice(0, index) + this.text.slice(index + length);\n    };\n    TextBlot.prototype.index = function (node, offset) {\n        if (this.domNode === node) {\n            return offset;\n        }\n        return -1;\n    };\n    TextBlot.prototype.insertAt = function (index, value, def) {\n        if (def == null) {\n            this.text = this.text.slice(0, index) + value + this.text.slice(index);\n            this.domNode.data = this.text;\n        }\n        else {\n            _super.prototype.insertAt.call(this, index, value, def);\n        }\n    };\n    TextBlot.prototype.length = function () {\n        return this.text.length;\n    };\n    TextBlot.prototype.optimize = function (context) {\n        _super.prototype.optimize.call(this, context);\n        this.text = this.statics.value(this.domNode);\n        if (this.text.length === 0) {\n            this.remove();\n        }\n        else if (this.next instanceof TextBlot && this.next.prev === this) {\n            this.insertAt(this.length(), this.next.value());\n            this.next.remove();\n        }\n    };\n    TextBlot.prototype.position = function (index, inclusive) {\n        if (inclusive === void 0) { inclusive = false; }\n        return [this.domNode, index];\n    };\n    TextBlot.prototype.split = function (index, force) {\n        if (force === void 0) { force = false; }\n        if (!force) {\n            if (index === 0)\n                return this;\n            if (index === this.length())\n                return this.next;\n        }\n        var after = Registry.create(this.domNode.splitText(index));\n        this.parent.insertBefore(after, this.next);\n        this.text = this.statics.value(this.domNode);\n        return after;\n    };\n    TextBlot.prototype.update = function (mutations, context) {\n        var _this = this;\n        if (mutations.some(function (mutation) {\n            return mutation.type === 'characterData' && mutation.target === _this.domNode;\n        })) {\n            this.text = this.statics.value(this.domNode);\n        }\n    };\n    TextBlot.prototype.value = function () {\n        return this.text;\n    };\n    TextBlot.blotName = 'text';\n    TextBlot.scope = Registry.Scope.INLINE_BLOT;\n    return TextBlot;\n}(leaf_1.default));\nexports.default = TextBlot;\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar elem = document.createElement('div');\nelem.classList.toggle('test-class', false);\nif (elem.classList.contains('test-class')) {\n  var _toggle = DOMTokenList.prototype.toggle;\n  DOMTokenList.prototype.toggle = function (token, force) {\n    if (arguments.length > 1 && !this.contains(token) === !force) {\n      return force;\n    } else {\n      return _toggle.call(this, token);\n    }\n  };\n}\n\nif (!String.prototype.startsWith) {\n  String.prototype.startsWith = function (searchString, position) {\n    position = position || 0;\n    return this.substr(position, searchString.length) === searchString;\n  };\n}\n\nif (!String.prototype.endsWith) {\n  String.prototype.endsWith = function (searchString, position) {\n    var subjectString = this.toString();\n    if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {\n      position = subjectString.length;\n    }\n    position -= searchString.length;\n    var lastIndex = subjectString.indexOf(searchString, position);\n    return lastIndex !== -1 && lastIndex === position;\n  };\n}\n\nif (!Array.prototype.find) {\n  Object.defineProperty(Array.prototype, \"find\", {\n    value: function value(predicate) {\n      if (this === null) {\n        throw new TypeError('Array.prototype.find called on null or undefined');\n      }\n      if (typeof predicate !== 'function') {\n        throw new TypeError('predicate must be a function');\n      }\n      var list = Object(this);\n      var length = list.length >>> 0;\n      var thisArg = arguments[1];\n      var value;\n\n      for (var i = 0; i < length; i++) {\n        value = list[i];\n        if (predicate.call(thisArg, value, i, list)) {\n          return value;\n        }\n      }\n      return undefined;\n    }\n  });\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  // Disable resizing in Firefox\n  document.execCommand(\"enableObjectResizing\", false, false);\n  // Disable automatic linkifying in IE11\n  document.execCommand(\"autoUrlDetect\", false, false);\n});\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports) {\n\n/**\n * This library modifies the diff-patch-match library by Neil Fraser\n * by removing the patch and match functionality and certain advanced\n * options in the diff function. The original license is as follows:\n *\n * ===\n *\n * Diff Match and Patch\n *\n * Copyright 2006 Google Inc.\n * http://code.google.com/p/google-diff-match-patch/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * The data structure representing a diff is an array of tuples:\n * [[DIFF_DELETE, 'Hello'], [DIFF_INSERT, 'Goodbye'], [DIFF_EQUAL, ' world.']]\n * which means: delete 'Hello', add 'Goodbye' and keep ' world.'\n */\nvar DIFF_DELETE = -1;\nvar DIFF_INSERT = 1;\nvar DIFF_EQUAL = 0;\n\n\n/**\n * Find the differences between two texts.  Simplifies the problem by stripping\n * any common prefix or suffix off the texts before diffing.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {Int} cursor_pos Expected edit position in text1 (optional)\n * @return {Array} Array of diff tuples.\n */\nfunction diff_main(text1, text2, cursor_pos) {\n  // Check for equality (speedup).\n  if (text1 == text2) {\n    if (text1) {\n      return [[DIFF_EQUAL, text1]];\n    }\n    return [];\n  }\n\n  // Check cursor_pos within bounds\n  if (cursor_pos < 0 || text1.length < cursor_pos) {\n    cursor_pos = null;\n  }\n\n  // Trim off common prefix (speedup).\n  var commonlength = diff_commonPrefix(text1, text2);\n  var commonprefix = text1.substring(0, commonlength);\n  text1 = text1.substring(commonlength);\n  text2 = text2.substring(commonlength);\n\n  // Trim off common suffix (speedup).\n  commonlength = diff_commonSuffix(text1, text2);\n  var commonsuffix = text1.substring(text1.length - commonlength);\n  text1 = text1.substring(0, text1.length - commonlength);\n  text2 = text2.substring(0, text2.length - commonlength);\n\n  // Compute the diff on the middle block.\n  var diffs = diff_compute_(text1, text2);\n\n  // Restore the prefix and suffix.\n  if (commonprefix) {\n    diffs.unshift([DIFF_EQUAL, commonprefix]);\n  }\n  if (commonsuffix) {\n    diffs.push([DIFF_EQUAL, commonsuffix]);\n  }\n  diff_cleanupMerge(diffs);\n  if (cursor_pos != null) {\n    diffs = fix_cursor(diffs, cursor_pos);\n  }\n  diffs = fix_emoji(diffs);\n  return diffs;\n};\n\n\n/**\n * Find the differences between two texts.  Assumes that the texts do not\n * have any common prefix or suffix.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @return {Array} Array of diff tuples.\n */\nfunction diff_compute_(text1, text2) {\n  var diffs;\n\n  if (!text1) {\n    // Just add some text (speedup).\n    return [[DIFF_INSERT, text2]];\n  }\n\n  if (!text2) {\n    // Just delete some text (speedup).\n    return [[DIFF_DELETE, text1]];\n  }\n\n  var longtext = text1.length > text2.length ? text1 : text2;\n  var shorttext = text1.length > text2.length ? text2 : text1;\n  var i = longtext.indexOf(shorttext);\n  if (i != -1) {\n    // Shorter text is inside the longer text (speedup).\n    diffs = [[DIFF_INSERT, longtext.substring(0, i)],\n             [DIFF_EQUAL, shorttext],\n             [DIFF_INSERT, longtext.substring(i + shorttext.length)]];\n    // Swap insertions for deletions if diff is reversed.\n    if (text1.length > text2.length) {\n      diffs[0][0] = diffs[2][0] = DIFF_DELETE;\n    }\n    return diffs;\n  }\n\n  if (shorttext.length == 1) {\n    // Single character string.\n    // After the previous speedup, the character can't be an equality.\n    return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];\n  }\n\n  // Check to see if the problem can be split in two.\n  var hm = diff_halfMatch_(text1, text2);\n  if (hm) {\n    // A half-match was found, sort out the return data.\n    var text1_a = hm[0];\n    var text1_b = hm[1];\n    var text2_a = hm[2];\n    var text2_b = hm[3];\n    var mid_common = hm[4];\n    // Send both pairs off for separate processing.\n    var diffs_a = diff_main(text1_a, text2_a);\n    var diffs_b = diff_main(text1_b, text2_b);\n    // Merge the results.\n    return diffs_a.concat([[DIFF_EQUAL, mid_common]], diffs_b);\n  }\n\n  return diff_bisect_(text1, text2);\n};\n\n\n/**\n * Find the 'middle snake' of a diff, split the problem in two\n * and return the recursively constructed diff.\n * See Myers 1986 paper: An O(ND) Difference Algorithm and Its Variations.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @return {Array} Array of diff tuples.\n * @private\n */\nfunction diff_bisect_(text1, text2) {\n  // Cache the text lengths to prevent multiple calls.\n  var text1_length = text1.length;\n  var text2_length = text2.length;\n  var max_d = Math.ceil((text1_length + text2_length) / 2);\n  var v_offset = max_d;\n  var v_length = 2 * max_d;\n  var v1 = new Array(v_length);\n  var v2 = new Array(v_length);\n  // Setting all elements to -1 is faster in Chrome & Firefox than mixing\n  // integers and undefined.\n  for (var x = 0; x < v_length; x++) {\n    v1[x] = -1;\n    v2[x] = -1;\n  }\n  v1[v_offset + 1] = 0;\n  v2[v_offset + 1] = 0;\n  var delta = text1_length - text2_length;\n  // If the total number of characters is odd, then the front path will collide\n  // with the reverse path.\n  var front = (delta % 2 != 0);\n  // Offsets for start and end of k loop.\n  // Prevents mapping of space beyond the grid.\n  var k1start = 0;\n  var k1end = 0;\n  var k2start = 0;\n  var k2end = 0;\n  for (var d = 0; d < max_d; d++) {\n    // Walk the front path one step.\n    for (var k1 = -d + k1start; k1 <= d - k1end; k1 += 2) {\n      var k1_offset = v_offset + k1;\n      var x1;\n      if (k1 == -d || (k1 != d && v1[k1_offset - 1] < v1[k1_offset + 1])) {\n        x1 = v1[k1_offset + 1];\n      } else {\n        x1 = v1[k1_offset - 1] + 1;\n      }\n      var y1 = x1 - k1;\n      while (x1 < text1_length && y1 < text2_length &&\n             text1.charAt(x1) == text2.charAt(y1)) {\n        x1++;\n        y1++;\n      }\n      v1[k1_offset] = x1;\n      if (x1 > text1_length) {\n        // Ran off the right of the graph.\n        k1end += 2;\n      } else if (y1 > text2_length) {\n        // Ran off the bottom of the graph.\n        k1start += 2;\n      } else if (front) {\n        var k2_offset = v_offset + delta - k1;\n        if (k2_offset >= 0 && k2_offset < v_length && v2[k2_offset] != -1) {\n          // Mirror x2 onto top-left coordinate system.\n          var x2 = text1_length - v2[k2_offset];\n          if (x1 >= x2) {\n            // Overlap detected.\n            return diff_bisectSplit_(text1, text2, x1, y1);\n          }\n        }\n      }\n    }\n\n    // Walk the reverse path one step.\n    for (var k2 = -d + k2start; k2 <= d - k2end; k2 += 2) {\n      var k2_offset = v_offset + k2;\n      var x2;\n      if (k2 == -d || (k2 != d && v2[k2_offset - 1] < v2[k2_offset + 1])) {\n        x2 = v2[k2_offset + 1];\n      } else {\n        x2 = v2[k2_offset - 1] + 1;\n      }\n      var y2 = x2 - k2;\n      while (x2 < text1_length && y2 < text2_length &&\n             text1.charAt(text1_length - x2 - 1) ==\n             text2.charAt(text2_length - y2 - 1)) {\n        x2++;\n        y2++;\n      }\n      v2[k2_offset] = x2;\n      if (x2 > text1_length) {\n        // Ran off the left of the graph.\n        k2end += 2;\n      } else if (y2 > text2_length) {\n        // Ran off the top of the graph.\n        k2start += 2;\n      } else if (!front) {\n        var k1_offset = v_offset + delta - k2;\n        if (k1_offset >= 0 && k1_offset < v_length && v1[k1_offset] != -1) {\n          var x1 = v1[k1_offset];\n          var y1 = v_offset + x1 - k1_offset;\n          // Mirror x2 onto top-left coordinate system.\n          x2 = text1_length - x2;\n          if (x1 >= x2) {\n            // Overlap detected.\n            return diff_bisectSplit_(text1, text2, x1, y1);\n          }\n        }\n      }\n    }\n  }\n  // Diff took too long and hit the deadline or\n  // number of diffs equals number of characters, no commonality at all.\n  return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];\n};\n\n\n/**\n * Given the location of the 'middle snake', split the diff in two parts\n * and recurse.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {number} x Index of split point in text1.\n * @param {number} y Index of split point in text2.\n * @return {Array} Array of diff tuples.\n */\nfunction diff_bisectSplit_(text1, text2, x, y) {\n  var text1a = text1.substring(0, x);\n  var text2a = text2.substring(0, y);\n  var text1b = text1.substring(x);\n  var text2b = text2.substring(y);\n\n  // Compute both diffs serially.\n  var diffs = diff_main(text1a, text2a);\n  var diffsb = diff_main(text1b, text2b);\n\n  return diffs.concat(diffsb);\n};\n\n\n/**\n * Determine the common prefix of two strings.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {number} The number of characters common to the start of each\n *     string.\n */\nfunction diff_commonPrefix(text1, text2) {\n  // Quick check for common null cases.\n  if (!text1 || !text2 || text1.charAt(0) != text2.charAt(0)) {\n    return 0;\n  }\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  var pointermin = 0;\n  var pointermax = Math.min(text1.length, text2.length);\n  var pointermid = pointermax;\n  var pointerstart = 0;\n  while (pointermin < pointermid) {\n    if (text1.substring(pointerstart, pointermid) ==\n        text2.substring(pointerstart, pointermid)) {\n      pointermin = pointermid;\n      pointerstart = pointermin;\n    } else {\n      pointermax = pointermid;\n    }\n    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);\n  }\n  return pointermid;\n};\n\n\n/**\n * Determine the common suffix of two strings.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {number} The number of characters common to the end of each string.\n */\nfunction diff_commonSuffix(text1, text2) {\n  // Quick check for common null cases.\n  if (!text1 || !text2 ||\n      text1.charAt(text1.length - 1) != text2.charAt(text2.length - 1)) {\n    return 0;\n  }\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  var pointermin = 0;\n  var pointermax = Math.min(text1.length, text2.length);\n  var pointermid = pointermax;\n  var pointerend = 0;\n  while (pointermin < pointermid) {\n    if (text1.substring(text1.length - pointermid, text1.length - pointerend) ==\n        text2.substring(text2.length - pointermid, text2.length - pointerend)) {\n      pointermin = pointermid;\n      pointerend = pointermin;\n    } else {\n      pointermax = pointermid;\n    }\n    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);\n  }\n  return pointermid;\n};\n\n\n/**\n * Do the two texts share a substring which is at least half the length of the\n * longer text?\n * This speedup can produce non-minimal diffs.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {Array.<string>} Five element Array, containing the prefix of\n *     text1, the suffix of text1, the prefix of text2, the suffix of\n *     text2 and the common middle.  Or null if there was no match.\n */\nfunction diff_halfMatch_(text1, text2) {\n  var longtext = text1.length > text2.length ? text1 : text2;\n  var shorttext = text1.length > text2.length ? text2 : text1;\n  if (longtext.length < 4 || shorttext.length * 2 < longtext.length) {\n    return null;  // Pointless.\n  }\n\n  /**\n   * Does a substring of shorttext exist within longtext such that the substring\n   * is at least half the length of longtext?\n   * Closure, but does not reference any external variables.\n   * @param {string} longtext Longer string.\n   * @param {string} shorttext Shorter string.\n   * @param {number} i Start index of quarter length substring within longtext.\n   * @return {Array.<string>} Five element Array, containing the prefix of\n   *     longtext, the suffix of longtext, the prefix of shorttext, the suffix\n   *     of shorttext and the common middle.  Or null if there was no match.\n   * @private\n   */\n  function diff_halfMatchI_(longtext, shorttext, i) {\n    // Start with a 1/4 length substring at position i as a seed.\n    var seed = longtext.substring(i, i + Math.floor(longtext.length / 4));\n    var j = -1;\n    var best_common = '';\n    var best_longtext_a, best_longtext_b, best_shorttext_a, best_shorttext_b;\n    while ((j = shorttext.indexOf(seed, j + 1)) != -1) {\n      var prefixLength = diff_commonPrefix(longtext.substring(i),\n                                           shorttext.substring(j));\n      var suffixLength = diff_commonSuffix(longtext.substring(0, i),\n                                           shorttext.substring(0, j));\n      if (best_common.length < suffixLength + prefixLength) {\n        best_common = shorttext.substring(j - suffixLength, j) +\n            shorttext.substring(j, j + prefixLength);\n        best_longtext_a = longtext.substring(0, i - suffixLength);\n        best_longtext_b = longtext.substring(i + prefixLength);\n        best_shorttext_a = shorttext.substring(0, j - suffixLength);\n        best_shorttext_b = shorttext.substring(j + prefixLength);\n      }\n    }\n    if (best_common.length * 2 >= longtext.length) {\n      return [best_longtext_a, best_longtext_b,\n              best_shorttext_a, best_shorttext_b, best_common];\n    } else {\n      return null;\n    }\n  }\n\n  // First check if the second quarter is the seed for a half-match.\n  var hm1 = diff_halfMatchI_(longtext, shorttext,\n                             Math.ceil(longtext.length / 4));\n  // Check again based on the third quarter.\n  var hm2 = diff_halfMatchI_(longtext, shorttext,\n                             Math.ceil(longtext.length / 2));\n  var hm;\n  if (!hm1 && !hm2) {\n    return null;\n  } else if (!hm2) {\n    hm = hm1;\n  } else if (!hm1) {\n    hm = hm2;\n  } else {\n    // Both matched.  Select the longest.\n    hm = hm1[4].length > hm2[4].length ? hm1 : hm2;\n  }\n\n  // A half-match was found, sort out the return data.\n  var text1_a, text1_b, text2_a, text2_b;\n  if (text1.length > text2.length) {\n    text1_a = hm[0];\n    text1_b = hm[1];\n    text2_a = hm[2];\n    text2_b = hm[3];\n  } else {\n    text2_a = hm[0];\n    text2_b = hm[1];\n    text1_a = hm[2];\n    text1_b = hm[3];\n  }\n  var mid_common = hm[4];\n  return [text1_a, text1_b, text2_a, text2_b, mid_common];\n};\n\n\n/**\n * Reorder and merge like edit sections.  Merge equalities.\n * Any edit section can move as long as it doesn't cross an equality.\n * @param {Array} diffs Array of diff tuples.\n */\nfunction diff_cleanupMerge(diffs) {\n  diffs.push([DIFF_EQUAL, '']);  // Add a dummy entry at the end.\n  var pointer = 0;\n  var count_delete = 0;\n  var count_insert = 0;\n  var text_delete = '';\n  var text_insert = '';\n  var commonlength;\n  while (pointer < diffs.length) {\n    switch (diffs[pointer][0]) {\n      case DIFF_INSERT:\n        count_insert++;\n        text_insert += diffs[pointer][1];\n        pointer++;\n        break;\n      case DIFF_DELETE:\n        count_delete++;\n        text_delete += diffs[pointer][1];\n        pointer++;\n        break;\n      case DIFF_EQUAL:\n        // Upon reaching an equality, check for prior redundancies.\n        if (count_delete + count_insert > 1) {\n          if (count_delete !== 0 && count_insert !== 0) {\n            // Factor out any common prefixies.\n            commonlength = diff_commonPrefix(text_insert, text_delete);\n            if (commonlength !== 0) {\n              if ((pointer - count_delete - count_insert) > 0 &&\n                  diffs[pointer - count_delete - count_insert - 1][0] ==\n                  DIFF_EQUAL) {\n                diffs[pointer - count_delete - count_insert - 1][1] +=\n                    text_insert.substring(0, commonlength);\n              } else {\n                diffs.splice(0, 0, [DIFF_EQUAL,\n                                    text_insert.substring(0, commonlength)]);\n                pointer++;\n              }\n              text_insert = text_insert.substring(commonlength);\n              text_delete = text_delete.substring(commonlength);\n            }\n            // Factor out any common suffixies.\n            commonlength = diff_commonSuffix(text_insert, text_delete);\n            if (commonlength !== 0) {\n              diffs[pointer][1] = text_insert.substring(text_insert.length -\n                  commonlength) + diffs[pointer][1];\n              text_insert = text_insert.substring(0, text_insert.length -\n                  commonlength);\n              text_delete = text_delete.substring(0, text_delete.length -\n                  commonlength);\n            }\n          }\n          // Delete the offending records and add the merged ones.\n          if (count_delete === 0) {\n            diffs.splice(pointer - count_insert,\n                count_delete + count_insert, [DIFF_INSERT, text_insert]);\n          } else if (count_insert === 0) {\n            diffs.splice(pointer - count_delete,\n                count_delete + count_insert, [DIFF_DELETE, text_delete]);\n          } else {\n            diffs.splice(pointer - count_delete - count_insert,\n                count_delete + count_insert, [DIFF_DELETE, text_delete],\n                [DIFF_INSERT, text_insert]);\n          }\n          pointer = pointer - count_delete - count_insert +\n                    (count_delete ? 1 : 0) + (count_insert ? 1 : 0) + 1;\n        } else if (pointer !== 0 && diffs[pointer - 1][0] == DIFF_EQUAL) {\n          // Merge this equality with the previous one.\n          diffs[pointer - 1][1] += diffs[pointer][1];\n          diffs.splice(pointer, 1);\n        } else {\n          pointer++;\n        }\n        count_insert = 0;\n        count_delete = 0;\n        text_delete = '';\n        text_insert = '';\n        break;\n    }\n  }\n  if (diffs[diffs.length - 1][1] === '') {\n    diffs.pop();  // Remove the dummy entry at the end.\n  }\n\n  // Second pass: look for single edits surrounded on both sides by equalities\n  // which can be shifted sideways to eliminate an equality.\n  // e.g: A<ins>BA</ins>C -> <ins>AB</ins>AC\n  var changes = false;\n  pointer = 1;\n  // Intentionally ignore the first and last element (don't need checking).\n  while (pointer < diffs.length - 1) {\n    if (diffs[pointer - 1][0] == DIFF_EQUAL &&\n        diffs[pointer + 1][0] == DIFF_EQUAL) {\n      // This is a single edit surrounded by equalities.\n      if (diffs[pointer][1].substring(diffs[pointer][1].length -\n          diffs[pointer - 1][1].length) == diffs[pointer - 1][1]) {\n        // Shift the edit over the previous equality.\n        diffs[pointer][1] = diffs[pointer - 1][1] +\n            diffs[pointer][1].substring(0, diffs[pointer][1].length -\n                                        diffs[pointer - 1][1].length);\n        diffs[pointer + 1][1] = diffs[pointer - 1][1] + diffs[pointer + 1][1];\n        diffs.splice(pointer - 1, 1);\n        changes = true;\n      } else if (diffs[pointer][1].substring(0, diffs[pointer + 1][1].length) ==\n          diffs[pointer + 1][1]) {\n        // Shift the edit over the next equality.\n        diffs[pointer - 1][1] += diffs[pointer + 1][1];\n        diffs[pointer][1] =\n            diffs[pointer][1].substring(diffs[pointer + 1][1].length) +\n            diffs[pointer + 1][1];\n        diffs.splice(pointer + 1, 1);\n        changes = true;\n      }\n    }\n    pointer++;\n  }\n  // If shifts were made, the diff needs reordering and another shift sweep.\n  if (changes) {\n    diff_cleanupMerge(diffs);\n  }\n};\n\n\nvar diff = diff_main;\ndiff.INSERT = DIFF_INSERT;\ndiff.DELETE = DIFF_DELETE;\ndiff.EQUAL = DIFF_EQUAL;\n\nmodule.exports = diff;\n\n/*\n * Modify a diff such that the cursor position points to the start of a change:\n * E.g.\n *   cursor_normalize_diff([[DIFF_EQUAL, 'abc']], 1)\n *     => [1, [[DIFF_EQUAL, 'a'], [DIFF_EQUAL, 'bc']]]\n *   cursor_normalize_diff([[DIFF_INSERT, 'new'], [DIFF_DELETE, 'xyz']], 2)\n *     => [2, [[DIFF_INSERT, 'new'], [DIFF_DELETE, 'xy'], [DIFF_DELETE, 'z']]]\n *\n * @param {Array} diffs Array of diff tuples\n * @param {Int} cursor_pos Suggested edit position. Must not be out of bounds!\n * @return {Array} A tuple [cursor location in the modified diff, modified diff]\n */\nfunction cursor_normalize_diff (diffs, cursor_pos) {\n  if (cursor_pos === 0) {\n    return [DIFF_EQUAL, diffs];\n  }\n  for (var current_pos = 0, i = 0; i < diffs.length; i++) {\n    var d = diffs[i];\n    if (d[0] === DIFF_DELETE || d[0] === DIFF_EQUAL) {\n      var next_pos = current_pos + d[1].length;\n      if (cursor_pos === next_pos) {\n        return [i + 1, diffs];\n      } else if (cursor_pos < next_pos) {\n        // copy to prevent side effects\n        diffs = diffs.slice();\n        // split d into two diff changes\n        var split_pos = cursor_pos - current_pos;\n        var d_left = [d[0], d[1].slice(0, split_pos)];\n        var d_right = [d[0], d[1].slice(split_pos)];\n        diffs.splice(i, 1, d_left, d_right);\n        return [i + 1, diffs];\n      } else {\n        current_pos = next_pos;\n      }\n    }\n  }\n  throw new Error('cursor_pos is out of bounds!')\n}\n\n/*\n * Modify a diff such that the edit position is \"shifted\" to the proposed edit location (cursor_position).\n *\n * Case 1)\n *   Check if a naive shift is possible:\n *     [0, X], [ 1, Y] -> [ 1, Y], [0, X]    (if X + Y === Y + X)\n *     [0, X], [-1, Y] -> [-1, Y], [0, X]    (if X + Y === Y + X) - holds same result\n * Case 2)\n *   Check if the following shifts are possible:\n *     [0, 'pre'], [ 1, 'prefix'] -> [ 1, 'pre'], [0, 'pre'], [ 1, 'fix']\n *     [0, 'pre'], [-1, 'prefix'] -> [-1, 'pre'], [0, 'pre'], [-1, 'fix']\n *         ^            ^\n *         d          d_next\n *\n * @param {Array} diffs Array of diff tuples\n * @param {Int} cursor_pos Suggested edit position. Must not be out of bounds!\n * @return {Array} Array of diff tuples\n */\nfunction fix_cursor (diffs, cursor_pos) {\n  var norm = cursor_normalize_diff(diffs, cursor_pos);\n  var ndiffs = norm[1];\n  var cursor_pointer = norm[0];\n  var d = ndiffs[cursor_pointer];\n  var d_next = ndiffs[cursor_pointer + 1];\n\n  if (d == null) {\n    // Text was deleted from end of original string,\n    // cursor is now out of bounds in new string\n    return diffs;\n  } else if (d[0] !== DIFF_EQUAL) {\n    // A modification happened at the cursor location.\n    // This is the expected outcome, so we can return the original diff.\n    return diffs;\n  } else {\n    if (d_next != null && d[1] + d_next[1] === d_next[1] + d[1]) {\n      // Case 1)\n      // It is possible to perform a naive shift\n      ndiffs.splice(cursor_pointer, 2, d_next, d)\n      return merge_tuples(ndiffs, cursor_pointer, 2)\n    } else if (d_next != null && d_next[1].indexOf(d[1]) === 0) {\n      // Case 2)\n      // d[1] is a prefix of d_next[1]\n      // We can assume that d_next[0] !== 0, since d[0] === 0\n      // Shift edit locations..\n      ndiffs.splice(cursor_pointer, 2, [d_next[0], d[1]], [0, d[1]]);\n      var suffix = d_next[1].slice(d[1].length);\n      if (suffix.length > 0) {\n        ndiffs.splice(cursor_pointer + 2, 0, [d_next[0], suffix]);\n      }\n      return merge_tuples(ndiffs, cursor_pointer, 3)\n    } else {\n      // Not possible to perform any modification\n      return diffs;\n    }\n  }\n}\n\n/*\n * Check diff did not split surrogate pairs.\n * Ex. [0, '\\uD83D'], [-1, '\\uDC36'], [1, '\\uDC2F'] -> [-1, '\\uD83D\\uDC36'], [1, '\\uD83D\\uDC2F']\n *     '\\uD83D\\uDC36' === '', '\\uD83D\\uDC2F' === ''\n *\n * @param {Array} diffs Array of diff tuples\n * @return {Array} Array of diff tuples\n */\nfunction fix_emoji (diffs) {\n  var compact = false;\n  var starts_with_pair_end = function(str) {\n    return str.charCodeAt(0) >= 0xDC00 && str.charCodeAt(0) <= 0xDFFF;\n  }\n  var ends_with_pair_start = function(str) {\n    return str.charCodeAt(str.length-1) >= 0xD800 && str.charCodeAt(str.length-1) <= 0xDBFF;\n  }\n  for (var i = 2; i < diffs.length; i += 1) {\n    if (diffs[i-2][0] === DIFF_EQUAL && ends_with_pair_start(diffs[i-2][1]) &&\n        diffs[i-1][0] === DIFF_DELETE && starts_with_pair_end(diffs[i-1][1]) &&\n        diffs[i][0] === DIFF_INSERT && starts_with_pair_end(diffs[i][1])) {\n      compact = true;\n\n      diffs[i-1][1] = diffs[i-2][1].slice(-1) + diffs[i-1][1];\n      diffs[i][1] = diffs[i-2][1].slice(-1) + diffs[i][1];\n\n      diffs[i-2][1] = diffs[i-2][1].slice(0, -1);\n    }\n  }\n  if (!compact) {\n    return diffs;\n  }\n  var fixed_diffs = [];\n  for (var i = 0; i < diffs.length; i += 1) {\n    if (diffs[i][1].length > 0) {\n      fixed_diffs.push(diffs[i]);\n    }\n  }\n  return fixed_diffs;\n}\n\n/*\n * Try to merge tuples with their neigbors in a given range.\n * E.g. [0, 'a'], [0, 'b'] -> [0, 'ab']\n *\n * @param {Array} diffs Array of diff tuples.\n * @param {Int} start Position of the first element to merge (diffs[start] is also merged with diffs[start - 1]).\n * @param {Int} length Number of consecutive elements to check.\n * @return {Array} Array of merged diff tuples.\n */\nfunction merge_tuples (diffs, start, length) {\n  // Check from (start-1) to (start+length).\n  for (var i = start + length - 1; i >= 0 && i >= start - 1; i--) {\n    if (i + 1 < diffs.length) {\n      var left_d = diffs[i];\n      var right_d = diffs[i+1];\n      if (left_d[0] === right_d[1]) {\n        diffs.splice(i, 2, [left_d[0], left_d[1] + right_d[1]]);\n      }\n    }\n  }\n  return diffs;\n}\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports) {\n\nexports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports) {\n\nvar supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports) {\n\n'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @api private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {Mixed} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @api private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @api public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @api public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {String|Symbol} event The event name.\n * @param {Boolean} exists Only check if there are listeners.\n * @returns {Array|Boolean}\n * @api public\n */\nEventEmitter.prototype.listeners = function listeners(event, exists) {\n  var evt = prefix ? prefix + event : event\n    , available = this._events[evt];\n\n  if (exists) return !!available;\n  if (!available) return [];\n  if (available.fn) return [available.fn];\n\n  for (var i = 0, l = available.length, ee = new Array(l); i < l; i++) {\n    ee[i] = available[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {String|Symbol} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @api public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {String|Symbol} event The event name.\n * @param {Function} fn The listener function.\n * @param {Mixed} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @api public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  var listener = new EE(fn, context || this)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) this._events[evt] = listener, this._eventsCount++;\n  else if (!this._events[evt].fn) this._events[evt].push(listener);\n  else this._events[evt] = [this._events[evt], listener];\n\n  return this;\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {String|Symbol} event The event name.\n * @param {Function} fn The listener function.\n * @param {Mixed} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @api public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  var listener = new EE(fn, context || this, true)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) this._events[evt] = listener, this._eventsCount++;\n  else if (!this._events[evt].fn) this._events[evt].push(listener);\n  else this._events[evt] = [this._events[evt], listener];\n\n  return this;\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {String|Symbol} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {Mixed} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @api public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    if (--this._eventsCount === 0) this._events = new Events();\n    else delete this._events[evt];\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n         listeners.fn === fn\n      && (!once || listeners.once)\n      && (!context || listeners.context === context)\n    ) {\n      if (--this._eventsCount === 0) this._events = new Events();\n      else delete this._events[evt];\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n           listeners[i].fn !== fn\n        || (once && !listeners[i].once)\n        || (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else if (--this._eventsCount === 0) this._events = new Events();\n    else delete this._events[evt];\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {String|Symbol} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @api public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) {\n      if (--this._eventsCount === 0) this._events = new Events();\n      else delete this._events[evt];\n    }\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// This function doesn't apply anymore.\n//\nEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n  return this;\n};\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.matchText = exports.matchSpacing = exports.matchNewline = exports.matchBlot = exports.matchAttributor = exports.default = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _extend2 = __webpack_require__(3);\n\nvar _extend3 = _interopRequireDefault(_extend2);\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _quill = __webpack_require__(5);\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _logger = __webpack_require__(10);\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _module = __webpack_require__(9);\n\nvar _module2 = _interopRequireDefault(_module);\n\nvar _align = __webpack_require__(36);\n\nvar _background = __webpack_require__(37);\n\nvar _code = __webpack_require__(13);\n\nvar _code2 = _interopRequireDefault(_code);\n\nvar _color = __webpack_require__(26);\n\nvar _direction = __webpack_require__(38);\n\nvar _font = __webpack_require__(39);\n\nvar _size = __webpack_require__(40);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar debug = (0, _logger2.default)('quill:clipboard');\n\nvar DOM_KEY = '__ql-matcher';\n\nvar CLIPBOARD_CONFIG = [[Node.TEXT_NODE, matchText], [Node.TEXT_NODE, matchNewline], ['br', matchBreak], [Node.ELEMENT_NODE, matchNewline], [Node.ELEMENT_NODE, matchBlot], [Node.ELEMENT_NODE, matchSpacing], [Node.ELEMENT_NODE, matchAttributor], [Node.ELEMENT_NODE, matchStyles], ['li', matchIndent], ['b', matchAlias.bind(matchAlias, 'bold')], ['i', matchAlias.bind(matchAlias, 'italic')], ['style', matchIgnore]];\n\nvar ATTRIBUTE_ATTRIBUTORS = [_align.AlignAttribute, _direction.DirectionAttribute].reduce(function (memo, attr) {\n  memo[attr.keyName] = attr;\n  return memo;\n}, {});\n\nvar STYLE_ATTRIBUTORS = [_align.AlignStyle, _background.BackgroundStyle, _color.ColorStyle, _direction.DirectionStyle, _font.FontStyle, _size.SizeStyle].reduce(function (memo, attr) {\n  memo[attr.keyName] = attr;\n  return memo;\n}, {});\n\nvar Clipboard = function (_Module) {\n  _inherits(Clipboard, _Module);\n\n  function Clipboard(quill, options) {\n    _classCallCheck(this, Clipboard);\n\n    var _this = _possibleConstructorReturn(this, (Clipboard.__proto__ || Object.getPrototypeOf(Clipboard)).call(this, quill, options));\n\n    _this.quill.root.addEventListener('paste', _this.onPaste.bind(_this));\n    _this.container = _this.quill.addContainer('ql-clipboard');\n    _this.container.setAttribute('contenteditable', true);\n    _this.container.setAttribute('tabindex', -1);\n    _this.matchers = [];\n    CLIPBOARD_CONFIG.concat(_this.options.matchers).forEach(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          selector = _ref2[0],\n          matcher = _ref2[1];\n\n      if (!options.matchVisual && matcher === matchSpacing) return;\n      _this.addMatcher(selector, matcher);\n    });\n    return _this;\n  }\n\n  _createClass(Clipboard, [{\n    key: 'addMatcher',\n    value: function addMatcher(selector, matcher) {\n      this.matchers.push([selector, matcher]);\n    }\n  }, {\n    key: 'convert',\n    value: function convert(html) {\n      if (typeof html === 'string') {\n        this.container.innerHTML = html.replace(/\\>\\r?\\n +\\</g, '><'); // Remove spaces between tags\n        return this.convert();\n      }\n      var formats = this.quill.getFormat(this.quill.selection.savedRange.index);\n      if (formats[_code2.default.blotName]) {\n        var text = this.container.innerText;\n        this.container.innerHTML = '';\n        return new _quillDelta2.default().insert(text, _defineProperty({}, _code2.default.blotName, formats[_code2.default.blotName]));\n      }\n\n      var _prepareMatching = this.prepareMatching(),\n          _prepareMatching2 = _slicedToArray(_prepareMatching, 2),\n          elementMatchers = _prepareMatching2[0],\n          textMatchers = _prepareMatching2[1];\n\n      var delta = traverse(this.container, elementMatchers, textMatchers);\n      // Remove trailing newline\n      if (deltaEndsWith(delta, '\\n') && delta.ops[delta.ops.length - 1].attributes == null) {\n        delta = delta.compose(new _quillDelta2.default().retain(delta.length() - 1).delete(1));\n      }\n      debug.log('convert', this.container.innerHTML, delta);\n      this.container.innerHTML = '';\n      return delta;\n    }\n  }, {\n    key: 'dangerouslyPasteHTML',\n    value: function dangerouslyPasteHTML(index, html) {\n      var source = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : _quill2.default.sources.API;\n\n      if (typeof index === 'string') {\n        this.quill.setContents(this.convert(index), html);\n        this.quill.setSelection(0, _quill2.default.sources.SILENT);\n      } else {\n        var paste = this.convert(html);\n        this.quill.updateContents(new _quillDelta2.default().retain(index).concat(paste), source);\n        this.quill.setSelection(index + paste.length(), _quill2.default.sources.SILENT);\n      }\n    }\n  }, {\n    key: 'onPaste',\n    value: function onPaste(e) {\n      var _this2 = this;\n\n      if (e.defaultPrevented || !this.quill.isEnabled()) return;\n      var range = this.quill.getSelection();\n      var delta = new _quillDelta2.default().retain(range.index);\n      var scrollTop = this.quill.scrollingContainer.scrollTop;\n      this.container.focus();\n      this.quill.selection.update(_quill2.default.sources.SILENT);\n      setTimeout(function () {\n        delta = delta.concat(_this2.convert()).delete(range.length);\n        _this2.quill.updateContents(delta, _quill2.default.sources.USER);\n        // range.length contributes to delta.length()\n        _this2.quill.setSelection(delta.length() - range.length, _quill2.default.sources.SILENT);\n        _this2.quill.scrollingContainer.scrollTop = scrollTop;\n        _this2.quill.focus();\n      }, 1);\n    }\n  }, {\n    key: 'prepareMatching',\n    value: function prepareMatching() {\n      var _this3 = this;\n\n      var elementMatchers = [],\n          textMatchers = [];\n      this.matchers.forEach(function (pair) {\n        var _pair = _slicedToArray(pair, 2),\n            selector = _pair[0],\n            matcher = _pair[1];\n\n        switch (selector) {\n          case Node.TEXT_NODE:\n            textMatchers.push(matcher);\n            break;\n          case Node.ELEMENT_NODE:\n            elementMatchers.push(matcher);\n            break;\n          default:\n            [].forEach.call(_this3.container.querySelectorAll(selector), function (node) {\n              // TODO use weakmap\n              node[DOM_KEY] = node[DOM_KEY] || [];\n              node[DOM_KEY].push(matcher);\n            });\n            break;\n        }\n      });\n      return [elementMatchers, textMatchers];\n    }\n  }]);\n\n  return Clipboard;\n}(_module2.default);\n\nClipboard.DEFAULTS = {\n  matchers: [],\n  matchVisual: true\n};\n\nfunction applyFormat(delta, format, value) {\n  if ((typeof format === 'undefined' ? 'undefined' : _typeof(format)) === 'object') {\n    return Object.keys(format).reduce(function (delta, key) {\n      return applyFormat(delta, key, format[key]);\n    }, delta);\n  } else {\n    return delta.reduce(function (delta, op) {\n      if (op.attributes && op.attributes[format]) {\n        return delta.push(op);\n      } else {\n        return delta.insert(op.insert, (0, _extend3.default)({}, _defineProperty({}, format, value), op.attributes));\n      }\n    }, new _quillDelta2.default());\n  }\n}\n\nfunction computeStyle(node) {\n  if (node.nodeType !== Node.ELEMENT_NODE) return {};\n  var DOM_KEY = '__ql-computed-style';\n  return node[DOM_KEY] || (node[DOM_KEY] = window.getComputedStyle(node));\n}\n\nfunction deltaEndsWith(delta, text) {\n  var endText = \"\";\n  for (var i = delta.ops.length - 1; i >= 0 && endText.length < text.length; --i) {\n    var op = delta.ops[i];\n    if (typeof op.insert !== 'string') break;\n    endText = op.insert + endText;\n  }\n  return endText.slice(-1 * text.length) === text;\n}\n\nfunction isLine(node) {\n  if (node.childNodes.length === 0) return false; // Exclude embed blocks\n  var style = computeStyle(node);\n  return ['block', 'list-item'].indexOf(style.display) > -1;\n}\n\nfunction traverse(node, elementMatchers, textMatchers) {\n  // Post-order\n  if (node.nodeType === node.TEXT_NODE) {\n    return textMatchers.reduce(function (delta, matcher) {\n      return matcher(node, delta);\n    }, new _quillDelta2.default());\n  } else if (node.nodeType === node.ELEMENT_NODE) {\n    return [].reduce.call(node.childNodes || [], function (delta, childNode) {\n      var childrenDelta = traverse(childNode, elementMatchers, textMatchers);\n      if (childNode.nodeType === node.ELEMENT_NODE) {\n        childrenDelta = elementMatchers.reduce(function (childrenDelta, matcher) {\n          return matcher(childNode, childrenDelta);\n        }, childrenDelta);\n        childrenDelta = (childNode[DOM_KEY] || []).reduce(function (childrenDelta, matcher) {\n          return matcher(childNode, childrenDelta);\n        }, childrenDelta);\n      }\n      return delta.concat(childrenDelta);\n    }, new _quillDelta2.default());\n  } else {\n    return new _quillDelta2.default();\n  }\n}\n\nfunction matchAlias(format, node, delta) {\n  return applyFormat(delta, format, true);\n}\n\nfunction matchAttributor(node, delta) {\n  var attributes = _parchment2.default.Attributor.Attribute.keys(node);\n  var classes = _parchment2.default.Attributor.Class.keys(node);\n  var styles = _parchment2.default.Attributor.Style.keys(node);\n  var formats = {};\n  attributes.concat(classes).concat(styles).forEach(function (name) {\n    var attr = _parchment2.default.query(name, _parchment2.default.Scope.ATTRIBUTE);\n    if (attr != null) {\n      formats[attr.attrName] = attr.value(node);\n      if (formats[attr.attrName]) return;\n    }\n    attr = ATTRIBUTE_ATTRIBUTORS[name];\n    if (attr != null && (attr.attrName === name || attr.keyName === name)) {\n      formats[attr.attrName] = attr.value(node) || undefined;\n    }\n    attr = STYLE_ATTRIBUTORS[name];\n    if (attr != null && (attr.attrName === name || attr.keyName === name)) {\n      attr = STYLE_ATTRIBUTORS[name];\n      formats[attr.attrName] = attr.value(node) || undefined;\n    }\n  });\n  if (Object.keys(formats).length > 0) {\n    delta = applyFormat(delta, formats);\n  }\n  return delta;\n}\n\nfunction matchBlot(node, delta) {\n  var match = _parchment2.default.query(node);\n  if (match == null) return delta;\n  if (match.prototype instanceof _parchment2.default.Embed) {\n    var embed = {};\n    var value = match.value(node);\n    if (value != null) {\n      embed[match.blotName] = value;\n      delta = new _quillDelta2.default().insert(embed, match.formats(node));\n    }\n  } else if (typeof match.formats === 'function') {\n    delta = applyFormat(delta, match.blotName, match.formats(node));\n  }\n  return delta;\n}\n\nfunction matchBreak(node, delta) {\n  if (!deltaEndsWith(delta, '\\n')) {\n    delta.insert('\\n');\n  }\n  return delta;\n}\n\nfunction matchIgnore() {\n  return new _quillDelta2.default();\n}\n\nfunction matchIndent(node, delta) {\n  var match = _parchment2.default.query(node);\n  if (match == null || match.blotName !== 'list-item' || !deltaEndsWith(delta, '\\n')) {\n    return delta;\n  }\n  var indent = -1,\n      parent = node.parentNode;\n  while (!parent.classList.contains('ql-clipboard')) {\n    if ((_parchment2.default.query(parent) || {}).blotName === 'list') {\n      indent += 1;\n    }\n    parent = parent.parentNode;\n  }\n  if (indent <= 0) return delta;\n  return delta.compose(new _quillDelta2.default().retain(delta.length() - 1).retain(1, { indent: indent }));\n}\n\nfunction matchNewline(node, delta) {\n  if (!deltaEndsWith(delta, '\\n')) {\n    if (isLine(node) || delta.length() > 0 && node.nextSibling && isLine(node.nextSibling)) {\n      delta.insert('\\n');\n    }\n  }\n  return delta;\n}\n\nfunction matchSpacing(node, delta) {\n  if (isLine(node) && node.nextElementSibling != null && !deltaEndsWith(delta, '\\n\\n')) {\n    var nodeHeight = node.offsetHeight + parseFloat(computeStyle(node).marginTop) + parseFloat(computeStyle(node).marginBottom);\n    if (node.nextElementSibling.offsetTop > node.offsetTop + nodeHeight * 1.5) {\n      delta.insert('\\n');\n    }\n  }\n  return delta;\n}\n\nfunction matchStyles(node, delta) {\n  var formats = {};\n  var style = node.style || {};\n  if (style.fontStyle && computeStyle(node).fontStyle === 'italic') {\n    formats.italic = true;\n  }\n  if (style.fontWeight && (computeStyle(node).fontWeight.startsWith('bold') || parseInt(computeStyle(node).fontWeight) >= 700)) {\n    formats.bold = true;\n  }\n  if (Object.keys(formats).length > 0) {\n    delta = applyFormat(delta, formats);\n  }\n  if (parseFloat(style.textIndent || 0) > 0) {\n    // Could be 0.5in\n    delta = new _quillDelta2.default().insert('\\t').concat(delta);\n  }\n  return delta;\n}\n\nfunction matchText(node, delta) {\n  var text = node.data;\n  // Word represents empty line with <o:p>&nbsp;</o:p>\n  if (node.parentNode.tagName === 'O:P') {\n    return delta.insert(text.trim());\n  }\n  if (text.trim().length === 0 && node.parentNode.classList.contains('ql-clipboard')) {\n    return delta;\n  }\n  if (!computeStyle(node.parentNode).whiteSpace.startsWith('pre')) {\n    // eslint-disable-next-line func-style\n    var replacer = function replacer(collapse, match) {\n      match = match.replace(/[^\\u00a0]/g, ''); // \\u00a0 is nbsp;\n      return match.length < 1 && collapse ? ' ' : match;\n    };\n    text = text.replace(/\\r\\n/g, ' ').replace(/\\n/g, ' ');\n    text = text.replace(/\\s\\s+/g, replacer.bind(replacer, true)); // collapse whitespace\n    if (node.previousSibling == null && isLine(node.parentNode) || node.previousSibling != null && isLine(node.previousSibling)) {\n      text = text.replace(/^\\s+/, replacer.bind(replacer, false));\n    }\n    if (node.nextSibling == null && isLine(node.parentNode) || node.nextSibling != null && isLine(node.nextSibling)) {\n      text = text.replace(/\\s+$/, replacer.bind(replacer, false));\n    }\n  }\n  return delta.insert(text);\n}\n\nexports.default = Clipboard;\nexports.matchAttributor = matchAttributor;\nexports.matchBlot = matchBlot;\nexports.matchNewline = matchNewline;\nexports.matchSpacing = matchSpacing;\nexports.matchText = matchText;\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Bold = function (_Inline) {\n  _inherits(Bold, _Inline);\n\n  function Bold() {\n    _classCallCheck(this, Bold);\n\n    return _possibleConstructorReturn(this, (Bold.__proto__ || Object.getPrototypeOf(Bold)).apply(this, arguments));\n  }\n\n  _createClass(Bold, [{\n    key: 'optimize',\n    value: function optimize(context) {\n      _get(Bold.prototype.__proto__ || Object.getPrototypeOf(Bold.prototype), 'optimize', this).call(this, context);\n      if (this.domNode.tagName !== this.statics.tagName[0]) {\n        this.replaceWith(this.statics.blotName);\n      }\n    }\n  }], [{\n    key: 'create',\n    value: function create() {\n      return _get(Bold.__proto__ || Object.getPrototypeOf(Bold), 'create', this).call(this);\n    }\n  }, {\n    key: 'formats',\n    value: function formats() {\n      return true;\n    }\n  }]);\n\n  return Bold;\n}(_inline2.default);\n\nBold.blotName = 'bold';\nBold.tagName = ['STRONG', 'B'];\n\nexports.default = Bold;\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addControls = exports.default = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _quillDelta = __webpack_require__(2);\n\nvar _quillDelta2 = _interopRequireDefault(_quillDelta);\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _quill = __webpack_require__(5);\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _logger = __webpack_require__(10);\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _module = __webpack_require__(9);\n\nvar _module2 = _interopRequireDefault(_module);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar debug = (0, _logger2.default)('quill:toolbar');\n\nvar Toolbar = function (_Module) {\n  _inherits(Toolbar, _Module);\n\n  function Toolbar(quill, options) {\n    _classCallCheck(this, Toolbar);\n\n    var _this = _possibleConstructorReturn(this, (Toolbar.__proto__ || Object.getPrototypeOf(Toolbar)).call(this, quill, options));\n\n    if (Array.isArray(_this.options.container)) {\n      var container = document.createElement('div');\n      addControls(container, _this.options.container);\n      quill.container.parentNode.insertBefore(container, quill.container);\n      _this.container = container;\n    } else if (typeof _this.options.container === 'string') {\n      _this.container = document.querySelector(_this.options.container);\n    } else {\n      _this.container = _this.options.container;\n    }\n    if (!(_this.container instanceof HTMLElement)) {\n      var _ret;\n\n      return _ret = debug.error('Container required for toolbar', _this.options), _possibleConstructorReturn(_this, _ret);\n    }\n    _this.container.classList.add('ql-toolbar');\n    _this.controls = [];\n    _this.handlers = {};\n    Object.keys(_this.options.handlers).forEach(function (format) {\n      _this.addHandler(format, _this.options.handlers[format]);\n    });\n    [].forEach.call(_this.container.querySelectorAll('button, select'), function (input) {\n      _this.attach(input);\n    });\n    _this.quill.on(_quill2.default.events.EDITOR_CHANGE, function (type, range) {\n      if (type === _quill2.default.events.SELECTION_CHANGE) {\n        _this.update(range);\n      }\n    });\n    _this.quill.on(_quill2.default.events.SCROLL_OPTIMIZE, function () {\n      var _this$quill$selection = _this.quill.selection.getRange(),\n          _this$quill$selection2 = _slicedToArray(_this$quill$selection, 1),\n          range = _this$quill$selection2[0]; // quill.getSelection triggers update\n\n\n      _this.update(range);\n    });\n    return _this;\n  }\n\n  _createClass(Toolbar, [{\n    key: 'addHandler',\n    value: function addHandler(format, handler) {\n      this.handlers[format] = handler;\n    }\n  }, {\n    key: 'attach',\n    value: function attach(input) {\n      var _this2 = this;\n\n      var format = [].find.call(input.classList, function (className) {\n        return className.indexOf('ql-') === 0;\n      });\n      if (!format) return;\n      format = format.slice('ql-'.length);\n      if (input.tagName === 'BUTTON') {\n        input.setAttribute('type', 'button');\n      }\n      if (this.handlers[format] == null) {\n        if (this.quill.scroll.whitelist != null && this.quill.scroll.whitelist[format] == null) {\n          debug.warn('ignoring attaching to disabled format', format, input);\n          return;\n        }\n        if (_parchment2.default.query(format) == null) {\n          debug.warn('ignoring attaching to nonexistent format', format, input);\n          return;\n        }\n      }\n      var eventName = input.tagName === 'SELECT' ? 'change' : 'click';\n      input.addEventListener(eventName, function (e) {\n        var value = void 0;\n        if (input.tagName === 'SELECT') {\n          if (input.selectedIndex < 0) return;\n          var selected = input.options[input.selectedIndex];\n          if (selected.hasAttribute('selected')) {\n            value = false;\n          } else {\n            value = selected.value || false;\n          }\n        } else {\n          if (input.classList.contains('ql-active')) {\n            value = false;\n          } else {\n            value = input.value || !input.hasAttribute('value');\n          }\n          e.preventDefault();\n        }\n        _this2.quill.focus();\n\n        var _quill$selection$getR = _this2.quill.selection.getRange(),\n            _quill$selection$getR2 = _slicedToArray(_quill$selection$getR, 1),\n            range = _quill$selection$getR2[0];\n\n        if (_this2.handlers[format] != null) {\n          _this2.handlers[format].call(_this2, value);\n        } else if (_parchment2.default.query(format).prototype instanceof _parchment2.default.Embed) {\n          value = prompt('Enter ' + format);\n          if (!value) return;\n          _this2.quill.updateContents(new _quillDelta2.default().retain(range.index).delete(range.length).insert(_defineProperty({}, format, value)), _quill2.default.sources.USER);\n        } else {\n          _this2.quill.format(format, value, _quill2.default.sources.USER);\n        }\n        _this2.update(range);\n      });\n      // TODO use weakmap\n      this.controls.push([format, input]);\n    }\n  }, {\n    key: 'update',\n    value: function update(range) {\n      var formats = range == null ? {} : this.quill.getFormat(range);\n      this.controls.forEach(function (pair) {\n        var _pair = _slicedToArray(pair, 2),\n            format = _pair[0],\n            input = _pair[1];\n\n        if (input.tagName === 'SELECT') {\n          var option = void 0;\n          if (range == null) {\n            option = null;\n          } else if (formats[format] == null) {\n            option = input.querySelector('option[selected]');\n          } else if (!Array.isArray(formats[format])) {\n            var value = formats[format];\n            if (typeof value === 'string') {\n              value = value.replace(/\\\"/g, '\\\\\"');\n            }\n            option = input.querySelector('option[value=\"' + value + '\"]');\n          }\n          if (option == null) {\n            input.value = ''; // TODO make configurable?\n            input.selectedIndex = -1;\n          } else {\n            option.selected = true;\n          }\n        } else {\n          if (range == null) {\n            input.classList.remove('ql-active');\n          } else if (input.hasAttribute('value')) {\n            // both being null should match (default values)\n            // '1' should match with 1 (headers)\n            var isActive = formats[format] === input.getAttribute('value') || formats[format] != null && formats[format].toString() === input.getAttribute('value') || formats[format] == null && !input.getAttribute('value');\n            input.classList.toggle('ql-active', isActive);\n          } else {\n            input.classList.toggle('ql-active', formats[format] != null);\n          }\n        }\n      });\n    }\n  }]);\n\n  return Toolbar;\n}(_module2.default);\n\nToolbar.DEFAULTS = {};\n\nfunction addButton(container, format, value) {\n  var input = document.createElement('button');\n  input.setAttribute('type', 'button');\n  input.classList.add('ql-' + format);\n  if (value != null) {\n    input.value = value;\n  }\n  container.appendChild(input);\n}\n\nfunction addControls(container, groups) {\n  if (!Array.isArray(groups[0])) {\n    groups = [groups];\n  }\n  groups.forEach(function (controls) {\n    var group = document.createElement('span');\n    group.classList.add('ql-formats');\n    controls.forEach(function (control) {\n      if (typeof control === 'string') {\n        addButton(group, control);\n      } else {\n        var format = Object.keys(control)[0];\n        var value = control[format];\n        if (Array.isArray(value)) {\n          addSelect(group, format, value);\n        } else {\n          addButton(group, format, value);\n        }\n      }\n    });\n    container.appendChild(group);\n  });\n}\n\nfunction addSelect(container, format, values) {\n  var input = document.createElement('select');\n  input.classList.add('ql-' + format);\n  values.forEach(function (value) {\n    var option = document.createElement('option');\n    if (value !== false) {\n      option.setAttribute('value', value);\n    } else {\n      option.setAttribute('selected', 'selected');\n    }\n    input.appendChild(option);\n  });\n  container.appendChild(input);\n}\n\nToolbar.DEFAULTS = {\n  container: null,\n  handlers: {\n    clean: function clean() {\n      var _this3 = this;\n\n      var range = this.quill.getSelection();\n      if (range == null) return;\n      if (range.length == 0) {\n        var formats = this.quill.getFormat();\n        Object.keys(formats).forEach(function (name) {\n          // Clean functionality in existing apps only clean inline formats\n          if (_parchment2.default.query(name, _parchment2.default.Scope.INLINE) != null) {\n            _this3.quill.format(name, false);\n          }\n        });\n      } else {\n        this.quill.removeFormat(range, _quill2.default.sources.USER);\n      }\n    },\n    direction: function direction(value) {\n      var align = this.quill.getFormat()['align'];\n      if (value === 'rtl' && align == null) {\n        this.quill.format('align', 'right', _quill2.default.sources.USER);\n      } else if (!value && align === 'right') {\n        this.quill.format('align', false, _quill2.default.sources.USER);\n      }\n      this.quill.format('direction', value, _quill2.default.sources.USER);\n    },\n    indent: function indent(value) {\n      var range = this.quill.getSelection();\n      var formats = this.quill.getFormat(range);\n      var indent = parseInt(formats.indent || 0);\n      if (value === '+1' || value === '-1') {\n        var modifier = value === '+1' ? 1 : -1;\n        if (formats.direction === 'rtl') modifier *= -1;\n        this.quill.format('indent', indent + modifier, _quill2.default.sources.USER);\n      }\n    },\n    link: function link(value) {\n      if (value === true) {\n        value = prompt('Enter link URL:');\n      }\n      this.quill.format('link', value, _quill2.default.sources.USER);\n    },\n    list: function list(value) {\n      var range = this.quill.getSelection();\n      var formats = this.quill.getFormat(range);\n      if (value === 'check') {\n        if (formats['list'] === 'checked' || formats['list'] === 'unchecked') {\n          this.quill.format('list', false, _quill2.default.sources.USER);\n        } else {\n          this.quill.format('list', 'unchecked', _quill2.default.sources.USER);\n        }\n      } else {\n        this.quill.format('list', value, _quill2.default.sources.USER);\n      }\n    }\n  }\n};\n\nexports.default = Toolbar;\nexports.addControls = addControls;\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <polyline class=\\\"ql-even ql-stroke\\\" points=\\\"5 7 3 9 5 11\\\"></polyline> <polyline class=\\\"ql-even ql-stroke\\\" points=\\\"13 7 15 9 13 11\\\"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>\";\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _picker = __webpack_require__(28);\n\nvar _picker2 = _interopRequireDefault(_picker);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ColorPicker = function (_Picker) {\n  _inherits(ColorPicker, _Picker);\n\n  function ColorPicker(select, label) {\n    _classCallCheck(this, ColorPicker);\n\n    var _this = _possibleConstructorReturn(this, (ColorPicker.__proto__ || Object.getPrototypeOf(ColorPicker)).call(this, select));\n\n    _this.label.innerHTML = label;\n    _this.container.classList.add('ql-color-picker');\n    [].slice.call(_this.container.querySelectorAll('.ql-picker-item'), 0, 7).forEach(function (item) {\n      item.classList.add('ql-primary');\n    });\n    return _this;\n  }\n\n  _createClass(ColorPicker, [{\n    key: 'buildItem',\n    value: function buildItem(option) {\n      var item = _get(ColorPicker.prototype.__proto__ || Object.getPrototypeOf(ColorPicker.prototype), 'buildItem', this).call(this, option);\n      item.style.backgroundColor = option.getAttribute('value') || '';\n      return item;\n    }\n  }, {\n    key: 'selectItem',\n    value: function selectItem(item, trigger) {\n      _get(ColorPicker.prototype.__proto__ || Object.getPrototypeOf(ColorPicker.prototype), 'selectItem', this).call(this, item, trigger);\n      var colorLabel = this.label.querySelector('.ql-color-label');\n      var value = item ? item.getAttribute('data-value') || '' : '';\n      if (colorLabel) {\n        if (colorLabel.tagName === 'line') {\n          colorLabel.style.stroke = value;\n        } else {\n          colorLabel.style.fill = value;\n        }\n      }\n    }\n  }]);\n\n  return ColorPicker;\n}(_picker2.default);\n\nexports.default = ColorPicker;\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _picker = __webpack_require__(28);\n\nvar _picker2 = _interopRequireDefault(_picker);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar IconPicker = function (_Picker) {\n  _inherits(IconPicker, _Picker);\n\n  function IconPicker(select, icons) {\n    _classCallCheck(this, IconPicker);\n\n    var _this = _possibleConstructorReturn(this, (IconPicker.__proto__ || Object.getPrototypeOf(IconPicker)).call(this, select));\n\n    _this.container.classList.add('ql-icon-picker');\n    [].forEach.call(_this.container.querySelectorAll('.ql-picker-item'), function (item) {\n      item.innerHTML = icons[item.getAttribute('data-value') || ''];\n    });\n    _this.defaultItem = _this.container.querySelector('.ql-selected');\n    _this.selectItem(_this.defaultItem);\n    return _this;\n  }\n\n  _createClass(IconPicker, [{\n    key: 'selectItem',\n    value: function selectItem(item, trigger) {\n      _get(IconPicker.prototype.__proto__ || Object.getPrototypeOf(IconPicker.prototype), 'selectItem', this).call(this, item, trigger);\n      item = item || this.defaultItem;\n      this.label.innerHTML = item.innerHTML;\n    }\n  }]);\n\n  return IconPicker;\n}(_picker2.default);\n\nexports.default = IconPicker;\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Tooltip = function () {\n  function Tooltip(quill, boundsContainer) {\n    var _this = this;\n\n    _classCallCheck(this, Tooltip);\n\n    this.quill = quill;\n    this.boundsContainer = boundsContainer || document.body;\n    this.root = quill.addContainer('ql-tooltip');\n    this.root.innerHTML = this.constructor.TEMPLATE;\n    if (this.quill.root === this.quill.scrollingContainer) {\n      this.quill.root.addEventListener('scroll', function () {\n        _this.root.style.marginTop = -1 * _this.quill.root.scrollTop + 'px';\n      });\n    }\n    this.hide();\n  }\n\n  _createClass(Tooltip, [{\n    key: 'hide',\n    value: function hide() {\n      this.root.classList.add('ql-hidden');\n    }\n  }, {\n    key: 'position',\n    value: function position(reference) {\n      var left = reference.left + reference.width / 2 - this.root.offsetWidth / 2;\n      // root.scrollTop should be 0 if scrollContainer !== root\n      var top = reference.bottom + this.quill.root.scrollTop;\n      this.root.style.left = left + 'px';\n      this.root.style.top = top + 'px';\n      this.root.classList.remove('ql-flip');\n      var containerBounds = this.boundsContainer.getBoundingClientRect();\n      var rootBounds = this.root.getBoundingClientRect();\n      var shift = 0;\n      if (rootBounds.right > containerBounds.right) {\n        shift = containerBounds.right - rootBounds.right;\n        this.root.style.left = left + shift + 'px';\n      }\n      if (rootBounds.left < containerBounds.left) {\n        shift = containerBounds.left - rootBounds.left;\n        this.root.style.left = left + shift + 'px';\n      }\n      if (rootBounds.bottom > containerBounds.bottom) {\n        var height = rootBounds.bottom - rootBounds.top;\n        var verticalShift = reference.bottom - reference.top + height;\n        this.root.style.top = top - verticalShift + 'px';\n        this.root.classList.add('ql-flip');\n      }\n      return shift;\n    }\n  }, {\n    key: 'show',\n    value: function show() {\n      this.root.classList.remove('ql-editing');\n      this.root.classList.remove('ql-hidden');\n    }\n  }]);\n\n  return Tooltip;\n}();\n\nexports.default = Tooltip;\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _extend = __webpack_require__(3);\n\nvar _extend2 = _interopRequireDefault(_extend);\n\nvar _emitter = __webpack_require__(8);\n\nvar _emitter2 = _interopRequireDefault(_emitter);\n\nvar _base = __webpack_require__(43);\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _link = __webpack_require__(27);\n\nvar _link2 = _interopRequireDefault(_link);\n\nvar _selection = __webpack_require__(15);\n\nvar _icons = __webpack_require__(41);\n\nvar _icons2 = _interopRequireDefault(_icons);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar TOOLBAR_CONFIG = [[{ header: ['1', '2', '3', false] }], ['bold', 'italic', 'underline', 'link'], [{ list: 'ordered' }, { list: 'bullet' }], ['clean']];\n\nvar SnowTheme = function (_BaseTheme) {\n  _inherits(SnowTheme, _BaseTheme);\n\n  function SnowTheme(quill, options) {\n    _classCallCheck(this, SnowTheme);\n\n    if (options.modules.toolbar != null && options.modules.toolbar.container == null) {\n      options.modules.toolbar.container = TOOLBAR_CONFIG;\n    }\n\n    var _this = _possibleConstructorReturn(this, (SnowTheme.__proto__ || Object.getPrototypeOf(SnowTheme)).call(this, quill, options));\n\n    _this.quill.container.classList.add('ql-snow');\n    return _this;\n  }\n\n  _createClass(SnowTheme, [{\n    key: 'extendToolbar',\n    value: function extendToolbar(toolbar) {\n      toolbar.container.classList.add('ql-snow');\n      this.buildButtons([].slice.call(toolbar.container.querySelectorAll('button')), _icons2.default);\n      this.buildPickers([].slice.call(toolbar.container.querySelectorAll('select')), _icons2.default);\n      this.tooltip = new SnowTooltip(this.quill, this.options.bounds);\n      if (toolbar.container.querySelector('.ql-link')) {\n        this.quill.keyboard.addBinding({ key: 'K', shortKey: true }, function (range, context) {\n          toolbar.handlers['link'].call(toolbar, !context.format.link);\n        });\n      }\n    }\n  }]);\n\n  return SnowTheme;\n}(_base2.default);\n\nSnowTheme.DEFAULTS = (0, _extend2.default)(true, {}, _base2.default.DEFAULTS, {\n  modules: {\n    toolbar: {\n      handlers: {\n        link: function link(value) {\n          if (value) {\n            var range = this.quill.getSelection();\n            if (range == null || range.length == 0) return;\n            var preview = this.quill.getText(range);\n            if (/^\\S+@\\S+\\.\\S+$/.test(preview) && preview.indexOf('mailto:') !== 0) {\n              preview = 'mailto:' + preview;\n            }\n            var tooltip = this.quill.theme.tooltip;\n            tooltip.edit('link', preview);\n          } else {\n            this.quill.format('link', false);\n          }\n        }\n      }\n    }\n  }\n});\n\nvar SnowTooltip = function (_BaseTooltip) {\n  _inherits(SnowTooltip, _BaseTooltip);\n\n  function SnowTooltip(quill, bounds) {\n    _classCallCheck(this, SnowTooltip);\n\n    var _this2 = _possibleConstructorReturn(this, (SnowTooltip.__proto__ || Object.getPrototypeOf(SnowTooltip)).call(this, quill, bounds));\n\n    _this2.preview = _this2.root.querySelector('a.ql-preview');\n    return _this2;\n  }\n\n  _createClass(SnowTooltip, [{\n    key: 'listen',\n    value: function listen() {\n      var _this3 = this;\n\n      _get(SnowTooltip.prototype.__proto__ || Object.getPrototypeOf(SnowTooltip.prototype), 'listen', this).call(this);\n      this.root.querySelector('a.ql-action').addEventListener('click', function (event) {\n        if (_this3.root.classList.contains('ql-editing')) {\n          _this3.save();\n        } else {\n          _this3.edit('link', _this3.preview.textContent);\n        }\n        event.preventDefault();\n      });\n      this.root.querySelector('a.ql-remove').addEventListener('click', function (event) {\n        if (_this3.linkRange != null) {\n          var range = _this3.linkRange;\n          _this3.restoreFocus();\n          _this3.quill.formatText(range, 'link', false, _emitter2.default.sources.USER);\n          delete _this3.linkRange;\n        }\n        event.preventDefault();\n        _this3.hide();\n      });\n      this.quill.on(_emitter2.default.events.SELECTION_CHANGE, function (range, oldRange, source) {\n        if (range == null) return;\n        if (range.length === 0 && source === _emitter2.default.sources.USER) {\n          var _quill$scroll$descend = _this3.quill.scroll.descendant(_link2.default, range.index),\n              _quill$scroll$descend2 = _slicedToArray(_quill$scroll$descend, 2),\n              link = _quill$scroll$descend2[0],\n              offset = _quill$scroll$descend2[1];\n\n          if (link != null) {\n            _this3.linkRange = new _selection.Range(range.index - offset, link.length());\n            var preview = _link2.default.formats(link.domNode);\n            _this3.preview.textContent = preview;\n            _this3.preview.setAttribute('href', preview);\n            _this3.show();\n            _this3.position(_this3.quill.getBounds(_this3.linkRange));\n            return;\n          }\n        } else {\n          delete _this3.linkRange;\n        }\n        _this3.hide();\n      });\n    }\n  }, {\n    key: 'show',\n    value: function show() {\n      _get(SnowTooltip.prototype.__proto__ || Object.getPrototypeOf(SnowTooltip.prototype), 'show', this).call(this);\n      this.root.removeAttribute('data-mode');\n    }\n  }]);\n\n  return SnowTooltip;\n}(_base.BaseTooltip);\n\nSnowTooltip.TEMPLATE = ['<a class=\"ql-preview\" rel=\"noopener noreferrer\" target=\"_blank\" href=\"about:blank\"></a>', '<input type=\"text\" data-formula=\"e=mc^2\" data-link=\"https://quilljs.com\" data-video=\"Embed URL\">', '<a class=\"ql-action\"></a>', '<a class=\"ql-remove\"></a>'].join('');\n\nexports.default = SnowTheme;\n\n/***/ }),\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _core = __webpack_require__(29);\n\nvar _core2 = _interopRequireDefault(_core);\n\nvar _align = __webpack_require__(36);\n\nvar _direction = __webpack_require__(38);\n\nvar _indent = __webpack_require__(64);\n\nvar _blockquote = __webpack_require__(65);\n\nvar _blockquote2 = _interopRequireDefault(_blockquote);\n\nvar _header = __webpack_require__(66);\n\nvar _header2 = _interopRequireDefault(_header);\n\nvar _list = __webpack_require__(67);\n\nvar _list2 = _interopRequireDefault(_list);\n\nvar _background = __webpack_require__(37);\n\nvar _color = __webpack_require__(26);\n\nvar _font = __webpack_require__(39);\n\nvar _size = __webpack_require__(40);\n\nvar _bold = __webpack_require__(56);\n\nvar _bold2 = _interopRequireDefault(_bold);\n\nvar _italic = __webpack_require__(68);\n\nvar _italic2 = _interopRequireDefault(_italic);\n\nvar _link = __webpack_require__(27);\n\nvar _link2 = _interopRequireDefault(_link);\n\nvar _script = __webpack_require__(69);\n\nvar _script2 = _interopRequireDefault(_script);\n\nvar _strike = __webpack_require__(70);\n\nvar _strike2 = _interopRequireDefault(_strike);\n\nvar _underline = __webpack_require__(71);\n\nvar _underline2 = _interopRequireDefault(_underline);\n\nvar _image = __webpack_require__(72);\n\nvar _image2 = _interopRequireDefault(_image);\n\nvar _video = __webpack_require__(73);\n\nvar _video2 = _interopRequireDefault(_video);\n\nvar _code = __webpack_require__(13);\n\nvar _code2 = _interopRequireDefault(_code);\n\nvar _formula = __webpack_require__(74);\n\nvar _formula2 = _interopRequireDefault(_formula);\n\nvar _syntax = __webpack_require__(75);\n\nvar _syntax2 = _interopRequireDefault(_syntax);\n\nvar _toolbar = __webpack_require__(57);\n\nvar _toolbar2 = _interopRequireDefault(_toolbar);\n\nvar _icons = __webpack_require__(41);\n\nvar _icons2 = _interopRequireDefault(_icons);\n\nvar _picker = __webpack_require__(28);\n\nvar _picker2 = _interopRequireDefault(_picker);\n\nvar _colorPicker = __webpack_require__(59);\n\nvar _colorPicker2 = _interopRequireDefault(_colorPicker);\n\nvar _iconPicker = __webpack_require__(60);\n\nvar _iconPicker2 = _interopRequireDefault(_iconPicker);\n\nvar _tooltip = __webpack_require__(61);\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nvar _bubble = __webpack_require__(108);\n\nvar _bubble2 = _interopRequireDefault(_bubble);\n\nvar _snow = __webpack_require__(62);\n\nvar _snow2 = _interopRequireDefault(_snow);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_core2.default.register({\n  'attributors/attribute/direction': _direction.DirectionAttribute,\n\n  'attributors/class/align': _align.AlignClass,\n  'attributors/class/background': _background.BackgroundClass,\n  'attributors/class/color': _color.ColorClass,\n  'attributors/class/direction': _direction.DirectionClass,\n  'attributors/class/font': _font.FontClass,\n  'attributors/class/size': _size.SizeClass,\n\n  'attributors/style/align': _align.AlignStyle,\n  'attributors/style/background': _background.BackgroundStyle,\n  'attributors/style/color': _color.ColorStyle,\n  'attributors/style/direction': _direction.DirectionStyle,\n  'attributors/style/font': _font.FontStyle,\n  'attributors/style/size': _size.SizeStyle\n}, true);\n\n_core2.default.register({\n  'formats/align': _align.AlignClass,\n  'formats/direction': _direction.DirectionClass,\n  'formats/indent': _indent.IndentClass,\n\n  'formats/background': _background.BackgroundStyle,\n  'formats/color': _color.ColorStyle,\n  'formats/font': _font.FontClass,\n  'formats/size': _size.SizeClass,\n\n  'formats/blockquote': _blockquote2.default,\n  'formats/code-block': _code2.default,\n  'formats/header': _header2.default,\n  'formats/list': _list2.default,\n\n  'formats/bold': _bold2.default,\n  'formats/code': _code.Code,\n  'formats/italic': _italic2.default,\n  'formats/link': _link2.default,\n  'formats/script': _script2.default,\n  'formats/strike': _strike2.default,\n  'formats/underline': _underline2.default,\n\n  'formats/image': _image2.default,\n  'formats/video': _video2.default,\n\n  'formats/list/item': _list.ListItem,\n\n  'modules/formula': _formula2.default,\n  'modules/syntax': _syntax2.default,\n  'modules/toolbar': _toolbar2.default,\n\n  'themes/bubble': _bubble2.default,\n  'themes/snow': _snow2.default,\n\n  'ui/icons': _icons2.default,\n  'ui/picker': _picker2.default,\n  'ui/icon-picker': _iconPicker2.default,\n  'ui/color-picker': _colorPicker2.default,\n  'ui/tooltip': _tooltip2.default\n}, true);\n\nexports.default = _core2.default;\n\n/***/ }),\n/* 64 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.IndentClass = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar IdentAttributor = function (_Parchment$Attributor) {\n  _inherits(IdentAttributor, _Parchment$Attributor);\n\n  function IdentAttributor() {\n    _classCallCheck(this, IdentAttributor);\n\n    return _possibleConstructorReturn(this, (IdentAttributor.__proto__ || Object.getPrototypeOf(IdentAttributor)).apply(this, arguments));\n  }\n\n  _createClass(IdentAttributor, [{\n    key: 'add',\n    value: function add(node, value) {\n      if (value === '+1' || value === '-1') {\n        var indent = this.value(node) || 0;\n        value = value === '+1' ? indent + 1 : indent - 1;\n      }\n      if (value === 0) {\n        this.remove(node);\n        return true;\n      } else {\n        return _get(IdentAttributor.prototype.__proto__ || Object.getPrototypeOf(IdentAttributor.prototype), 'add', this).call(this, node, value);\n      }\n    }\n  }, {\n    key: 'canAdd',\n    value: function canAdd(node, value) {\n      return _get(IdentAttributor.prototype.__proto__ || Object.getPrototypeOf(IdentAttributor.prototype), 'canAdd', this).call(this, node, value) || _get(IdentAttributor.prototype.__proto__ || Object.getPrototypeOf(IdentAttributor.prototype), 'canAdd', this).call(this, node, parseInt(value));\n    }\n  }, {\n    key: 'value',\n    value: function value(node) {\n      return parseInt(_get(IdentAttributor.prototype.__proto__ || Object.getPrototypeOf(IdentAttributor.prototype), 'value', this).call(this, node)) || undefined; // Don't return NaN\n    }\n  }]);\n\n  return IdentAttributor;\n}(_parchment2.default.Attributor.Class);\n\nvar IndentClass = new IdentAttributor('indent', 'ql-indent', {\n  scope: _parchment2.default.Scope.BLOCK,\n  whitelist: [1, 2, 3, 4, 5, 6, 7, 8]\n});\n\nexports.IndentClass = IndentClass;\n\n/***/ }),\n/* 65 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Blockquote = function (_Block) {\n  _inherits(Blockquote, _Block);\n\n  function Blockquote() {\n    _classCallCheck(this, Blockquote);\n\n    return _possibleConstructorReturn(this, (Blockquote.__proto__ || Object.getPrototypeOf(Blockquote)).apply(this, arguments));\n  }\n\n  return Blockquote;\n}(_block2.default);\n\nBlockquote.blotName = 'blockquote';\nBlockquote.tagName = 'blockquote';\n\nexports.default = Blockquote;\n\n/***/ }),\n/* 66 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Header = function (_Block) {\n  _inherits(Header, _Block);\n\n  function Header() {\n    _classCallCheck(this, Header);\n\n    return _possibleConstructorReturn(this, (Header.__proto__ || Object.getPrototypeOf(Header)).apply(this, arguments));\n  }\n\n  _createClass(Header, null, [{\n    key: 'formats',\n    value: function formats(domNode) {\n      return this.tagName.indexOf(domNode.tagName) + 1;\n    }\n  }]);\n\n  return Header;\n}(_block2.default);\n\nHeader.blotName = 'header';\nHeader.tagName = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6'];\n\nexports.default = Header;\n\n/***/ }),\n/* 67 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.ListItem = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _block = __webpack_require__(4);\n\nvar _block2 = _interopRequireDefault(_block);\n\nvar _container = __webpack_require__(25);\n\nvar _container2 = _interopRequireDefault(_container);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ListItem = function (_Block) {\n  _inherits(ListItem, _Block);\n\n  function ListItem() {\n    _classCallCheck(this, ListItem);\n\n    return _possibleConstructorReturn(this, (ListItem.__proto__ || Object.getPrototypeOf(ListItem)).apply(this, arguments));\n  }\n\n  _createClass(ListItem, [{\n    key: 'format',\n    value: function format(name, value) {\n      if (name === List.blotName && !value) {\n        this.replaceWith(_parchment2.default.create(this.statics.scope));\n      } else {\n        _get(ListItem.prototype.__proto__ || Object.getPrototypeOf(ListItem.prototype), 'format', this).call(this, name, value);\n      }\n    }\n  }, {\n    key: 'remove',\n    value: function remove() {\n      if (this.prev == null && this.next == null) {\n        this.parent.remove();\n      } else {\n        _get(ListItem.prototype.__proto__ || Object.getPrototypeOf(ListItem.prototype), 'remove', this).call(this);\n      }\n    }\n  }, {\n    key: 'replaceWith',\n    value: function replaceWith(name, value) {\n      this.parent.isolate(this.offset(this.parent), this.length());\n      if (name === this.parent.statics.blotName) {\n        this.parent.replaceWith(name, value);\n        return this;\n      } else {\n        this.parent.unwrap();\n        return _get(ListItem.prototype.__proto__ || Object.getPrototypeOf(ListItem.prototype), 'replaceWith', this).call(this, name, value);\n      }\n    }\n  }], [{\n    key: 'formats',\n    value: function formats(domNode) {\n      return domNode.tagName === this.tagName ? undefined : _get(ListItem.__proto__ || Object.getPrototypeOf(ListItem), 'formats', this).call(this, domNode);\n    }\n  }]);\n\n  return ListItem;\n}(_block2.default);\n\nListItem.blotName = 'list-item';\nListItem.tagName = 'LI';\n\nvar List = function (_Container) {\n  _inherits(List, _Container);\n\n  _createClass(List, null, [{\n    key: 'create',\n    value: function create(value) {\n      var tagName = value === 'ordered' ? 'OL' : 'UL';\n      var node = _get(List.__proto__ || Object.getPrototypeOf(List), 'create', this).call(this, tagName);\n      if (value === 'checked' || value === 'unchecked') {\n        node.setAttribute('data-checked', value === 'checked');\n      }\n      return node;\n    }\n  }, {\n    key: 'formats',\n    value: function formats(domNode) {\n      if (domNode.tagName === 'OL') return 'ordered';\n      if (domNode.tagName === 'UL') {\n        if (domNode.hasAttribute('data-checked')) {\n          return domNode.getAttribute('data-checked') === 'true' ? 'checked' : 'unchecked';\n        } else {\n          return 'bullet';\n        }\n      }\n      return undefined;\n    }\n  }]);\n\n  function List(domNode) {\n    _classCallCheck(this, List);\n\n    var _this2 = _possibleConstructorReturn(this, (List.__proto__ || Object.getPrototypeOf(List)).call(this, domNode));\n\n    var listEventHandler = function listEventHandler(e) {\n      if (e.target.parentNode !== domNode) return;\n      var format = _this2.statics.formats(domNode);\n      var blot = _parchment2.default.find(e.target);\n      if (format === 'checked') {\n        blot.format('list', 'unchecked');\n      } else if (format === 'unchecked') {\n        blot.format('list', 'checked');\n      }\n    };\n\n    domNode.addEventListener('touchstart', listEventHandler);\n    domNode.addEventListener('mousedown', listEventHandler);\n    return _this2;\n  }\n\n  _createClass(List, [{\n    key: 'format',\n    value: function format(name, value) {\n      if (this.children.length > 0) {\n        this.children.tail.format(name, value);\n      }\n    }\n  }, {\n    key: 'formats',\n    value: function formats() {\n      // We don't inherit from FormatBlot\n      return _defineProperty({}, this.statics.blotName, this.statics.formats(this.domNode));\n    }\n  }, {\n    key: 'insertBefore',\n    value: function insertBefore(blot, ref) {\n      if (blot instanceof ListItem) {\n        _get(List.prototype.__proto__ || Object.getPrototypeOf(List.prototype), 'insertBefore', this).call(this, blot, ref);\n      } else {\n        var index = ref == null ? this.length() : ref.offset(this);\n        var after = this.split(index);\n        after.parent.insertBefore(blot, after);\n      }\n    }\n  }, {\n    key: 'optimize',\n    value: function optimize(context) {\n      _get(List.prototype.__proto__ || Object.getPrototypeOf(List.prototype), 'optimize', this).call(this, context);\n      var next = this.next;\n      if (next != null && next.prev === this && next.statics.blotName === this.statics.blotName && next.domNode.tagName === this.domNode.tagName && next.domNode.getAttribute('data-checked') === this.domNode.getAttribute('data-checked')) {\n        next.moveChildren(this);\n        next.remove();\n      }\n    }\n  }, {\n    key: 'replace',\n    value: function replace(target) {\n      if (target.statics.blotName !== this.statics.blotName) {\n        var item = _parchment2.default.create(this.statics.defaultChild);\n        target.moveChildren(item);\n        this.appendChild(item);\n      }\n      _get(List.prototype.__proto__ || Object.getPrototypeOf(List.prototype), 'replace', this).call(this, target);\n    }\n  }]);\n\n  return List;\n}(_container2.default);\n\nList.blotName = 'list';\nList.scope = _parchment2.default.Scope.BLOCK_BLOT;\nList.tagName = ['OL', 'UL'];\nList.defaultChild = 'list-item';\nList.allowedChildren = [ListItem];\n\nexports.ListItem = ListItem;\nexports.default = List;\n\n/***/ }),\n/* 68 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _bold = __webpack_require__(56);\n\nvar _bold2 = _interopRequireDefault(_bold);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Italic = function (_Bold) {\n  _inherits(Italic, _Bold);\n\n  function Italic() {\n    _classCallCheck(this, Italic);\n\n    return _possibleConstructorReturn(this, (Italic.__proto__ || Object.getPrototypeOf(Italic)).apply(this, arguments));\n  }\n\n  return Italic;\n}(_bold2.default);\n\nItalic.blotName = 'italic';\nItalic.tagName = ['EM', 'I'];\n\nexports.default = Italic;\n\n/***/ }),\n/* 69 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Script = function (_Inline) {\n  _inherits(Script, _Inline);\n\n  function Script() {\n    _classCallCheck(this, Script);\n\n    return _possibleConstructorReturn(this, (Script.__proto__ || Object.getPrototypeOf(Script)).apply(this, arguments));\n  }\n\n  _createClass(Script, null, [{\n    key: 'create',\n    value: function create(value) {\n      if (value === 'super') {\n        return document.createElement('sup');\n      } else if (value === 'sub') {\n        return document.createElement('sub');\n      } else {\n        return _get(Script.__proto__ || Object.getPrototypeOf(Script), 'create', this).call(this, value);\n      }\n    }\n  }, {\n    key: 'formats',\n    value: function formats(domNode) {\n      if (domNode.tagName === 'SUB') return 'sub';\n      if (domNode.tagName === 'SUP') return 'super';\n      return undefined;\n    }\n  }]);\n\n  return Script;\n}(_inline2.default);\n\nScript.blotName = 'script';\nScript.tagName = ['SUB', 'SUP'];\n\nexports.default = Script;\n\n/***/ }),\n/* 70 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Strike = function (_Inline) {\n  _inherits(Strike, _Inline);\n\n  function Strike() {\n    _classCallCheck(this, Strike);\n\n    return _possibleConstructorReturn(this, (Strike.__proto__ || Object.getPrototypeOf(Strike)).apply(this, arguments));\n  }\n\n  return Strike;\n}(_inline2.default);\n\nStrike.blotName = 'strike';\nStrike.tagName = 'S';\n\nexports.default = Strike;\n\n/***/ }),\n/* 71 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _inline = __webpack_require__(6);\n\nvar _inline2 = _interopRequireDefault(_inline);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Underline = function (_Inline) {\n  _inherits(Underline, _Inline);\n\n  function Underline() {\n    _classCallCheck(this, Underline);\n\n    return _possibleConstructorReturn(this, (Underline.__proto__ || Object.getPrototypeOf(Underline)).apply(this, arguments));\n  }\n\n  return Underline;\n}(_inline2.default);\n\nUnderline.blotName = 'underline';\nUnderline.tagName = 'U';\n\nexports.default = Underline;\n\n/***/ }),\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _link = __webpack_require__(27);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ATTRIBUTES = ['alt', 'height', 'width'];\n\nvar Image = function (_Parchment$Embed) {\n  _inherits(Image, _Parchment$Embed);\n\n  function Image() {\n    _classCallCheck(this, Image);\n\n    return _possibleConstructorReturn(this, (Image.__proto__ || Object.getPrototypeOf(Image)).apply(this, arguments));\n  }\n\n  _createClass(Image, [{\n    key: 'format',\n    value: function format(name, value) {\n      if (ATTRIBUTES.indexOf(name) > -1) {\n        if (value) {\n          this.domNode.setAttribute(name, value);\n        } else {\n          this.domNode.removeAttribute(name);\n        }\n      } else {\n        _get(Image.prototype.__proto__ || Object.getPrototypeOf(Image.prototype), 'format', this).call(this, name, value);\n      }\n    }\n  }], [{\n    key: 'create',\n    value: function create(value) {\n      var node = _get(Image.__proto__ || Object.getPrototypeOf(Image), 'create', this).call(this, value);\n      if (typeof value === 'string') {\n        node.setAttribute('src', this.sanitize(value));\n      }\n      return node;\n    }\n  }, {\n    key: 'formats',\n    value: function formats(domNode) {\n      return ATTRIBUTES.reduce(function (formats, attribute) {\n        if (domNode.hasAttribute(attribute)) {\n          formats[attribute] = domNode.getAttribute(attribute);\n        }\n        return formats;\n      }, {});\n    }\n  }, {\n    key: 'match',\n    value: function match(url) {\n      return (/\\.(jpe?g|gif|png)$/.test(url) || /^data:image\\/.+;base64/.test(url)\n      );\n    }\n  }, {\n    key: 'sanitize',\n    value: function sanitize(url) {\n      return (0, _link.sanitize)(url, ['http', 'https', 'data']) ? url : '//:0';\n    }\n  }, {\n    key: 'value',\n    value: function value(domNode) {\n      return domNode.getAttribute('src');\n    }\n  }]);\n\n  return Image;\n}(_parchment2.default.Embed);\n\nImage.blotName = 'image';\nImage.tagName = 'IMG';\n\nexports.default = Image;\n\n/***/ }),\n/* 73 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _block = __webpack_require__(4);\n\nvar _link = __webpack_require__(27);\n\nvar _link2 = _interopRequireDefault(_link);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ATTRIBUTES = ['height', 'width'];\n\nvar Video = function (_BlockEmbed) {\n  _inherits(Video, _BlockEmbed);\n\n  function Video() {\n    _classCallCheck(this, Video);\n\n    return _possibleConstructorReturn(this, (Video.__proto__ || Object.getPrototypeOf(Video)).apply(this, arguments));\n  }\n\n  _createClass(Video, [{\n    key: 'format',\n    value: function format(name, value) {\n      if (ATTRIBUTES.indexOf(name) > -1) {\n        if (value) {\n          this.domNode.setAttribute(name, value);\n        } else {\n          this.domNode.removeAttribute(name);\n        }\n      } else {\n        _get(Video.prototype.__proto__ || Object.getPrototypeOf(Video.prototype), 'format', this).call(this, name, value);\n      }\n    }\n  }], [{\n    key: 'create',\n    value: function create(value) {\n      var node = _get(Video.__proto__ || Object.getPrototypeOf(Video), 'create', this).call(this, value);\n      node.setAttribute('frameborder', '0');\n      node.setAttribute('allowfullscreen', true);\n      node.setAttribute('src', this.sanitize(value));\n      return node;\n    }\n  }, {\n    key: 'formats',\n    value: function formats(domNode) {\n      return ATTRIBUTES.reduce(function (formats, attribute) {\n        if (domNode.hasAttribute(attribute)) {\n          formats[attribute] = domNode.getAttribute(attribute);\n        }\n        return formats;\n      }, {});\n    }\n  }, {\n    key: 'sanitize',\n    value: function sanitize(url) {\n      return _link2.default.sanitize(url);\n    }\n  }, {\n    key: 'value',\n    value: function value(domNode) {\n      return domNode.getAttribute('src');\n    }\n  }]);\n\n  return Video;\n}(_block.BlockEmbed);\n\nVideo.blotName = 'video';\nVideo.className = 'ql-video';\nVideo.tagName = 'IFRAME';\n\nexports.default = Video;\n\n/***/ }),\n/* 74 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.FormulaBlot = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _embed = __webpack_require__(35);\n\nvar _embed2 = _interopRequireDefault(_embed);\n\nvar _quill = __webpack_require__(5);\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _module = __webpack_require__(9);\n\nvar _module2 = _interopRequireDefault(_module);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar FormulaBlot = function (_Embed) {\n  _inherits(FormulaBlot, _Embed);\n\n  function FormulaBlot() {\n    _classCallCheck(this, FormulaBlot);\n\n    return _possibleConstructorReturn(this, (FormulaBlot.__proto__ || Object.getPrototypeOf(FormulaBlot)).apply(this, arguments));\n  }\n\n  _createClass(FormulaBlot, null, [{\n    key: 'create',\n    value: function create(value) {\n      var node = _get(FormulaBlot.__proto__ || Object.getPrototypeOf(FormulaBlot), 'create', this).call(this, value);\n      if (typeof value === 'string') {\n        window.katex.render(value, node, {\n          throwOnError: false,\n          errorColor: '#f00'\n        });\n        node.setAttribute('data-value', value);\n      }\n      return node;\n    }\n  }, {\n    key: 'value',\n    value: function value(domNode) {\n      return domNode.getAttribute('data-value');\n    }\n  }]);\n\n  return FormulaBlot;\n}(_embed2.default);\n\nFormulaBlot.blotName = 'formula';\nFormulaBlot.className = 'ql-formula';\nFormulaBlot.tagName = 'SPAN';\n\nvar Formula = function (_Module) {\n  _inherits(Formula, _Module);\n\n  _createClass(Formula, null, [{\n    key: 'register',\n    value: function register() {\n      _quill2.default.register(FormulaBlot, true);\n    }\n  }]);\n\n  function Formula() {\n    _classCallCheck(this, Formula);\n\n    var _this2 = _possibleConstructorReturn(this, (Formula.__proto__ || Object.getPrototypeOf(Formula)).call(this));\n\n    if (window.katex == null) {\n      throw new Error('Formula module requires KaTeX.');\n    }\n    return _this2;\n  }\n\n  return Formula;\n}(_module2.default);\n\nexports.FormulaBlot = FormulaBlot;\nexports.default = Formula;\n\n/***/ }),\n/* 75 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.CodeToken = exports.CodeBlock = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _parchment = __webpack_require__(0);\n\nvar _parchment2 = _interopRequireDefault(_parchment);\n\nvar _quill = __webpack_require__(5);\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _module = __webpack_require__(9);\n\nvar _module2 = _interopRequireDefault(_module);\n\nvar _code = __webpack_require__(13);\n\nvar _code2 = _interopRequireDefault(_code);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar SyntaxCodeBlock = function (_CodeBlock) {\n  _inherits(SyntaxCodeBlock, _CodeBlock);\n\n  function SyntaxCodeBlock() {\n    _classCallCheck(this, SyntaxCodeBlock);\n\n    return _possibleConstructorReturn(this, (SyntaxCodeBlock.__proto__ || Object.getPrototypeOf(SyntaxCodeBlock)).apply(this, arguments));\n  }\n\n  _createClass(SyntaxCodeBlock, [{\n    key: 'replaceWith',\n    value: function replaceWith(block) {\n      this.domNode.textContent = this.domNode.textContent;\n      this.attach();\n      _get(SyntaxCodeBlock.prototype.__proto__ || Object.getPrototypeOf(SyntaxCodeBlock.prototype), 'replaceWith', this).call(this, block);\n    }\n  }, {\n    key: 'highlight',\n    value: function highlight(_highlight) {\n      var text = this.domNode.textContent;\n      if (this.cachedText !== text) {\n        if (text.trim().length > 0 || this.cachedText == null) {\n          this.domNode.innerHTML = _highlight(text);\n          this.domNode.normalize();\n          this.attach();\n        }\n        this.cachedText = text;\n      }\n    }\n  }]);\n\n  return SyntaxCodeBlock;\n}(_code2.default);\n\nSyntaxCodeBlock.className = 'ql-syntax';\n\nvar CodeToken = new _parchment2.default.Attributor.Class('token', 'hljs', {\n  scope: _parchment2.default.Scope.INLINE\n});\n\nvar Syntax = function (_Module) {\n  _inherits(Syntax, _Module);\n\n  _createClass(Syntax, null, [{\n    key: 'register',\n    value: function register() {\n      _quill2.default.register(CodeToken, true);\n      _quill2.default.register(SyntaxCodeBlock, true);\n    }\n  }]);\n\n  function Syntax(quill, options) {\n    _classCallCheck(this, Syntax);\n\n    var _this2 = _possibleConstructorReturn(this, (Syntax.__proto__ || Object.getPrototypeOf(Syntax)).call(this, quill, options));\n\n    if (typeof _this2.options.highlight !== 'function') {\n      throw new Error('Syntax module requires highlight.js. Please include the library on the page before Quill.');\n    }\n    var timer = null;\n    _this2.quill.on(_quill2.default.events.SCROLL_OPTIMIZE, function () {\n      clearTimeout(timer);\n      timer = setTimeout(function () {\n        _this2.highlight();\n        timer = null;\n      }, _this2.options.interval);\n    });\n    _this2.highlight();\n    return _this2;\n  }\n\n  _createClass(Syntax, [{\n    key: 'highlight',\n    value: function highlight() {\n      var _this3 = this;\n\n      if (this.quill.selection.composing) return;\n      this.quill.update(_quill2.default.sources.USER);\n      var range = this.quill.getSelection();\n      this.quill.scroll.descendants(SyntaxCodeBlock).forEach(function (code) {\n        code.highlight(_this3.options.highlight);\n      });\n      this.quill.update(_quill2.default.sources.SILENT);\n      if (range != null) {\n        this.quill.setSelection(range, _quill2.default.sources.SILENT);\n      }\n    }\n  }]);\n\n  return Syntax;\n}(_module2.default);\n\nSyntax.DEFAULTS = {\n  highlight: function () {\n    if (window.hljs == null) return null;\n    return function (text) {\n      var result = window.hljs.highlightAuto(text);\n      return result.value;\n    };\n  }(),\n  interval: 1000\n};\n\nexports.CodeBlock = SyntaxCodeBlock;\nexports.CodeToken = CodeToken;\nexports.default = Syntax;\n\n/***/ }),\n/* 76 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>\";\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>\";\n\n/***/ }),\n/* 78 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>\";\n\n/***/ }),\n/* 79 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>\";\n\n/***/ }),\n/* 80 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <g class=\\\"ql-fill ql-color-label\\\"> <polygon points=\\\"6 6.868 6 6 5 6 5 7 5.942 7 6 6.868\\\"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points=\\\"6.817 5 6 5 6 6 6.38 6 6.817 5\\\"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points=\\\"4 11.439 4 11 3 11 3 12 3.755 12 4 11.439\\\"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points=\\\"4.63 10 4 10 4 11 4.192 11 4.63 10\\\"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points=\\\"13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174\\\"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points=\\\"12 6.868 12 6 11.62 6 12 6.868\\\"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points=\\\"12.933 9 13 9 13 8 12.495 8 12.933 9\\\"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points=\\\"5.5 13 9 5 12.5 13\\\"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>\";\n\n/***/ }),\n/* 81 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <rect class=\\\"ql-fill ql-stroke\\\" height=3 width=3 x=4 y=5></rect> <rect class=\\\"ql-fill ql-stroke\\\" height=3 width=3 x=11 y=5></rect> <path class=\\\"ql-even ql-fill ql-stroke\\\" d=M7,8c0,4.031-3,5-3,5></path> <path class=\\\"ql-even ql-fill ql-stroke\\\" d=M14,8c0,4.031-3,5-3,5></path> </svg>\";\n\n/***/ }),\n/* 82 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>\";\n\n/***/ }),\n/* 83 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg class=\\\"\\\" viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>\";\n\n/***/ }),\n/* 84 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=\\\"ql-color-label ql-stroke ql-transparent\\\" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points=\\\"5.5 11 9 3 12.5 11\\\"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>\";\n\n/***/ }),\n/* 85 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <polygon class=\\\"ql-stroke ql-fill\\\" points=\\\"3 11 5 9 3 7 3 11\\\"></polygon> <line class=\\\"ql-stroke ql-fill\\\" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>\";\n\n/***/ }),\n/* 86 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <polygon class=\\\"ql-stroke ql-fill\\\" points=\\\"15 12 13 10 15 8 15 12\\\"></polygon> <line class=\\\"ql-stroke ql-fill\\\" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>\";\n\n/***/ }),\n/* 87 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>\";\n\n/***/ }),\n/* 88 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>\";\n\n/***/ }),\n/* 89 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>\";\n\n/***/ }),\n/* 90 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform=\\\"translate(24 18) rotate(-180)\\\"/> </svg>\";\n\n/***/ }),\n/* 91 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>\";\n\n/***/ }),\n/* 92 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewBox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>\";\n\n/***/ }),\n/* 93 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewBox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>\";\n\n/***/ }),\n/* 94 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>\";\n\n/***/ }),\n/* 95 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class=\\\"ql-even ql-fill\\\" points=\\\"5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12\\\"></polyline> </svg>\";\n\n/***/ }),\n/* 96 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=\\\"ql-fill ql-stroke\\\" points=\\\"3 7 3 11 5 9 3 7\\\"></polyline> </svg>\";\n\n/***/ }),\n/* 97 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points=\\\"5 7 5 11 3 9 5 7\\\"></polyline> </svg>\";\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class=\\\"ql-even ql-stroke\\\" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class=\\\"ql-even ql-stroke\\\" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>\";\n\n/***/ }),\n/* 99 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class=\\\"ql-stroke ql-thin\\\" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class=\\\"ql-stroke ql-thin\\\" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class=\\\"ql-stroke ql-thin\\\" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>\";\n\n/***/ }),\n/* 100 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>\";\n\n/***/ }),\n/* 101 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg class=\\\"\\\" viewbox=\\\"0 0 18 18\\\"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points=\\\"3 4 4 5 6 3\\\"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points=\\\"3 14 4 15 6 13\\\"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points=\\\"3 9 4 10 6 8\\\"></polyline> </svg>\";\n\n/***/ }),\n/* 102 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>\";\n\n/***/ }),\n/* 103 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>\";\n\n/***/ }),\n/* 104 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <line class=\\\"ql-stroke ql-thin\\\" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>\";\n\n/***/ }),\n/* 105 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>\";\n\n/***/ }),\n/* 106 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>\";\n\n/***/ }),\n/* 107 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<svg viewbox=\\\"0 0 18 18\\\"> <polygon class=ql-stroke points=\\\"7 11 9 13 11 11 7 11\\\"></polygon> <polygon class=ql-stroke points=\\\"7 7 9 5 11 7 7 7\\\"></polygon> </svg>\";\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.BubbleTooltip = undefined;\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _extend = __webpack_require__(3);\n\nvar _extend2 = _interopRequireDefault(_extend);\n\nvar _emitter = __webpack_require__(8);\n\nvar _emitter2 = _interopRequireDefault(_emitter);\n\nvar _base = __webpack_require__(43);\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _selection = __webpack_require__(15);\n\nvar _icons = __webpack_require__(41);\n\nvar _icons2 = _interopRequireDefault(_icons);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar TOOLBAR_CONFIG = [['bold', 'italic', 'link'], [{ header: 1 }, { header: 2 }, 'blockquote']];\n\nvar BubbleTheme = function (_BaseTheme) {\n  _inherits(BubbleTheme, _BaseTheme);\n\n  function BubbleTheme(quill, options) {\n    _classCallCheck(this, BubbleTheme);\n\n    if (options.modules.toolbar != null && options.modules.toolbar.container == null) {\n      options.modules.toolbar.container = TOOLBAR_CONFIG;\n    }\n\n    var _this = _possibleConstructorReturn(this, (BubbleTheme.__proto__ || Object.getPrototypeOf(BubbleTheme)).call(this, quill, options));\n\n    _this.quill.container.classList.add('ql-bubble');\n    return _this;\n  }\n\n  _createClass(BubbleTheme, [{\n    key: 'extendToolbar',\n    value: function extendToolbar(toolbar) {\n      this.tooltip = new BubbleTooltip(this.quill, this.options.bounds);\n      this.tooltip.root.appendChild(toolbar.container);\n      this.buildButtons([].slice.call(toolbar.container.querySelectorAll('button')), _icons2.default);\n      this.buildPickers([].slice.call(toolbar.container.querySelectorAll('select')), _icons2.default);\n    }\n  }]);\n\n  return BubbleTheme;\n}(_base2.default);\n\nBubbleTheme.DEFAULTS = (0, _extend2.default)(true, {}, _base2.default.DEFAULTS, {\n  modules: {\n    toolbar: {\n      handlers: {\n        link: function link(value) {\n          if (!value) {\n            this.quill.format('link', false);\n          } else {\n            this.quill.theme.tooltip.edit();\n          }\n        }\n      }\n    }\n  }\n});\n\nvar BubbleTooltip = function (_BaseTooltip) {\n  _inherits(BubbleTooltip, _BaseTooltip);\n\n  function BubbleTooltip(quill, bounds) {\n    _classCallCheck(this, BubbleTooltip);\n\n    var _this2 = _possibleConstructorReturn(this, (BubbleTooltip.__proto__ || Object.getPrototypeOf(BubbleTooltip)).call(this, quill, bounds));\n\n    _this2.quill.on(_emitter2.default.events.EDITOR_CHANGE, function (type, range, oldRange, source) {\n      if (type !== _emitter2.default.events.SELECTION_CHANGE) return;\n      if (range != null && range.length > 0 && source === _emitter2.default.sources.USER) {\n        _this2.show();\n        // Lock our width so we will expand beyond our offsetParent boundaries\n        _this2.root.style.left = '0px';\n        _this2.root.style.width = '';\n        _this2.root.style.width = _this2.root.offsetWidth + 'px';\n        var lines = _this2.quill.getLines(range.index, range.length);\n        if (lines.length === 1) {\n          _this2.position(_this2.quill.getBounds(range));\n        } else {\n          var lastLine = lines[lines.length - 1];\n          var index = _this2.quill.getIndex(lastLine);\n          var length = Math.min(lastLine.length() - 1, range.index + range.length - index);\n          var _bounds = _this2.quill.getBounds(new _selection.Range(index, length));\n          _this2.position(_bounds);\n        }\n      } else if (document.activeElement !== _this2.textbox && _this2.quill.hasFocus()) {\n        _this2.hide();\n      }\n    });\n    return _this2;\n  }\n\n  _createClass(BubbleTooltip, [{\n    key: 'listen',\n    value: function listen() {\n      var _this3 = this;\n\n      _get(BubbleTooltip.prototype.__proto__ || Object.getPrototypeOf(BubbleTooltip.prototype), 'listen', this).call(this);\n      this.root.querySelector('.ql-close').addEventListener('click', function () {\n        _this3.root.classList.remove('ql-editing');\n      });\n      this.quill.on(_emitter2.default.events.SCROLL_OPTIMIZE, function () {\n        // Let selection be restored by toolbar handlers before repositioning\n        setTimeout(function () {\n          if (_this3.root.classList.contains('ql-hidden')) return;\n          var range = _this3.quill.getSelection();\n          if (range != null) {\n            _this3.position(_this3.quill.getBounds(range));\n          }\n        }, 1);\n      });\n    }\n  }, {\n    key: 'cancel',\n    value: function cancel() {\n      this.show();\n    }\n  }, {\n    key: 'position',\n    value: function position(reference) {\n      var shift = _get(BubbleTooltip.prototype.__proto__ || Object.getPrototypeOf(BubbleTooltip.prototype), 'position', this).call(this, reference);\n      var arrow = this.root.querySelector('.ql-tooltip-arrow');\n      arrow.style.marginLeft = '';\n      if (shift === 0) return shift;\n      arrow.style.marginLeft = -1 * shift - arrow.offsetWidth / 2 + 'px';\n    }\n  }]);\n\n  return BubbleTooltip;\n}(_base.BaseTooltip);\n\nBubbleTooltip.TEMPLATE = ['<span class=\"ql-tooltip-arrow\"></span>', '<div class=\"ql-tooltip-editor\">', '<input type=\"text\" data-formula=\"e=mc^2\" data-link=\"https://quilljs.com\" data-video=\"Embed URL\">', '<a class=\"ql-close\"></a>', '</div>'].join('');\n\nexports.BubbleTooltip = BubbleTooltip;\nexports.default = BubbleTheme;\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(63);\n\n\n/***/ })\n/******/ ])[\"default\"];\n});","/*\n* MIT Licensed\n* http://www.23developer.com/opensource\n* http://github.com/23/resumable.js\n* Steffen Tiedemann Christensen, steffen@23company.com\n*/\n\n(function(){\n\"use strict\";\n\n  var Resumable = function(opts){\n    if ( !(this instanceof Resumable) ) {\n      return new Resumable(opts);\n    }\n    this.version = 1.0;\n    // SUPPORTED BY BROWSER?\n    // Check if these features are support by the browser:\n    // - File object type\n    // - Blob object type\n    // - FileList object type\n    // - slicing files\n    this.support = (\n                   (typeof(File)!=='undefined')\n                   &&\n                   (typeof(Blob)!=='undefined')\n                   &&\n                   (typeof(FileList)!=='undefined')\n                   &&\n                   (!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||false)\n                   );\n    if(!this.support) return(false);\n\n\n    // PROPERTIES\n    var $ = this;\n    $.files = [];\n    $.defaults = {\n      chunkSize:1*1024*1024,\n      forceChunkSize:false,\n      simultaneousUploads:3,\n      fileParameterName:'file',\n      chunkNumberParameterName: 'resumableChunkNumber',\n      chunkSizeParameterName: 'resumableChunkSize',\n      currentChunkSizeParameterName: 'resumableCurrentChunkSize',\n      totalSizeParameterName: 'resumableTotalSize',\n      typeParameterName: 'resumableType',\n      identifierParameterName: 'resumableIdentifier',\n      fileNameParameterName: 'resumableFilename',\n      relativePathParameterName: 'resumableRelativePath',\n      totalChunksParameterName: 'resumableTotalChunks',\n      throttleProgressCallbacks: 0.5,\n      query:{},\n      headers:{},\n      preprocess:null,\n      method:'multipart',\n      uploadMethod: 'POST',\n      testMethod: 'GET',\n      prioritizeFirstAndLastChunk:false,\n      target:'/',\n      testTarget: null,\n      parameterNamespace:'',\n      testChunks:true,\n      generateUniqueIdentifier:null,\n      getTarget:null,\n      maxChunkRetries:100,\n      chunkRetryInterval:undefined,\n      permanentErrors:[400, 404, 415, 500, 501],\n      maxFiles:undefined,\n      withCredentials:false,\n      xhrTimeout:0,\n      clearInput:true,\n      chunkFormat:'blob',\n      setChunkTypeFromFile:false,\n      maxFilesErrorCallback:function (files, errorCount) {\n        var maxFiles = $.getOpt('maxFiles');\n        alert('Please upload no more than ' + maxFiles + ' file' + (maxFiles === 1 ? '' : 's') + ' at a time.');\n      },\n      minFileSize:1,\n      minFileSizeErrorCallback:function(file, errorCount) {\n        alert(file.fileName||file.name +' is too small, please upload files larger than ' + $h.formatSize($.getOpt('minFileSize')) + '.');\n      },\n      maxFileSize:undefined,\n      maxFileSizeErrorCallback:function(file, errorCount) {\n        alert(file.fileName||file.name +' is too large, please upload files less than ' + $h.formatSize($.getOpt('maxFileSize')) + '.');\n      },\n      fileType: [],\n      fileTypeErrorCallback: function(file, errorCount) {\n        alert(file.fileName||file.name +' has type not allowed, please upload files of type ' + $.getOpt('fileType') + '.');\n      }\n    };\n    $.opts = opts||{};\n    $.getOpt = function(o) {\n      var $opt = this;\n      // Get multiple option if passed an array\n      if(o instanceof Array) {\n        var options = {};\n        $h.each(o, function(option){\n          options[option] = $opt.getOpt(option);\n        });\n        return options;\n      }\n      // Otherwise, just return a simple option\n      if ($opt instanceof ResumableChunk) {\n        if (typeof $opt.opts[o] !== 'undefined') { return $opt.opts[o]; }\n        else { $opt = $opt.fileObj; }\n      }\n      if ($opt instanceof ResumableFile) {\n        if (typeof $opt.opts[o] !== 'undefined') { return $opt.opts[o]; }\n        else { $opt = $opt.resumableObj; }\n      }\n      if ($opt instanceof Resumable) {\n        if (typeof $opt.opts[o] !== 'undefined') { return $opt.opts[o]; }\n        else { return $opt.defaults[o]; }\n      }\n    };\n\n    // EVENTS\n    // catchAll(event, ...)\n    // fileSuccess(file), fileProgress(file), fileAdded(file, event), filesAdded(files, filesSkipped), fileRetry(file),\n    // fileError(file, message), complete(), progress(), error(message, file), pause()\n    $.events = [];\n    $.on = function(event,callback){\n      $.events.push(event.toLowerCase(), callback);\n    };\n    $.fire = function(){\n      // `arguments` is an object, not array, in FF, so:\n      var args = [];\n      for (var i=0; i<arguments.length; i++) args.push(arguments[i]);\n      // Find event listeners, and support pseudo-event `catchAll`\n      var event = args[0].toLowerCase();\n      for (var i=0; i<=$.events.length; i+=2) {\n        if($.events[i]==event) $.events[i+1].apply($,args.slice(1));\n        if($.events[i]=='catchall') $.events[i+1].apply(null,args);\n      }\n      if(event=='fileerror') $.fire('error', args[2], args[1]);\n      if(event=='fileprogress') $.fire('progress');\n    };\n\n\n    // INTERNAL HELPER METHODS (handy, but ultimately not part of uploading)\n    var $h = {\n      stopEvent: function(e){\n        e.stopPropagation();\n        e.preventDefault();\n      },\n      each: function(o,callback){\n        if(typeof(o.length)!=='undefined') {\n          for (var i=0; i<o.length; i++) {\n            // Array or FileList\n            if(callback(o[i])===false) return;\n          }\n        } else {\n          for (i in o) {\n            // Object\n            if(callback(i,o[i])===false) return;\n          }\n        }\n      },\n      generateUniqueIdentifier:function(file, event){\n        var custom = $.getOpt('generateUniqueIdentifier');\n        if(typeof custom === 'function') {\n          return custom(file, event);\n        }\n        var relativePath = file.webkitRelativePath||file.fileName||file.name; // Some confusion in different versions of Firefox\n        var size = file.size;\n        return(size + '-' + relativePath.replace(/[^0-9a-zA-Z_-]/img, ''));\n      },\n      contains:function(array,test) {\n        var result = false;\n\n        $h.each(array, function(value) {\n          if (value == test) {\n            result = true;\n            return false;\n          }\n          return true;\n        });\n\n        return result;\n      },\n      formatSize:function(size){\n        if(size<1024) {\n          return size + ' bytes';\n        } else if(size<1024*1024) {\n          return (size/1024.0).toFixed(0) + ' KB';\n        } else if(size<1024*1024*1024) {\n          return (size/1024.0/1024.0).toFixed(1) + ' MB';\n        } else {\n          return (size/1024.0/1024.0/1024.0).toFixed(1) + ' GB';\n        }\n      },\n      getTarget:function(request, params){\n        var target = $.getOpt('target');\n\n        if (request === 'test' && $.getOpt('testTarget')) {\n          target = $.getOpt('testTarget') === '/' ? $.getOpt('target') : $.getOpt('testTarget');\n        }\n\n        if (typeof target === 'function') {\n          return target(params);\n        }\n\n        var separator = target.indexOf('?') < 0 ? '?' : '&';\n        var joinedParams = params.join('&');\n\n        return target + separator + joinedParams;\n      }\n    };\n\n    var onDrop = function(event){\n      $h.stopEvent(event);\n\n      //handle dropped things as items if we can (this lets us deal with folders nicer in some cases)\n      if (event.dataTransfer && event.dataTransfer.items) {\n        loadFiles(event.dataTransfer.items, event);\n      }\n      //else handle them as files\n      else if (event.dataTransfer && event.dataTransfer.files) {\n        loadFiles(event.dataTransfer.files, event);\n      }\n    };\n    var preventDefault = function(e) {\n      e.preventDefault();\n    };\n\n    /**\n     * processes a single upload item (file or directory)\n     * @param {Object} item item to upload, may be file or directory entry\n     * @param {string} path current file path\n     * @param {File[]} items list of files to append new items to\n     * @param {Function} cb callback invoked when item is processed\n     */\n    function processItem(item, path, items, cb) {\n      var entry;\n      if(item.isFile){\n        // file provided\n        return item.file(function(file){\n          file.relativePath = path + file.name;\n          items.push(file);\n          cb();\n        });\n      }else if(item.isDirectory){\n        // item is already a directory entry, just assign\n        entry = item;\n      }else if(item instanceof File) {\n        items.push(item);\n      }\n      if('function' === typeof item.webkitGetAsEntry){\n        // get entry from file object\n        entry = item.webkitGetAsEntry();\n      }\n      if(entry && entry.isDirectory){\n        // directory provided, process it\n        return processDirectory(entry, path + entry.name + '/', items, cb);\n      }\n      if('function' === typeof item.getAsFile){\n        // item represents a File object, convert it\n        item = item.getAsFile();\n        if(item instanceof File) {\n          item.relativePath = path + item.name;\n          items.push(item);\n        }\n      }\n      cb(); // indicate processing is done\n    }\n\n\n    /**\n     * cps-style list iteration.\n     * invokes all functions in list and waits for their callback to be\n     * triggered.\n     * @param  {Function[]}   items list of functions expecting callback parameter\n     * @param  {Function} cb    callback to trigger after the last callback has been invoked\n     */\n    function processCallbacks(items, cb){\n      if(!items || items.length === 0){\n        // empty or no list, invoke callback\n        return cb();\n      }\n      // invoke current function, pass the next part as continuation\n      items[0](function(){\n        processCallbacks(items.slice(1), cb);\n      });\n    }\n\n    /**\n     * recursively traverse directory and collect files to upload\n     * @param  {Object}   directory directory to process\n     * @param  {string}   path      current path\n     * @param  {File[]}   items     target list of items\n     * @param  {Function} cb        callback invoked after traversing directory\n     */\n    function processDirectory (directory, path, items, cb) {\n      var dirReader = directory.createReader();\n      dirReader.readEntries(function(entries){\n        if(!entries.length){\n          // empty directory, skip\n          return cb();\n        }\n        // process all conversion callbacks, finally invoke own one\n        processCallbacks(\n          entries.map(function(entry){\n            // bind all properties except for callback\n            return processItem.bind(null, entry, path, items);\n          }),\n          cb\n        );\n      });\n    }\n\n    /**\n     * process items to extract files to be uploaded\n     * @param  {File[]} items items to process\n     * @param  {Event} event event that led to upload\n     */\n    function loadFiles(items, event) {\n      if(!items.length){\n        return; // nothing to do\n      }\n      $.fire('beforeAdd');\n      var files = [];\n      processCallbacks(\n          Array.prototype.map.call(items, function(item){\n            // bind all properties except for callback\n            return processItem.bind(null, item, \"\", files);\n          }),\n          function(){\n            if(files.length){\n              // at least one file found\n              appendFilesFromFileList(files, event);\n            }\n          }\n      );\n    };\n\n    var appendFilesFromFileList = function(fileList, event){\n      // check for uploading too many files\n      var errorCount = 0;\n      var o = $.getOpt(['maxFiles', 'minFileSize', 'maxFileSize', 'maxFilesErrorCallback', 'minFileSizeErrorCallback', 'maxFileSizeErrorCallback', 'fileType', 'fileTypeErrorCallback']);\n      if (typeof(o.maxFiles)!=='undefined' && o.maxFiles<(fileList.length+$.files.length)) {\n        // if single-file upload, file is already added, and trying to add 1 new file, simply replace the already-added file\n        if (o.maxFiles===1 && $.files.length===1 && fileList.length===1) {\n          $.removeFile($.files[0]);\n        } else {\n          o.maxFilesErrorCallback(fileList, errorCount++);\n          return false;\n        }\n      }\n      var files = [], filesSkipped = [], remaining = fileList.length;\n      var decreaseReamining = function(){\n        if(!--remaining){\n          // all files processed, trigger event\n          if(!files.length && !filesSkipped.length){\n            // no succeeded files, just skip\n            return;\n          }\n          window.setTimeout(function(){\n            $.fire('filesAdded', files, filesSkipped);\n          },0);\n        }\n      };\n      $h.each(fileList, function(file){\n        var fileName = file.name;\n        if(o.fileType.length > 0){\n          var fileTypeFound = false;\n          for(var index in o.fileType){\n            var extension = '.' + o.fileType[index];\n\t\t\tif(fileName.toLowerCase().indexOf(extension.toLowerCase(), fileName.length - extension.length) !== -1){\n              fileTypeFound = true;\n              break;\n            }\n          }\n          if (!fileTypeFound) {\n            o.fileTypeErrorCallback(file, errorCount++);\n            return false;\n          }\n        }\n\n        if (typeof(o.minFileSize)!=='undefined' && file.size<o.minFileSize) {\n          o.minFileSizeErrorCallback(file, errorCount++);\n          return false;\n        }\n        if (typeof(o.maxFileSize)!=='undefined' && file.size>o.maxFileSize) {\n          o.maxFileSizeErrorCallback(file, errorCount++);\n          return false;\n        }\n\n        function addFile(uniqueIdentifier){\n          if (!$.getFromUniqueIdentifier(uniqueIdentifier)) {(function(){\n            file.uniqueIdentifier = uniqueIdentifier;\n            var f = new ResumableFile($, file, uniqueIdentifier);\n            $.files.push(f);\n            files.push(f);\n            f.container = (typeof event != 'undefined' ? event.srcElement : null);\n            window.setTimeout(function(){\n              $.fire('fileAdded', f, event)\n            },0);\n          })()} else {\n            filesSkipped.push(file);\n          };\n          decreaseReamining();\n        }\n        // directories have size == 0\n        var uniqueIdentifier = $h.generateUniqueIdentifier(file, event);\n        if(uniqueIdentifier && typeof uniqueIdentifier.then === 'function'){\n          // Promise or Promise-like object provided as unique identifier\n          uniqueIdentifier\n          .then(\n            function(uniqueIdentifier){\n              // unique identifier generation succeeded\n              addFile(uniqueIdentifier);\n            },\n           function(){\n              // unique identifier generation failed\n              // skip further processing, only decrease file count\n              decreaseReamining();\n            }\n          );\n        }else{\n          // non-Promise provided as unique identifier, process synchronously\n          addFile(uniqueIdentifier);\n        }\n      });\n    };\n\n    // INTERNAL OBJECT TYPES\n    function ResumableFile(resumableObj, file, uniqueIdentifier){\n      var $ = this;\n      $.opts = {};\n      $.getOpt = resumableObj.getOpt;\n      $._prevProgress = 0;\n      $.resumableObj = resumableObj;\n      $.file = file;\n      $.fileName = file.fileName||file.name; // Some confusion in different versions of Firefox\n      $.size = file.size;\n      $.relativePath = file.relativePath || file.webkitRelativePath || $.fileName;\n      $.uniqueIdentifier = uniqueIdentifier;\n      $._pause = false;\n      $.container = '';\n      var _error = uniqueIdentifier !== undefined;\n\n      // Callback when something happens within the chunk\n      var chunkEvent = function(event, message){\n        // event can be 'progress', 'success', 'error' or 'retry'\n        switch(event){\n        case 'progress':\n          $.resumableObj.fire('fileProgress', $, message);\n          break;\n        case 'error':\n          $.abort();\n          _error = true;\n          $.chunks = [];\n          $.resumableObj.fire('fileError', $, message);\n          break;\n        case 'success':\n          if(_error) return;\n          $.resumableObj.fire('fileProgress', $); // it's at least progress\n          if($.isComplete()) {\n            $.resumableObj.fire('fileSuccess', $, message);\n          }\n          break;\n        case 'retry':\n          $.resumableObj.fire('fileRetry', $);\n          break;\n        }\n      };\n\n      // Main code to set up a file object with chunks,\n      // packaged to be able to handle retries if needed.\n      $.chunks = [];\n      $.abort = function(){\n        // Stop current uploads\n        var abortCount = 0;\n        $h.each($.chunks, function(c){\n          if(c.status()=='uploading') {\n            c.abort();\n            abortCount++;\n          }\n        });\n        if(abortCount>0) $.resumableObj.fire('fileProgress', $);\n      };\n      $.cancel = function(){\n        // Reset this file to be void\n        var _chunks = $.chunks;\n        $.chunks = [];\n        // Stop current uploads\n        $h.each(_chunks, function(c){\n          if(c.status()=='uploading')  {\n            c.abort();\n            $.resumableObj.uploadNextChunk();\n          }\n        });\n        $.resumableObj.removeFile($);\n        $.resumableObj.fire('fileProgress', $);\n      };\n      $.retry = function(){\n        $.bootstrap();\n        var firedRetry = false;\n        $.resumableObj.on('chunkingComplete', function(){\n          if(!firedRetry) $.resumableObj.upload();\n          firedRetry = true;\n        });\n      };\n      $.bootstrap = function(){\n        $.abort();\n        _error = false;\n        // Rebuild stack of chunks from file\n        $.chunks = [];\n        $._prevProgress = 0;\n        var round = $.getOpt('forceChunkSize') ? Math.ceil : Math.floor;\n        var maxOffset = Math.max(round($.file.size/$.getOpt('chunkSize')),1);\n        for (var offset=0; offset<maxOffset; offset++) {(function(offset){\n            window.setTimeout(function(){\n                $.chunks.push(new ResumableChunk($.resumableObj, $, offset, chunkEvent));\n                $.resumableObj.fire('chunkingProgress',$,offset/maxOffset);\n            },0);\n        })(offset)}\n        window.setTimeout(function(){\n            $.resumableObj.fire('chunkingComplete',$);\n        },0);\n      };\n      $.progress = function(){\n        if(_error) return(1);\n        // Sum up progress across everything\n        var ret = 0;\n        var error = false;\n        $h.each($.chunks, function(c){\n          if(c.status()=='error') error = true;\n          ret += c.progress(true); // get chunk progress relative to entire file\n        });\n        ret = (error ? 1 : (ret>0.99999 ? 1 : ret));\n        ret = Math.max($._prevProgress, ret); // We don't want to lose percentages when an upload is paused\n        $._prevProgress = ret;\n        return(ret);\n      };\n      $.isUploading = function(){\n        var uploading = false;\n        $h.each($.chunks, function(chunk){\n          if(chunk.status()=='uploading') {\n            uploading = true;\n            return(false);\n          }\n        });\n        return(uploading);\n      };\n      $.isComplete = function(){\n        var outstanding = false;\n        $h.each($.chunks, function(chunk){\n          var status = chunk.status();\n          if(status=='pending' || status=='uploading' || chunk.preprocessState === 1) {\n            outstanding = true;\n            return(false);\n          }\n        });\n        return(!outstanding);\n      };\n      $.pause = function(pause){\n          if(typeof(pause)==='undefined'){\n              $._pause = ($._pause ? false : true);\n          }else{\n              $._pause = pause;\n          }\n      };\n      $.isPaused = function() {\n        return $._pause;\n      };\n\n\n      // Bootstrap and return\n      $.resumableObj.fire('chunkingStart', $);\n      $.bootstrap();\n      return(this);\n    }\n\n\n    function ResumableChunk(resumableObj, fileObj, offset, callback){\n      var $ = this;\n      $.opts = {};\n      $.getOpt = resumableObj.getOpt;\n      $.resumableObj = resumableObj;\n      $.fileObj = fileObj;\n      $.fileObjSize = fileObj.size;\n      $.fileObjType = fileObj.file.type;\n      $.offset = offset;\n      $.callback = callback;\n      $.lastProgressCallback = (new Date);\n      $.tested = false;\n      $.retries = 0;\n      $.pendingRetry = false;\n      $.preprocessState = 0; // 0 = unprocessed, 1 = processing, 2 = finished\n\n      // Computed properties\n      var chunkSize = $.getOpt('chunkSize');\n      $.loaded = 0;\n      $.startByte = $.offset*chunkSize;\n      $.endByte = Math.min($.fileObjSize, ($.offset+1)*chunkSize);\n      if ($.fileObjSize-$.endByte < chunkSize && !$.getOpt('forceChunkSize')) {\n        // The last chunk will be bigger than the chunk size, but less than 2*chunkSize\n        $.endByte = $.fileObjSize;\n      }\n      $.xhr = null;\n\n      // test() makes a GET request without any data to see if the chunk has already been uploaded in a previous session\n      $.test = function(){\n        // Set up request and listen for event\n        $.xhr = new XMLHttpRequest();\n\n        var testHandler = function(e){\n          $.tested = true;\n          var status = $.status();\n          if(status=='success') {\n            $.callback(status, $.message());\n            $.resumableObj.uploadNextChunk();\n          } else {\n            $.send();\n          }\n        };\n        $.xhr.addEventListener('load', testHandler, false);\n        $.xhr.addEventListener('error', testHandler, false);\n        $.xhr.addEventListener('timeout', testHandler, false);\n\n        // Add data from the query options\n        var params = [];\n        var parameterNamespace = $.getOpt('parameterNamespace');\n        var customQuery = $.getOpt('query');\n        if(typeof customQuery == 'function') customQuery = customQuery($.fileObj, $);\n        $h.each(customQuery, function(k,v){\n          params.push([encodeURIComponent(parameterNamespace+k), encodeURIComponent(v)].join('='));\n        });\n        // Add extra data to identify chunk\n        params = params.concat(\n          [\n            // define key/value pairs for additional parameters\n            ['chunkNumberParameterName', $.offset + 1],\n            ['chunkSizeParameterName', $.getOpt('chunkSize')],\n            ['currentChunkSizeParameterName', $.endByte - $.startByte],\n            ['totalSizeParameterName', $.fileObjSize],\n            ['typeParameterName', $.fileObjType],\n            ['identifierParameterName', $.fileObj.uniqueIdentifier],\n            ['fileNameParameterName', $.fileObj.fileName],\n            ['relativePathParameterName', $.fileObj.relativePath],\n            ['totalChunksParameterName', $.fileObj.chunks.length]\n          ].filter(function(pair){\n            // include items that resolve to truthy values\n            // i.e. exclude false, null, undefined and empty strings\n            return $.getOpt(pair[0]);\n          })\n          .map(function(pair){\n            // map each key/value pair to its final form\n            return [\n              parameterNamespace + $.getOpt(pair[0]),\n              encodeURIComponent(pair[1])\n            ].join('=');\n          })\n        );\n        // Append the relevant chunk and send it\n        $.xhr.open($.getOpt('testMethod'), $h.getTarget('test', params));\n        $.xhr.timeout = $.getOpt('xhrTimeout');\n        $.xhr.withCredentials = $.getOpt('withCredentials');\n        // Add data from header options\n        var customHeaders = $.getOpt('headers');\n        if(typeof customHeaders === 'function') {\n          customHeaders = customHeaders($.fileObj, $);\n        }\n        $h.each(customHeaders, function(k,v) {\n          $.xhr.setRequestHeader(k, v);\n        });\n        $.xhr.send(null);\n      };\n\n      $.preprocessFinished = function(){\n        $.preprocessState = 2;\n        $.send();\n      };\n\n      // send() uploads the actual data in a POST call\n      $.send = function(){\n        var preprocess = $.getOpt('preprocess');\n        if(typeof preprocess === 'function') {\n          switch($.preprocessState) {\n          case 0: $.preprocessState = 1; preprocess($); return;\n          case 1: return;\n          case 2: break;\n          }\n        }\n        if($.getOpt('testChunks') && !$.tested) {\n          $.test();\n          return;\n        }\n\n        // Set up request and listen for event\n        $.xhr = new XMLHttpRequest();\n\n        // Progress\n        $.xhr.upload.addEventListener('progress', function(e){\n          if( (new Date) - $.lastProgressCallback > $.getOpt('throttleProgressCallbacks') * 1000 ) {\n            $.callback('progress');\n            $.lastProgressCallback = (new Date);\n          }\n          $.loaded=e.loaded||0;\n        }, false);\n        $.loaded = 0;\n        $.pendingRetry = false;\n        $.callback('progress');\n\n        // Done (either done, failed or retry)\n        var doneHandler = function(e){\n          var status = $.status();\n          if(status=='success'||status=='error') {\n            $.callback(status, $.message());\n            $.resumableObj.uploadNextChunk();\n          } else {\n            $.callback('retry', $.message());\n            $.abort();\n            $.retries++;\n            var retryInterval = $.getOpt('chunkRetryInterval');\n            if(retryInterval !== undefined) {\n              $.pendingRetry = true;\n              setTimeout($.send, retryInterval);\n            } else {\n              $.send();\n            }\n          }\n        };\n        $.xhr.addEventListener('load', doneHandler, false);\n        $.xhr.addEventListener('error', doneHandler, false);\n        $.xhr.addEventListener('timeout', doneHandler, false);\n\n        // Set up the basic query data from Resumable\n        var query = [\n          ['chunkNumberParameterName', $.offset + 1],\n          ['chunkSizeParameterName', $.getOpt('chunkSize')],\n          ['currentChunkSizeParameterName', $.endByte - $.startByte],\n          ['totalSizeParameterName', $.fileObjSize],\n          ['typeParameterName', $.fileObjType],\n          ['identifierParameterName', $.fileObj.uniqueIdentifier],\n          ['fileNameParameterName', $.fileObj.fileName],\n          ['relativePathParameterName', $.fileObj.relativePath],\n          ['totalChunksParameterName', $.fileObj.chunks.length],\n        ].filter(function(pair){\n          // include items that resolve to truthy values\n          // i.e. exclude false, null, undefined and empty strings\n          return $.getOpt(pair[0]);\n        })\n        .reduce(function(query, pair){\n          // assign query key/value\n          query[$.getOpt(pair[0])] = pair[1];\n          return query;\n        }, {});\n        // Mix in custom data\n        var customQuery = $.getOpt('query');\n        if(typeof customQuery == 'function') customQuery = customQuery($.fileObj, $);\n        $h.each(customQuery, function(k,v){\n          query[k] = v;\n        });\n\n        var func = ($.fileObj.file.slice ? 'slice' : ($.fileObj.file.mozSlice ? 'mozSlice' : ($.fileObj.file.webkitSlice ? 'webkitSlice' : 'slice')));\n        var bytes = $.fileObj.file[func]($.startByte, $.endByte, $.getOpt('setChunkTypeFromFile') ? $.fileObj.file.type : \"\");\n        var data = null;\n        var params = [];\n\n        var parameterNamespace = $.getOpt('parameterNamespace');\n                if ($.getOpt('method') === 'octet') {\n                    // Add data from the query options\n                    data = bytes;\n                    $h.each(query, function (k, v) {\n                        params.push([encodeURIComponent(parameterNamespace + k), encodeURIComponent(v)].join('='));\n                    });\n                } else {\n                    // Add data from the query options\n                    data = new FormData();\n                    $h.each(query, function (k, v) {\n                        data.append(parameterNamespace + k, v);\n                        params.push([encodeURIComponent(parameterNamespace + k), encodeURIComponent(v)].join('='));\n                    });\n                    if ($.getOpt('chunkFormat') == 'blob') {\n                        data.append(parameterNamespace + $.getOpt('fileParameterName'), bytes, $.fileObj.fileName);\n                    }\n                    else if ($.getOpt('chunkFormat') == 'base64') {\n                        var fr = new FileReader();\n                        fr.onload = function (e) {\n                            data.append(parameterNamespace + $.getOpt('fileParameterName'), fr.result);\n                            $.xhr.send(data);\n                        }\n                        fr.readAsDataURL(bytes);\n                    }\n                }\n\n        var target = $h.getTarget('upload', params);\n        var method = $.getOpt('uploadMethod');\n\n        $.xhr.open(method, target);\n        if ($.getOpt('method') === 'octet') {\n          $.xhr.setRequestHeader('Content-Type', 'application/octet-stream');\n        }\n        $.xhr.timeout = $.getOpt('xhrTimeout');\n        $.xhr.withCredentials = $.getOpt('withCredentials');\n        // Add data from header options\n        var customHeaders = $.getOpt('headers');\n        if(typeof customHeaders === 'function') {\n          customHeaders = customHeaders($.fileObj, $);\n        }\n\n        $h.each(customHeaders, function(k,v) {\n          $.xhr.setRequestHeader(k, v);\n        });\n\n                if ($.getOpt('chunkFormat') == 'blob') {\n                    $.xhr.send(data);\n                }\n      };\n      $.abort = function(){\n        // Abort and reset\n        if($.xhr) $.xhr.abort();\n        $.xhr = null;\n      };\n      $.status = function(){\n        // Returns: 'pending', 'uploading', 'success', 'error'\n        if($.pendingRetry) {\n          // if pending retry then that's effectively the same as actively uploading,\n          // there might just be a slight delay before the retry starts\n          return('uploading');\n        } else if(!$.xhr) {\n          return('pending');\n        } else if($.xhr.readyState<4) {\n          // Status is really 'OPENED', 'HEADERS_RECEIVED' or 'LOADING' - meaning that stuff is happening\n          return('uploading');\n        } else {\n          if($.xhr.status == 200 || $.xhr.status == 201) {\n            // HTTP 200, 201 (created)\n            return('success');\n          } else if($h.contains($.getOpt('permanentErrors'), $.xhr.status) || $.retries >= $.getOpt('maxChunkRetries')) {\n            // HTTP 415/500/501, permanent error\n            return('error');\n          } else {\n            // this should never happen, but we'll reset and queue a retry\n            // a likely case for this would be 503 service unavailable\n            $.abort();\n            return('pending');\n          }\n        }\n      };\n      $.message = function(){\n        return($.xhr ? $.xhr.responseText : '');\n      };\n      $.progress = function(relative){\n        if(typeof(relative)==='undefined') relative = false;\n        var factor = (relative ? ($.endByte-$.startByte)/$.fileObjSize : 1);\n        if($.pendingRetry) return(0);\n        if(!$.xhr || !$.xhr.status) factor*=.95;\n        var s = $.status();\n        switch(s){\n        case 'success':\n        case 'error':\n          return(1*factor);\n        case 'pending':\n          return(0*factor);\n        default:\n          return($.loaded/($.endByte-$.startByte)*factor);\n        }\n      };\n      return(this);\n    }\n\n    // QUEUE\n    $.uploadNextChunk = function(){\n      var found = false;\n\n      // In some cases (such as videos) it's really handy to upload the first\n      // and last chunk of a file quickly; this let's the server check the file's\n      // metadata and determine if there's even a point in continuing.\n      if ($.getOpt('prioritizeFirstAndLastChunk')) {\n        $h.each($.files, function(file){\n          if(file.chunks.length && file.chunks[0].status()=='pending' && file.chunks[0].preprocessState === 0) {\n            file.chunks[0].send();\n            found = true;\n            return(false);\n          }\n          if(file.chunks.length>1 && file.chunks[file.chunks.length-1].status()=='pending' && file.chunks[file.chunks.length-1].preprocessState === 0) {\n            file.chunks[file.chunks.length-1].send();\n            found = true;\n            return(false);\n          }\n        });\n        if(found) return(true);\n      }\n\n      // Now, simply look for the next, best thing to upload\n      $h.each($.files, function(file){\n        if(file.isPaused()===false){\n         $h.each(file.chunks, function(chunk){\n           if(chunk.status()=='pending' && chunk.preprocessState === 0) {\n             chunk.send();\n             found = true;\n             return(false);\n           }\n          });\n        }\n        if(found) return(false);\n      });\n      if(found) return(true);\n\n      // The are no more outstanding chunks to upload, check is everything is done\n      var outstanding = false;\n      $h.each($.files, function(file){\n        if(!file.isComplete()) {\n          outstanding = true;\n          return(false);\n        }\n      });\n      if(!outstanding) {\n        // All chunks have been uploaded, complete\n        $.fire('complete');\n      }\n      return(false);\n    };\n\n\n    // PUBLIC METHODS FOR RESUMABLE.JS\n    $.assignBrowse = function(domNodes, isDirectory){\n      if(typeof(domNodes.length)=='undefined') domNodes = [domNodes];\n\n      $h.each(domNodes, function(domNode) {\n        var input;\n        if(domNode.tagName==='INPUT' && domNode.type==='file'){\n          input = domNode;\n        } else {\n          input = document.createElement('input');\n          input.setAttribute('type', 'file');\n          input.style.display = 'none';\n          domNode.addEventListener('click', function(){\n            input.style.opacity = 0;\n            input.style.display='block';\n            input.focus();\n            input.click();\n            input.style.display='none';\n          }, false);\n          domNode.appendChild(input);\n        }\n        var maxFiles = $.getOpt('maxFiles');\n        if (typeof(maxFiles)==='undefined'||maxFiles!=1){\n          input.setAttribute('multiple', 'multiple');\n        } else {\n          input.removeAttribute('multiple');\n        }\n        if(isDirectory){\n          input.setAttribute('webkitdirectory', 'webkitdirectory');\n        } else {\n          input.removeAttribute('webkitdirectory');\n        }\n        var fileTypes = $.getOpt('fileType');\n        if (typeof (fileTypes) !== 'undefined' && fileTypes.length >= 1) {\n          input.setAttribute('accept', fileTypes.map(function (e) { return '.' + e }).join(','));\n        }\n        else {\n          input.removeAttribute('accept');\n        }\n        // When new files are added, simply append them to the overall list\n        input.addEventListener('change', function(e){\n          appendFilesFromFileList(e.target.files,e);\n          var clearInput = $.getOpt('clearInput');\n          if (clearInput) {\n            e.target.value = '';\n          }\n        }, false);\n      });\n    };\n    $.assignDrop = function(domNodes){\n      if(typeof(domNodes.length)=='undefined') domNodes = [domNodes];\n\n      $h.each(domNodes, function(domNode) {\n        domNode.addEventListener('dragover', preventDefault, false);\n        domNode.addEventListener('dragenter', preventDefault, false);\n        domNode.addEventListener('drop', onDrop, false);\n      });\n    };\n    $.unAssignDrop = function(domNodes) {\n      if (typeof(domNodes.length) == 'undefined') domNodes = [domNodes];\n\n      $h.each(domNodes, function(domNode) {\n        domNode.removeEventListener('dragover', preventDefault);\n        domNode.removeEventListener('dragenter', preventDefault);\n        domNode.removeEventListener('drop', onDrop);\n      });\n    };\n    $.isUploading = function(){\n      var uploading = false;\n      $h.each($.files, function(file){\n        if (file.isUploading()) {\n          uploading = true;\n          return(false);\n        }\n      });\n      return(uploading);\n    };\n    $.upload = function(){\n      // Make sure we don't start too many uploads at once\n      if($.isUploading()) return;\n      // Kick off the queue\n      $.fire('uploadStart');\n      for (var num=1; num<=$.getOpt('simultaneousUploads'); num++) {\n        $.uploadNextChunk();\n      }\n    };\n    $.pause = function(){\n      // Resume all chunks currently being uploaded\n      $h.each($.files, function(file){\n        file.abort();\n      });\n      $.fire('pause');\n    };\n    $.cancel = function(){\n      $.fire('beforeCancel');\n      for(var i = $.files.length - 1; i >= 0; i--) {\n        $.files[i].cancel();\n      }\n      $.fire('cancel');\n    };\n    $.progress = function(){\n      var totalDone = 0;\n      var totalSize = 0;\n      // Resume all chunks currently being uploaded\n      $h.each($.files, function(file){\n        totalDone += file.progress()*file.size;\n        totalSize += file.size;\n      });\n      return(totalSize>0 ? totalDone/totalSize : 0);\n    };\n    $.addFile = function(file, event){\n      appendFilesFromFileList([file], event);\n    };\n    $.addFiles = function(files, event){\n      appendFilesFromFileList(files, event);\n    };\n    $.removeFile = function(file){\n      for(var i = $.files.length - 1; i >= 0; i--) {\n        if($.files[i] === file) {\n          $.files.splice(i, 1);\n        }\n      }\n    };\n    $.getFromUniqueIdentifier = function(uniqueIdentifier){\n      var ret = false;\n      $h.each($.files, function(f){\n        if(f.uniqueIdentifier==uniqueIdentifier) ret = f;\n      });\n      return(ret);\n    };\n    $.getSize = function(){\n      var totalSize = 0;\n      $h.each($.files, function(file){\n        totalSize += file.size;\n      });\n      return(totalSize);\n    };\n    $.handleDropEvent = function (e) {\n      onDrop(e);\n    };\n    $.handleChangeEvent = function (e) {\n      appendFilesFromFileList(e.target.files, e);\n      e.target.value = '';\n    };\n    $.updateQuery = function(query){\n        $.opts.query = query;\n    };\n\n    return(this);\n  };\n\n\n  // Node.js-style export for Node and Component\n  if (typeof module != 'undefined') {\n    module.exports = Resumable;\n  } else if (typeof define === \"function\" && define.amd) {\n    // AMD/requirejs: Define the module\n    define(function(){\n      return Resumable;\n    });\n  } else {\n    // Browser: Expose to window\n    window.Resumable = Resumable;\n  }\n\n})();\n","/*!\n * URI.js - Mutating URLs\n * IPv6 Support\n *\n * Version: 1.19.11\n *\n * Author: Rodney Rehm\n * Web: http://medialize.github.io/URI.js/\n *\n * Licensed under\n *   MIT License http://www.opensource.org/licenses/mit-license\n *\n */\n\n(function (root, factory) {\n  'use strict';\n  // https://github.com/umdjs/umd/blob/master/returnExports.js\n  if (typeof module === 'object' && module.exports) {\n    // Node\n    module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(factory);\n  } else {\n    // Browser globals (root is window)\n    root.IPv6 = factory(root);\n  }\n}(this, function (root) {\n  'use strict';\n\n  /*\n  var _in = \"fe80:0000:0000:0000:0204:61ff:fe9d:f156\";\n  var _out = IPv6.best(_in);\n  var _expected = \"fe80::204:61ff:fe9d:f156\";\n\n  console.log(_in, _out, _expected, _out === _expected);\n  */\n\n  // save current IPv6 variable, if any\n  var _IPv6 = root && root.IPv6;\n\n  function bestPresentation(address) {\n    // based on:\n    // Javascript to test an IPv6 address for proper format, and to\n    // present the \"best text representation\" according to IETF Draft RFC at\n    // http://tools.ietf.org/html/draft-ietf-6man-text-addr-representation-04\n    // 8 Feb 2010 Rich Brown, Dartware, LLC\n    // Please feel free to use this code as long as you provide a link to\n    // http://www.intermapper.com\n    // http://intermapper.com/support/tools/IPV6-Validator.aspx\n    // http://download.dartware.com/thirdparty/ipv6validator.js\n\n    var _address = address.toLowerCase();\n    var segments = _address.split(':');\n    var length = segments.length;\n    var total = 8;\n\n    // trim colons (:: or ::a:b:c or a:b:c::)\n    if (segments[0] === '' && segments[1] === '' && segments[2] === '') {\n      // must have been ::\n      // remove first two items\n      segments.shift();\n      segments.shift();\n    } else if (segments[0] === '' && segments[1] === '') {\n      // must have been ::xxxx\n      // remove the first item\n      segments.shift();\n    } else if (segments[length - 1] === '' && segments[length - 2] === '') {\n      // must have been xxxx::\n      segments.pop();\n    }\n\n    length = segments.length;\n\n    // adjust total segments for IPv4 trailer\n    if (segments[length - 1].indexOf('.') !== -1) {\n      // found a \".\" which means IPv4\n      total = 7;\n    }\n\n    // fill empty segments them with \"0000\"\n    var pos;\n    for (pos = 0; pos < length; pos++) {\n      if (segments[pos] === '') {\n        break;\n      }\n    }\n\n    if (pos < total) {\n      segments.splice(pos, 1, '0000');\n      while (segments.length < total) {\n        segments.splice(pos, 0, '0000');\n      }\n    }\n\n    // strip leading zeros\n    var _segments;\n    for (var i = 0; i < total; i++) {\n      _segments = segments[i].split('');\n      for (var j = 0; j < 3 ; j++) {\n        if (_segments[0] === '0' && _segments.length > 1) {\n          _segments.splice(0,1);\n        } else {\n          break;\n        }\n      }\n\n      segments[i] = _segments.join('');\n    }\n\n    // find longest sequence of zeroes and coalesce them into one segment\n    var best = -1;\n    var _best = 0;\n    var _current = 0;\n    var current = -1;\n    var inzeroes = false;\n    // i; already declared\n\n    for (i = 0; i < total; i++) {\n      if (inzeroes) {\n        if (segments[i] === '0') {\n          _current += 1;\n        } else {\n          inzeroes = false;\n          if (_current > _best) {\n            best = current;\n            _best = _current;\n          }\n        }\n      } else {\n        if (segments[i] === '0') {\n          inzeroes = true;\n          current = i;\n          _current = 1;\n        }\n      }\n    }\n\n    if (_current > _best) {\n      best = current;\n      _best = _current;\n    }\n\n    if (_best > 1) {\n      segments.splice(best, _best, '');\n    }\n\n    length = segments.length;\n\n    // assemble remaining segments\n    var result = '';\n    if (segments[0] === '')  {\n      result = ':';\n    }\n\n    for (i = 0; i < length; i++) {\n      result += segments[i];\n      if (i === length - 1) {\n        break;\n      }\n\n      result += ':';\n    }\n\n    if (segments[length - 1] === '') {\n      result += ':';\n    }\n\n    return result;\n  }\n\n  function noConflict() {\n    /*jshint validthis: true */\n    if (root.IPv6 === this) {\n      root.IPv6 = _IPv6;\n    }\n\n    return this;\n  }\n\n  return {\n    best: bestPresentation,\n    noConflict: noConflict\n  };\n}));\n","/*!\n * URI.js - Mutating URLs\n * Second Level Domain (SLD) Support\n *\n * Version: 1.19.11\n *\n * Author: Rodney Rehm\n * Web: http://medialize.github.io/URI.js/\n *\n * Licensed under\n *   MIT License http://www.opensource.org/licenses/mit-license\n *\n */\n\n(function (root, factory) {\n  'use strict';\n  // https://github.com/umdjs/umd/blob/master/returnExports.js\n  if (typeof module === 'object' && module.exports) {\n    // Node\n    module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(factory);\n  } else {\n    // Browser globals (root is window)\n    root.SecondLevelDomains = factory(root);\n  }\n}(this, function (root) {\n  'use strict';\n\n  // save current SecondLevelDomains variable, if any\n  var _SecondLevelDomains = root && root.SecondLevelDomains;\n\n  var SLD = {\n    // list of known Second Level Domains\n    // converted list of SLDs from https://github.com/gavingmiller/second-level-domains\n    // ----\n    // publicsuffix.org is more current and actually used by a couple of browsers internally.\n    // downside is it also contains domains like \"dyndns.org\" - which is fine for the security\n    // issues browser have to deal with (SOP for cookies, etc) - but is way overboard for URI.js\n    // ----\n    list: {\n      'ac':' com gov mil net org ',\n      'ae':' ac co gov mil name net org pro sch ',\n      'af':' com edu gov net org ',\n      'al':' com edu gov mil net org ',\n      'ao':' co ed gv it og pb ',\n      'ar':' com edu gob gov int mil net org tur ',\n      'at':' ac co gv or ',\n      'au':' asn com csiro edu gov id net org ',\n      'ba':' co com edu gov mil net org rs unbi unmo unsa untz unze ',\n      'bb':' biz co com edu gov info net org store tv ',\n      'bh':' biz cc com edu gov info net org ',\n      'bn':' com edu gov net org ',\n      'bo':' com edu gob gov int mil net org tv ',\n      'br':' adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ',\n      'bs':' com edu gov net org ',\n      'bz':' du et om ov rg ',\n      'ca':' ab bc mb nb nf nl ns nt nu on pe qc sk yk ',\n      'ck':' biz co edu gen gov info net org ',\n      'cn':' ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ',\n      'co':' com edu gov mil net nom org ',\n      'cr':' ac c co ed fi go or sa ',\n      'cy':' ac biz com ekloges gov ltd name net org parliament press pro tm ',\n      'do':' art com edu gob gov mil net org sld web ',\n      'dz':' art asso com edu gov net org pol ',\n      'ec':' com edu fin gov info med mil net org pro ',\n      'eg':' com edu eun gov mil name net org sci ',\n      'er':' com edu gov ind mil net org rochest w ',\n      'es':' com edu gob nom org ',\n      'et':' biz com edu gov info name net org ',\n      'fj':' ac biz com info mil name net org pro ',\n      'fk':' ac co gov net nom org ',\n      'fr':' asso com f gouv nom prd presse tm ',\n      'gg':' co net org ',\n      'gh':' com edu gov mil org ',\n      'gn':' ac com gov net org ',\n      'gr':' com edu gov mil net org ',\n      'gt':' com edu gob ind mil net org ',\n      'gu':' com edu gov net org ',\n      'hk':' com edu gov idv net org ',\n      'hu':' 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ',\n      'id':' ac co go mil net or sch web ',\n      'il':' ac co gov idf k12 muni net org ',\n      'in':' ac co edu ernet firm gen gov i ind mil net nic org res ',\n      'iq':' com edu gov i mil net org ',\n      'ir':' ac co dnssec gov i id net org sch ',\n      'it':' edu gov ',\n      'je':' co net org ',\n      'jo':' com edu gov mil name net org sch ',\n      'jp':' ac ad co ed go gr lg ne or ',\n      'ke':' ac co go info me mobi ne or sc ',\n      'kh':' com edu gov mil net org per ',\n      'ki':' biz com de edu gov info mob net org tel ',\n      'km':' asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ',\n      'kn':' edu gov net org ',\n      'kr':' ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ',\n      'kw':' com edu gov net org ',\n      'ky':' com edu gov net org ',\n      'kz':' com edu gov mil net org ',\n      'lb':' com edu gov net org ',\n      'lk':' assn com edu gov grp hotel int ltd net ngo org sch soc web ',\n      'lr':' com edu gov net org ',\n      'lv':' asn com conf edu gov id mil net org ',\n      'ly':' com edu gov id med net org plc sch ',\n      'ma':' ac co gov m net org press ',\n      'mc':' asso tm ',\n      'me':' ac co edu gov its net org priv ',\n      'mg':' com edu gov mil nom org prd tm ',\n      'mk':' com edu gov inf name net org pro ',\n      'ml':' com edu gov net org presse ',\n      'mn':' edu gov org ',\n      'mo':' com edu gov net org ',\n      'mt':' com edu gov net org ',\n      'mv':' aero biz com coop edu gov info int mil museum name net org pro ',\n      'mw':' ac co com coop edu gov int museum net org ',\n      'mx':' com edu gob net org ',\n      'my':' com edu gov mil name net org sch ',\n      'nf':' arts com firm info net other per rec store web ',\n      'ng':' biz com edu gov mil mobi name net org sch ',\n      'ni':' ac co com edu gob mil net nom org ',\n      'np':' com edu gov mil net org ',\n      'nr':' biz com edu gov info net org ',\n      'om':' ac biz co com edu gov med mil museum net org pro sch ',\n      'pe':' com edu gob mil net nom org sld ',\n      'ph':' com edu gov i mil net ngo org ',\n      'pk':' biz com edu fam gob gok gon gop gos gov net org web ',\n      'pl':' art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ',\n      'pr':' ac biz com edu est gov info isla name net org pro prof ',\n      'ps':' com edu gov net org plo sec ',\n      'pw':' belau co ed go ne or ',\n      'ro':' arts com firm info nom nt org rec store tm www ',\n      'rs':' ac co edu gov in org ',\n      'sb':' com edu gov net org ',\n      'sc':' com edu gov net org ',\n      'sh':' co com edu gov net nom org ',\n      'sl':' com edu gov net org ',\n      'st':' co com consulado edu embaixada gov mil net org principe saotome store ',\n      'sv':' com edu gob org red ',\n      'sz':' ac co org ',\n      'tr':' av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ',\n      'tt':' aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ',\n      'tw':' club com ebiz edu game gov idv mil net org ',\n      'mu':' ac co com gov net or org ',\n      'mz':' ac co edu gov org ',\n      'na':' co com ',\n      'nz':' ac co cri geek gen govt health iwi maori mil net org parliament school ',\n      'pa':' abo ac com edu gob ing med net nom org sld ',\n      'pt':' com edu gov int net nome org publ ',\n      'py':' com edu gov mil net org ',\n      'qa':' com edu gov mil net org ',\n      're':' asso com nom ',\n      'ru':' ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ',\n      'rw':' ac co com edu gouv gov int mil net ',\n      'sa':' com edu gov med net org pub sch ',\n      'sd':' com edu gov info med net org tv ',\n      'se':' a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ',\n      'sg':' com edu gov idn net org per ',\n      'sn':' art com edu gouv org perso univ ',\n      'sy':' com edu gov mil net news org ',\n      'th':' ac co go in mi net or ',\n      'tj':' ac biz co com edu go gov info int mil name net nic org test web ',\n      'tn':' agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ',\n      'tz':' ac co go ne or ',\n      'ua':' biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ',\n      'ug':' ac co go ne or org sc ',\n      'uk':' ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ',\n      'us':' dni fed isa kids nsn ',\n      'uy':' com edu gub mil net org ',\n      've':' co com edu gob info mil net org web ',\n      'vi':' co com k12 net org ',\n      'vn':' ac biz com edu gov health info int name net org pro ',\n      'ye':' co com gov ltd me net org plc ',\n      'yu':' ac co edu gov org ',\n      'za':' ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ',\n      'zm':' ac co com edu gov net org sch ',\n      // https://en.wikipedia.org/wiki/CentralNic#Second-level_domains\n      'com': 'ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ',\n      'net': 'gb jp se uk ',\n      'org': 'ae',\n      'de': 'com '\n    },\n    // gorhill 2013-10-25: Using indexOf() instead Regexp(). Significant boost\n    // in both performance and memory footprint. No initialization required.\n    // http://jsperf.com/uri-js-sld-regex-vs-binary-search/4\n    // Following methods use lastIndexOf() rather than array.split() in order\n    // to avoid any memory allocations.\n    has: function(domain) {\n      var tldOffset = domain.lastIndexOf('.');\n      if (tldOffset <= 0 || tldOffset >= (domain.length-1)) {\n        return false;\n      }\n      var sldOffset = domain.lastIndexOf('.', tldOffset-1);\n      if (sldOffset <= 0 || sldOffset >= (tldOffset-1)) {\n        return false;\n      }\n      var sldList = SLD.list[domain.slice(tldOffset+1)];\n      if (!sldList) {\n        return false;\n      }\n      return sldList.indexOf(' ' + domain.slice(sldOffset+1, tldOffset) + ' ') >= 0;\n    },\n    is: function(domain) {\n      var tldOffset = domain.lastIndexOf('.');\n      if (tldOffset <= 0 || tldOffset >= (domain.length-1)) {\n        return false;\n      }\n      var sldOffset = domain.lastIndexOf('.', tldOffset-1);\n      if (sldOffset >= 0) {\n        return false;\n      }\n      var sldList = SLD.list[domain.slice(tldOffset+1)];\n      if (!sldList) {\n        return false;\n      }\n      return sldList.indexOf(' ' + domain.slice(0, tldOffset) + ' ') >= 0;\n    },\n    get: function(domain) {\n      var tldOffset = domain.lastIndexOf('.');\n      if (tldOffset <= 0 || tldOffset >= (domain.length-1)) {\n        return null;\n      }\n      var sldOffset = domain.lastIndexOf('.', tldOffset-1);\n      if (sldOffset <= 0 || sldOffset >= (tldOffset-1)) {\n        return null;\n      }\n      var sldList = SLD.list[domain.slice(tldOffset+1)];\n      if (!sldList) {\n        return null;\n      }\n      if (sldList.indexOf(' ' + domain.slice(sldOffset+1, tldOffset) + ' ') < 0) {\n        return null;\n      }\n      return domain.slice(sldOffset+1);\n    },\n    noConflict: function(){\n      if (root.SecondLevelDomains === this) {\n        root.SecondLevelDomains = _SecondLevelDomains;\n      }\n      return this;\n    }\n  };\n\n  return SLD;\n}));\n","/*!\n * URI.js - Mutating URLs\n *\n * Version: 1.19.11\n *\n * Author: Rodney Rehm\n * Web: http://medialize.github.io/URI.js/\n *\n * Licensed under\n *   MIT License http://www.opensource.org/licenses/mit-license\n *\n */\n(function (root, factory) {\n  'use strict';\n  // https://github.com/umdjs/umd/blob/master/returnExports.js\n  if (typeof module === 'object' && module.exports) {\n    // Node\n    module.exports = factory(require('./punycode'), require('./IPv6'), require('./SecondLevelDomains'));\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['./punycode', './IPv6', './SecondLevelDomains'], factory);\n  } else {\n    // Browser globals (root is window)\n    root.URI = factory(root.punycode, root.IPv6, root.SecondLevelDomains, root);\n  }\n}(this, function (punycode, IPv6, SLD, root) {\n  'use strict';\n  /*global location, escape, unescape */\n  // FIXME: v2.0.0 renamce non-camelCase properties to uppercase\n  /*jshint camelcase: false */\n\n  // save current URI variable, if any\n  var _URI = root && root.URI;\n\n  function URI(url, base) {\n    var _urlSupplied = arguments.length >= 1;\n    var _baseSupplied = arguments.length >= 2;\n\n    // Allow instantiation without the 'new' keyword\n    if (!(this instanceof URI)) {\n      if (_urlSupplied) {\n        if (_baseSupplied) {\n          return new URI(url, base);\n        }\n\n        return new URI(url);\n      }\n\n      return new URI();\n    }\n\n    if (url === undefined) {\n      if (_urlSupplied) {\n        throw new TypeError('undefined is not a valid argument for URI');\n      }\n\n      if (typeof location !== 'undefined') {\n        url = location.href + '';\n      } else {\n        url = '';\n      }\n    }\n\n    if (url === null) {\n      if (_urlSupplied) {\n        throw new TypeError('null is not a valid argument for URI');\n      }\n    }\n\n    this.href(url);\n\n    // resolve to base according to http://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#constructor\n    if (base !== undefined) {\n      return this.absoluteTo(base);\n    }\n\n    return this;\n  }\n\n  function isInteger(value) {\n    return /^[0-9]+$/.test(value);\n  }\n\n  URI.version = '1.19.11';\n\n  var p = URI.prototype;\n  var hasOwn = Object.prototype.hasOwnProperty;\n\n  function escapeRegEx(string) {\n    // https://github.com/medialize/URI.js/commit/85ac21783c11f8ccab06106dba9735a31a86924d#commitcomment-821963\n    return string.replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g, '\\\\$1');\n  }\n\n  function getType(value) {\n    // IE8 doesn't return [Object Undefined] but [Object Object] for undefined value\n    if (value === undefined) {\n      return 'Undefined';\n    }\n\n    return String(Object.prototype.toString.call(value)).slice(8, -1);\n  }\n\n  function isArray(obj) {\n    return getType(obj) === 'Array';\n  }\n\n  function filterArrayValues(data, value) {\n    var lookup = {};\n    var i, length;\n\n    if (getType(value) === 'RegExp') {\n      lookup = null;\n    } else if (isArray(value)) {\n      for (i = 0, length = value.length; i < length; i++) {\n        lookup[value[i]] = true;\n      }\n    } else {\n      lookup[value] = true;\n    }\n\n    for (i = 0, length = data.length; i < length; i++) {\n      /*jshint laxbreak: true */\n      var _match = lookup && lookup[data[i]] !== undefined\n        || !lookup && value.test(data[i]);\n      /*jshint laxbreak: false */\n      if (_match) {\n        data.splice(i, 1);\n        length--;\n        i--;\n      }\n    }\n\n    return data;\n  }\n\n  function arrayContains(list, value) {\n    var i, length;\n\n    // value may be string, number, array, regexp\n    if (isArray(value)) {\n      // Note: this can be optimized to O(n) (instead of current O(m * n))\n      for (i = 0, length = value.length; i < length; i++) {\n        if (!arrayContains(list, value[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    var _type = getType(value);\n    for (i = 0, length = list.length; i < length; i++) {\n      if (_type === 'RegExp') {\n        if (typeof list[i] === 'string' && list[i].match(value)) {\n          return true;\n        }\n      } else if (list[i] === value) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function arraysEqual(one, two) {\n    if (!isArray(one) || !isArray(two)) {\n      return false;\n    }\n\n    // arrays can't be equal if they have different amount of content\n    if (one.length !== two.length) {\n      return false;\n    }\n\n    one.sort();\n    two.sort();\n\n    for (var i = 0, l = one.length; i < l; i++) {\n      if (one[i] !== two[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function trimSlashes(text) {\n    var trim_expression = /^\\/+|\\/+$/g;\n    return text.replace(trim_expression, '');\n  }\n\n  URI._parts = function() {\n    return {\n      protocol: null,\n      username: null,\n      password: null,\n      hostname: null,\n      urn: null,\n      port: null,\n      path: null,\n      query: null,\n      fragment: null,\n      // state\n      preventInvalidHostname: URI.preventInvalidHostname,\n      duplicateQueryParameters: URI.duplicateQueryParameters,\n      escapeQuerySpace: URI.escapeQuerySpace\n    };\n  };\n  // state: throw on invalid hostname\n  // see https://github.com/medialize/URI.js/pull/345\n  // and https://github.com/medialize/URI.js/issues/354\n  URI.preventInvalidHostname = false;\n  // state: allow duplicate query parameters (a=1&a=1)\n  URI.duplicateQueryParameters = false;\n  // state: replaces + with %20 (space in query strings)\n  URI.escapeQuerySpace = true;\n  // static properties\n  URI.protocol_expression = /^[a-z][a-z0-9.+-]*$/i;\n  URI.idn_expression = /[^a-z0-9\\._-]/i;\n  URI.punycode_expression = /(xn--)/i;\n  // well, 333.444.555.666 matches, but it sure ain't no IPv4 - do we care?\n  URI.ip4_expression = /^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/;\n  // credits to Rich Brown\n  // source: http://forums.intermapper.com/viewtopic.php?p=1096#1096\n  // specification: http://www.ietf.org/rfc/rfc4291.txt\n  URI.ip6_expression = /^\\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?\\s*$/;\n  // expression used is \"gruber revised\" (@gruber v2) determined to be the\n  // best solution in a regex-golf we did a couple of ages ago at\n  // * http://mathiasbynens.be/demo/url-regex\n  // * http://rodneyrehm.de/t/url-regex.html\n  URI.find_uri_expression = /\\b((?:[a-z][\\w-]+:(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]+|\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\))+(?:\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\)|[^\\s`!()\\[\\]{};:'\".,<>?]))/ig;\n  URI.findUri = {\n    // valid \"scheme://\" or \"www.\"\n    start: /\\b(?:([a-z][a-z0-9.+-]*:\\/\\/)|www\\.)/gi,\n    // everything up to the next whitespace\n    end: /[\\s\\r\\n]|$/,\n    // trim trailing punctuation captured by end RegExp\n    trim: /[`!()\\[\\]{};:'\".,<>?]+$/,\n    // balanced parens inclusion (), [], {}, <>\n    parens: /(\\([^\\)]*\\)|\\[[^\\]]*\\]|\\{[^}]*\\}|<[^>]*>)/g,\n  };\n  URI.leading_whitespace_expression = /^[\\x00-\\x20\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]+/\n  // https://infra.spec.whatwg.org/#ascii-tab-or-newline\n  URI.ascii_tab_whitespace = /[\\u0009\\u000A\\u000D]+/g\n  // http://www.iana.org/assignments/uri-schemes.html\n  // http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers#Well-known_ports\n  URI.defaultPorts = {\n    http: '80',\n    https: '443',\n    ftp: '21',\n    gopher: '70',\n    ws: '80',\n    wss: '443'\n  };\n  // list of protocols which always require a hostname\n  URI.hostProtocols = [\n    'http',\n    'https'\n  ];\n\n  // allowed hostname characters according to RFC 3986\n  // ALPHA DIGIT \"-\" \".\" \"_\" \"~\" \"!\" \"$\" \"&\" \"'\" \"(\" \")\" \"*\" \"+\" \",\" \";\" \"=\" %encoded\n  // I've never seen a (non-IDN) hostname other than: ALPHA DIGIT . - _\n  URI.invalid_hostname_characters = /[^a-zA-Z0-9\\.\\-:_]/;\n  // map DOM Elements to their URI attribute\n  URI.domAttributes = {\n    'a': 'href',\n    'blockquote': 'cite',\n    'link': 'href',\n    'base': 'href',\n    'script': 'src',\n    'form': 'action',\n    'img': 'src',\n    'area': 'href',\n    'iframe': 'src',\n    'embed': 'src',\n    'source': 'src',\n    'track': 'src',\n    'input': 'src', // but only if type=\"image\"\n    'audio': 'src',\n    'video': 'src'\n  };\n  URI.getDomAttribute = function(node) {\n    if (!node || !node.nodeName) {\n      return undefined;\n    }\n\n    var nodeName = node.nodeName.toLowerCase();\n    // <input> should only expose src for type=\"image\"\n    if (nodeName === 'input' && node.type !== 'image') {\n      return undefined;\n    }\n\n    return URI.domAttributes[nodeName];\n  };\n\n  function escapeForDumbFirefox36(value) {\n    // https://github.com/medialize/URI.js/issues/91\n    return escape(value);\n  }\n\n  // encoding / decoding according to RFC3986\n  function strictEncodeURIComponent(string) {\n    // see https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent\n    return encodeURIComponent(string)\n      .replace(/[!'()*]/g, escapeForDumbFirefox36)\n      .replace(/\\*/g, '%2A');\n  }\n  URI.encode = strictEncodeURIComponent;\n  URI.decode = decodeURIComponent;\n  URI.iso8859 = function() {\n    URI.encode = escape;\n    URI.decode = unescape;\n  };\n  URI.unicode = function() {\n    URI.encode = strictEncodeURIComponent;\n    URI.decode = decodeURIComponent;\n  };\n  URI.characters = {\n    pathname: {\n      encode: {\n        // RFC3986 2.1: For consistency, URI producers and normalizers should\n        // use uppercase hexadecimal digits for all percent-encodings.\n        expression: /%(24|26|2B|2C|3B|3D|3A|40)/ig,\n        map: {\n          // -._~!'()*\n          '%24': '$',\n          '%26': '&',\n          '%2B': '+',\n          '%2C': ',',\n          '%3B': ';',\n          '%3D': '=',\n          '%3A': ':',\n          '%40': '@'\n        }\n      },\n      decode: {\n        expression: /[\\/\\?#]/g,\n        map: {\n          '/': '%2F',\n          '?': '%3F',\n          '#': '%23'\n        }\n      }\n    },\n    reserved: {\n      encode: {\n        // RFC3986 2.1: For consistency, URI producers and normalizers should\n        // use uppercase hexadecimal digits for all percent-encodings.\n        expression: /%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,\n        map: {\n          // gen-delims\n          '%3A': ':',\n          '%2F': '/',\n          '%3F': '?',\n          '%23': '#',\n          '%5B': '[',\n          '%5D': ']',\n          '%40': '@',\n          // sub-delims\n          '%21': '!',\n          '%24': '$',\n          '%26': '&',\n          '%27': '\\'',\n          '%28': '(',\n          '%29': ')',\n          '%2A': '*',\n          '%2B': '+',\n          '%2C': ',',\n          '%3B': ';',\n          '%3D': '='\n        }\n      }\n    },\n    urnpath: {\n      // The characters under `encode` are the characters called out by RFC 2141 as being acceptable\n      // for usage in a URN. RFC2141 also calls out \"-\", \".\", and \"_\" as acceptable characters, but\n      // these aren't encoded by encodeURIComponent, so we don't have to call them out here. Also\n      // note that the colon character is not featured in the encoding map; this is because URI.js\n      // gives the colons in URNs semantic meaning as the delimiters of path segements, and so it\n      // should not appear unencoded in a segment itself.\n      // See also the note above about RFC3986 and capitalalized hex digits.\n      encode: {\n        expression: /%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,\n        map: {\n          '%21': '!',\n          '%24': '$',\n          '%27': '\\'',\n          '%28': '(',\n          '%29': ')',\n          '%2A': '*',\n          '%2B': '+',\n          '%2C': ',',\n          '%3B': ';',\n          '%3D': '=',\n          '%40': '@'\n        }\n      },\n      // These characters are the characters called out by RFC2141 as \"reserved\" characters that\n      // should never appear in a URN, plus the colon character (see note above).\n      decode: {\n        expression: /[\\/\\?#:]/g,\n        map: {\n          '/': '%2F',\n          '?': '%3F',\n          '#': '%23',\n          ':': '%3A'\n        }\n      }\n    }\n  };\n  URI.encodeQuery = function(string, escapeQuerySpace) {\n    var escaped = URI.encode(string + '');\n    if (escapeQuerySpace === undefined) {\n      escapeQuerySpace = URI.escapeQuerySpace;\n    }\n\n    return escapeQuerySpace ? escaped.replace(/%20/g, '+') : escaped;\n  };\n  URI.decodeQuery = function(string, escapeQuerySpace) {\n    string += '';\n    if (escapeQuerySpace === undefined) {\n      escapeQuerySpace = URI.escapeQuerySpace;\n    }\n\n    try {\n      return URI.decode(escapeQuerySpace ? string.replace(/\\+/g, '%20') : string);\n    } catch(e) {\n      // we're not going to mess with weird encodings,\n      // give up and return the undecoded original string\n      // see https://github.com/medialize/URI.js/issues/87\n      // see https://github.com/medialize/URI.js/issues/92\n      return string;\n    }\n  };\n  // generate encode/decode path functions\n  var _parts = {'encode':'encode', 'decode':'decode'};\n  var _part;\n  var generateAccessor = function(_group, _part) {\n    return function(string) {\n      try {\n        return URI[_part](string + '').replace(URI.characters[_group][_part].expression, function(c) {\n          return URI.characters[_group][_part].map[c];\n        });\n      } catch (e) {\n        // we're not going to mess with weird encodings,\n        // give up and return the undecoded original string\n        // see https://github.com/medialize/URI.js/issues/87\n        // see https://github.com/medialize/URI.js/issues/92\n        return string;\n      }\n    };\n  };\n\n  for (_part in _parts) {\n    URI[_part + 'PathSegment'] = generateAccessor('pathname', _parts[_part]);\n    URI[_part + 'UrnPathSegment'] = generateAccessor('urnpath', _parts[_part]);\n  }\n\n  var generateSegmentedPathFunction = function(_sep, _codingFuncName, _innerCodingFuncName) {\n    return function(string) {\n      // Why pass in names of functions, rather than the function objects themselves? The\n      // definitions of some functions (but in particular, URI.decode) will occasionally change due\n      // to URI.js having ISO8859 and Unicode modes. Passing in the name and getting it will ensure\n      // that the functions we use here are \"fresh\".\n      var actualCodingFunc;\n      if (!_innerCodingFuncName) {\n        actualCodingFunc = URI[_codingFuncName];\n      } else {\n        actualCodingFunc = function(string) {\n          return URI[_codingFuncName](URI[_innerCodingFuncName](string));\n        };\n      }\n\n      var segments = (string + '').split(_sep);\n\n      for (var i = 0, length = segments.length; i < length; i++) {\n        segments[i] = actualCodingFunc(segments[i]);\n      }\n\n      return segments.join(_sep);\n    };\n  };\n\n  // This takes place outside the above loop because we don't want, e.g., encodeUrnPath functions.\n  URI.decodePath = generateSegmentedPathFunction('/', 'decodePathSegment');\n  URI.decodeUrnPath = generateSegmentedPathFunction(':', 'decodeUrnPathSegment');\n  URI.recodePath = generateSegmentedPathFunction('/', 'encodePathSegment', 'decode');\n  URI.recodeUrnPath = generateSegmentedPathFunction(':', 'encodeUrnPathSegment', 'decode');\n\n  URI.encodeReserved = generateAccessor('reserved', 'encode');\n\n  URI.parse = function(string, parts) {\n    var pos;\n    if (!parts) {\n      parts = {\n        preventInvalidHostname: URI.preventInvalidHostname\n      };\n    }\n\n    string = string.replace(URI.leading_whitespace_expression, '')\n    // https://infra.spec.whatwg.org/#ascii-tab-or-newline\n    string = string.replace(URI.ascii_tab_whitespace, '')\n\n    // [protocol\"://\"[username[\":\"password]\"@\"]hostname[\":\"port]\"/\"?][path][\"?\"querystring][\"#\"fragment]\n\n    // extract fragment\n    pos = string.indexOf('#');\n    if (pos > -1) {\n      // escaping?\n      parts.fragment = string.substring(pos + 1) || null;\n      string = string.substring(0, pos);\n    }\n\n    // extract query\n    pos = string.indexOf('?');\n    if (pos > -1) {\n      // escaping?\n      parts.query = string.substring(pos + 1) || null;\n      string = string.substring(0, pos);\n    }\n\n    // slashes and backslashes have lost all meaning for the web protocols (https, http, wss, ws)\n    string = string.replace(/^(https?|ftp|wss?)?:+[/\\\\]*/i, '$1://');\n    // slashes and backslashes have lost all meaning for scheme relative URLs\n    string = string.replace(/^[/\\\\]{2,}/i, '//');\n\n    // extract protocol\n    if (string.substring(0, 2) === '//') {\n      // relative-scheme\n      parts.protocol = null;\n      string = string.substring(2);\n      // extract \"user:pass@host:port\"\n      string = URI.parseAuthority(string, parts);\n    } else {\n      pos = string.indexOf(':');\n      if (pos > -1) {\n        parts.protocol = string.substring(0, pos) || null;\n        if (parts.protocol && !parts.protocol.match(URI.protocol_expression)) {\n          // : may be within the path\n          parts.protocol = undefined;\n        } else if (string.substring(pos + 1, pos + 3).replace(/\\\\/g, '/') === '//') {\n          string = string.substring(pos + 3);\n\n          // extract \"user:pass@host:port\"\n          string = URI.parseAuthority(string, parts);\n        } else {\n          string = string.substring(pos + 1);\n          parts.urn = true;\n        }\n      }\n    }\n\n    // what's left must be the path\n    parts.path = string;\n\n    // and we're done\n    return parts;\n  };\n  URI.parseHost = function(string, parts) {\n    if (!string) {\n      string = '';\n    }\n\n    // Copy chrome, IE, opera backslash-handling behavior.\n    // Back slashes before the query string get converted to forward slashes\n    // See: https://github.com/joyent/node/blob/386fd24f49b0e9d1a8a076592a404168faeecc34/lib/url.js#L115-L124\n    // See: https://code.google.com/p/chromium/issues/detail?id=25916\n    // https://github.com/medialize/URI.js/pull/233\n    string = string.replace(/\\\\/g, '/');\n\n    // extract host:port\n    var pos = string.indexOf('/');\n    var bracketPos;\n    var t;\n\n    if (pos === -1) {\n      pos = string.length;\n    }\n\n    if (string.charAt(0) === '[') {\n      // IPv6 host - http://tools.ietf.org/html/draft-ietf-6man-text-addr-representation-04#section-6\n      // I claim most client software breaks on IPv6 anyways. To simplify things, URI only accepts\n      // IPv6+port in the format [2001:db8::1]:80 (for the time being)\n      bracketPos = string.indexOf(']');\n      parts.hostname = string.substring(1, bracketPos) || null;\n      parts.port = string.substring(bracketPos + 2, pos) || null;\n      if (parts.port === '/') {\n        parts.port = null;\n      }\n    } else {\n      var firstColon = string.indexOf(':');\n      var firstSlash = string.indexOf('/');\n      var nextColon = string.indexOf(':', firstColon + 1);\n      if (nextColon !== -1 && (firstSlash === -1 || nextColon < firstSlash)) {\n        // IPv6 host contains multiple colons - but no port\n        // this notation is actually not allowed by RFC 3986, but we're a liberal parser\n        parts.hostname = string.substring(0, pos) || null;\n        parts.port = null;\n      } else {\n        t = string.substring(0, pos).split(':');\n        parts.hostname = t[0] || null;\n        parts.port = t[1] || null;\n      }\n    }\n\n    if (parts.hostname && string.substring(pos).charAt(0) !== '/') {\n      pos++;\n      string = '/' + string;\n    }\n\n    if (parts.preventInvalidHostname) {\n      URI.ensureValidHostname(parts.hostname, parts.protocol);\n    }\n\n    if (parts.port) {\n      URI.ensureValidPort(parts.port);\n    }\n\n    return string.substring(pos) || '/';\n  };\n  URI.parseAuthority = function(string, parts) {\n    string = URI.parseUserinfo(string, parts);\n    return URI.parseHost(string, parts);\n  };\n  URI.parseUserinfo = function(string, parts) {\n    // extract username:password\n    var _string = string\n    var firstBackSlash = string.indexOf('\\\\');\n    if (firstBackSlash !== -1) {\n      string = string.replace(/\\\\/g, '/')\n    }\n    var firstSlash = string.indexOf('/');\n    var pos = string.lastIndexOf('@', firstSlash > -1 ? firstSlash : string.length - 1);\n    var t;\n\n    // authority@ must come before /path or \\path\n    if (pos > -1 && (firstSlash === -1 || pos < firstSlash)) {\n      t = string.substring(0, pos).split(':');\n      parts.username = t[0] ? URI.decode(t[0]) : null;\n      t.shift();\n      parts.password = t[0] ? URI.decode(t.join(':')) : null;\n      string = _string.substring(pos + 1);\n    } else {\n      parts.username = null;\n      parts.password = null;\n    }\n\n    return string;\n  };\n  URI.parseQuery = function(string, escapeQuerySpace) {\n    if (!string) {\n      return {};\n    }\n\n    // throw out the funky business - \"?\"[name\"=\"value\"&\"]+\n    string = string.replace(/&+/g, '&').replace(/^\\?*&*|&+$/g, '');\n\n    if (!string) {\n      return {};\n    }\n\n    var items = {};\n    var splits = string.split('&');\n    var length = splits.length;\n    var v, name, value;\n\n    for (var i = 0; i < length; i++) {\n      v = splits[i].split('=');\n      name = URI.decodeQuery(v.shift(), escapeQuerySpace);\n      // no \"=\" is null according to http://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#collect-url-parameters\n      value = v.length ? URI.decodeQuery(v.join('='), escapeQuerySpace) : null;\n\n      if (name === '__proto__') {\n        // ignore attempt at exploiting JavaScript internals\n        continue;\n      } else if (hasOwn.call(items, name)) {\n        if (typeof items[name] === 'string' || items[name] === null) {\n          items[name] = [items[name]];\n        }\n\n        items[name].push(value);\n      } else {\n        items[name] = value;\n      }\n    }\n\n    return items;\n  };\n\n  URI.build = function(parts) {\n    var t = '';\n    var requireAbsolutePath = false\n\n    if (parts.protocol) {\n      t += parts.protocol + ':';\n    }\n\n    if (!parts.urn && (t || parts.hostname)) {\n      t += '//';\n      requireAbsolutePath = true\n    }\n\n    t += (URI.buildAuthority(parts) || '');\n\n    if (typeof parts.path === 'string') {\n      if (parts.path.charAt(0) !== '/' && requireAbsolutePath) {\n        t += '/';\n      }\n\n      t += parts.path;\n    }\n\n    if (typeof parts.query === 'string' && parts.query) {\n      t += '?' + parts.query;\n    }\n\n    if (typeof parts.fragment === 'string' && parts.fragment) {\n      t += '#' + parts.fragment;\n    }\n    return t;\n  };\n  URI.buildHost = function(parts) {\n    var t = '';\n\n    if (!parts.hostname) {\n      return '';\n    } else if (URI.ip6_expression.test(parts.hostname)) {\n      t += '[' + parts.hostname + ']';\n    } else {\n      t += parts.hostname;\n    }\n\n    if (parts.port) {\n      t += ':' + parts.port;\n    }\n\n    return t;\n  };\n  URI.buildAuthority = function(parts) {\n    return URI.buildUserinfo(parts) + URI.buildHost(parts);\n  };\n  URI.buildUserinfo = function(parts) {\n    var t = '';\n\n    if (parts.username) {\n      t += URI.encode(parts.username);\n    }\n\n    if (parts.password) {\n      t += ':' + URI.encode(parts.password);\n    }\n\n    if (t) {\n      t += '@';\n    }\n\n    return t;\n  };\n  URI.buildQuery = function(data, duplicateQueryParameters, escapeQuerySpace) {\n    // according to http://tools.ietf.org/html/rfc3986 or http://labs.apache.org/webarch/uri/rfc/rfc3986.html\n    // being -._~!$&'()*+,;=:@/? %HEX and alnum are allowed\n    // the RFC explicitly states ?/foo being a valid use case, no mention of parameter syntax!\n    // URI.js treats the query string as being application/x-www-form-urlencoded\n    // see http://www.w3.org/TR/REC-html40/interact/forms.html#form-content-type\n\n    var t = '';\n    var unique, key, i, length;\n    for (key in data) {\n      if (key === '__proto__') {\n        // ignore attempt at exploiting JavaScript internals\n        continue;\n      } else if (hasOwn.call(data, key)) {\n        if (isArray(data[key])) {\n          unique = {};\n          for (i = 0, length = data[key].length; i < length; i++) {\n            if (data[key][i] !== undefined && unique[data[key][i] + ''] === undefined) {\n              t += '&' + URI.buildQueryParameter(key, data[key][i], escapeQuerySpace);\n              if (duplicateQueryParameters !== true) {\n                unique[data[key][i] + ''] = true;\n              }\n            }\n          }\n        } else if (data[key] !== undefined) {\n          t += '&' + URI.buildQueryParameter(key, data[key], escapeQuerySpace);\n        }\n      }\n    }\n\n    return t.substring(1);\n  };\n  URI.buildQueryParameter = function(name, value, escapeQuerySpace) {\n    // http://www.w3.org/TR/REC-html40/interact/forms.html#form-content-type -- application/x-www-form-urlencoded\n    // don't append \"=\" for null values, according to http://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#url-parameter-serialization\n    return URI.encodeQuery(name, escapeQuerySpace) + (value !== null ? '=' + URI.encodeQuery(value, escapeQuerySpace) : '');\n  };\n\n  URI.addQuery = function(data, name, value) {\n    if (typeof name === 'object') {\n      for (var key in name) {\n        if (hasOwn.call(name, key)) {\n          URI.addQuery(data, key, name[key]);\n        }\n      }\n    } else if (typeof name === 'string') {\n      if (data[name] === undefined) {\n        data[name] = value;\n        return;\n      } else if (typeof data[name] === 'string') {\n        data[name] = [data[name]];\n      }\n\n      if (!isArray(value)) {\n        value = [value];\n      }\n\n      data[name] = (data[name] || []).concat(value);\n    } else {\n      throw new TypeError('URI.addQuery() accepts an object, string as the name parameter');\n    }\n  };\n\n  URI.setQuery = function(data, name, value) {\n    if (typeof name === 'object') {\n      for (var key in name) {\n        if (hasOwn.call(name, key)) {\n          URI.setQuery(data, key, name[key]);\n        }\n      }\n    } else if (typeof name === 'string') {\n      data[name] = value === undefined ? null : value;\n    } else {\n      throw new TypeError('URI.setQuery() accepts an object, string as the name parameter');\n    }\n  };\n\n  URI.removeQuery = function(data, name, value) {\n    var i, length, key;\n\n    if (isArray(name)) {\n      for (i = 0, length = name.length; i < length; i++) {\n        data[name[i]] = undefined;\n      }\n    } else if (getType(name) === 'RegExp') {\n      for (key in data) {\n        if (name.test(key)) {\n          data[key] = undefined;\n        }\n      }\n    } else if (typeof name === 'object') {\n      for (key in name) {\n        if (hasOwn.call(name, key)) {\n          URI.removeQuery(data, key, name[key]);\n        }\n      }\n    } else if (typeof name === 'string') {\n      if (value !== undefined) {\n        if (getType(value) === 'RegExp') {\n          if (!isArray(data[name]) && value.test(data[name])) {\n            data[name] = undefined;\n          } else {\n            data[name] = filterArrayValues(data[name], value);\n          }\n        } else if (data[name] === String(value) && (!isArray(value) || value.length === 1)) {\n          data[name] = undefined;\n        } else if (isArray(data[name])) {\n          data[name] = filterArrayValues(data[name], value);\n        }\n      } else {\n        data[name] = undefined;\n      }\n    } else {\n      throw new TypeError('URI.removeQuery() accepts an object, string, RegExp as the first parameter');\n    }\n  };\n  URI.hasQuery = function(data, name, value, withinArray) {\n    switch (getType(name)) {\n      case 'String':\n        // Nothing to do here\n        break;\n\n      case 'RegExp':\n        for (var key in data) {\n          if (hasOwn.call(data, key)) {\n            if (name.test(key) && (value === undefined || URI.hasQuery(data, key, value))) {\n              return true;\n            }\n          }\n        }\n\n        return false;\n\n      case 'Object':\n        for (var _key in name) {\n          if (hasOwn.call(name, _key)) {\n            if (!URI.hasQuery(data, _key, name[_key])) {\n              return false;\n            }\n          }\n        }\n\n        return true;\n\n      default:\n        throw new TypeError('URI.hasQuery() accepts a string, regular expression or object as the name parameter');\n    }\n\n    switch (getType(value)) {\n      case 'Undefined':\n        // true if exists (but may be empty)\n        return name in data; // data[name] !== undefined;\n\n      case 'Boolean':\n        // true if exists and non-empty\n        var _booly = Boolean(isArray(data[name]) ? data[name].length : data[name]);\n        return value === _booly;\n\n      case 'Function':\n        // allow complex comparison\n        return !!value(data[name], name, data);\n\n      case 'Array':\n        if (!isArray(data[name])) {\n          return false;\n        }\n\n        var op = withinArray ? arrayContains : arraysEqual;\n        return op(data[name], value);\n\n      case 'RegExp':\n        if (!isArray(data[name])) {\n          return Boolean(data[name] && data[name].match(value));\n        }\n\n        if (!withinArray) {\n          return false;\n        }\n\n        return arrayContains(data[name], value);\n\n      case 'Number':\n        value = String(value);\n        /* falls through */\n      case 'String':\n        if (!isArray(data[name])) {\n          return data[name] === value;\n        }\n\n        if (!withinArray) {\n          return false;\n        }\n\n        return arrayContains(data[name], value);\n\n      default:\n        throw new TypeError('URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter');\n    }\n  };\n\n\n  URI.joinPaths = function() {\n    var input = [];\n    var segments = [];\n    var nonEmptySegments = 0;\n\n    for (var i = 0; i < arguments.length; i++) {\n      var url = new URI(arguments[i]);\n      input.push(url);\n      var _segments = url.segment();\n      for (var s = 0; s < _segments.length; s++) {\n        if (typeof _segments[s] === 'string') {\n          segments.push(_segments[s]);\n        }\n\n        if (_segments[s]) {\n          nonEmptySegments++;\n        }\n      }\n    }\n\n    if (!segments.length || !nonEmptySegments) {\n      return new URI('');\n    }\n\n    var uri = new URI('').segment(segments);\n\n    if (input[0].path() === '' || input[0].path().slice(0, 1) === '/') {\n      uri.path('/' + uri.path());\n    }\n\n    return uri.normalize();\n  };\n\n  URI.commonPath = function(one, two) {\n    var length = Math.min(one.length, two.length);\n    var pos;\n\n    // find first non-matching character\n    for (pos = 0; pos < length; pos++) {\n      if (one.charAt(pos) !== two.charAt(pos)) {\n        pos--;\n        break;\n      }\n    }\n\n    if (pos < 1) {\n      return one.charAt(0) === two.charAt(0) && one.charAt(0) === '/' ? '/' : '';\n    }\n\n    // revert to last /\n    if (one.charAt(pos) !== '/' || two.charAt(pos) !== '/') {\n      pos = one.substring(0, pos).lastIndexOf('/');\n    }\n\n    return one.substring(0, pos + 1);\n  };\n\n  URI.withinString = function(string, callback, options) {\n    options || (options = {});\n    var _start = options.start || URI.findUri.start;\n    var _end = options.end || URI.findUri.end;\n    var _trim = options.trim || URI.findUri.trim;\n    var _parens = options.parens || URI.findUri.parens;\n    var _attributeOpen = /[a-z0-9-]=[\"']?$/i;\n\n    _start.lastIndex = 0;\n    while (true) {\n      var match = _start.exec(string);\n      if (!match) {\n        break;\n      }\n\n      var start = match.index;\n      if (options.ignoreHtml) {\n        // attribut(e=[\"']?$)\n        var attributeOpen = string.slice(Math.max(start - 3, 0), start);\n        if (attributeOpen && _attributeOpen.test(attributeOpen)) {\n          continue;\n        }\n      }\n\n      var end = start + string.slice(start).search(_end);\n      var slice = string.slice(start, end);\n      // make sure we include well balanced parens\n      var parensEnd = -1;\n      while (true) {\n        var parensMatch = _parens.exec(slice);\n        if (!parensMatch) {\n          break;\n        }\n\n        var parensMatchEnd = parensMatch.index + parensMatch[0].length;\n        parensEnd = Math.max(parensEnd, parensMatchEnd);\n      }\n\n      if (parensEnd > -1) {\n        slice = slice.slice(0, parensEnd) + slice.slice(parensEnd).replace(_trim, '');\n      } else {\n        slice = slice.replace(_trim, '');\n      }\n\n      if (slice.length <= match[0].length) {\n        // the extract only contains the starting marker of a URI,\n        // e.g. \"www\" or \"http://\"\n        continue;\n      }\n\n      if (options.ignore && options.ignore.test(slice)) {\n        continue;\n      }\n\n      end = start + slice.length;\n      var result = callback(slice, start, end, string);\n      if (result === undefined) {\n        _start.lastIndex = end;\n        continue;\n      }\n\n      result = String(result);\n      string = string.slice(0, start) + result + string.slice(end);\n      _start.lastIndex = start + result.length;\n    }\n\n    _start.lastIndex = 0;\n    return string;\n  };\n\n  URI.ensureValidHostname = function(v, protocol) {\n    // Theoretically URIs allow percent-encoding in Hostnames (according to RFC 3986)\n    // they are not part of DNS and therefore ignored by URI.js\n\n    var hasHostname = !!v; // not null and not an empty string\n    var hasProtocol = !!protocol;\n    var rejectEmptyHostname = false;\n\n    if (hasProtocol) {\n      rejectEmptyHostname = arrayContains(URI.hostProtocols, protocol);\n    }\n\n    if (rejectEmptyHostname && !hasHostname) {\n      throw new TypeError('Hostname cannot be empty, if protocol is ' + protocol);\n    } else if (v && v.match(URI.invalid_hostname_characters)) {\n      // test punycode\n      if (!punycode) {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');\n      }\n      if (punycode.toASCII(v).match(URI.invalid_hostname_characters)) {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-:_]');\n      }\n    }\n  };\n\n  URI.ensureValidPort = function (v) {\n    if (!v) {\n      return;\n    }\n\n    var port = Number(v);\n    if (isInteger(port) && (port > 0) && (port < 65536)) {\n      return;\n    }\n\n    throw new TypeError('Port \"' + v + '\" is not a valid port');\n  };\n\n  // noConflict\n  URI.noConflict = function(removeAll) {\n    if (removeAll) {\n      var unconflicted = {\n        URI: this.noConflict()\n      };\n\n      if (root.URITemplate && typeof root.URITemplate.noConflict === 'function') {\n        unconflicted.URITemplate = root.URITemplate.noConflict();\n      }\n\n      if (root.IPv6 && typeof root.IPv6.noConflict === 'function') {\n        unconflicted.IPv6 = root.IPv6.noConflict();\n      }\n\n      if (root.SecondLevelDomains && typeof root.SecondLevelDomains.noConflict === 'function') {\n        unconflicted.SecondLevelDomains = root.SecondLevelDomains.noConflict();\n      }\n\n      return unconflicted;\n    } else if (root.URI === this) {\n      root.URI = _URI;\n    }\n\n    return this;\n  };\n\n  p.build = function(deferBuild) {\n    if (deferBuild === true) {\n      this._deferred_build = true;\n    } else if (deferBuild === undefined || this._deferred_build) {\n      this._string = URI.build(this._parts);\n      this._deferred_build = false;\n    }\n\n    return this;\n  };\n\n  p.clone = function() {\n    return new URI(this);\n  };\n\n  p.valueOf = p.toString = function() {\n    return this.build(false)._string;\n  };\n\n\n  function generateSimpleAccessor(_part){\n    return function(v, build) {\n      if (v === undefined) {\n        return this._parts[_part] || '';\n      } else {\n        this._parts[_part] = v || null;\n        this.build(!build);\n        return this;\n      }\n    };\n  }\n\n  function generatePrefixAccessor(_part, _key){\n    return function(v, build) {\n      if (v === undefined) {\n        return this._parts[_part] || '';\n      } else {\n        if (v !== null) {\n          v = v + '';\n          if (v.charAt(0) === _key) {\n            v = v.substring(1);\n          }\n        }\n\n        this._parts[_part] = v;\n        this.build(!build);\n        return this;\n      }\n    };\n  }\n\n  p.protocol = generateSimpleAccessor('protocol');\n  p.username = generateSimpleAccessor('username');\n  p.password = generateSimpleAccessor('password');\n  p.hostname = generateSimpleAccessor('hostname');\n  p.port = generateSimpleAccessor('port');\n  p.query = generatePrefixAccessor('query', '?');\n  p.fragment = generatePrefixAccessor('fragment', '#');\n\n  p.search = function(v, build) {\n    var t = this.query(v, build);\n    return typeof t === 'string' && t.length ? ('?' + t) : t;\n  };\n  p.hash = function(v, build) {\n    var t = this.fragment(v, build);\n    return typeof t === 'string' && t.length ? ('#' + t) : t;\n  };\n\n  p.pathname = function(v, build) {\n    if (v === undefined || v === true) {\n      var res = this._parts.path || (this._parts.hostname ? '/' : '');\n      return v ? (this._parts.urn ? URI.decodeUrnPath : URI.decodePath)(res) : res;\n    } else {\n      if (this._parts.urn) {\n        this._parts.path = v ? URI.recodeUrnPath(v) : '';\n      } else {\n        this._parts.path = v ? URI.recodePath(v) : '/';\n      }\n      this.build(!build);\n      return this;\n    }\n  };\n  p.path = p.pathname;\n  p.href = function(href, build) {\n    var key;\n\n    if (href === undefined) {\n      return this.toString();\n    }\n\n    this._string = '';\n    this._parts = URI._parts();\n\n    var _URI = href instanceof URI;\n    var _object = typeof href === 'object' && (href.hostname || href.path || href.pathname);\n    if (href.nodeName) {\n      var attribute = URI.getDomAttribute(href);\n      href = href[attribute] || '';\n      _object = false;\n    }\n\n    // window.location is reported to be an object, but it's not the sort\n    // of object we're looking for:\n    // * location.protocol ends with a colon\n    // * location.query != object.search\n    // * location.hash != object.fragment\n    // simply serializing the unknown object should do the trick\n    // (for location, not for everything...)\n    if (!_URI && _object && href.pathname !== undefined) {\n      href = href.toString();\n    }\n\n    if (typeof href === 'string' || href instanceof String) {\n      this._parts = URI.parse(String(href), this._parts);\n    } else if (_URI || _object) {\n      var src = _URI ? href._parts : href;\n      for (key in src) {\n        if (key === 'query') { continue; }\n        if (hasOwn.call(this._parts, key)) {\n          this._parts[key] = src[key];\n        }\n      }\n      if (src.query) {\n        this.query(src.query, false);\n      }\n    } else {\n      throw new TypeError('invalid input');\n    }\n\n    this.build(!build);\n    return this;\n  };\n\n  // identification accessors\n  p.is = function(what) {\n    var ip = false;\n    var ip4 = false;\n    var ip6 = false;\n    var name = false;\n    var sld = false;\n    var idn = false;\n    var punycode = false;\n    var relative = !this._parts.urn;\n\n    if (this._parts.hostname) {\n      relative = false;\n      ip4 = URI.ip4_expression.test(this._parts.hostname);\n      ip6 = URI.ip6_expression.test(this._parts.hostname);\n      ip = ip4 || ip6;\n      name = !ip;\n      sld = name && SLD && SLD.has(this._parts.hostname);\n      idn = name && URI.idn_expression.test(this._parts.hostname);\n      punycode = name && URI.punycode_expression.test(this._parts.hostname);\n    }\n\n    switch (what.toLowerCase()) {\n      case 'relative':\n        return relative;\n\n      case 'absolute':\n        return !relative;\n\n      // hostname identification\n      case 'domain':\n      case 'name':\n        return name;\n\n      case 'sld':\n        return sld;\n\n      case 'ip':\n        return ip;\n\n      case 'ip4':\n      case 'ipv4':\n      case 'inet4':\n        return ip4;\n\n      case 'ip6':\n      case 'ipv6':\n      case 'inet6':\n        return ip6;\n\n      case 'idn':\n        return idn;\n\n      case 'url':\n        return !this._parts.urn;\n\n      case 'urn':\n        return !!this._parts.urn;\n\n      case 'punycode':\n        return punycode;\n    }\n\n    return null;\n  };\n\n  // component specific input validation\n  var _protocol = p.protocol;\n  var _port = p.port;\n  var _hostname = p.hostname;\n\n  p.protocol = function(v, build) {\n    if (v) {\n      // accept trailing ://\n      v = v.replace(/:(\\/\\/)?$/, '');\n\n      if (!v.match(URI.protocol_expression)) {\n        throw new TypeError('Protocol \"' + v + '\" contains characters other than [A-Z0-9.+-] or doesn\\'t start with [A-Z]');\n      }\n    }\n\n    return _protocol.call(this, v, build);\n  };\n  p.scheme = p.protocol;\n  p.port = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v !== undefined) {\n      if (v === 0) {\n        v = null;\n      }\n\n      if (v) {\n        v += '';\n        if (v.charAt(0) === ':') {\n          v = v.substring(1);\n        }\n\n        URI.ensureValidPort(v);\n      }\n    }\n    return _port.call(this, v, build);\n  };\n  p.hostname = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v !== undefined) {\n      var x = { preventInvalidHostname: this._parts.preventInvalidHostname };\n      var res = URI.parseHost(v, x);\n      if (res !== '/') {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-]');\n      }\n\n      v = x.hostname;\n      if (this._parts.preventInvalidHostname) {\n        URI.ensureValidHostname(v, this._parts.protocol);\n      }\n    }\n\n    return _hostname.call(this, v, build);\n  };\n\n  // compound accessors\n  p.origin = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      var protocol = this.protocol();\n      var authority = this.authority();\n      if (!authority) {\n        return '';\n      }\n\n      return (protocol ? protocol + '://' : '') + this.authority();\n    } else {\n      var origin = URI(v);\n      this\n        .protocol(origin.protocol())\n        .authority(origin.authority())\n        .build(!build);\n      return this;\n    }\n  };\n  p.host = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      return this._parts.hostname ? URI.buildHost(this._parts) : '';\n    } else {\n      var res = URI.parseHost(v, this._parts);\n      if (res !== '/') {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-]');\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.authority = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      return this._parts.hostname ? URI.buildAuthority(this._parts) : '';\n    } else {\n      var res = URI.parseAuthority(v, this._parts);\n      if (res !== '/') {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-]');\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.userinfo = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      var t = URI.buildUserinfo(this._parts);\n      return t ? t.substring(0, t.length -1) : t;\n    } else {\n      if (v[v.length-1] !== '@') {\n        v += '@';\n      }\n\n      URI.parseUserinfo(v, this._parts);\n      this.build(!build);\n      return this;\n    }\n  };\n  p.resource = function(v, build) {\n    var parts;\n\n    if (v === undefined) {\n      return this.path() + this.search() + this.hash();\n    }\n\n    parts = URI.parse(v);\n    this._parts.path = parts.path;\n    this._parts.query = parts.query;\n    this._parts.fragment = parts.fragment;\n    this.build(!build);\n    return this;\n  };\n\n  // fraction accessors\n  p.subdomain = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    // convenience, return \"www\" from \"www.example.org\"\n    if (v === undefined) {\n      if (!this._parts.hostname || this.is('IP')) {\n        return '';\n      }\n\n      // grab domain and add another segment\n      var end = this._parts.hostname.length - this.domain().length - 1;\n      return this._parts.hostname.substring(0, end) || '';\n    } else {\n      var e = this._parts.hostname.length - this.domain().length;\n      var sub = this._parts.hostname.substring(0, e);\n      var replace = new RegExp('^' + escapeRegEx(sub));\n\n      if (v && v.charAt(v.length - 1) !== '.') {\n        v += '.';\n      }\n\n      if (v.indexOf(':') !== -1) {\n        throw new TypeError('Domains cannot contain colons');\n      }\n\n      if (v) {\n        URI.ensureValidHostname(v, this._parts.protocol);\n      }\n\n      this._parts.hostname = this._parts.hostname.replace(replace, v);\n      this.build(!build);\n      return this;\n    }\n  };\n  p.domain = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (typeof v === 'boolean') {\n      build = v;\n      v = undefined;\n    }\n\n    // convenience, return \"example.org\" from \"www.example.org\"\n    if (v === undefined) {\n      if (!this._parts.hostname || this.is('IP')) {\n        return '';\n      }\n\n      // if hostname consists of 1 or 2 segments, it must be the domain\n      var t = this._parts.hostname.match(/\\./g);\n      if (t && t.length < 2) {\n        return this._parts.hostname;\n      }\n\n      // grab tld and add another segment\n      var end = this._parts.hostname.length - this.tld(build).length - 1;\n      end = this._parts.hostname.lastIndexOf('.', end -1) + 1;\n      return this._parts.hostname.substring(end) || '';\n    } else {\n      if (!v) {\n        throw new TypeError('cannot set domain empty');\n      }\n\n      if (v.indexOf(':') !== -1) {\n        throw new TypeError('Domains cannot contain colons');\n      }\n\n      URI.ensureValidHostname(v, this._parts.protocol);\n\n      if (!this._parts.hostname || this.is('IP')) {\n        this._parts.hostname = v;\n      } else {\n        var replace = new RegExp(escapeRegEx(this.domain()) + '$');\n        this._parts.hostname = this._parts.hostname.replace(replace, v);\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.tld = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (typeof v === 'boolean') {\n      build = v;\n      v = undefined;\n    }\n\n    // return \"org\" from \"www.example.org\"\n    if (v === undefined) {\n      if (!this._parts.hostname || this.is('IP')) {\n        return '';\n      }\n\n      var pos = this._parts.hostname.lastIndexOf('.');\n      var tld = this._parts.hostname.substring(pos + 1);\n\n      if (build !== true && SLD && SLD.list[tld.toLowerCase()]) {\n        return SLD.get(this._parts.hostname) || tld;\n      }\n\n      return tld;\n    } else {\n      var replace;\n\n      if (!v) {\n        throw new TypeError('cannot set TLD empty');\n      } else if (v.match(/[^a-zA-Z0-9-]/)) {\n        if (SLD && SLD.is(v)) {\n          replace = new RegExp(escapeRegEx(this.tld()) + '$');\n          this._parts.hostname = this._parts.hostname.replace(replace, v);\n        } else {\n          throw new TypeError('TLD \"' + v + '\" contains characters other than [A-Z0-9]');\n        }\n      } else if (!this._parts.hostname || this.is('IP')) {\n        throw new ReferenceError('cannot set TLD on non-domain host');\n      } else {\n        replace = new RegExp(escapeRegEx(this.tld()) + '$');\n        this._parts.hostname = this._parts.hostname.replace(replace, v);\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.directory = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined || v === true) {\n      if (!this._parts.path && !this._parts.hostname) {\n        return '';\n      }\n\n      if (this._parts.path === '/') {\n        return '/';\n      }\n\n      var end = this._parts.path.length - this.filename().length - 1;\n      var res = this._parts.path.substring(0, end) || (this._parts.hostname ? '/' : '');\n\n      return v ? URI.decodePath(res) : res;\n\n    } else {\n      var e = this._parts.path.length - this.filename().length;\n      var directory = this._parts.path.substring(0, e);\n      var replace = new RegExp('^' + escapeRegEx(directory));\n\n      // fully qualifier directories begin with a slash\n      if (!this.is('relative')) {\n        if (!v) {\n          v = '/';\n        }\n\n        if (v.charAt(0) !== '/') {\n          v = '/' + v;\n        }\n      }\n\n      // directories always end with a slash\n      if (v && v.charAt(v.length - 1) !== '/') {\n        v += '/';\n      }\n\n      v = URI.recodePath(v);\n      this._parts.path = this._parts.path.replace(replace, v);\n      this.build(!build);\n      return this;\n    }\n  };\n  p.filename = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (typeof v !== 'string') {\n      if (!this._parts.path || this._parts.path === '/') {\n        return '';\n      }\n\n      var pos = this._parts.path.lastIndexOf('/');\n      var res = this._parts.path.substring(pos+1);\n\n      return v ? URI.decodePathSegment(res) : res;\n    } else {\n      var mutatedDirectory = false;\n\n      if (v.charAt(0) === '/') {\n        v = v.substring(1);\n      }\n\n      if (v.match(/\\.?\\//)) {\n        mutatedDirectory = true;\n      }\n\n      var replace = new RegExp(escapeRegEx(this.filename()) + '$');\n      v = URI.recodePath(v);\n      this._parts.path = this._parts.path.replace(replace, v);\n\n      if (mutatedDirectory) {\n        this.normalizePath(build);\n      } else {\n        this.build(!build);\n      }\n\n      return this;\n    }\n  };\n  p.suffix = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined || v === true) {\n      if (!this._parts.path || this._parts.path === '/') {\n        return '';\n      }\n\n      var filename = this.filename();\n      var pos = filename.lastIndexOf('.');\n      var s, res;\n\n      if (pos === -1) {\n        return '';\n      }\n\n      // suffix may only contain alnum characters (yup, I made this up.)\n      s = filename.substring(pos+1);\n      res = (/^[a-z0-9%]+$/i).test(s) ? s : '';\n      return v ? URI.decodePathSegment(res) : res;\n    } else {\n      if (v.charAt(0) === '.') {\n        v = v.substring(1);\n      }\n\n      var suffix = this.suffix();\n      var replace;\n\n      if (!suffix) {\n        if (!v) {\n          return this;\n        }\n\n        this._parts.path += '.' + URI.recodePath(v);\n      } else if (!v) {\n        replace = new RegExp(escapeRegEx('.' + suffix) + '$');\n      } else {\n        replace = new RegExp(escapeRegEx(suffix) + '$');\n      }\n\n      if (replace) {\n        v = URI.recodePath(v);\n        this._parts.path = this._parts.path.replace(replace, v);\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.segment = function(segment, v, build) {\n    var separator = this._parts.urn ? ':' : '/';\n    var path = this.path();\n    var absolute = path.substring(0, 1) === '/';\n    var segments = path.split(separator);\n\n    if (segment !== undefined && typeof segment !== 'number') {\n      build = v;\n      v = segment;\n      segment = undefined;\n    }\n\n    if (segment !== undefined && typeof segment !== 'number') {\n      throw new Error('Bad segment \"' + segment + '\", must be 0-based integer');\n    }\n\n    if (absolute) {\n      segments.shift();\n    }\n\n    if (segment < 0) {\n      // allow negative indexes to address from the end\n      segment = Math.max(segments.length + segment, 0);\n    }\n\n    if (v === undefined) {\n      /*jshint laxbreak: true */\n      return segment === undefined\n        ? segments\n        : segments[segment];\n      /*jshint laxbreak: false */\n    } else if (segment === null || segments[segment] === undefined) {\n      if (isArray(v)) {\n        segments = [];\n        // collapse empty elements within array\n        for (var i=0, l=v.length; i < l; i++) {\n          if (!v[i].length && (!segments.length || !segments[segments.length -1].length)) {\n            continue;\n          }\n\n          if (segments.length && !segments[segments.length -1].length) {\n            segments.pop();\n          }\n\n          segments.push(trimSlashes(v[i]));\n        }\n      } else if (v || typeof v === 'string') {\n        v = trimSlashes(v);\n        if (segments[segments.length -1] === '') {\n          // empty trailing elements have to be overwritten\n          // to prevent results such as /foo//bar\n          segments[segments.length -1] = v;\n        } else {\n          segments.push(v);\n        }\n      }\n    } else {\n      if (v) {\n        segments[segment] = trimSlashes(v);\n      } else {\n        segments.splice(segment, 1);\n      }\n    }\n\n    if (absolute) {\n      segments.unshift('');\n    }\n\n    return this.path(segments.join(separator), build);\n  };\n  p.segmentCoded = function(segment, v, build) {\n    var segments, i, l;\n\n    if (typeof segment !== 'number') {\n      build = v;\n      v = segment;\n      segment = undefined;\n    }\n\n    if (v === undefined) {\n      segments = this.segment(segment, v, build);\n      if (!isArray(segments)) {\n        segments = segments !== undefined ? URI.decode(segments) : undefined;\n      } else {\n        for (i = 0, l = segments.length; i < l; i++) {\n          segments[i] = URI.decode(segments[i]);\n        }\n      }\n\n      return segments;\n    }\n\n    if (!isArray(v)) {\n      v = (typeof v === 'string' || v instanceof String) ? URI.encode(v) : v;\n    } else {\n      for (i = 0, l = v.length; i < l; i++) {\n        v[i] = URI.encode(v[i]);\n      }\n    }\n\n    return this.segment(segment, v, build);\n  };\n\n  // mutating query string\n  var q = p.query;\n  p.query = function(v, build) {\n    if (v === true) {\n      return URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    } else if (typeof v === 'function') {\n      var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n      var result = v.call(this, data);\n      this._parts.query = URI.buildQuery(result || data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n      this.build(!build);\n      return this;\n    } else if (v !== undefined && typeof v !== 'string') {\n      this._parts.query = URI.buildQuery(v, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n      this.build(!build);\n      return this;\n    } else {\n      return q.call(this, v, build);\n    }\n  };\n  p.setQuery = function(name, value, build) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n\n    if (typeof name === 'string' || name instanceof String) {\n      data[name] = value !== undefined ? value : null;\n    } else if (typeof name === 'object') {\n      for (var key in name) {\n        if (hasOwn.call(name, key)) {\n          data[key] = name[key];\n        }\n      }\n    } else {\n      throw new TypeError('URI.addQuery() accepts an object, string as the name parameter');\n    }\n\n    this._parts.query = URI.buildQuery(data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n    if (typeof name !== 'string') {\n      build = value;\n    }\n\n    this.build(!build);\n    return this;\n  };\n  p.addQuery = function(name, value, build) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    URI.addQuery(data, name, value === undefined ? null : value);\n    this._parts.query = URI.buildQuery(data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n    if (typeof name !== 'string') {\n      build = value;\n    }\n\n    this.build(!build);\n    return this;\n  };\n  p.removeQuery = function(name, value, build) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    URI.removeQuery(data, name, value);\n    this._parts.query = URI.buildQuery(data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n    if (typeof name !== 'string') {\n      build = value;\n    }\n\n    this.build(!build);\n    return this;\n  };\n  p.hasQuery = function(name, value, withinArray) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    return URI.hasQuery(data, name, value, withinArray);\n  };\n  p.setSearch = p.setQuery;\n  p.addSearch = p.addQuery;\n  p.removeSearch = p.removeQuery;\n  p.hasSearch = p.hasQuery;\n\n  // sanitizing URLs\n  p.normalize = function() {\n    if (this._parts.urn) {\n      return this\n        .normalizeProtocol(false)\n        .normalizePath(false)\n        .normalizeQuery(false)\n        .normalizeFragment(false)\n        .build();\n    }\n\n    return this\n      .normalizeProtocol(false)\n      .normalizeHostname(false)\n      .normalizePort(false)\n      .normalizePath(false)\n      .normalizeQuery(false)\n      .normalizeFragment(false)\n      .build();\n  };\n  p.normalizeProtocol = function(build) {\n    if (typeof this._parts.protocol === 'string') {\n      this._parts.protocol = this._parts.protocol.toLowerCase();\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizeHostname = function(build) {\n    if (this._parts.hostname) {\n      if (this.is('IDN') && punycode) {\n        this._parts.hostname = punycode.toASCII(this._parts.hostname);\n      } else if (this.is('IPv6') && IPv6) {\n        this._parts.hostname = IPv6.best(this._parts.hostname);\n      }\n\n      this._parts.hostname = this._parts.hostname.toLowerCase();\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizePort = function(build) {\n    // remove port of it's the protocol's default\n    if (typeof this._parts.protocol === 'string' && this._parts.port === URI.defaultPorts[this._parts.protocol]) {\n      this._parts.port = null;\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizePath = function(build) {\n    var _path = this._parts.path;\n    if (!_path) {\n      return this;\n    }\n\n    if (this._parts.urn) {\n      this._parts.path = URI.recodeUrnPath(this._parts.path);\n      this.build(!build);\n      return this;\n    }\n\n    if (this._parts.path === '/') {\n      return this;\n    }\n\n    _path = URI.recodePath(_path);\n\n    var _was_relative;\n    var _leadingParents = '';\n    var _parent, _pos;\n\n    // handle relative paths\n    if (_path.charAt(0) !== '/') {\n      _was_relative = true;\n      _path = '/' + _path;\n    }\n\n    // handle relative files (as opposed to directories)\n    if (_path.slice(-3) === '/..' || _path.slice(-2) === '/.') {\n      _path += '/';\n    }\n\n    // resolve simples\n    _path = _path\n      .replace(/(\\/(\\.\\/)+)|(\\/\\.$)/g, '/')\n      .replace(/\\/{2,}/g, '/');\n\n    // remember leading parents\n    if (_was_relative) {\n      _leadingParents = _path.substring(1).match(/^(\\.\\.\\/)+/) || '';\n      if (_leadingParents) {\n        _leadingParents = _leadingParents[0];\n      }\n    }\n\n    // resolve parents\n    while (true) {\n      _parent = _path.search(/\\/\\.\\.(\\/|$)/);\n      if (_parent === -1) {\n        // no more ../ to resolve\n        break;\n      } else if (_parent === 0) {\n        // top level cannot be relative, skip it\n        _path = _path.substring(3);\n        continue;\n      }\n\n      _pos = _path.substring(0, _parent).lastIndexOf('/');\n      if (_pos === -1) {\n        _pos = _parent;\n      }\n      _path = _path.substring(0, _pos) + _path.substring(_parent + 3);\n    }\n\n    // revert to relative\n    if (_was_relative && this.is('relative')) {\n      _path = _leadingParents + _path.substring(1);\n    }\n\n    this._parts.path = _path;\n    this.build(!build);\n    return this;\n  };\n  p.normalizePathname = p.normalizePath;\n  p.normalizeQuery = function(build) {\n    if (typeof this._parts.query === 'string') {\n      if (!this._parts.query.length) {\n        this._parts.query = null;\n      } else {\n        this.query(URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace));\n      }\n\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizeFragment = function(build) {\n    if (!this._parts.fragment) {\n      this._parts.fragment = null;\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizeSearch = p.normalizeQuery;\n  p.normalizeHash = p.normalizeFragment;\n\n  p.iso8859 = function() {\n    // expect unicode input, iso8859 output\n    var e = URI.encode;\n    var d = URI.decode;\n\n    URI.encode = escape;\n    URI.decode = decodeURIComponent;\n    try {\n      this.normalize();\n    } finally {\n      URI.encode = e;\n      URI.decode = d;\n    }\n    return this;\n  };\n\n  p.unicode = function() {\n    // expect iso8859 input, unicode output\n    var e = URI.encode;\n    var d = URI.decode;\n\n    URI.encode = strictEncodeURIComponent;\n    URI.decode = unescape;\n    try {\n      this.normalize();\n    } finally {\n      URI.encode = e;\n      URI.decode = d;\n    }\n    return this;\n  };\n\n  p.readable = function() {\n    var uri = this.clone();\n    // removing username, password, because they shouldn't be displayed according to RFC 3986\n    uri.username('').password('').normalize();\n    var t = '';\n    if (uri._parts.protocol) {\n      t += uri._parts.protocol + '://';\n    }\n\n    if (uri._parts.hostname) {\n      if (uri.is('punycode') && punycode) {\n        t += punycode.toUnicode(uri._parts.hostname);\n        if (uri._parts.port) {\n          t += ':' + uri._parts.port;\n        }\n      } else {\n        t += uri.host();\n      }\n    }\n\n    if (uri._parts.hostname && uri._parts.path && uri._parts.path.charAt(0) !== '/') {\n      t += '/';\n    }\n\n    t += uri.path(true);\n    if (uri._parts.query) {\n      var q = '';\n      for (var i = 0, qp = uri._parts.query.split('&'), l = qp.length; i < l; i++) {\n        var kv = (qp[i] || '').split('=');\n        q += '&' + URI.decodeQuery(kv[0], this._parts.escapeQuerySpace)\n          .replace(/&/g, '%26');\n\n        if (kv[1] !== undefined) {\n          q += '=' + URI.decodeQuery(kv[1], this._parts.escapeQuerySpace)\n            .replace(/&/g, '%26');\n        }\n      }\n      t += '?' + q.substring(1);\n    }\n\n    t += URI.decodeQuery(uri.hash(), true);\n    return t;\n  };\n\n  // resolving relative and absolute URLs\n  p.absoluteTo = function(base) {\n    var resolved = this.clone();\n    var properties = ['protocol', 'username', 'password', 'hostname', 'port'];\n    var basedir, i, p;\n\n    if (this._parts.urn) {\n      throw new Error('URNs do not have any generally defined hierarchical components');\n    }\n\n    if (!(base instanceof URI)) {\n      base = new URI(base);\n    }\n\n    if (resolved._parts.protocol) {\n      // Directly returns even if this._parts.hostname is empty.\n      return resolved;\n    } else {\n      resolved._parts.protocol = base._parts.protocol;\n    }\n\n    if (this._parts.hostname) {\n      return resolved;\n    }\n\n    for (i = 0; (p = properties[i]); i++) {\n      resolved._parts[p] = base._parts[p];\n    }\n\n    if (!resolved._parts.path) {\n      resolved._parts.path = base._parts.path;\n      if (!resolved._parts.query) {\n        resolved._parts.query = base._parts.query;\n      }\n    } else {\n      if (resolved._parts.path.substring(-2) === '..') {\n        resolved._parts.path += '/';\n      }\n\n      if (resolved.path().charAt(0) !== '/') {\n        basedir = base.directory();\n        basedir = basedir ? basedir : base.path().indexOf('/') === 0 ? '/' : '';\n        resolved._parts.path = (basedir ? (basedir + '/') : '') + resolved._parts.path;\n        resolved.normalizePath();\n      }\n    }\n\n    resolved.build();\n    return resolved;\n  };\n  p.relativeTo = function(base) {\n    var relative = this.clone().normalize();\n    var relativeParts, baseParts, common, relativePath, basePath;\n\n    if (relative._parts.urn) {\n      throw new Error('URNs do not have any generally defined hierarchical components');\n    }\n\n    base = new URI(base).normalize();\n    relativeParts = relative._parts;\n    baseParts = base._parts;\n    relativePath = relative.path();\n    basePath = base.path();\n\n    if (relativePath.charAt(0) !== '/') {\n      throw new Error('URI is already relative');\n    }\n\n    if (basePath.charAt(0) !== '/') {\n      throw new Error('Cannot calculate a URI relative to another relative URI');\n    }\n\n    if (relativeParts.protocol === baseParts.protocol) {\n      relativeParts.protocol = null;\n    }\n\n    if (relativeParts.username !== baseParts.username || relativeParts.password !== baseParts.password) {\n      return relative.build();\n    }\n\n    if (relativeParts.protocol !== null || relativeParts.username !== null || relativeParts.password !== null) {\n      return relative.build();\n    }\n\n    if (relativeParts.hostname === baseParts.hostname && relativeParts.port === baseParts.port) {\n      relativeParts.hostname = null;\n      relativeParts.port = null;\n    } else {\n      return relative.build();\n    }\n\n    if (relativePath === basePath) {\n      relativeParts.path = '';\n      return relative.build();\n    }\n\n    // determine common sub path\n    common = URI.commonPath(relativePath, basePath);\n\n    // If the paths have nothing in common, return a relative URL with the absolute path.\n    if (!common) {\n      return relative.build();\n    }\n\n    var parents = baseParts.path\n      .substring(common.length)\n      .replace(/[^\\/]*$/, '')\n      .replace(/.*?\\//g, '../');\n\n    relativeParts.path = (parents + relativeParts.path.substring(common.length)) || './';\n\n    return relative.build();\n  };\n\n  // comparing URIs\n  p.equals = function(uri) {\n    var one = this.clone();\n    var two = new URI(uri);\n    var one_map = {};\n    var two_map = {};\n    var checked = {};\n    var one_query, two_query, key;\n\n    one.normalize();\n    two.normalize();\n\n    // exact match\n    if (one.toString() === two.toString()) {\n      return true;\n    }\n\n    // extract query string\n    one_query = one.query();\n    two_query = two.query();\n    one.query('');\n    two.query('');\n\n    // definitely not equal if not even non-query parts match\n    if (one.toString() !== two.toString()) {\n      return false;\n    }\n\n    // query parameters have the same length, even if they're permuted\n    if (one_query.length !== two_query.length) {\n      return false;\n    }\n\n    one_map = URI.parseQuery(one_query, this._parts.escapeQuerySpace);\n    two_map = URI.parseQuery(two_query, this._parts.escapeQuerySpace);\n\n    for (key in one_map) {\n      if (hasOwn.call(one_map, key)) {\n        if (!isArray(one_map[key])) {\n          if (one_map[key] !== two_map[key]) {\n            return false;\n          }\n        } else if (!arraysEqual(one_map[key], two_map[key])) {\n          return false;\n        }\n\n        checked[key] = true;\n      }\n    }\n\n    for (key in two_map) {\n      if (hasOwn.call(two_map, key)) {\n        if (!checked[key]) {\n          // two contains a parameter not present in one\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // state\n  p.preventInvalidHostname = function(v) {\n    this._parts.preventInvalidHostname = !!v;\n    return this;\n  };\n\n  p.duplicateQueryParameters = function(v) {\n    this._parts.duplicateQueryParameters = !!v;\n    return this;\n  };\n\n  p.escapeQuerySpace = function(v) {\n    this._parts.escapeQuerySpace = !!v;\n    return this;\n  };\n\n  return URI;\n}));\n","/*! https://mths.be/punycode v1.4.0 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.3.2',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","import { DI as t } from \"@aurelia/kernel\";\n\nfunction e(t, e) {\n    return JSON.stringify(void 0 !== t ? t : {}, e);\n}\n\nconst r = {\n    fixed: 0,\n    incremental: 1,\n    exponential: 2,\n    random: 3\n};\n\nconst n = {\n    maxRetries: 3,\n    interval: 1e3,\n    strategy: r.fixed\n};\n\nclass RetryInterceptor {\n    constructor(t) {\n        this.retryConfig = {\n            ...n,\n            ...void 0 !== t ? t : {}\n        };\n        if (this.retryConfig.strategy === r.exponential && this.retryConfig.interval <= 1e3) throw new Error(\"An interval less than or equal to 1 second is not allowed when using the exponential retry strategy\");\n    }\n    request(t) {\n        if (!t.retryConfig) {\n            t.retryConfig = {\n                ...this.retryConfig\n            };\n            t.retryConfig.counter = 0;\n        }\n        t.retryConfig.requestClone = t.clone();\n        return t;\n    }\n    response(t, e) {\n        Reflect.deleteProperty(e, \"retryConfig\");\n        return t;\n    }\n    responseError(t, e, r) {\n        const {retryConfig: n} = e;\n        const {requestClone: i} = n;\n        return Promise.resolve().then((() => {\n            if (n.counter < n.maxRetries) {\n                const o = void 0 !== n.doRetry ? n.doRetry(t, e) : true;\n                return Promise.resolve(o).then((o => {\n                    if (o) {\n                        n.counter++;\n                        const t = s(n);\n                        return new Promise((e => setTimeout(e, !isNaN(t) ? t : 0))).then((() => {\n                            const t = i.clone();\n                            if (\"function\" === typeof n.beforeRetry) return n.beforeRetry(t, r);\n                            return t;\n                        })).then((t => {\n                            const e = {\n                                ...t,\n                                retryConfig: n\n                            };\n                            return r.fetch(e);\n                        }));\n                    }\n                    Reflect.deleteProperty(e, \"retryConfig\");\n                    throw t;\n                }));\n            }\n            Reflect.deleteProperty(e, \"retryConfig\");\n            throw t;\n        }));\n    }\n}\n\nfunction s(t) {\n    const {interval: e, strategy: n, minRandomInterval: s, maxRandomInterval: o, counter: c} = t;\n    if (\"function\" === typeof n) return t.strategy(c);\n    switch (n) {\n      case r.fixed:\n        return i[r.fixed](e);\n\n      case r.incremental:\n        return i[r.incremental](c, e);\n\n      case r.exponential:\n        return i[r.exponential](c, e);\n\n      case r.random:\n        return i[r.random](c, e, s, o);\n\n      default:\n        throw new Error(\"Unrecognized retry strategy\");\n    }\n}\n\nconst i = [ t => t, (t, e) => e * t, (t, e) => 1 === t ? e : e ** t / 1e3, (t, e, r = 0, n = 6e4) => Math.random() * (n - r) + r ];\n\nclass HttpClientConfiguration {\n    constructor() {\n        this.baseUrl = \"\";\n        this.defaults = {};\n        this.interceptors = [];\n        this.dispatcher = null;\n    }\n    withBaseUrl(t) {\n        this.baseUrl = t;\n        return this;\n    }\n    withDefaults(t) {\n        this.defaults = t;\n        return this;\n    }\n    withInterceptor(t) {\n        this.interceptors.push(t);\n        return this;\n    }\n    useStandardConfiguration() {\n        const t = {\n            credentials: \"same-origin\"\n        };\n        Object.assign(this.defaults, t, this.defaults);\n        return this.rejectErrorResponses();\n    }\n    rejectErrorResponses() {\n        return this.withInterceptor({\n            response: o\n        });\n    }\n    withRetry(t) {\n        const e = new RetryInterceptor(t);\n        return this.withInterceptor(e);\n    }\n    withDispatcher(t) {\n        this.dispatcher = t;\n        return this;\n    }\n}\n\nfunction o(t) {\n    if (!t.ok) throw t;\n    return t;\n}\n\nconst c = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\n\nconst u = t.createInterface(\"IHttpClient\", (t => t.singleton(HttpClient)));\n\nclass HttpClient {\n    constructor() {\n        this.dispatcher = null;\n        this.activeRequestCount = 0;\n        this.isRequesting = false;\n        this.isConfigured = false;\n        this.baseUrl = \"\";\n        this.defaults = null;\n        this.interceptors = [];\n    }\n    configure(t) {\n        let e;\n        if (\"object\" === typeof t) {\n            const r = {\n                defaults: t\n            };\n            e = r;\n        } else if (\"function\" === typeof t) {\n            e = new HttpClientConfiguration;\n            e.baseUrl = this.baseUrl;\n            e.defaults = {\n                ...this.defaults\n            };\n            e.interceptors = this.interceptors;\n            e.dispatcher = this.dispatcher;\n            const r = t(e);\n            if (Object.prototype.isPrototypeOf.call(HttpClientConfiguration.prototype, r)) e = r;\n        } else throw new Error(\"invalid config\");\n        const r = e.defaults;\n        if (void 0 !== r && Object.prototype.isPrototypeOf.call(Headers.prototype, r.headers)) throw new Error(\"Default headers must be a plain object.\");\n        const n = e.interceptors;\n        if (void 0 !== n && n.length) {\n            if (n.filter((t => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, t))).length > 1) throw new Error(\"Only one RetryInterceptor is allowed.\");\n            const t = n.findIndex((t => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, t)));\n            if (t >= 0 && t !== n.length - 1) throw new Error(\"The retry interceptor must be the last interceptor defined.\");\n        }\n        this.baseUrl = e.baseUrl;\n        this.defaults = r;\n        this.interceptors = void 0 !== e.interceptors ? e.interceptors : [];\n        this.dispatcher = e.dispatcher;\n        this.isConfigured = true;\n        return this;\n    }\n    fetch(t, e) {\n        this.trackRequestStart();\n        let r = this.buildRequest(t, e);\n        return this.processRequest(r, this.interceptors).then((t => {\n            let e;\n            if (Object.prototype.isPrototypeOf.call(Response.prototype, t)) e = Promise.resolve(t); else if (Object.prototype.isPrototypeOf.call(Request.prototype, t)) {\n                r = t;\n                e = fetch(r);\n            } else throw new Error(`An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got [${t}]`);\n            return this.processResponse(e, this.interceptors, r);\n        })).then((t => {\n            if (Object.prototype.isPrototypeOf.call(Request.prototype, t)) return this.fetch(t);\n            return t;\n        })).then((t => {\n            this.trackRequestEnd();\n            return t;\n        }), (t => {\n            this.trackRequestEnd();\n            throw t;\n        }));\n    }\n    buildRequest(t, e) {\n        const r = null !== this.defaults ? this.defaults : {};\n        let n;\n        let s;\n        let i;\n        const o = h(r.headers);\n        if (Object.prototype.isPrototypeOf.call(Request.prototype, t)) {\n            n = t;\n            i = new Headers(n.headers).get(\"Content-Type\");\n        } else {\n            if (!e) e = {};\n            s = e.body;\n            const o = void 0 !== s ? {\n                body: s\n            } : null;\n            const c = {\n                ...r,\n                headers: {},\n                ...e,\n                ...o\n            };\n            i = new Headers(c.headers).get(\"Content-Type\");\n            n = new Request(l(this.baseUrl, t), c);\n        }\n        if (!i) if (new Headers(o).has(\"content-type\")) n.headers.set(\"Content-Type\", new Headers(o).get(\"content-type\")); else if (void 0 !== s && f(s)) n.headers.set(\"Content-Type\", \"application/json\");\n        a(n.headers, o);\n        if (void 0 !== s && Object.prototype.isPrototypeOf.call(Blob.prototype, s) && s.type) n.headers.set(\"Content-Type\", s.type);\n        return n;\n    }\n    get(t, e) {\n        return this.fetch(t, e);\n    }\n    post(t, e, r) {\n        return this.callFetch(t, e, r, \"POST\");\n    }\n    put(t, e, r) {\n        return this.callFetch(t, e, r, \"PUT\");\n    }\n    patch(t, e, r) {\n        return this.callFetch(t, e, r, \"PATCH\");\n    }\n    delete(t, e, r) {\n        return this.callFetch(t, e, r, \"DELETE\");\n    }\n    trackRequestStart() {\n        this.isRequesting = !!++this.activeRequestCount;\n        if (this.isRequesting && null !== this.dispatcher) {\n            const t = new this.dispatcher.ownerDocument.defaultView.CustomEvent(\"aurelia-fetch-client-request-started\", {\n                bubbles: true,\n                cancelable: true\n            });\n            setTimeout((() => {\n                this.dispatcher.dispatchEvent(t);\n            }), 1);\n        }\n    }\n    trackRequestEnd() {\n        this.isRequesting = !!--this.activeRequestCount;\n        if (!this.isRequesting && null !== this.dispatcher) {\n            const t = new this.dispatcher.ownerDocument.defaultView.CustomEvent(\"aurelia-fetch-client-requests-drained\", {\n                bubbles: true,\n                cancelable: true\n            });\n            setTimeout((() => {\n                this.dispatcher.dispatchEvent(t);\n            }), 1);\n        }\n    }\n    processRequest(t, e) {\n        return this.applyInterceptors(t, e, \"request\", \"requestError\", this);\n    }\n    processResponse(t, e, r) {\n        return this.applyInterceptors(t, e, \"response\", \"responseError\", r, this);\n    }\n    applyInterceptors(t, e, r, n, ...s) {\n        return (void 0 !== e ? e : []).reduce(((t, e) => {\n            const i = e[r];\n            const o = e[n];\n            return t.then(i ? t => i.call(e, t, ...s) : p, o ? t => o.call(e, t, ...s) : d);\n        }), Promise.resolve(t));\n    }\n    callFetch(t, e, r, n) {\n        if (!r) r = {};\n        r.method = n;\n        if (e) r.body = e;\n        return this.fetch(t, r);\n    }\n}\n\nfunction h(t) {\n    const e = {};\n    const r = void 0 !== t ? t : {};\n    for (const t in r) if (Object.prototype.hasOwnProperty.call(r, t)) e[t] = \"function\" === typeof r[t] ? r[t]() : r[t];\n    return e;\n}\n\nfunction l(t, e) {\n    if (c.test(e)) return e;\n    return (void 0 !== t ? t : \"\") + e;\n}\n\nfunction a(t, e) {\n    const r = void 0 !== e ? e : {};\n    for (const e in r) if (Object.prototype.hasOwnProperty.call(r, e) && !t.has(e)) t.set(e, r[e]);\n}\n\nfunction f(t) {\n    try {\n        JSON.parse(t);\n    } catch (t) {\n        return false;\n    }\n    return true;\n}\n\nfunction p(t) {\n    return t;\n}\n\nfunction d(t) {\n    throw t;\n}\n\nexport { HttpClient, HttpClientConfiguration, u as IHttpClient, RetryInterceptor, e as json, r as retryStrategy };\n//# sourceMappingURL=index.mjs.map\n","class ConfigurableRoute {\n    constructor(t, s, n) {\n        this.path = t;\n        this.caseSensitive = s;\n        this.handler = n;\n    }\n}\n\nclass Endpoint {\n    constructor(t, s) {\n        this.route = t;\n        this.paramNames = s;\n    }\n}\n\nclass RecognizedRoute {\n    constructor(t, s) {\n        this.endpoint = t;\n        this.params = s;\n    }\n}\n\nclass Candidate {\n    constructor(t, s, n, e) {\n        var i;\n        this.chars = t;\n        this.states = s;\n        this.skippedStates = n;\n        this.result = e;\n        this.head = s[s.length - 1];\n        this.endpoint = null === (i = this.head) || void 0 === i ? void 0 : i.endpoint;\n    }\n    advance(t) {\n        const {chars: s, states: n, skippedStates: e, result: i} = this;\n        let o = null;\n        let r = 0;\n        const l = n[n.length - 1];\n        function u(c, h) {\n            if (c.isMatch(t)) if (1 === ++r) o = c; else i.add(new Candidate(s.concat(t), n.concat(c), null === h ? e : e.concat(h), i));\n            if (null === l.segment && c.isOptional && null !== c.nextStates) {\n                if (c.nextStates.length > 1) throw new Error(`${c.nextStates.length} nextStates`);\n                const t = c.nextStates[0];\n                if (!t.isSeparator) throw new Error(`Not a separator`);\n                if (null !== t.nextStates) for (const s of t.nextStates) u(s, c);\n            }\n        }\n        if (l.isDynamic) u(l, null);\n        if (null !== l.nextStates) for (const t of l.nextStates) u(t, null);\n        if (null !== o) {\n            n.push(this.head = o);\n            s.push(t);\n            if (null !== o.endpoint) this.endpoint = o.endpoint;\n        }\n        if (0 === r) i.remove(this);\n    }\n    finalize() {\n        function t(s, n) {\n            const e = n.nextStates;\n            if (null !== e) if (1 === e.length && null === e[0].segment) t(s, e[0]); else for (const n of e) if (n.isOptional && null !== n.endpoint) {\n                s.push(n);\n                if (null !== n.nextStates) for (const e of n.nextStates) t(s, e);\n                break;\n            }\n        }\n        t(this.skippedStates, this.head);\n    }\n    getParams() {\n        const {states: t, chars: s, endpoint: n} = this;\n        const e = {};\n        for (const t of n.paramNames) e[t] = void 0;\n        for (let n = 0, i = t.length; n < i; ++n) {\n            const i = t[n];\n            if (i.isDynamic) {\n                const t = i.segment.name;\n                if (void 0 === e[t]) e[t] = s[n]; else e[t] += s[n];\n            }\n        }\n        return e;\n    }\n    compareTo(t) {\n        const s = this.states;\n        const n = t.states;\n        for (let t = 0, e = 0, i = Math.max(s.length, n.length); t < i; ++t) {\n            let i = s[t];\n            if (void 0 === i) return 1;\n            let o = n[e];\n            if (void 0 === o) return -1;\n            let r = i.segment;\n            let l = o.segment;\n            if (null === r) {\n                if (null === l) {\n                    ++e;\n                    continue;\n                }\n                if (void 0 === (i = s[++t])) return 1;\n                r = i.segment;\n            } else if (null === l) {\n                if (void 0 === (o = n[++e])) return -1;\n                l = o.segment;\n            }\n            if (r.kind < l.kind) return 1;\n            if (r.kind > l.kind) return -1;\n            ++e;\n        }\n        const e = this.skippedStates;\n        const i = t.skippedStates;\n        const o = e.length;\n        const r = i.length;\n        if (o < r) return 1;\n        if (o > r) return -1;\n        for (let t = 0; t < o; ++t) {\n            const s = e[t];\n            const n = i[t];\n            if (s.length < n.length) return 1;\n            if (s.length > n.length) return -1;\n        }\n        return 0;\n    }\n}\n\nfunction t(t) {\n    return null !== t.head.endpoint;\n}\n\nfunction s(t, s) {\n    return t.compareTo(s);\n}\n\nclass RecognizeResult {\n    constructor(t) {\n        this.candidates = [];\n        this.candidates = [ new Candidate([ \"\" ], [ t ], [], this) ];\n    }\n    get isEmpty() {\n        return 0 === this.candidates.length;\n    }\n    getSolution() {\n        const n = this.candidates.filter(t);\n        if (0 === n.length) return null;\n        for (const t of n) t.finalize();\n        n.sort(s);\n        return n[0];\n    }\n    add(t) {\n        this.candidates.push(t);\n    }\n    remove(t) {\n        this.candidates.splice(this.candidates.indexOf(t), 1);\n    }\n    advance(t) {\n        const s = this.candidates.slice();\n        for (const n of s) n.advance(t);\n    }\n}\n\nclass RouteRecognizer {\n    constructor() {\n        this.rootState = new State(null, null, \"\");\n        this.cache = new Map;\n    }\n    add(t) {\n        if (t instanceof Array) for (const s of t) this.$add(s); else this.$add(t);\n        this.cache.clear();\n    }\n    $add(t) {\n        const s = t.path;\n        const e = new ConfigurableRoute(t.path, true === t.caseSensitive, t.handler);\n        const i = \"\" === s ? [ \"\" ] : s.split(\"/\").filter(n);\n        const o = [];\n        let r = this.rootState;\n        for (const t of i) {\n            r = r.append(null, \"/\");\n            switch (t.charAt(0)) {\n              case \":\":\n                {\n                    const s = t.endsWith(\"?\");\n                    const n = s ? t.slice(1, -1) : t.slice(1);\n                    o.push(n);\n                    r = new DynamicSegment(n, s).appendTo(r);\n                    break;\n                }\n\n              case \"*\":\n                {\n                    const s = t.slice(1);\n                    o.push(s);\n                    r = new StarSegment(s).appendTo(r);\n                    break;\n                }\n\n              default:\n                r = new StaticSegment(t, e.caseSensitive).appendTo(r);\n                break;\n            }\n        }\n        const l = new Endpoint(e, o);\n        r.setEndpoint(l);\n    }\n    recognize(t) {\n        let s = this.cache.get(t);\n        if (void 0 === s) this.cache.set(t, s = this.$recognize(t));\n        return s;\n    }\n    $recognize(t) {\n        t = decodeURI(t);\n        if (!t.startsWith(\"/\")) t = `/${t}`;\n        if (t.length > 1 && t.endsWith(\"/\")) t = t.slice(0, -1);\n        const s = new RecognizeResult(this.rootState);\n        for (let n = 0, e = t.length; n < e; ++n) {\n            const e = t.charAt(n);\n            s.advance(e);\n            if (s.isEmpty) return null;\n        }\n        const n = s.getSolution();\n        if (null === n) return null;\n        const {endpoint: e} = n;\n        const i = n.getParams();\n        return new RecognizedRoute(e, i);\n    }\n}\n\nclass State {\n    constructor(t, s, n) {\n        this.prevState = t;\n        this.segment = s;\n        this.value = n;\n        this.nextStates = null;\n        this.endpoint = null;\n        switch (null === s || void 0 === s ? void 0 : s.kind) {\n          case 2:\n            this.length = t.length + 1;\n            this.isSeparator = false;\n            this.isDynamic = true;\n            this.isOptional = s.optional;\n            break;\n\n          case 1:\n            this.length = t.length + 1;\n            this.isSeparator = false;\n            this.isDynamic = true;\n            this.isOptional = false;\n            break;\n\n          case 3:\n            this.length = t.length + 1;\n            this.isSeparator = false;\n            this.isDynamic = false;\n            this.isOptional = false;\n            break;\n\n          case void 0:\n            this.length = null === t ? 0 : t.length;\n            this.isSeparator = true;\n            this.isDynamic = false;\n            this.isOptional = false;\n            break;\n        }\n    }\n    append(t, s) {\n        let n;\n        let e = this.nextStates;\n        if (null === e) {\n            n = void 0;\n            e = this.nextStates = [];\n        } else if (null === t) n = e.find((t => t.value === s)); else n = e.find((s => {\n            var n;\n            return null === (n = s.segment) || void 0 === n ? void 0 : n.equals(t);\n        }));\n        if (void 0 === n) e.push(n = new State(this, t, s));\n        return n;\n    }\n    setEndpoint(t) {\n        if (null !== this.endpoint) throw new Error(`Cannot add ambiguous route. The pattern '${t.route.path}' clashes with '${this.endpoint.route.path}'`);\n        this.endpoint = t;\n        if (this.isOptional) {\n            this.prevState.setEndpoint(t);\n            if (this.prevState.isSeparator && null !== this.prevState.prevState) this.prevState.prevState.setEndpoint(t);\n        }\n    }\n    isMatch(t) {\n        const s = this.segment;\n        switch (null === s || void 0 === s ? void 0 : s.kind) {\n          case 2:\n            return !this.value.includes(t);\n\n          case 1:\n            return true;\n\n          case 3:\n          case void 0:\n            return this.value.includes(t);\n        }\n    }\n}\n\nfunction n(t) {\n    return t.length > 0;\n}\n\nvar e;\n\n(function(t) {\n    t[t[\"star\"] = 1] = \"star\";\n    t[t[\"dynamic\"] = 2] = \"dynamic\";\n    t[t[\"static\"] = 3] = \"static\";\n})(e || (e = {}));\n\nclass StaticSegment {\n    constructor(t, s) {\n        this.value = t;\n        this.caseSensitive = s;\n    }\n    get kind() {\n        return 3;\n    }\n    appendTo(t) {\n        const {value: s, value: {length: n}} = this;\n        if (this.caseSensitive) for (let e = 0; e < n; ++e) t = t.append(this, s.charAt(e)); else for (let e = 0; e < n; ++e) {\n            const n = s.charAt(e);\n            t = t.append(this, n.toUpperCase() + n.toLowerCase());\n        }\n        return t;\n    }\n    equals(t) {\n        return 3 === t.kind && t.caseSensitive === this.caseSensitive && t.value === this.value;\n    }\n}\n\nclass DynamicSegment {\n    constructor(t, s) {\n        this.name = t;\n        this.optional = s;\n    }\n    get kind() {\n        return 2;\n    }\n    appendTo(t) {\n        t = t.append(this, \"/\");\n        return t;\n    }\n    equals(t) {\n        return 2 === t.kind && t.optional === this.optional && t.name === this.name;\n    }\n}\n\nclass StarSegment {\n    constructor(t) {\n        this.name = t;\n    }\n    get kind() {\n        return 1;\n    }\n    appendTo(t) {\n        t = t.append(this, \"\");\n        return t;\n    }\n    equals(t) {\n        return 1 === t.kind && t.name === this.name;\n    }\n}\n\nexport { ConfigurableRoute, Endpoint, RecognizedRoute, RouteRecognizer };\n//# sourceMappingURL=index.mjs.map\n","import { isObject as t, Metadata as i } from \"@aurelia/metadata\";\n\nimport { DI as e, IEventAggregator as s, ILogger as n, bound as o, onResolve as r, resolveAll as h, toArray as a, emptyObject as c, IContainer as u, isArrayIndex as l, Protocol as d, emptyArray as f, IModuleLoader as p, InstanceProvider as v, noop as g, Registration as w } from \"@aurelia/kernel\";\n\nimport { isCustomElementViewModel as m, IHistory as $, ILocation as x, IWindow as E, Controller as y, IPlatform as b, CustomElement as R, CustomElementDefinition as S, IController as k, IAppRoot as C, isCustomElementController as I, bindable as N, customElement as T, customAttribute as A, IEventTarget as V, INode as P, IEventDelegator as L, getRef as U, CustomAttribute as O, AppTask as j } from \"@aurelia/runtime-html\";\n\nimport { RecognizedRoute as B, Endpoint as D, ConfigurableRoute as M, RouteRecognizer as H } from \"@aurelia/route-recognizer\";\n\nimport { BindingMode as z } from \"@aurelia/runtime\";\n\nclass Batch {\n    constructor(t, i, e) {\n        this.stack = t;\n        this.cb = i;\n        this.done = false;\n        this.next = null;\n        this.head = null !== e && void 0 !== e ? e : this;\n    }\n    static start(t) {\n        return new Batch(0, t, null);\n    }\n    push() {\n        let t = this;\n        do {\n            ++t.stack;\n            t = t.next;\n        } while (null !== t);\n    }\n    pop() {\n        let t = this;\n        do {\n            if (0 === --t.stack) t.invoke();\n            t = t.next;\n        } while (null !== t);\n    }\n    invoke() {\n        const t = this.cb;\n        if (null !== t) {\n            this.cb = null;\n            t(this);\n            this.done = true;\n        }\n    }\n    continueWith(t) {\n        if (null === this.next) return this.next = new Batch(this.stack, t, this.head); else return this.next.continueWith(t);\n    }\n    start() {\n        this.head.push();\n        this.head.pop();\n        return this;\n    }\n}\n\nfunction F(t, i) {\n    t = t.slice();\n    i = i.slice();\n    const e = [];\n    while (t.length > 0) {\n        const s = t.shift();\n        if (e.every((t => t.context.vpa !== s.context.vpa))) {\n            const t = i.findIndex((t => t.context.vpa === s.context.vpa));\n            if (t >= 0) e.push(...i.splice(0, t + 1)); else e.push(s);\n        }\n    }\n    e.push(...i);\n    return e;\n}\n\nfunction q(t) {\n    try {\n        return JSON.stringify(t);\n    } catch (i) {\n        return Object.prototype.toString.call(t);\n    }\n}\n\nfunction W(t) {\n    return \"string\" === typeof t ? [ t ] : t;\n}\n\nfunction G(t) {\n    return \"string\" === typeof t ? t : t[0];\n}\n\nfunction Y(t) {\n    return \"object\" === typeof t && null !== t && !m(t);\n}\n\nfunction J(t) {\n    return Y(t) && true === Object.prototype.hasOwnProperty.call(t, \"name\");\n}\n\nfunction _(t) {\n    return Y(t) && true === Object.prototype.hasOwnProperty.call(t, \"component\");\n}\n\nfunction Z(t) {\n    return Y(t) && true === Object.prototype.hasOwnProperty.call(t, \"redirectTo\");\n}\n\nfunction K(t) {\n    return Y(t) && true === Object.prototype.hasOwnProperty.call(t, \"component\");\n}\n\nfunction Q(t, i, e) {\n    throw new Error(`Invalid route config property: \"${i}\". Expected ${t}, but got ${q(e)}.`);\n}\n\nfunction X(t, i) {\n    if (null === t || void 0 === t) throw new Error(`Invalid route config: expected an object or string, but got: ${String(t)}.`);\n    const e = Object.keys(t);\n    for (const s of e) {\n        const e = t[s];\n        const n = [ i, s ].join(\".\");\n        switch (s) {\n          case \"id\":\n          case \"viewport\":\n          case \"redirectTo\":\n          case \"fallback\":\n            if (\"string\" !== typeof e) Q(\"string\", n, e);\n            break;\n\n          case \"caseSensitive\":\n            if (\"boolean\" !== typeof e) Q(\"boolean\", n, e);\n            break;\n\n          case \"data\":\n            if (\"object\" !== typeof e || null === e) Q(\"object\", n, e);\n            break;\n\n          case \"title\":\n            switch (typeof e) {\n              case \"string\":\n              case \"function\":\n                break;\n\n              default:\n                Q(\"string or function\", n, e);\n            }\n            break;\n\n          case \"path\":\n            if (e instanceof Array) {\n                for (let t = 0; t < e.length; ++t) if (\"string\" !== typeof e[t]) Q(\"string\", `${n}[${t}]`, e[t]);\n            } else if (\"string\" !== typeof e) Q(\"string or Array of strings\", n, e);\n            break;\n\n          case \"component\":\n            it(e, n);\n            break;\n\n          case \"routes\":\n            if (!(e instanceof Array)) Q(\"Array\", n, e);\n            for (const t of e) {\n                const i = `${n}[${e.indexOf(t)}]`;\n                it(t, i);\n            }\n            break;\n\n          case \"transitionPlan\":\n            switch (typeof e) {\n              case \"string\":\n                switch (e) {\n                  case \"none\":\n                  case \"replace\":\n                  case \"invoke-lifecycles\":\n                    break;\n\n                  default:\n                    Q(\"string('none'|'replace'|'invoke-lifecycles') or function\", n, e);\n                }\n                break;\n\n              case \"function\":\n                break;\n\n              default:\n                Q(\"string('none'|'replace'|'invoke-lifecycles') or function\", n, e);\n            }\n            break;\n\n          default:\n            throw new Error(`Unknown route config property: \"${i}.${s}\". Please specify known properties only.`);\n        }\n    }\n}\n\nfunction tt(t, i) {\n    if (null === t || void 0 === t) throw new Error(`Invalid route config: expected an object or string, but got: ${String(t)}.`);\n    const e = Object.keys(t);\n    for (const s of e) {\n        const e = t[s];\n        const n = [ i, s ].join(\".\");\n        switch (s) {\n          case \"path\":\n          case \"redirectTo\":\n            if (\"string\" !== typeof e) Q(\"string\", n, e);\n            break;\n\n          default:\n            throw new Error(`Unknown redirect config property: \"${i}.${s}\". Only 'path' and 'redirectTo' should be specified for redirects.`);\n        }\n    }\n}\n\nfunction it(t, i) {\n    switch (typeof t) {\n      case \"function\":\n        break;\n\n      case \"object\":\n        if (t instanceof Promise) break;\n        if (Z(t)) {\n            tt(t, i);\n            break;\n        }\n        if (_(t)) {\n            X(t, i);\n            break;\n        }\n        if (!m(t) && !J(t)) Q(`an object with at least a 'component' property (see Routeable)`, i, t);\n        break;\n\n      case \"string\":\n        break;\n\n      default:\n        Q(\"function, object or string (see Routeable)\", i, t);\n    }\n}\n\nfunction et(t, i) {\n    if (t === i) return true;\n    if (typeof t !== typeof i) return false;\n    if (null === t || null === i) return false;\n    if (Object.getPrototypeOf(t) !== Object.getPrototypeOf(i)) return false;\n    const e = Object.keys(t);\n    const s = Object.keys(i);\n    if (e.length !== s.length) return false;\n    for (let n = 0, o = e.length; n < o; ++n) {\n        const o = e[n];\n        if (o !== s[n]) return false;\n        if (t[o] !== i[o]) return false;\n    }\n    return true;\n}\n\nfunction st(t, i, e, s) {\n    var n = arguments.length, o = n < 3 ? i : null === s ? s = Object.getOwnPropertyDescriptor(i, e) : s, r;\n    if (\"object\" === typeof Reflect && \"function\" === typeof Reflect.decorate) o = Reflect.decorate(t, i, e, s); else for (var h = t.length - 1; h >= 0; h--) if (r = t[h]) o = (n < 3 ? r(o) : n > 3 ? r(i, e, o) : r(i, e)) || o;\n    return n > 3 && o && Object.defineProperty(i, e, o), o;\n}\n\nfunction nt(t, i) {\n    return function(e, s) {\n        i(e, s, t);\n    };\n}\n\nclass Subscription {\n    constructor(t, i, e) {\n        this.events = t;\n        this.serial = i;\n        this.inner = e;\n        this.disposed = false;\n    }\n    dispose() {\n        if (!this.disposed) {\n            this.disposed = true;\n            this.inner.dispose();\n            const t = this.events[\"subscriptions\"];\n            t.splice(t.indexOf(this), 1);\n        }\n    }\n}\n\nconst ot = e.createInterface(\"IRouterEvents\", (t => t.singleton(rt)));\n\nlet rt = class RouterEvents {\n    constructor(t, i) {\n        this.ea = t;\n        this.logger = i;\n        this.subscriptionSerial = 0;\n        this.subscriptions = [];\n        this.logger = i.scopeTo(\"RouterEvents\");\n    }\n    publish(t) {\n        this.logger.trace(`publishing %s`, t);\n        this.ea.publish(t.name, t);\n    }\n    subscribe(t, i) {\n        const e = new Subscription(this, ++this.subscriptionSerial, this.ea.subscribe(t, (s => {\n            this.logger.trace(`handling %s for subscription #${e.serial}`, t);\n            i(s);\n        })));\n        this.subscriptions.push(e);\n        return e;\n    }\n};\n\nrt = st([ nt(0, s), nt(1, n) ], rt);\n\nclass LocationChangeEvent {\n    constructor(t, i, e, s) {\n        this.id = t;\n        this.url = i;\n        this.trigger = e;\n        this.state = s;\n    }\n    get name() {\n        return \"au:router:location-change\";\n    }\n    toString() {\n        return `LocationChangeEvent(id:${this.id},url:'${this.url}',trigger:'${this.trigger}')`;\n    }\n}\n\nclass NavigationStartEvent {\n    constructor(t, i, e, s) {\n        this.id = t;\n        this.instructions = i;\n        this.trigger = e;\n        this.managedState = s;\n    }\n    get name() {\n        return \"au:router:navigation-start\";\n    }\n    toString() {\n        return `NavigationStartEvent(id:${this.id},instructions:'${this.instructions}',trigger:'${this.trigger}')`;\n    }\n}\n\nclass NavigationEndEvent {\n    constructor(t, i, e) {\n        this.id = t;\n        this.instructions = i;\n        this.finalInstructions = e;\n    }\n    get name() {\n        return \"au:router:navigation-end\";\n    }\n    toString() {\n        return `NavigationEndEvent(id:${this.id},instructions:'${this.instructions}',finalInstructions:'${this.finalInstructions}')`;\n    }\n}\n\nclass NavigationCancelEvent {\n    constructor(t, i, e) {\n        this.id = t;\n        this.instructions = i;\n        this.reason = e;\n    }\n    get name() {\n        return \"au:router:navigation-cancel\";\n    }\n    toString() {\n        return `NavigationCancelEvent(id:${this.id},instructions:'${this.instructions}',reason:${String(this.reason)})`;\n    }\n}\n\nclass NavigationErrorEvent {\n    constructor(t, i, e) {\n        this.id = t;\n        this.instructions = i;\n        this.error = e;\n    }\n    get name() {\n        return \"au:router:navigation-error\";\n    }\n    toString() {\n        return `NavigationErrorEvent(id:${this.id},instructions:'${this.instructions}',error:${String(this.error)})`;\n    }\n}\n\nconst ht = e.createInterface(\"IBaseHrefProvider\", (t => t.singleton(at)));\n\nclass BaseHref {\n    constructor(t, i) {\n        this.path = t;\n        this.rootedPath = i;\n    }\n}\n\nlet at = class BrowserBaseHrefProvider {\n    constructor(t) {\n        this.window = t;\n    }\n    getBaseHref() {\n        var t;\n        const i = this.window.document.head.querySelector(\"base\");\n        if (null === i) return null;\n        const e = lt(i.href);\n        const s = lt(null !== (t = i.getAttribute(\"href\")) && void 0 !== t ? t : \"\");\n        return new BaseHref(s, e);\n    }\n};\n\nat = st([ nt(0, E) ], at);\n\nconst ct = e.createInterface(\"ILocationManager\", (t => t.singleton(ut)));\n\nlet ut = class BrowserLocationManager {\n    constructor(t, i, e, s, n, o) {\n        var r;\n        this.logger = t;\n        this.events = i;\n        this.history = e;\n        this.location = s;\n        this.window = n;\n        this.baseHrefProvider = o;\n        this.eventId = 0;\n        this.logger = t.root.scopeTo(\"LocationManager\");\n        const h = o.getBaseHref();\n        if (null === h) {\n            const t = null !== (r = s.origin) && void 0 !== r ? r : \"\";\n            const i = this.baseHref = new BaseHref(\"\", lt(t));\n            this.logger.warn(`no baseHref provided, defaulting to origin '${i.rootedPath}' (normalized from '${t}')`);\n        } else {\n            this.baseHref = h;\n            this.logger.debug(`baseHref set to path: '${h.path}', rootedPath: '${h.rootedPath}'`);\n        }\n    }\n    startListening() {\n        this.logger.trace(`startListening()`);\n        this.window.addEventListener(\"popstate\", this.onPopState, false);\n        this.window.addEventListener(\"hashchange\", this.onHashChange, false);\n    }\n    stopListening() {\n        this.logger.trace(`stopListening()`);\n        this.window.removeEventListener(\"popstate\", this.onPopState, false);\n        this.window.removeEventListener(\"hashchange\", this.onHashChange, false);\n    }\n    onPopState(t) {\n        this.logger.trace(`onPopState()`);\n        this.events.publish(new LocationChangeEvent(++this.eventId, this.getPath(), \"popstate\", t.state));\n    }\n    onHashChange(t) {\n        this.logger.trace(`onHashChange()`);\n        this.events.publish(new LocationChangeEvent(++this.eventId, this.getPath(), \"hashchange\", null));\n    }\n    pushState(t, i, e) {\n        e = this.addBaseHref(e);\n        try {\n            const s = JSON.stringify(t);\n            this.logger.trace(`pushState(state:${s},title:'${i}',url:'${e}')`);\n        } catch (t) {\n            this.logger.warn(`pushState(state:NOT_SERIALIZABLE,title:'${i}',url:'${e}')`);\n        }\n        this.history.pushState(t, i, e);\n    }\n    replaceState(t, i, e) {\n        e = this.addBaseHref(e);\n        try {\n            const s = JSON.stringify(t);\n            this.logger.trace(`replaceState(state:${s},title:'${i}',url:'${e}')`);\n        } catch (t) {\n            this.logger.warn(`replaceState(state:NOT_SERIALIZABLE,title:'${i}',url:'${e}')`);\n        }\n        this.history.replaceState(t, i, e);\n    }\n    getPath() {\n        const {pathname: t, search: i, hash: e} = this.location;\n        const s = this.removeBaseHref(`${t}${dt(i)}${e}`);\n        this.logger.trace(`getPath() -> '${s}'`);\n        return s;\n    }\n    currentPathEquals(t) {\n        const i = this.getPath() === this.removeBaseHref(t);\n        this.logger.trace(`currentPathEquals(path:'${t}') -> ${i}`);\n        return i;\n    }\n    addBaseHref(t) {\n        const i = t;\n        let e;\n        let s = this.baseHref.rootedPath;\n        if (s.endsWith(\"/\")) s = s.slice(0, -1);\n        if (0 === s.length) e = t; else {\n            if (t.startsWith(\"/\")) t = t.slice(1);\n            e = `${s}/${t}`;\n        }\n        this.logger.trace(`addBaseHref(path:'${i}') -> '${e}'`);\n        return e;\n    }\n    removeBaseHref(t) {\n        const i = t;\n        if (t.startsWith(this.baseHref.path)) t = t.slice(this.baseHref.path.length);\n        t = lt(t);\n        this.logger.trace(`removeBaseHref(path:'${i}') -> '${t}'`);\n        return t;\n    }\n};\n\nst([ o ], ut.prototype, \"onPopState\", null);\n\nst([ o ], ut.prototype, \"onHashChange\", null);\n\nut = st([ nt(0, n), nt(1, ot), nt(2, $), nt(3, x), nt(4, E), nt(5, ht) ], ut);\n\nfunction lt(t) {\n    let i;\n    let e;\n    let s;\n    if ((s = t.indexOf(\"?\")) >= 0 || (s = t.indexOf(\"#\")) >= 0) {\n        i = t.slice(0, s);\n        e = t.slice(s);\n    } else {\n        i = t;\n        e = \"\";\n    }\n    if (i.endsWith(\"/\")) i = i.slice(0, -1); else if (i.endsWith(\"/index.html\")) i = i.slice(0, -11);\n    return `${i}${e}`;\n}\n\nfunction dt(t) {\n    return t.length > 0 && !t.startsWith(\"?\") ? `?${t}` : t;\n}\n\nconst ft = [ \"?\", \"#\", \"/\", \"+\", \"(\", \")\", \".\", \"@\", \"!\", \"=\", \",\", \"&\", \"'\", \"~\", \";\" ];\n\nclass ParserState {\n    constructor(t) {\n        this.input = t;\n        this.buffers = [];\n        this.bufferIndex = 0;\n        this.index = 0;\n        this.rest = t;\n    }\n    get done() {\n        return 0 === this.rest.length;\n    }\n    startsWith(...t) {\n        const i = this.rest;\n        return t.some((function(t) {\n            return i.startsWith(t);\n        }));\n    }\n    consumeOptional(t) {\n        if (this.startsWith(t)) {\n            this.rest = this.rest.slice(t.length);\n            this.index += t.length;\n            this.append(t);\n            return true;\n        }\n        return false;\n    }\n    consume(t) {\n        if (!this.consumeOptional(t)) this.expect(`'${t}'`);\n    }\n    expect(t) {\n        throw new Error(`Expected ${t} at index ${this.index} of '${this.input}', but got: '${this.rest}' (rest='${this.rest}')`);\n    }\n    ensureDone() {\n        if (!this.done) throw new Error(`Unexpected '${this.rest}' at index ${this.index} of '${this.input}'`);\n    }\n    advance() {\n        const t = this.rest[0];\n        this.rest = this.rest.slice(1);\n        ++this.index;\n        this.append(t);\n    }\n    record() {\n        this.buffers[this.bufferIndex++] = \"\";\n    }\n    playback() {\n        const t = --this.bufferIndex;\n        const i = this.buffers;\n        const e = i[t];\n        i[t] = \"\";\n        return e;\n    }\n    discard() {\n        this.buffers[--this.bufferIndex] = \"\";\n    }\n    append(t) {\n        const i = this.bufferIndex;\n        const e = this.buffers;\n        for (let s = 0; s < i; ++s) e[s] += t;\n    }\n}\n\nvar pt;\n\n(function(t) {\n    t[t[\"Route\"] = 0] = \"Route\";\n    t[t[\"CompositeSegment\"] = 1] = \"CompositeSegment\";\n    t[t[\"ScopedSegment\"] = 2] = \"ScopedSegment\";\n    t[t[\"SegmentGroup\"] = 3] = \"SegmentGroup\";\n    t[t[\"Segment\"] = 4] = \"Segment\";\n    t[t[\"Component\"] = 5] = \"Component\";\n    t[t[\"Action\"] = 6] = \"Action\";\n    t[t[\"Viewport\"] = 7] = \"Viewport\";\n    t[t[\"ParameterList\"] = 8] = \"ParameterList\";\n    t[t[\"Parameter\"] = 9] = \"Parameter\";\n})(pt || (pt = {}));\n\nconst vt = new Map;\n\nconst gt = new Map;\n\nclass RouteExpression {\n    constructor(t, i, e, s, n, o) {\n        this.raw = t;\n        this.isAbsolute = i;\n        this.root = e;\n        this.queryParams = s;\n        this.fragment = n;\n        this.fragmentIsRoute = o;\n    }\n    get kind() {\n        return 0;\n    }\n    static parse(t, i) {\n        const e = i ? vt : gt;\n        let s = e.get(t);\n        if (void 0 === s) e.set(t, s = RouteExpression.$parse(t, i));\n        return s;\n    }\n    static $parse(t, i) {\n        let e;\n        const s = t.indexOf(\"#\");\n        if (s >= 0) {\n            const n = t.slice(s + 1);\n            e = decodeURIComponent(n);\n            if (i) t = e; else t = t.slice(0, s);\n        } else {\n            if (i) t = \"\";\n            e = null;\n        }\n        let n = null;\n        const o = t.indexOf(\"?\");\n        if (o >= 0) {\n            const i = t.slice(o + 1);\n            t = t.slice(0, o);\n            n = new URLSearchParams(i);\n        }\n        if (\"\" === t) return new RouteExpression(\"\", false, SegmentExpression.EMPTY, null != n ? Object.freeze(n) : Ut, e, i);\n        const r = new ParserState(t);\n        r.record();\n        const h = r.consumeOptional(\"/\");\n        const a = CompositeSegmentExpression.parse(r);\n        r.ensureDone();\n        const c = r.playback();\n        return new RouteExpression(c, h, a, null != n ? Object.freeze(n) : Ut, e, i);\n    }\n    toInstructionTree(t) {\n        let i = this.queryParams;\n        const e = t.queryParams;\n        if (null != e) i = new URLSearchParams({\n            ...Object.fromEntries(i.entries()),\n            ...e\n        });\n        return new ViewportInstructionTree(t, this.isAbsolute, this.root.toInstructions(t.append, 0, 0), i, this.fragment);\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass CompositeSegmentExpression {\n    constructor(t, i, e) {\n        this.raw = t;\n        this.siblings = i;\n        this.append = e;\n    }\n    get kind() {\n        return 1;\n    }\n    static parse(t) {\n        t.record();\n        const i = t.consumeOptional(\"+\");\n        const e = [];\n        do {\n            e.push(ScopedSegmentExpression.parse(t));\n        } while (t.consumeOptional(\"+\"));\n        if (!i && 1 === e.length) {\n            t.discard();\n            return e[0];\n        }\n        const s = t.playback();\n        return new CompositeSegmentExpression(s, e, i);\n    }\n    toInstructions(t, i, e) {\n        switch (this.siblings.length) {\n          case 0:\n            return [];\n\n          case 1:\n            return this.siblings[0].toInstructions(t, i, e);\n\n          case 2:\n            return [ ...this.siblings[0].toInstructions(t, i, 0), ...this.siblings[1].toInstructions(t, 0, e) ];\n\n          default:\n            return [ ...this.siblings[0].toInstructions(t, i, 0), ...this.siblings.slice(1, -1).flatMap((function(i) {\n                return i.toInstructions(t, 0, 0);\n            })), ...this.siblings[this.siblings.length - 1].toInstructions(t, 0, e) ];\n        }\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass ScopedSegmentExpression {\n    constructor(t, i, e) {\n        this.raw = t;\n        this.left = i;\n        this.right = e;\n    }\n    get kind() {\n        return 2;\n    }\n    static parse(t) {\n        t.record();\n        const i = SegmentGroupExpression.parse(t);\n        if (t.consumeOptional(\"/\")) {\n            const e = ScopedSegmentExpression.parse(t);\n            const s = t.playback();\n            return new ScopedSegmentExpression(s, i, e);\n        }\n        t.discard();\n        return i;\n    }\n    toInstructions(t, i, e) {\n        const s = this.left.toInstructions(t, i, 0);\n        const n = this.right.toInstructions(false, 0, e);\n        let o = s[s.length - 1];\n        while (o.children.length > 0) o = o.children[o.children.length - 1];\n        o.children.push(...n);\n        return s;\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass SegmentGroupExpression {\n    constructor(t, i) {\n        this.raw = t;\n        this.expression = i;\n    }\n    get kind() {\n        return 3;\n    }\n    static parse(t) {\n        t.record();\n        if (t.consumeOptional(\"(\")) {\n            const i = CompositeSegmentExpression.parse(t);\n            t.consume(\")\");\n            const e = t.playback();\n            return new SegmentGroupExpression(e, i);\n        }\n        t.discard();\n        return SegmentExpression.parse(t);\n    }\n    toInstructions(t, i, e) {\n        return this.expression.toInstructions(t, i + 1, e + 1);\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass SegmentExpression {\n    constructor(t, i, e, s, n) {\n        this.raw = t;\n        this.component = i;\n        this.action = e;\n        this.viewport = s;\n        this.scoped = n;\n    }\n    get kind() {\n        return 4;\n    }\n    static get EMPTY() {\n        return new SegmentExpression(\"\", ComponentExpression.EMPTY, ActionExpression.EMPTY, ViewportExpression.EMPTY, true);\n    }\n    static parse(t) {\n        t.record();\n        const i = ComponentExpression.parse(t);\n        const e = ActionExpression.parse(t);\n        const s = ViewportExpression.parse(t);\n        const n = !t.consumeOptional(\"!\");\n        const o = t.playback();\n        return new SegmentExpression(o, i, e, s, n);\n    }\n    toInstructions(t, i, e) {\n        return [ ViewportInstruction.create({\n            component: this.component.name,\n            params: this.component.parameterList.toObject(),\n            viewport: this.viewport.name,\n            append: t,\n            open: i,\n            close: e\n        }) ];\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass ComponentExpression {\n    constructor(t, i, e) {\n        this.raw = t;\n        this.name = i;\n        this.parameterList = e;\n        switch (i.charAt(0)) {\n          case \":\":\n            this.isParameter = true;\n            this.isStar = false;\n            this.isDynamic = true;\n            this.parameterName = i.slice(1);\n            break;\n\n          case \"*\":\n            this.isParameter = false;\n            this.isStar = true;\n            this.isDynamic = true;\n            this.parameterName = i.slice(1);\n            break;\n\n          default:\n            this.isParameter = false;\n            this.isStar = false;\n            this.isDynamic = false;\n            this.parameterName = i;\n            break;\n        }\n    }\n    get kind() {\n        return 5;\n    }\n    static get EMPTY() {\n        return new ComponentExpression(\"\", \"\", ParameterListExpression.EMPTY);\n    }\n    static parse(t) {\n        t.record();\n        t.record();\n        if (!t.done) if (t.startsWith(\"./\")) t.advance(); else if (t.startsWith(\"../\")) {\n            t.advance();\n            t.advance();\n        } else while (!t.done && !t.startsWith(...ft)) t.advance();\n        const i = decodeURIComponent(t.playback());\n        if (0 === i.length) t.expect(\"component name\");\n        const e = ParameterListExpression.parse(t);\n        const s = t.playback();\n        return new ComponentExpression(s, i, e);\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass ActionExpression {\n    constructor(t, i, e) {\n        this.raw = t;\n        this.name = i;\n        this.parameterList = e;\n    }\n    get kind() {\n        return 6;\n    }\n    static get EMPTY() {\n        return new ActionExpression(\"\", \"\", ParameterListExpression.EMPTY);\n    }\n    static parse(t) {\n        t.record();\n        let i = \"\";\n        if (t.consumeOptional(\".\")) {\n            t.record();\n            while (!t.done && !t.startsWith(...ft)) t.advance();\n            i = decodeURIComponent(t.playback());\n            if (0 === i.length) t.expect(\"method name\");\n        }\n        const e = ParameterListExpression.parse(t);\n        const s = t.playback();\n        return new ActionExpression(s, i, e);\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass ViewportExpression {\n    constructor(t, i) {\n        this.raw = t;\n        this.name = i;\n    }\n    get kind() {\n        return 7;\n    }\n    static get EMPTY() {\n        return new ViewportExpression(\"\", \"\");\n    }\n    static parse(t) {\n        t.record();\n        let i = \"\";\n        if (t.consumeOptional(\"@\")) {\n            t.record();\n            while (!t.done && !t.startsWith(...ft)) t.advance();\n            i = decodeURIComponent(t.playback());\n            if (0 === i.length) t.expect(\"viewport name\");\n        }\n        const e = t.playback();\n        return new ViewportExpression(e, i);\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass ParameterListExpression {\n    constructor(t, i) {\n        this.raw = t;\n        this.expressions = i;\n    }\n    get kind() {\n        return 8;\n    }\n    static get EMPTY() {\n        return new ParameterListExpression(\"\", []);\n    }\n    static parse(t) {\n        t.record();\n        const i = [];\n        if (t.consumeOptional(\"(\")) {\n            do {\n                i.push(ParameterExpression.parse(t, i.length));\n                if (!t.consumeOptional(\",\")) break;\n            } while (!t.done && !t.startsWith(\")\"));\n            t.consume(\")\");\n        }\n        const e = t.playback();\n        return new ParameterListExpression(e, i);\n    }\n    toObject() {\n        const t = {};\n        for (const i of this.expressions) t[i.key] = i.value;\n        return t;\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nclass ParameterExpression {\n    constructor(t, i, e) {\n        this.raw = t;\n        this.key = i;\n        this.value = e;\n    }\n    get kind() {\n        return 9;\n    }\n    static get EMPTY() {\n        return new ParameterExpression(\"\", \"\", \"\");\n    }\n    static parse(t, i) {\n        t.record();\n        t.record();\n        while (!t.done && !t.startsWith(...ft)) t.advance();\n        let e = decodeURIComponent(t.playback());\n        if (0 === e.length) t.expect(\"parameter key\");\n        let s;\n        if (t.consumeOptional(\"=\")) {\n            t.record();\n            while (!t.done && !t.startsWith(...ft)) t.advance();\n            s = decodeURIComponent(t.playback());\n            if (0 === s.length) t.expect(\"parameter value\");\n        } else {\n            s = e;\n            e = i.toString();\n        }\n        const n = t.playback();\n        return new ParameterExpression(n, e, s);\n    }\n    toString() {\n        return this.raw;\n    }\n}\n\nconst wt = Object.freeze({\n    RouteExpression: RouteExpression,\n    CompositeSegmentExpression: CompositeSegmentExpression,\n    ScopedSegmentExpression: ScopedSegmentExpression,\n    SegmentGroupExpression: SegmentGroupExpression,\n    SegmentExpression: SegmentExpression,\n    ComponentExpression: ComponentExpression,\n    ActionExpression: ActionExpression,\n    ViewportExpression: ViewportExpression,\n    ParameterListExpression: ParameterListExpression,\n    ParameterExpression: ParameterExpression\n});\n\nclass ViewportRequest {\n    constructor(t, i, e, s) {\n        this.viewportName = t;\n        this.componentName = i;\n        this.resolution = e;\n        this.append = s;\n    }\n    toString() {\n        return `VR(viewport:'${this.viewportName}',component:'${this.componentName}',resolution:'${this.resolution}',append:${this.append})`;\n    }\n}\n\nconst mt = new WeakMap;\n\nclass ViewportAgent {\n    constructor(t, i, e) {\n        this.viewport = t;\n        this.hostController = i;\n        this.ctx = e;\n        this.isActive = false;\n        this.curCA = null;\n        this.nextCA = null;\n        this.state = 8256;\n        this.$resolution = \"dynamic\";\n        this.$plan = \"replace\";\n        this.currNode = null;\n        this.nextNode = null;\n        this.currTransition = null;\n        this.prevTransition = null;\n        this.logger = e.container.get(n).scopeTo(`ViewportAgent<${e.friendlyPath}>`);\n        this.logger.trace(`constructor()`);\n    }\n    get $state() {\n        return bt(this.state);\n    }\n    get currState() {\n        return 16256 & this.state;\n    }\n    set currState(t) {\n        this.state = 127 & this.state | t;\n    }\n    get nextState() {\n        return 127 & this.state;\n    }\n    set nextState(t) {\n        this.state = 16256 & this.state | t;\n    }\n    static for(t, i) {\n        let e = mt.get(t);\n        if (void 0 === e) {\n            const s = y.getCachedOrThrow(t);\n            mt.set(t, e = new ViewportAgent(t, s, i));\n        }\n        return e;\n    }\n    activateFromViewport(t, i, e) {\n        const s = this.currTransition;\n        if (null !== s) xt(s);\n        this.isActive = true;\n        switch (this.nextState) {\n          case 64:\n            switch (this.currState) {\n              case 8192:\n                this.logger.trace(`activateFromViewport() - nothing to activate at %s`, this);\n                return;\n\n              case 4096:\n                this.logger.trace(`activateFromViewport() - activating existing componentAgent at %s`, this);\n                return this.curCA.activate(t, i, e);\n\n              default:\n                this.unexpectedState(\"activateFromViewport 1\");\n            }\n\n          case 2:\n            {\n                if (null === this.currTransition) throw new Error(`Unexpected viewport activation outside of a transition context at ${this}`);\n                if (\"static\" !== this.$resolution) throw new Error(`Unexpected viewport activation at ${this}`);\n                this.logger.trace(`activateFromViewport() - running ordinary activate at %s`, this);\n                const i = Batch.start((i => {\n                    this.activate(t, this.currTransition, i);\n                }));\n                const e = new Promise((t => {\n                    i.continueWith((() => {\n                        t();\n                    }));\n                }));\n                return i.start().done ? void 0 : e;\n            }\n\n          default:\n            this.unexpectedState(\"activateFromViewport 2\");\n        }\n    }\n    deactivateFromViewport(t, i, e) {\n        const s = this.currTransition;\n        if (null !== s) xt(s);\n        this.isActive = false;\n        switch (this.currState) {\n          case 8192:\n            this.logger.trace(`deactivateFromViewport() - nothing to deactivate at %s`, this);\n            return;\n\n          case 4096:\n            this.logger.trace(`deactivateFromViewport() - deactivating existing componentAgent at %s`, this);\n            return this.curCA.deactivate(t, i, e);\n\n          case 128:\n            this.logger.trace(`deactivateFromViewport() - already deactivating at %s`, this);\n            return;\n\n          default:\n            {\n                if (null === this.currTransition) throw new Error(`Unexpected viewport deactivation outside of a transition context at ${this}`);\n                this.logger.trace(`deactivateFromViewport() - running ordinary deactivate at %s`, this);\n                const i = Batch.start((i => {\n                    this.deactivate(t, this.currTransition, i);\n                }));\n                const e = new Promise((t => {\n                    i.continueWith((() => {\n                        t();\n                    }));\n                }));\n                return i.start().done ? void 0 : e;\n            }\n        }\n    }\n    handles(t) {\n        if (!this.isAvailable(t.resolution)) return false;\n        if (t.append && 4096 === this.currState) {\n            this.logger.trace(`handles(req:%s) -> false (append mode, viewport already has content %s)`, t, this.curCA);\n            return false;\n        }\n        const i = t.viewportName;\n        const e = this.viewport.name;\n        if (i !== Zt && e !== Zt && e !== i) {\n            this.logger.trace(`handles(req:%s) -> false (viewport names don't match '%s')`, t, e);\n            return false;\n        }\n        if (this.viewport.usedBy.length > 0 && !this.viewport.usedBy.split(\",\").includes(t.componentName)) {\n            this.logger.trace(`handles(req:%s) -> false (componentName not included in usedBy)`, t);\n            return false;\n        }\n        this.logger.trace(`viewport '%s' handles(req:%s) -> true`, e, t);\n        return true;\n    }\n    isAvailable(t) {\n        if (\"dynamic\" === t && !this.isActive) {\n            this.logger.trace(`isAvailable(resolution:%s) -> false (viewport is not active and we're in dynamic resolution resolution)`, t);\n            return false;\n        }\n        if (64 !== this.nextState) {\n            this.logger.trace(`isAvailable(resolution:%s) -> false (update already scheduled for %s)`, t, this.nextNode);\n            return false;\n        }\n        return true;\n    }\n    canUnload(t, i) {\n        if (null === this.currTransition) this.currTransition = t;\n        xt(t);\n        if (true !== t.guardsResult) return;\n        i.push();\n        Batch.start((i => {\n            this.logger.trace(`canUnload() - invoking on children at %s`, this);\n            for (const e of this.currNode.children) e.context.vpa.canUnload(t, i);\n        })).continueWith((i => {\n            switch (this.currState) {\n              case 4096:\n                this.logger.trace(`canUnload() - invoking on existing component at %s`, this);\n                switch (this.$plan) {\n                  case \"none\":\n                    this.currState = 1024;\n                    return;\n\n                  case \"invoke-lifecycles\":\n                  case \"replace\":\n                    this.currState = 2048;\n                    i.push();\n                    Batch.start((i => {\n                        this.logger.trace(`canUnload() - finished invoking on children, now invoking on own component at %s`, this);\n                        this.curCA.canUnload(t, this.nextNode, i);\n                    })).continueWith((() => {\n                        this.logger.trace(`canUnload() - finished at %s`, this);\n                        this.currState = 1024;\n                        i.pop();\n                    })).start();\n                    return;\n                }\n\n              case 8192:\n                this.logger.trace(`canUnload() - nothing to unload at %s`, this);\n                return;\n\n              default:\n                t.handleError(new Error(`Unexpected state at canUnload of ${this}`));\n            }\n        })).continueWith((() => {\n            i.pop();\n        })).start();\n    }\n    canLoad(t, i) {\n        if (null === this.currTransition) this.currTransition = t;\n        xt(t);\n        if (true !== t.guardsResult) return;\n        i.push();\n        Batch.start((i => {\n            switch (this.nextState) {\n              case 32:\n                this.logger.trace(`canLoad() - invoking on new component at %s`, this);\n                this.nextState = 16;\n                switch (this.$plan) {\n                  case \"none\":\n                    return;\n\n                  case \"invoke-lifecycles\":\n                    return this.curCA.canLoad(t, this.nextNode, i);\n\n                  case \"replace\":\n                    this.nextCA = this.nextNode.context.createComponentAgent(this.hostController, this.nextNode);\n                    return this.nextCA.canLoad(t, this.nextNode, i);\n                }\n\n              case 64:\n                this.logger.trace(`canLoad() - nothing to load at %s`, this);\n                return;\n\n              default:\n                this.unexpectedState(\"canLoad\");\n            }\n        })).continueWith((t => {\n            const i = this.nextNode;\n            switch (this.$plan) {\n              case \"none\":\n              case \"invoke-lifecycles\":\n                this.logger.trace(`canLoad(next:%s) - plan set to '%s', compiling residue`, i, this.$plan);\n                t.push();\n                void r(It(i), (() => {\n                    t.pop();\n                }));\n                return;\n\n              case \"replace\":\n                switch (this.$resolution) {\n                  case \"dynamic\":\n                    this.logger.trace(`canLoad(next:%s) - (resolution: 'dynamic'), delaying residue compilation until activate`, i, this.$plan);\n                    return;\n\n                  case \"static\":\n                    this.logger.trace(`canLoad(next:%s) - (resolution: '${this.$resolution}'), creating nextCA and compiling residue`, i, this.$plan);\n                    t.push();\n                    void r(It(i), (() => {\n                        t.pop();\n                    }));\n                    return;\n                }\n            }\n        })).continueWith((i => {\n            switch (this.nextState) {\n              case 16:\n                this.logger.trace(`canLoad() - finished own component, now invoking on children at %s`, this);\n                this.nextState = 8;\n                for (const e of this.nextNode.children) e.context.vpa.canLoad(t, i);\n                return;\n\n              case 64:\n                return;\n\n              default:\n                this.unexpectedState(\"canLoad\");\n            }\n        })).continueWith((() => {\n            this.logger.trace(`canLoad() - finished at %s`, this);\n            i.pop();\n        })).start();\n    }\n    unload(t, i) {\n        xt(t);\n        $t(this, t);\n        i.push();\n        Batch.start((i => {\n            this.logger.trace(`unload() - invoking on children at %s`, this);\n            for (const e of this.currNode.children) e.context.vpa.unload(t, i);\n        })).continueWith((e => {\n            switch (this.currState) {\n              case 1024:\n                this.logger.trace(`unload() - invoking on existing component at %s`, this);\n                switch (this.$plan) {\n                  case \"none\":\n                    this.currState = 256;\n                    return;\n\n                  case \"invoke-lifecycles\":\n                  case \"replace\":\n                    this.currState = 512;\n                    e.push();\n                    Batch.start((i => {\n                        this.logger.trace(`unload() - finished invoking on children, now invoking on own component at %s`, this);\n                        this.curCA.unload(t, this.nextNode, i);\n                    })).continueWith((() => {\n                        this.logger.trace(`unload() - finished at %s`, this);\n                        this.currState = 256;\n                        e.pop();\n                    })).start();\n                    return;\n                }\n\n              case 8192:\n                this.logger.trace(`unload() - nothing to unload at %s`, this);\n                for (const e of this.currNode.children) e.context.vpa.unload(t, i);\n                return;\n\n              default:\n                this.unexpectedState(\"unload\");\n            }\n        })).continueWith((() => {\n            i.pop();\n        })).start();\n    }\n    load(t, i) {\n        xt(t);\n        $t(this, t);\n        i.push();\n        Batch.start((i => {\n            switch (this.nextState) {\n              case 8:\n                this.logger.trace(`load() - invoking on new component at %s`, this);\n                this.nextState = 4;\n                switch (this.$plan) {\n                  case \"none\":\n                    return;\n\n                  case \"invoke-lifecycles\":\n                    return this.curCA.load(t, this.nextNode, i);\n\n                  case \"replace\":\n                    return this.nextCA.load(t, this.nextNode, i);\n                }\n\n              case 64:\n                this.logger.trace(`load() - nothing to load at %s`, this);\n                return;\n\n              default:\n                this.unexpectedState(\"load\");\n            }\n        })).continueWith((i => {\n            switch (this.nextState) {\n              case 4:\n                this.logger.trace(`load() - finished own component, now invoking on children at %s`, this);\n                this.nextState = 2;\n                for (const e of this.nextNode.children) e.context.vpa.load(t, i);\n                return;\n\n              case 64:\n                return;\n\n              default:\n                this.unexpectedState(\"load\");\n            }\n        })).continueWith((() => {\n            this.logger.trace(`load() - finished at %s`, this);\n            i.pop();\n        })).start();\n    }\n    deactivate(t, i, e) {\n        xt(i);\n        $t(this, i);\n        e.push();\n        switch (this.currState) {\n          case 256:\n            this.logger.trace(`deactivate() - invoking on existing component at %s`, this);\n            this.currState = 128;\n            switch (this.$plan) {\n              case \"none\":\n              case \"invoke-lifecycles\":\n                e.pop();\n                return;\n\n              case \"replace\":\n                {\n                    const s = this.hostController;\n                    const n = this.viewport.stateful ? 0 : 16;\n                    i.run((() => this.curCA.deactivate(t, s, n)), (() => {\n                        e.pop();\n                    }));\n                }\n            }\n            return;\n\n          case 8192:\n            this.logger.trace(`deactivate() - nothing to deactivate at %s`, this);\n            e.pop();\n            return;\n\n          case 128:\n            this.logger.trace(`deactivate() - already deactivating at %s`, this);\n            e.pop();\n            return;\n\n          default:\n            this.unexpectedState(\"deactivate\");\n        }\n    }\n    activate(t, i, e) {\n        xt(i);\n        $t(this, i);\n        e.push();\n        if (32 === this.nextState && \"dynamic\" === this.$resolution) {\n            this.logger.trace(`activate() - invoking canLoad(), load() and activate() on new component due to resolution 'dynamic' at %s`, this);\n            Batch.start((t => {\n                this.canLoad(i, t);\n            })).continueWith((t => {\n                this.load(i, t);\n            })).continueWith((e => {\n                this.activate(t, i, e);\n            })).continueWith((() => {\n                e.pop();\n            })).start();\n            return;\n        }\n        switch (this.nextState) {\n          case 2:\n            this.logger.trace(`activate() - invoking on existing component at %s`, this);\n            this.nextState = 1;\n            Batch.start((e => {\n                switch (this.$plan) {\n                  case \"none\":\n                  case \"invoke-lifecycles\":\n                    return;\n\n                  case \"replace\":\n                    {\n                        const s = this.hostController;\n                        const n = 0;\n                        i.run((() => {\n                            e.push();\n                            return this.nextCA.activate(t, s, n);\n                        }), (() => {\n                            e.pop();\n                        }));\n                    }\n                }\n            })).continueWith((t => {\n                this.processDynamicChildren(i, t);\n            })).continueWith((() => {\n                e.pop();\n            })).start();\n            return;\n\n          case 64:\n            this.logger.trace(`activate() - nothing to activate at %s`, this);\n            e.pop();\n            return;\n\n          default:\n            this.unexpectedState(\"activate\");\n        }\n    }\n    swap(t, i) {\n        if (8192 === this.currState) {\n            this.logger.trace(`swap() - running activate on next instead, because there is nothing to deactivate at %s`, this);\n            this.activate(null, t, i);\n            return;\n        }\n        if (64 === this.nextState) {\n            this.logger.trace(`swap() - running deactivate on current instead, because there is nothing to activate at %s`, this);\n            this.deactivate(null, t, i);\n            return;\n        }\n        xt(t);\n        $t(this, t);\n        if (!(256 === this.currState && 2 === this.nextState)) this.unexpectedState(\"swap\");\n        this.currState = 128;\n        this.nextState = 1;\n        switch (this.$plan) {\n          case \"none\":\n          case \"invoke-lifecycles\":\n            {\n                this.logger.trace(`swap() - skipping this level and swapping children instead at %s`, this);\n                const e = F(this.nextNode.children, this.currNode.children);\n                for (const s of e) s.context.vpa.swap(t, i);\n                return;\n            }\n\n          case \"replace\":\n            {\n                this.logger.trace(`swap() - running normally at %s`, this);\n                const e = this.hostController;\n                const s = this.curCA;\n                const n = this.nextCA;\n                const o = this.viewport.stateful ? 0 : 16;\n                const r = 0;\n                i.push();\n                Batch.start((i => {\n                    t.run((() => {\n                        i.push();\n                        return s.deactivate(null, e, o);\n                    }), (() => {\n                        i.pop();\n                    }));\n                })).continueWith((i => {\n                    t.run((() => {\n                        i.push();\n                        return n.activate(null, e, r);\n                    }), (() => {\n                        i.pop();\n                    }));\n                })).continueWith((i => {\n                    this.processDynamicChildren(t, i);\n                })).continueWith((() => {\n                    i.pop();\n                })).start();\n                return;\n            }\n        }\n    }\n    processDynamicChildren(t, i) {\n        this.logger.trace(`processDynamicChildren() - %s`, this);\n        const e = this.nextNode;\n        t.run((() => {\n            i.push();\n            return Nt(e);\n        }), (e => {\n            Batch.start((i => {\n                for (const s of e) t.run((() => {\n                    i.push();\n                    return s.context.vpa.canLoad(t, i);\n                }), (() => {\n                    i.pop();\n                }));\n            })).continueWith((i => {\n                for (const s of e) t.run((() => {\n                    i.push();\n                    return s.context.vpa.load(t, i);\n                }), (() => {\n                    i.pop();\n                }));\n            })).continueWith((i => {\n                for (const s of e) t.run((() => {\n                    i.push();\n                    return s.context.vpa.activate(null, t, i);\n                }), (() => {\n                    i.pop();\n                }));\n            })).continueWith((() => {\n                i.pop();\n            })).start();\n        }));\n    }\n    scheduleUpdate(t, i) {\n        var e, s;\n        switch (this.nextState) {\n          case 64:\n            this.nextNode = i;\n            this.nextState = 32;\n            this.$resolution = t.resolutionMode;\n            break;\n\n          default:\n            this.unexpectedState(\"scheduleUpdate 1\");\n        }\n        switch (this.currState) {\n          case 8192:\n          case 4096:\n          case 1024:\n            break;\n\n          default:\n            this.unexpectedState(\"scheduleUpdate 2\");\n        }\n        const n = null !== (s = null === (e = this.curCA) || void 0 === e ? void 0 : e.routeNode) && void 0 !== s ? s : null;\n        if (null === n || n.component !== i.component) this.$plan = \"replace\"; else {\n            const t = i.context.definition.config.transitionPlan;\n            if (\"function\" === typeof t) this.$plan = t(n, i); else this.$plan = t;\n        }\n        this.logger.trace(`scheduleUpdate(next:%s) - plan set to '%s'`, i, this.$plan);\n    }\n    cancelUpdate() {\n        if (null !== this.currNode) this.currNode.children.forEach((function(t) {\n            t.context.vpa.cancelUpdate();\n        }));\n        if (null !== this.nextNode) this.nextNode.children.forEach((function(t) {\n            t.context.vpa.cancelUpdate();\n        }));\n        this.logger.trace(`cancelUpdate(nextNode:%s)`, this.nextNode);\n        switch (this.currState) {\n          case 8192:\n          case 4096:\n            break;\n\n          case 2048:\n          case 1024:\n            this.currState = 4096;\n            break;\n        }\n        switch (this.nextState) {\n          case 64:\n          case 32:\n          case 16:\n          case 8:\n            this.nextNode = null;\n            this.nextState = 64;\n            break;\n        }\n    }\n    endTransition() {\n        if (null !== this.currNode) this.currNode.children.forEach((function(t) {\n            t.context.vpa.endTransition();\n        }));\n        if (null !== this.nextNode) this.nextNode.children.forEach((function(t) {\n            t.context.vpa.endTransition();\n        }));\n        if (null !== this.currTransition) {\n            xt(this.currTransition);\n            switch (this.nextState) {\n              case 64:\n                switch (this.currState) {\n                  case 128:\n                    this.logger.trace(`endTransition() - setting currState to State.nextIsEmpty at %s`, this);\n                    this.currState = 8192;\n                    this.curCA = null;\n                    break;\n\n                  default:\n                    this.unexpectedState(\"endTransition 1\");\n                }\n                break;\n\n              case 1:\n                switch (this.currState) {\n                  case 8192:\n                  case 128:\n                    switch (this.$plan) {\n                      case \"none\":\n                      case \"invoke-lifecycles\":\n                        this.logger.trace(`endTransition() - setting currState to State.currIsActive at %s`, this);\n                        this.currState = 4096;\n                        break;\n\n                      case \"replace\":\n                        this.logger.trace(`endTransition() - setting currState to State.currIsActive and reassigning curCA at %s`, this);\n                        this.currState = 4096;\n                        this.curCA = this.nextCA;\n                        break;\n                    }\n                    this.currNode = this.nextNode;\n                    break;\n\n                  default:\n                    this.unexpectedState(\"endTransition 2\");\n                }\n                break;\n\n              default:\n                this.unexpectedState(\"endTransition 3\");\n            }\n            this.$plan = \"replace\";\n            this.nextState = 64;\n            this.nextNode = null;\n            this.nextCA = null;\n            this.prevTransition = this.currTransition;\n            this.currTransition = null;\n        }\n    }\n    toString() {\n        return `VPA(state:${this.$state},plan:'${this.$plan}',resolution:'${this.$resolution}',n:${this.nextNode},c:${this.currNode},viewport:${this.viewport})`;\n    }\n    dispose() {\n        var t;\n        if (this.viewport.stateful) this.logger.trace(`dispose() - not disposing stateful viewport at %s`, this); else {\n            this.logger.trace(`dispose() - disposing %s`, this);\n            null === (t = this.curCA) || void 0 === t ? void 0 : t.dispose();\n        }\n    }\n    unexpectedState(t) {\n        throw new Error(`Unexpected state at ${t} of ${this}`);\n    }\n}\n\nfunction $t(t, i) {\n    if (true !== i.guardsResult) throw new Error(`Unexpected guardsResult ${i.guardsResult} at ${t}`);\n}\n\nfunction xt(t) {\n    if (void 0 !== t.error) throw t.error;\n}\n\nvar Et;\n\n(function(t) {\n    t[t[\"curr\"] = 16256] = \"curr\";\n    t[t[\"currIsEmpty\"] = 8192] = \"currIsEmpty\";\n    t[t[\"currIsActive\"] = 4096] = \"currIsActive\";\n    t[t[\"currCanUnload\"] = 2048] = \"currCanUnload\";\n    t[t[\"currCanUnloadDone\"] = 1024] = \"currCanUnloadDone\";\n    t[t[\"currUnload\"] = 512] = \"currUnload\";\n    t[t[\"currUnloadDone\"] = 256] = \"currUnloadDone\";\n    t[t[\"currDeactivate\"] = 128] = \"currDeactivate\";\n    t[t[\"next\"] = 127] = \"next\";\n    t[t[\"nextIsEmpty\"] = 64] = \"nextIsEmpty\";\n    t[t[\"nextIsScheduled\"] = 32] = \"nextIsScheduled\";\n    t[t[\"nextCanLoad\"] = 16] = \"nextCanLoad\";\n    t[t[\"nextCanLoadDone\"] = 8] = \"nextCanLoadDone\";\n    t[t[\"nextLoad\"] = 4] = \"nextLoad\";\n    t[t[\"nextLoadDone\"] = 2] = \"nextLoadDone\";\n    t[t[\"nextActivate\"] = 1] = \"nextActivate\";\n    t[t[\"bothAreEmpty\"] = 8256] = \"bothAreEmpty\";\n})(Et || (Et = {}));\n\nconst yt = new Map;\n\nfunction bt(t) {\n    let i = yt.get(t);\n    if (void 0 === i) yt.set(t, i = Rt(t));\n    return i;\n}\n\nfunction Rt(t) {\n    const i = [];\n    if (8192 === (8192 & t)) i.push(\"currIsEmpty\");\n    if (4096 === (4096 & t)) i.push(\"currIsActive\");\n    if (2048 === (2048 & t)) i.push(\"currCanUnload\");\n    if (1024 === (1024 & t)) i.push(\"currCanUnloadDone\");\n    if (512 === (512 & t)) i.push(\"currUnload\");\n    if (256 === (256 & t)) i.push(\"currUnloadDone\");\n    if (128 === (128 & t)) i.push(\"currDeactivate\");\n    if (64 === (64 & t)) i.push(\"nextIsEmpty\");\n    if (32 === (32 & t)) i.push(\"nextIsScheduled\");\n    if (16 === (16 & t)) i.push(\"nextCanLoad\");\n    if (8 === (8 & t)) i.push(\"nextCanLoadDone\");\n    if (4 === (4 & t)) i.push(\"nextLoad\");\n    if (2 === (2 & t)) i.push(\"nextLoadDone\");\n    if (1 === (1 & t)) i.push(\"nextActivate\");\n    return i.join(\"|\");\n}\n\nlet St = 0;\n\nclass RouteNode {\n    constructor(t, i, e, s, n, o, r, h, a, c, u, l, d, f, p, v) {\n        this.id = t;\n        this.path = i;\n        this.finalPath = e;\n        this.context = s;\n        this.originalInstruction = n;\n        this.instruction = o;\n        this.params = r;\n        this.queryParams = h;\n        this.fragment = a;\n        this.data = c;\n        this.viewport = u;\n        this.title = l;\n        this.component = d;\n        this.append = f;\n        this.children = p;\n        this.residue = v;\n        this.version = 1;\n        this.originalInstruction = o;\n    }\n    get root() {\n        return this.tree.root;\n    }\n    static create(t) {\n        var i, e, s, n, o, r, h, a;\n        const {[ti]: c, ...u} = null !== (i = t.params) && void 0 !== i ? i : {};\n        return new RouteNode(++St, t.path, t.finalPath, t.context, t.instruction, t.instruction, u, null !== (e = t.queryParams) && void 0 !== e ? e : Ut, null !== (s = t.fragment) && void 0 !== s ? s : null, null !== (n = t.data) && void 0 !== n ? n : {}, null !== (o = t.viewport) && void 0 !== o ? o : null, null !== (r = t.title) && void 0 !== r ? r : null, t.component, t.append, null !== (h = t.children) && void 0 !== h ? h : [], null !== (a = t.residue) && void 0 !== a ? a : []);\n    }\n    contains(t) {\n        var i, e;\n        if (this.context === t.options.context) {\n            const s = this.children;\n            const n = t.children;\n            for (let t = 0, o = s.length; t < o; ++t) for (let r = 0, h = n.length; r < h; ++r) if (t + r < o && (null !== (e = null === (i = s[t + r].instruction) || void 0 === i ? void 0 : i.contains(n[r])) && void 0 !== e ? e : false)) {\n                if (r + 1 === h) return true;\n            } else break;\n        }\n        return this.children.some((function(i) {\n            return i.contains(t);\n        }));\n    }\n    appendChild(t) {\n        this.children.push(t);\n        t.setTree(this.tree);\n    }\n    clearChildren() {\n        for (const t of this.children) {\n            t.clearChildren();\n            t.context.vpa.cancelUpdate();\n        }\n        this.children.length = 0;\n    }\n    getTitle(t) {\n        const i = [ ...this.children.map((i => i.getTitle(t))), this.getTitlePart() ].filter((t => null !== t));\n        if (0 === i.length) return null;\n        return i.join(t);\n    }\n    getTitlePart() {\n        if (\"function\" === typeof this.title) return this.title.call(void 0, this);\n        return this.title;\n    }\n    computeAbsolutePath() {\n        if (this.context.isRoot) return \"\";\n        const t = this.context.parent.node.computeAbsolutePath();\n        const i = this.instruction.toUrlComponent(false);\n        if (t.length > 0) {\n            if (i.length > 0) return [ t, i ].join(\"/\");\n            return t;\n        }\n        return i;\n    }\n    setTree(t) {\n        this.tree = t;\n        for (const i of this.children) i.setTree(t);\n    }\n    finalizeInstruction() {\n        const t = this.children.map((t => t.finalizeInstruction()));\n        const i = this.instruction.clone();\n        i.children.splice(0, i.children.length, ...t);\n        return this.instruction = i;\n    }\n    clone() {\n        const t = new RouteNode(this.id, this.path, this.finalPath, this.context, this.originalInstruction, this.instruction, {\n            ...this.params\n        }, {\n            ...this.queryParams\n        }, this.fragment, {\n            ...this.data\n        }, this.viewport, this.title, this.component, this.append, this.children.map((t => t.clone())), [ ...this.residue ]);\n        t.version = this.version + 1;\n        if (t.context.node === this) t.context.node = t;\n        return t;\n    }\n    toString() {\n        var t, i, e, s, n, o;\n        const r = [];\n        const h = null !== (e = null === (i = null === (t = this.context) || void 0 === t ? void 0 : t.definition.component) || void 0 === i ? void 0 : i.name) && void 0 !== e ? e : \"\";\n        if (h.length > 0) r.push(`c:'${h}'`);\n        const a = null !== (n = null === (s = this.context) || void 0 === s ? void 0 : s.definition.config.path) && void 0 !== n ? n : \"\";\n        if (a.length > 0) r.push(`path:'${a}'`);\n        if (this.children.length > 0) r.push(`children:[${this.children.map(String).join(\",\")}]`);\n        if (this.residue.length > 0) r.push(`residue:${this.residue.map((function(t) {\n            if (\"string\" === typeof t) return `'${t}'`;\n            return String(t);\n        })).join(\",\")}`);\n        return `RN(ctx:'${null === (o = this.context) || void 0 === o ? void 0 : o.friendlyPath}',${r.join(\",\")})`;\n    }\n}\n\nclass RouteTree {\n    constructor(t, i, e, s) {\n        this.options = t;\n        this.queryParams = i;\n        this.fragment = e;\n        this.root = s;\n    }\n    contains(t) {\n        return this.root.contains(t);\n    }\n    clone() {\n        const t = new RouteTree(this.options.clone(), {\n            ...this.queryParams\n        }, this.fragment, this.root.clone());\n        t.root.setTree(this);\n        return t;\n    }\n    finalizeInstructions() {\n        return new ViewportInstructionTree(this.options, true, this.root.children.map((t => t.finalizeInstruction())), this.queryParams, this.fragment);\n    }\n    toString() {\n        return this.root.toString();\n    }\n}\n\nfunction kt(t, i, e) {\n    const s = e.container.get(n).scopeTo(\"RouteTree\");\n    const o = e.root;\n    t.options = i.options;\n    t.queryParams = i.queryParams;\n    t.fragment = i.fragment;\n    if (i.isAbsolute) e = o;\n    if (e === o) {\n        t.root.setTree(t);\n        o.node = t.root;\n    }\n    const h = e.resolved instanceof Promise ? \" - awaiting promise\" : \"\";\n    s.trace(`updateRouteTree(rootCtx:%s,rt:%s,vit:%s)${h}`, o, t, i);\n    return r(e.resolved, (() => Ct(s, i, e, o.node)));\n}\n\nfunction Ct(t, i, e, s) {\n    t.trace(`updateNode(ctx:%s,node:%s)`, e, s);\n    s.queryParams = i.queryParams;\n    s.fragment = i.fragment;\n    let n;\n    if (!s.context.isRoot) n = s.context.vpa.scheduleUpdate(s.tree.options, s); else n = void 0;\n    return r(n, (() => {\n        if (s.context === e) {\n            s.clearChildren();\n            return r(h(...i.children.map((i => Tt(t, s, i, s.tree.options.append || i.append)))), (() => h(...e.getAvailableViewportAgents(\"dynamic\").map((i => {\n                const e = ViewportInstruction.create({\n                    component: i.viewport.default,\n                    viewport: i.viewport.name\n                });\n                return Tt(t, s, e, s.append);\n            })))));\n        }\n        return h(...s.children.map((s => Ct(t, i, e, s))));\n    }));\n}\n\nfunction It(t) {\n    const i = t.context;\n    const e = i.container.get(n).scopeTo(\"RouteTree\");\n    const s = i.resolved instanceof Promise ? \" - awaiting promise\" : \"\";\n    e.trace(`processResidue(node:%s)${s}`, t);\n    return r(i.resolved, (() => h(...t.residue.splice(0).map((i => Tt(e, t, i, t.append))), ...i.getAvailableViewportAgents(\"static\").map((i => {\n        const s = ViewportInstruction.create({\n            component: i.viewport.default,\n            viewport: i.viewport.name\n        });\n        return Tt(e, t, s, t.append);\n    })))));\n}\n\nfunction Nt(t) {\n    const i = t.context;\n    const e = i.container.get(n).scopeTo(\"RouteTree\");\n    const s = i.resolved instanceof Promise ? \" - awaiting promise\" : \"\";\n    e.trace(`getDynamicChildren(node:%s)${s}`, t);\n    return r(i.resolved, (() => {\n        const s = t.children.slice();\n        return r(h(...t.residue.splice(0).map((i => Tt(e, t, i, t.append))), ...i.getAvailableViewportAgents(\"dynamic\").map((i => {\n            const s = ViewportInstruction.create({\n                component: i.viewport.default,\n                viewport: i.viewport.name\n            });\n            return Tt(e, t, s, t.append);\n        }))), (() => t.children.filter((t => !s.includes(t)))));\n    }));\n}\n\nfunction Tt(t, i, e, s) {\n    var n, o, r;\n    t.trace(`createAndAppendNodes(node:%s,vi:%s,append:${s})`, i, e);\n    switch (e.component.type) {\n      case 0:\n        switch (e.component.value) {\n          case \"..\":\n            i.clearChildren();\n            i = null !== (o = null === (n = i.context.parent) || void 0 === n ? void 0 : n.node) && void 0 !== o ? o : i;\n\n          case \".\":\n            return h(...e.children.map((e => Tt(t, i, e, e.append))));\n\n          default:\n            {\n                t.trace(`createAndAppendNodes invoking createNode`);\n                const n = At(t, i, e, s);\n                if (null === n) return;\n                return Pt(t, i, n);\n            }\n        }\n\n      case 4:\n      case 2:\n        {\n            const n = RouteDefinition.resolve(e.component.value, i.context.definition);\n            const o = null !== (r = e.params) && void 0 !== r ? r : c;\n            const h = new $RecognizedRoute(new B(new D(new M(n.path[0], n.caseSensitive, n), a(Object.values(o))), o), null);\n            const u = Vt(t, i, e, s, h);\n            return Pt(t, i, u);\n        }\n    }\n}\n\nfunction At(t, i, e, s) {\n    var n, o;\n    const r = i.context;\n    let h = 0;\n    let a = e.component.value;\n    let c = e;\n    while (1 === c.children.length) {\n        c = c.children[0];\n        if (0 === c.component.type) {\n            ++h;\n            a = `${a}/${c.component.value}`;\n        } else break;\n    }\n    const u = r.recognize(a);\n    t.trace(\"createNode recognized route: %s\", u);\n    const l = null !== (n = null === u || void 0 === u ? void 0 : u.residue) && void 0 !== n ? n : null;\n    t.trace(\"createNode residue:\", l);\n    const d = null === l;\n    if (null === u || l === a) {\n        const n = e.component.value;\n        if (\"\" === n) return null;\n        let o = e.viewport;\n        if (null === o || 0 === o.length) o = Zt;\n        const h = r.getFallbackViewportAgent(\"dynamic\", o);\n        const a = null !== h ? h.viewport.fallback : r.definition.fallback;\n        if (null === a) throw new Error(`Neither the route '${n}' matched any configured route at '${r.friendlyPath}' nor a fallback is configured for the viewport '${o}' - did you forget to add '${n}' to the routes list of the route decorator of '${r.component.name}'?`);\n        t.trace(`Fallback is set to '${a}'. Looking for a recognized route.`);\n        const c = r.childRoutes.find((t => t.id === a));\n        if (void 0 !== c) return Lt(t, c, i, e, s);\n        t.trace(`No route definition for the fallback '${a}' is found; trying to recognize the route.`);\n        const u = r.recognize(a, true);\n        if (null !== u) return Vt(t, i, e, s, u);\n        t.trace(`The fallback '${a}' is not recognized as a route; treating as custom element name.`);\n        return Lt(t, RouteDefinition.resolve(a, r.definition, r), i, e, s);\n    }\n    u.residue = null;\n    e.component.value = d ? a : a.slice(0, -(l.length + 1));\n    for (let t = 0; t < h; ++t) {\n        const t = e.children[0];\n        if (null !== (o = null === l || void 0 === l ? void 0 : l.startsWith(t.component.value)) && void 0 !== o ? o : false) break;\n        e.children = t.children;\n    }\n    t.trace(\"createNode after adjustment vi:%s\", e);\n    return Vt(t, i, e, s, u);\n}\n\nfunction Vt(t, i, e, s, n, o = n.route.endpoint.route) {\n    const h = i.context;\n    const a = i.tree;\n    return r(o.handler, (r => {\n        var c, u, l;\n        o.handler = r;\n        t.trace(`creatingConfiguredNode(rd:%s, vi:%s)`, r, e);\n        if (null === r.redirectTo) {\n            const l = (null !== (u = null === (c = e.viewport) || void 0 === c ? void 0 : c.length) && void 0 !== u ? u : 0) > 0 ? e.viewport : r.viewport;\n            const d = r.component;\n            const f = h.resolveViewportAgent(new ViewportRequest(l, d.name, a.options.resolutionMode, s));\n            const p = h.container.get(Mt);\n            const v = p.getRouteContext(f, d, f.hostController.container, h.definition);\n            t.trace(\"createConfiguredNode setting the context node\");\n            v.node = RouteNode.create({\n                path: n.route.endpoint.route.path,\n                finalPath: o.path,\n                context: v,\n                instruction: e,\n                params: {\n                    ...i.params,\n                    ...n.route.params\n                },\n                queryParams: a.queryParams,\n                fragment: a.fragment,\n                data: r.data,\n                viewport: l,\n                component: d,\n                append: s,\n                title: r.config.title,\n                residue: [ ...null === n.residue ? [] : [ ViewportInstruction.create(n.residue) ], ...e.children ]\n            });\n            v.node.setTree(i.tree);\n            t.trace(`createConfiguredNode(vi:%s) -> %s`, e, v.node);\n            return v.node;\n        }\n        const d = RouteExpression.parse(o.path, false);\n        const f = RouteExpression.parse(r.redirectTo, false);\n        let p;\n        let v;\n        const g = [];\n        switch (d.root.kind) {\n          case 2:\n          case 4:\n            p = d.root;\n            break;\n\n          default:\n            throw new Error(`Unexpected expression kind ${d.root.kind}`);\n        }\n        switch (f.root.kind) {\n          case 2:\n          case 4:\n            v = f.root;\n            break;\n\n          default:\n            throw new Error(`Unexpected expression kind ${f.root.kind}`);\n        }\n        let w;\n        let m;\n        let $ = false;\n        let x = false;\n        while (!($ && x)) {\n            if ($) w = null; else if (4 === p.kind) {\n                w = p;\n                $ = true;\n            } else if (4 === p.left.kind) {\n                w = p.left;\n                switch (p.right.kind) {\n                  case 2:\n                  case 4:\n                    p = p.right;\n                    break;\n\n                  default:\n                    throw new Error(`Unexpected expression kind ${p.right.kind}`);\n                }\n            } else throw new Error(`Unexpected expression kind ${p.left.kind}`);\n            if (x) m = null; else if (4 === v.kind) {\n                m = v;\n                x = true;\n            } else if (4 === v.left.kind) {\n                m = v.left;\n                switch (v.right.kind) {\n                  case 2:\n                  case 4:\n                    v = v.right;\n                    break;\n\n                  default:\n                    throw new Error(`Unexpected expression kind ${v.right.kind}`);\n                }\n            } else throw new Error(`Unexpected expression kind ${v.left.kind}`);\n            if (null !== m) if (m.component.isDynamic && (null !== (l = null === w || void 0 === w ? void 0 : w.component.isDynamic) && void 0 !== l ? l : false)) g.push(n.route.params[w.component.name]); else g.push(m.raw);\n        }\n        const E = g.filter(Boolean).join(\"/\");\n        const y = h.recognize(E);\n        if (null === y) throw new Error(`'${E}' did not match any configured route or registered component name at '${h.friendlyPath}' - did you forget to add '${E}' to the routes list of the route decorator of '${h.component.name}'?`);\n        return Vt(t, i, e, s, n, y.route.endpoint.route);\n    }));\n}\n\nfunction Pt(t, i, e) {\n    return r(e, (e => {\n        t.trace(`appendNode($childNode:%s)`, e);\n        i.appendChild(e);\n        return e.context.vpa.scheduleUpdate(i.tree.options, e);\n    }));\n}\n\nfunction Lt(t, i, e, s, n) {\n    const o = new $RecognizedRoute(new B(new D(new M(i.path[0], i.caseSensitive, i), []), c), null);\n    s.children.length = 0;\n    return Vt(t, e, s, n, o);\n}\n\nconst Ut = Object.freeze(new URLSearchParams);\n\nconst Ot = \"au-nav-id\";\n\nfunction jt(i) {\n    return t(i) && true === Object.prototype.hasOwnProperty.call(i, Ot);\n}\n\nfunction Bt(t, i) {\n    return {\n        ...t,\n        [Ot]: i\n    };\n}\n\nfunction Dt(t, i) {\n    if (\"function\" === typeof i) return i(t);\n    return i;\n}\n\nclass RouterOptions {\n    constructor(t, i, e, s, n, o) {\n        this.useUrlFragmentHash = t;\n        this.useHref = i;\n        this.resolutionMode = e;\n        this.historyStrategy = s;\n        this.sameUrlStrategy = n;\n        this.buildTitle = o;\n    }\n    static get DEFAULT() {\n        return RouterOptions.create({});\n    }\n    static create(t) {\n        var i, e, s, n, o, r;\n        return new RouterOptions(null !== (i = t.useUrlFragmentHash) && void 0 !== i ? i : false, null !== (e = t.useHref) && void 0 !== e ? e : true, null !== (s = t.resolutionMode) && void 0 !== s ? s : \"dynamic\", null !== (n = t.historyStrategy) && void 0 !== n ? n : \"push\", null !== (o = t.sameUrlStrategy) && void 0 !== o ? o : \"ignore\", null !== (r = t.buildTitle) && void 0 !== r ? r : null);\n    }\n    getHistoryStrategy(t) {\n        return Dt(t, this.historyStrategy);\n    }\n    getSameUrlStrategy(t) {\n        return Dt(t, this.sameUrlStrategy);\n    }\n    stringifyProperties() {\n        return [ [ \"resolutionMode\", \"resolution\" ], [ \"historyStrategy\", \"history\" ], [ \"sameUrlStrategy\", \"sameUrl\" ] ].map((([t, i]) => {\n            const e = this[t];\n            return `${i}:${\"function\" === typeof e ? e : `'${e}'`}`;\n        })).join(\",\");\n    }\n    clone() {\n        return new RouterOptions(this.useUrlFragmentHash, this.useHref, this.resolutionMode, this.historyStrategy, this.sameUrlStrategy, this.buildTitle);\n    }\n    toString() {\n        return `RO(${this.stringifyProperties()})`;\n    }\n}\n\nclass NavigationOptions extends RouterOptions {\n    constructor(t, i, e, s, n, o, r, h) {\n        super(t.useUrlFragmentHash, t.useHref, t.resolutionMode, t.historyStrategy, t.sameUrlStrategy, t.buildTitle);\n        this.title = i;\n        this.titleSeparator = e;\n        this.append = s;\n        this.context = n;\n        this.queryParams = o;\n        this.fragment = r;\n        this.state = h;\n    }\n    static get DEFAULT() {\n        return NavigationOptions.create({});\n    }\n    static create(t) {\n        var i, e, s, n, o, r, h;\n        return new NavigationOptions(RouterOptions.create(t), null !== (i = t.title) && void 0 !== i ? i : null, null !== (e = t.titleSeparator) && void 0 !== e ? e : \" | \", null !== (s = t.append) && void 0 !== s ? s : false, null !== (n = t.context) && void 0 !== n ? n : null, null !== (o = t.queryParams) && void 0 !== o ? o : null, null !== (r = t.fragment) && void 0 !== r ? r : \"\", null !== (h = t.state) && void 0 !== h ? h : null);\n    }\n    clone() {\n        return new NavigationOptions(super.clone(), this.title, this.titleSeparator, this.append, this.context, {\n            ...this.queryParams\n        }, this.fragment, null === this.state ? null : {\n            ...this.state\n        });\n    }\n    toString() {\n        return `NO(${super.stringifyProperties()})`;\n    }\n}\n\nclass Navigation {\n    constructor(t, i, e, s, n, o) {\n        this.id = t;\n        this.instructions = i;\n        this.trigger = e;\n        this.options = s;\n        this.prevNavigation = n;\n        this.finalInstructions = o;\n    }\n    static create(t) {\n        return new Navigation(t.id, t.instructions, t.trigger, t.options, t.prevNavigation, t.finalInstructions);\n    }\n    toString() {\n        return `N(id:${this.id},instructions:${this.instructions},trigger:'${this.trigger}')`;\n    }\n}\n\nclass Transition {\n    constructor(t, i, e, s, n, o, r, h, a, c, u, l, d, f, p) {\n        this.id = t;\n        this.prevInstructions = i;\n        this.instructions = e;\n        this.finalInstructions = s;\n        this.instructionsChanged = n;\n        this.trigger = o;\n        this.options = r;\n        this.managedState = h;\n        this.previousRouteTree = a;\n        this.routeTree = c;\n        this.promise = u;\n        this.resolve = l;\n        this.reject = d;\n        this.guardsResult = f;\n        this.error = p;\n    }\n    static create(t) {\n        return new Transition(t.id, t.prevInstructions, t.instructions, t.finalInstructions, t.instructionsChanged, t.trigger, t.options, t.managedState, t.previousRouteTree, t.routeTree, t.promise, t.resolve, t.reject, t.guardsResult, void 0);\n    }\n    run(t, i) {\n        if (true !== this.guardsResult) return;\n        try {\n            const e = t();\n            if (e instanceof Promise) e.then(i).catch((t => {\n                this.handleError(t);\n            })); else i(e);\n        } catch (t) {\n            this.handleError(t);\n        }\n    }\n    handleError(t) {\n        this.reject(this.error = t);\n    }\n    toString() {\n        return `T(id:${this.id},trigger:'${this.trigger}',instructions:${this.instructions},options:${this.options})`;\n    }\n}\n\nconst Mt = e.createInterface(\"IRouter\", (t => t.singleton(Ht)));\n\nlet Ht = class Router {\n    constructor(t, i, e, s, n) {\n        this.container = t;\n        this.p = i;\n        this.logger = e;\n        this.events = s;\n        this.locationMgr = n;\n        this.t = null;\n        this.i = null;\n        this.h = null;\n        this.options = RouterOptions.DEFAULT;\n        this.navigated = false;\n        this.navigationId = 0;\n        this.lastSuccessfulNavigation = null;\n        this.activeNavigation = null;\n        this.instructions = ViewportInstructionTree.create(\"\");\n        this.nextTr = null;\n        this.locationChangeSubscription = null;\n        this.u = false;\n        this.vpaLookup = new Map;\n        this.logger = e.root.scopeTo(\"Router\");\n    }\n    get ctx() {\n        let t = this.t;\n        if (null === t) {\n            if (!this.container.has(Xt, true)) throw new Error(`Root RouteContext is not set. Did you forget to register RouteConfiguration, or try to navigate before calling Aurelia.start()?`);\n            t = this.t = this.container.get(Xt);\n        }\n        return t;\n    }\n    get routeTree() {\n        let t = this.i;\n        if (null === t) {\n            const i = this.ctx;\n            t = this.i = new RouteTree(NavigationOptions.create({\n                ...this.options\n            }), Ut, null, RouteNode.create({\n                path: \"\",\n                finalPath: \"\",\n                context: i,\n                instruction: null,\n                component: i.definition.component,\n                append: false,\n                title: i.definition.config.title\n            }));\n        }\n        return t;\n    }\n    get currentTr() {\n        let t = this.h;\n        if (null === t) t = this.h = Transition.create({\n            id: 0,\n            prevInstructions: this.instructions,\n            instructions: this.instructions,\n            finalInstructions: this.instructions,\n            instructionsChanged: true,\n            trigger: \"api\",\n            options: NavigationOptions.DEFAULT,\n            managedState: null,\n            previousRouteTree: this.routeTree.clone(),\n            routeTree: this.routeTree,\n            resolve: null,\n            reject: null,\n            promise: null,\n            guardsResult: true,\n            error: void 0\n        });\n        return t;\n    }\n    set currentTr(t) {\n        this.h = t;\n    }\n    resolveContext(t) {\n        return RouteContext.resolve(this.ctx, t);\n    }\n    start(t, i) {\n        this.options = RouterOptions.create(t);\n        this.u = \"function\" === typeof this.options.buildTitle;\n        this.locationMgr.startListening();\n        this.locationChangeSubscription = this.events.subscribe(\"au:router:location-change\", (t => {\n            this.p.taskQueue.queueTask((() => {\n                const i = jt(t.state) ? t.state : null;\n                const e = NavigationOptions.create({\n                    ...this.options,\n                    historyStrategy: \"replace\"\n                });\n                const s = ViewportInstructionTree.create(t.url, e);\n                this.enqueue(s, t.trigger, i, null);\n            }));\n        }));\n        if (!this.navigated && i) return this.load(this.locationMgr.getPath(), {\n            historyStrategy: \"replace\"\n        });\n    }\n    stop() {\n        var t;\n        this.locationMgr.stopListening();\n        null === (t = this.locationChangeSubscription) || void 0 === t ? void 0 : t.dispose();\n    }\n    load(t, i) {\n        const e = this.createViewportInstructions(t, i);\n        this.logger.trace(\"load(instructions:%s)\", e);\n        return this.enqueue(e, \"api\", null, null);\n    }\n    isActive(t, i) {\n        const e = this.resolveContext(i);\n        const s = this.createViewportInstructions(t, {\n            context: e\n        });\n        this.logger.trace(\"isActive(instructions:%s,ctx:%s)\", s, e);\n        return this.routeTree.contains(s);\n    }\n    getRouteContext(t, i, e, s) {\n        const o = e.get(n).scopeTo(\"RouteContext\");\n        const r = RouteDefinition.resolve(i.Type, s);\n        let h = this.vpaLookup.get(t);\n        if (void 0 === h) this.vpaLookup.set(t, h = new WeakMap);\n        let a = h.get(r);\n        if (void 0 === a) {\n            o.trace(`creating new RouteContext for %s`, r);\n            const s = e.has(Xt, true) ? e.get(Xt) : null;\n            h.set(r, a = new RouteContext(t, s, i, r, e));\n        } else {\n            o.trace(`returning existing RouteContext for %s`, r);\n            if (null !== t) a.vpa = t;\n        }\n        return a;\n    }\n    createViewportInstructions(t, i) {\n        if (\"string\" === typeof t) t = this.locationMgr.removeBaseHref(t);\n        return ViewportInstructionTree.create(t, this.getNavigationOptions(i));\n    }\n    enqueue(t, i, e, s) {\n        const n = this.currentTr;\n        const o = this.logger;\n        if (\"api\" !== i && \"api\" === n.trigger && n.instructions.equals(t)) {\n            o.debug(`Ignoring navigation triggered by '%s' because it is the same URL as the previous navigation which was triggered by 'api'.`, i);\n            return true;\n        }\n        let r;\n        let h;\n        let a;\n        if (null === s) a = new Promise((function(t, i) {\n            r = t;\n            h = i;\n        })); else {\n            o.debug(`Reusing promise/resolve/reject from the previously failed transition %s`, s);\n            a = s.promise;\n            r = s.resolve;\n            h = s.reject;\n        }\n        const c = this.nextTr = Transition.create({\n            id: ++this.navigationId,\n            trigger: i,\n            managedState: e,\n            prevInstructions: n.finalInstructions,\n            finalInstructions: t,\n            instructionsChanged: !n.finalInstructions.equals(t),\n            instructions: t,\n            options: t.options,\n            promise: a,\n            resolve: r,\n            reject: h,\n            previousRouteTree: this.routeTree,\n            routeTree: this.i = this.routeTree.clone(),\n            guardsResult: true,\n            error: void 0\n        });\n        o.debug(`Scheduling transition: %s`, c);\n        if (null === this.activeNavigation) try {\n            this.run(c);\n        } catch (t) {\n            c.handleError(t);\n        }\n        return c.promise.then((t => {\n            o.debug(`Transition succeeded: %s`, c);\n            return t;\n        })).catch((t => {\n            o.error(`Navigation failed: %s`, c, t);\n            this.activeNavigation = null;\n            const i = this.nextTr;\n            if (null !== i) i.previousRouteTree = c.previousRouteTree; else this.i = c.previousRouteTree;\n            throw t;\n        }));\n    }\n    run(t) {\n        this.currentTr = t;\n        this.nextTr = null;\n        const i = null === this.lastSuccessfulNavigation ? null : Navigation.create({\n            ...this.lastSuccessfulNavigation,\n            prevNavigation: null\n        });\n        this.activeNavigation = Navigation.create({\n            id: t.id,\n            instructions: t.instructions,\n            trigger: t.trigger,\n            options: t.options,\n            prevNavigation: i,\n            finalInstructions: t.finalInstructions\n        });\n        const e = this.resolveContext(t.options.context);\n        const s = !this.navigated || t.instructions.children.length !== e.node.children.length || t.instructions.children.some(((t, i) => {\n            var s, n;\n            return !(null !== (n = null === (s = e.node.children[i]) || void 0 === s ? void 0 : s.originalInstruction.equals(t)) && void 0 !== n ? n : false);\n        }));\n        const n = s || \"reload\" === t.options.getSameUrlStrategy(this.instructions);\n        if (!n) {\n            this.logger.trace(`run(tr:%s) - NOT processing route`, t);\n            this.navigated = true;\n            this.activeNavigation = null;\n            t.resolve(false);\n            this.runNextTransition(t);\n            return;\n        }\n        this.logger.trace(`run(tr:%s) - processing route`, t);\n        this.events.publish(new NavigationStartEvent(t.id, t.instructions, t.trigger, t.managedState));\n        if (null !== this.nextTr) {\n            this.logger.debug(`run(tr:%s) - aborting because a new transition was queued in response to the NavigationStartEvent`, t);\n            return this.run(this.nextTr);\n        }\n        this.activeNavigation = Navigation.create({\n            ...this.activeNavigation,\n            finalInstructions: t.finalInstructions\n        });\n        t.run((() => {\n            this.logger.trace(`run() - compiling route tree: %s`, t.finalInstructions);\n            return kt(t.routeTree, t.finalInstructions, e);\n        }), (() => {\n            const i = t.previousRouteTree.root.children;\n            const e = t.routeTree.root.children;\n            const s = F(i, e);\n            Batch.start((e => {\n                this.logger.trace(`run() - invoking canUnload on ${i.length} nodes`);\n                for (const s of i) s.context.vpa.canUnload(t, e);\n            })).continueWith((i => {\n                if (true !== t.guardsResult) {\n                    i.push();\n                    this.cancelNavigation(t);\n                }\n            })).continueWith((i => {\n                this.logger.trace(`run() - invoking canLoad on ${e.length} nodes`);\n                for (const s of e) s.context.vpa.canLoad(t, i);\n            })).continueWith((i => {\n                if (true !== t.guardsResult) {\n                    i.push();\n                    this.cancelNavigation(t);\n                }\n            })).continueWith((e => {\n                this.logger.trace(`run() - invoking unload on ${i.length} nodes`);\n                for (const s of i) s.context.vpa.unload(t, e);\n            })).continueWith((i => {\n                this.logger.trace(`run() - invoking load on ${e.length} nodes`);\n                for (const s of e) s.context.vpa.load(t, i);\n            })).continueWith((i => {\n                this.logger.trace(`run() - invoking swap on ${s.length} nodes`);\n                for (const e of s) e.context.vpa.swap(t, i);\n            })).continueWith((() => {\n                this.logger.trace(`run() - finalizing transition`);\n                s.forEach((function(t) {\n                    t.context.vpa.endTransition();\n                }));\n                this.navigated = true;\n                this.instructions = t.finalInstructions = t.routeTree.finalizeInstructions();\n                this.events.publish(new NavigationEndEvent(t.id, t.instructions, this.instructions));\n                this.lastSuccessfulNavigation = this.activeNavigation;\n                this.activeNavigation = null;\n                this.applyHistoryState(t);\n                t.resolve(true);\n                this.runNextTransition(t);\n            })).start();\n        }));\n    }\n    applyHistoryState(t) {\n        const i = t.finalInstructions.toUrl(this.options.useUrlFragmentHash);\n        switch (t.options.getHistoryStrategy(this.instructions)) {\n          case \"none\":\n            break;\n\n          case \"push\":\n            this.locationMgr.pushState(Bt(t.options.state, t.id), this.updateTitle(t), i);\n            break;\n\n          case \"replace\":\n            this.locationMgr.replaceState(Bt(t.options.state, t.id), this.updateTitle(t), i);\n            break;\n        }\n    }\n    getTitle(t) {\n        var i, e;\n        switch (typeof t.options.title) {\n          case \"function\":\n            return null !== (i = t.options.title.call(void 0, t.routeTree.root)) && void 0 !== i ? i : \"\";\n\n          case \"string\":\n            return t.options.title;\n\n          default:\n            return null !== (e = t.routeTree.root.getTitle(t.options.titleSeparator)) && void 0 !== e ? e : \"\";\n        }\n    }\n    updateTitle(t = this.currentTr) {\n        var i;\n        const e = this.u ? null !== (i = this.options.buildTitle(t)) && void 0 !== i ? i : \"\" : this.getTitle(t);\n        if (e.length > 0) this.p.document.title = e;\n        return this.p.document.title;\n    }\n    cancelNavigation(t) {\n        this.logger.trace(`cancelNavigation(tr:%s)`, t);\n        const i = t.previousRouteTree.root.children;\n        const e = t.routeTree.root.children;\n        const s = F(i, e);\n        s.forEach((function(t) {\n            t.context.vpa.cancelUpdate();\n        }));\n        this.activeNavigation = null;\n        this.instructions = t.prevInstructions;\n        this.i = t.previousRouteTree;\n        this.events.publish(new NavigationCancelEvent(t.id, t.instructions, `guardsResult is ${t.guardsResult}`));\n        if (false === t.guardsResult) {\n            t.resolve(false);\n            this.runNextTransition(t);\n        } else void r(this.enqueue(t.guardsResult, \"api\", t.managedState, t), (() => {\n            this.logger.trace(`cancelNavigation(tr:%s) - finished redirect`, t);\n        }));\n    }\n    runNextTransition(t) {\n        if (null !== this.nextTr) {\n            this.logger.trace(`runNextTransition(tr:%s) -> scheduling nextTransition: %s`, t, this.nextTr);\n            this.p.taskQueue.queueTask((() => {\n                const t = this.nextTr;\n                if (null !== t) try {\n                    this.run(t);\n                } catch (i) {\n                    t.handleError(i);\n                }\n            }));\n        }\n    }\n    getNavigationOptions(t) {\n        return NavigationOptions.create({\n            ...this.options,\n            ...t\n        });\n    }\n};\n\nHt = st([ nt(0, u), nt(1, b), nt(2, n), nt(3, ot), nt(4, ct) ], Ht);\n\nconst zt = e.createInterface(\"IViewportInstruction\");\n\nclass ViewportInstruction {\n    constructor(t, i, e, s, n, o, r, h) {\n        this.context = t;\n        this.append = i;\n        this.open = e;\n        this.close = s;\n        this.component = n;\n        this.viewport = o;\n        this.params = r;\n        this.children = h;\n    }\n    static create(t, i) {\n        var e, s, n, o, r, h, a, c, u;\n        if (t instanceof ViewportInstruction) return t;\n        if (K(t)) {\n            const l = TypedNavigationInstruction.create(t.component);\n            const d = null !== (s = null === (e = t.children) || void 0 === e ? void 0 : e.map(ViewportInstruction.create)) && void 0 !== s ? s : [];\n            return new ViewportInstruction(null !== (o = null !== (n = t.context) && void 0 !== n ? n : i) && void 0 !== o ? o : null, null !== (r = t.append) && void 0 !== r ? r : false, null !== (h = t.open) && void 0 !== h ? h : 0, null !== (a = t.close) && void 0 !== a ? a : 0, l, null !== (c = t.viewport) && void 0 !== c ? c : null, null !== (u = t.params) && void 0 !== u ? u : null, d);\n        }\n        const l = TypedNavigationInstruction.create(t);\n        return new ViewportInstruction(null !== i && void 0 !== i ? i : null, false, 0, 0, l, null, null, []);\n    }\n    contains(t) {\n        const i = this.children;\n        const e = t.children;\n        if (i.length < e.length) return false;\n        if (!this.component.equals(t.component)) return false;\n        for (let t = 0, s = e.length; t < s; ++t) if (!i[t].contains(e[t])) return false;\n        return true;\n    }\n    equals(t) {\n        const i = this.children;\n        const e = t.children;\n        if (i.length !== e.length) return false;\n        if (!this.component.equals(t.component) || this.viewport !== t.viewport || !et(this.params, t.params)) return false;\n        for (let t = 0, s = i.length; t < s; ++t) if (!i[t].equals(e[t])) return false;\n        return true;\n    }\n    clone() {\n        return new ViewportInstruction(this.context, this.append, this.open, this.close, this.component.clone(), this.viewport, null === this.params ? null : {\n            ...this.params\n        }, [ ...this.children ]);\n    }\n    toUrlComponent(t = true) {\n        const i = this.component.toUrlComponent();\n        const e = null === this.params || 0 === Object.keys(this.params).length ? \"\" : `(${Ft(this.params)})`;\n        const s = 0 === i.length || null === this.viewport || 0 === this.viewport.length ? \"\" : `@${this.viewport}`;\n        const n = `${\"(\".repeat(this.open)}${i}${e}${s}${\")\".repeat(this.close)}`;\n        const o = t ? this.children.map((t => t.toUrlComponent())).join(\"+\") : \"\";\n        if (n.length > 0) {\n            if (o.length > 0) return [ n, o ].join(\"/\");\n            return n;\n        }\n        return o;\n    }\n    toString() {\n        const t = `c:${this.component}`;\n        const i = null === this.viewport || 0 === this.viewport.length ? \"\" : `viewport:${this.viewport}`;\n        const e = 0 === this.children.length ? \"\" : `children:[${this.children.map(String).join(\",\")}]`;\n        const s = [ t, i, e ].filter(Boolean).join(\",\");\n        return `VPI(${s})`;\n    }\n}\n\nfunction Ft(t) {\n    const i = Object.keys(t);\n    const e = Array(i.length);\n    const s = [];\n    const n = [];\n    for (const t of i) if (l(t)) s.push(Number(t)); else n.push(t);\n    for (let o = 0; o < i.length; ++o) {\n        const i = s.indexOf(o);\n        if (i > -1) {\n            e[o] = t[o];\n            s.splice(i, 1);\n        } else {\n            const i = n.shift();\n            e[o] = `${i}=${t[i]}`;\n        }\n    }\n    return e.join(\",\");\n}\n\nconst qt = function() {\n    let t = 0;\n    const i = new Map;\n    return function(e) {\n        let s = i.get(e);\n        if (void 0 === s) i.set(e, s = ++t);\n        return s;\n    };\n}();\n\nclass ViewportInstructionTree {\n    constructor(t, i, e, s, n) {\n        this.options = t;\n        this.isAbsolute = i;\n        this.children = e;\n        this.queryParams = s;\n        this.fragment = n;\n    }\n    static create(t, i) {\n        const e = NavigationOptions.create({\n            ...i\n        });\n        if (t instanceof ViewportInstructionTree) return new ViewportInstructionTree(e, t.isAbsolute, t.children.map((t => ViewportInstruction.create(t, e.context))), t.queryParams, t.fragment);\n        if (t instanceof Array) return new ViewportInstructionTree(e, false, t.map((t => ViewportInstruction.create(t, e.context))), Ut, null);\n        if (\"string\" === typeof t) {\n            const i = RouteExpression.parse(t, e.useUrlFragmentHash);\n            return i.toInstructionTree(e);\n        }\n        return new ViewportInstructionTree(e, false, [ ViewportInstruction.create(t, e.context) ], Ut, null);\n    }\n    equals(t) {\n        const i = this.children;\n        const e = t.children;\n        if (i.length !== e.length) return false;\n        for (let t = 0, s = i.length; t < s; ++t) if (!i[t].equals(e[t])) return false;\n        return true;\n    }\n    toUrl(t = false) {\n        var i;\n        let e;\n        let s;\n        if (t) {\n            e = \"\";\n            s = `#${this.toPath()}`;\n        } else {\n            e = this.toPath();\n            s = null !== (i = this.fragment) && void 0 !== i ? i : \"\";\n        }\n        let n = this.queryParams.toString();\n        n = \"\" === n ? \"\" : `?${n}`;\n        const o = `${e}${s}${n}`;\n        return o;\n    }\n    toPath() {\n        const t = this.children.map((t => t.toUrlComponent())).join(\"+\");\n        return t;\n    }\n    toString() {\n        return `[${this.children.map(String).join(\",\")}]`;\n    }\n}\n\nvar Wt;\n\n(function(t) {\n    t[t[\"string\"] = 0] = \"string\";\n    t[t[\"ViewportInstruction\"] = 1] = \"ViewportInstruction\";\n    t[t[\"CustomElementDefinition\"] = 2] = \"CustomElementDefinition\";\n    t[t[\"Promise\"] = 3] = \"Promise\";\n    t[t[\"IRouteViewModel\"] = 4] = \"IRouteViewModel\";\n})(Wt || (Wt = {}));\n\nclass TypedNavigationInstruction {\n    constructor(t, i) {\n        this.type = t;\n        this.value = i;\n    }\n    static create(i) {\n        if (i instanceof TypedNavigationInstruction) return i;\n        if (\"string\" === typeof i) return new TypedNavigationInstruction(0, i);\n        if (!t(i)) Q(\"function/class or object\", \"\", i);\n        if (\"function\" === typeof i) if (R.isType(i)) {\n            const t = R.getDefinition(i);\n            return new TypedNavigationInstruction(2, t);\n        } else return TypedNavigationInstruction.create(i());\n        if (i instanceof Promise) return new TypedNavigationInstruction(3, i);\n        if (K(i)) {\n            const t = ViewportInstruction.create(i);\n            return new TypedNavigationInstruction(1, t);\n        }\n        if (m(i)) return new TypedNavigationInstruction(4, i);\n        if (i instanceof S) return new TypedNavigationInstruction(2, i);\n        if (J(i)) {\n            const t = R.define(i);\n            const e = R.getDefinition(t);\n            return new TypedNavigationInstruction(2, e);\n        }\n        throw new Error(`Invalid component ${q(i)}: must be either a class, a custom element ViewModel, or a (partial) custom element definition`);\n    }\n    equals(t) {\n        switch (this.type) {\n          case 2:\n          case 4:\n          case 3:\n          case 0:\n            return this.type === t.type && this.value === t.value;\n\n          case 1:\n            return this.type === t.type && this.value.equals(t.value);\n        }\n    }\n    clone() {\n        return new TypedNavigationInstruction(this.type, this.value);\n    }\n    toUrlComponent() {\n        switch (this.type) {\n          case 2:\n            return this.value.name;\n\n          case 4:\n          case 3:\n            return `au$obj${qt(this.value)}`;\n\n          case 1:\n            return this.value.toUrlComponent();\n\n          case 0:\n            return this.value;\n        }\n    }\n    toString() {\n        switch (this.type) {\n          case 2:\n            return `CEDef(name:'${this.value.name}')`;\n\n          case 3:\n            return `Promise`;\n\n          case 4:\n            return `VM(name:'${R.getDefinition(this.value.constructor).name}')`;\n\n          case 1:\n            return this.value.toString();\n\n          case 0:\n            return `'${this.value}'`;\n        }\n    }\n}\n\nconst Gt = f;\n\nfunction Yt(t, i) {\n    if (!et(t.params, i.params)) return \"invoke-lifecycles\";\n    return \"none\";\n}\n\nclass RouteConfig {\n    constructor(t, i, e, s, n, o, r, h, a, c, u) {\n        this.id = t;\n        this.path = i;\n        this.title = e;\n        this.redirectTo = s;\n        this.caseSensitive = n;\n        this.transitionPlan = o;\n        this.viewport = r;\n        this.data = h;\n        this.routes = a;\n        this.fallback = c;\n        this.component = u;\n    }\n    static create(t, i) {\n        var e, s, n, o, r, h, a, c, u, l, d, f, p, v, g, w, m, $, x, E, y, b, R, S, k, C, I, N;\n        if (\"string\" === typeof t || t instanceof Array) {\n            const l = t;\n            const d = null !== (e = null === i || void 0 === i ? void 0 : i.redirectTo) && void 0 !== e ? e : null;\n            const f = null !== (s = null === i || void 0 === i ? void 0 : i.caseSensitive) && void 0 !== s ? s : false;\n            const p = null !== (n = null === i || void 0 === i ? void 0 : i.id) && void 0 !== n ? n : l instanceof Array ? l[0] : l;\n            const v = null !== (o = null === i || void 0 === i ? void 0 : i.title) && void 0 !== o ? o : null;\n            const g = null !== (r = null === i || void 0 === i ? void 0 : i.transitionPlan) && void 0 !== r ? r : Yt;\n            const w = null !== (h = null === i || void 0 === i ? void 0 : i.viewport) && void 0 !== h ? h : null;\n            const m = null !== (a = null === i || void 0 === i ? void 0 : i.data) && void 0 !== a ? a : {};\n            const $ = null !== (c = null === i || void 0 === i ? void 0 : i.routes) && void 0 !== c ? c : Gt;\n            return new RouteConfig(p, l, v, d, f, g, w, m, $, null !== (u = null === i || void 0 === i ? void 0 : i.fallback) && void 0 !== u ? u : null, null);\n        } else if (\"object\" === typeof t) {\n            const e = t;\n            X(e, \"\");\n            const s = null !== (d = null !== (l = e.path) && void 0 !== l ? l : null === i || void 0 === i ? void 0 : i.path) && void 0 !== d ? d : null;\n            const n = null !== (p = null !== (f = e.title) && void 0 !== f ? f : null === i || void 0 === i ? void 0 : i.title) && void 0 !== p ? p : null;\n            const o = null !== (g = null !== (v = e.redirectTo) && void 0 !== v ? v : null === i || void 0 === i ? void 0 : i.redirectTo) && void 0 !== g ? g : null;\n            const r = null !== (m = null !== (w = e.caseSensitive) && void 0 !== w ? w : null === i || void 0 === i ? void 0 : i.caseSensitive) && void 0 !== m ? m : false;\n            const h = null !== (x = null !== ($ = e.id) && void 0 !== $ ? $ : null === i || void 0 === i ? void 0 : i.id) && void 0 !== x ? x : s instanceof Array ? s[0] : s;\n            const a = null !== (y = null !== (E = e.transitionPlan) && void 0 !== E ? E : null === i || void 0 === i ? void 0 : i.transitionPlan) && void 0 !== y ? y : Yt;\n            const c = null !== (R = null !== (b = e.viewport) && void 0 !== b ? b : null === i || void 0 === i ? void 0 : i.viewport) && void 0 !== R ? R : null;\n            const u = {\n                ...null === i || void 0 === i ? void 0 : i.data,\n                ...e.data\n            };\n            const T = [ ...null !== (S = e.routes) && void 0 !== S ? S : Gt, ...null !== (k = null === i || void 0 === i ? void 0 : i.routes) && void 0 !== k ? k : Gt ];\n            return new RouteConfig(h, s, n, o, r, a, c, u, T, null !== (I = null !== (C = e.fallback) && void 0 !== C ? C : null === i || void 0 === i ? void 0 : i.fallback) && void 0 !== I ? I : null, null !== (N = e.component) && void 0 !== N ? N : null);\n        } else Q(\"string, function/class or object\", \"\", t);\n    }\n    applyChildRouteConfig(t) {\n        var i, e, s, n, o, r, h, a, c, u, l, d;\n        let f = null !== (i = this.path) && void 0 !== i ? i : \"\";\n        if (\"string\" !== typeof f) f = f[0];\n        X(t, f);\n        return new RouteConfig(null !== (e = t.id) && void 0 !== e ? e : this.id, null !== (s = t.path) && void 0 !== s ? s : this.path, null !== (n = t.title) && void 0 !== n ? n : this.title, null !== (o = t.redirectTo) && void 0 !== o ? o : this.redirectTo, null !== (r = t.caseSensitive) && void 0 !== r ? r : this.caseSensitive, null !== (h = t.transitionPlan) && void 0 !== h ? h : this.transitionPlan, null !== (a = t.viewport) && void 0 !== a ? a : this.viewport, null !== (c = t.data) && void 0 !== c ? c : this.data, null !== (u = t.routes) && void 0 !== u ? u : this.routes, null !== (l = t.fallback) && void 0 !== l ? l : this.fallback, null !== (d = t.component) && void 0 !== d ? d : this.component);\n    }\n}\n\nconst Jt = {\n    name: d.resource.keyFor(\"route-configuration\"),\n    isConfigured(t) {\n        return i.hasOwn(Jt.name, t);\n    },\n    configure(t, e) {\n        const s = RouteConfig.create(t, e);\n        i.define(Jt.name, s, e);\n        return e;\n    },\n    getConfig(t) {\n        if (!Jt.isConfigured(t)) Jt.configure({}, t);\n        return i.getOwn(Jt.name, t);\n    }\n};\n\nfunction _t(t) {\n    return function(i) {\n        return Jt.configure(t, i);\n    };\n}\n\nconst Zt = \"default\";\n\nclass RouteDefinition {\n    constructor(t, i, e) {\n        var s, n, o, r, h, a, c;\n        this.config = t;\n        this.component = i;\n        this.hasExplicitPath = null !== t.path;\n        this.caseSensitive = t.caseSensitive;\n        this.path = W(null !== (s = t.path) && void 0 !== s ? s : i.name);\n        this.redirectTo = null !== (n = t.redirectTo) && void 0 !== n ? n : null;\n        this.viewport = null !== (o = t.viewport) && void 0 !== o ? o : Zt;\n        this.id = G(null !== (r = t.id) && void 0 !== r ? r : this.path);\n        this.data = null !== (h = t.data) && void 0 !== h ? h : {};\n        this.fallback = null !== (c = null !== (a = t.fallback) && void 0 !== a ? a : null === e || void 0 === e ? void 0 : e.fallback) && void 0 !== c ? c : null;\n    }\n    static resolve(t, i, e) {\n        if (Z(t)) return new RouteDefinition(RouteConfig.create(t, null), null, i);\n        return r(this.resolveCustomElementDefinition(t, e), (e => {\n            let s = Kt.get(e);\n            if (null === s) {\n                const n = e.Type;\n                const o = _(t) ? Jt.isConfigured(n) ? Jt.getConfig(n).applyChildRouteConfig(t) : RouteConfig.create(t, n) : Jt.getConfig(e.Type);\n                s = new RouteDefinition(o, e, i);\n                Kt.define(s, e);\n            }\n            return s;\n        }));\n    }\n    static resolveCustomElementDefinition(t, i) {\n        if (_(t)) return this.resolveCustomElementDefinition(t.component, i);\n        const e = TypedNavigationInstruction.create(t);\n        switch (e.type) {\n          case 0:\n            {\n                if (void 0 === i) throw new Error(`When retrieving the RouteDefinition for a component name, a RouteContext (that can resolve it) must be provided`);\n                const t = i.container.find(R, e.value);\n                if (null === t) throw new Error(`Could not find a CustomElement named '${e.value}' in the current container scope of ${i}. This means the component is neither registered at Aurelia startup nor via the 'dependencies' decorator or static property.`);\n                return t;\n            }\n\n          case 2:\n            return e.value;\n\n          case 4:\n            return R.getDefinition(e.value.constructor);\n\n          case 3:\n            if (void 0 === i) throw new Error(`RouteContext must be provided when resolving an imported module`);\n            return i.resolveLazy(e.value);\n        }\n    }\n    register(t) {\n        var i;\n        null === (i = this.component) || void 0 === i ? void 0 : i.register(t);\n    }\n    toUrlComponent() {\n        return \"not-implemented\";\n    }\n    toString() {\n        const t = null === this.config.path ? \"null\" : `'${this.config.path}'`;\n        if (null !== this.component) return `RD(config.path:${t},c.name:'${this.component.name}',vp:'${this.viewport}')`; else return `RD(config.path:${t},redirectTo:'${this.redirectTo}')`;\n    }\n}\n\nconst Kt = {\n    name: d.resource.keyFor(\"route-definition\"),\n    isDefined(t) {\n        return i.hasOwn(Kt.name, t);\n    },\n    define(t, e) {\n        i.define(Kt.name, t, e);\n    },\n    get(t) {\n        return Kt.isDefined(t) ? i.getOwn(Kt.name, t) : null;\n    }\n};\n\nconst Qt = new WeakMap;\n\nclass ComponentAgent {\n    constructor(t, i, e, s, o) {\n        var r, h, a, c;\n        this.instance = t;\n        this.controller = i;\n        this.definition = e;\n        this.routeNode = s;\n        this.ctx = o;\n        this.$ = o.container.get(n).scopeTo(`ComponentAgent<${o.friendlyPath}>`);\n        this.$.trace(`constructor()`);\n        const u = i.lifecycleHooks;\n        this.canLoadHooks = (null !== (r = u.canLoad) && void 0 !== r ? r : []).map((t => t.instance));\n        this.loadHooks = (null !== (h = u.load) && void 0 !== h ? h : []).map((t => t.instance));\n        this.canUnloadHooks = (null !== (a = u.canUnload) && void 0 !== a ? a : []).map((t => t.instance));\n        this.unloadHooks = (null !== (c = u.unload) && void 0 !== c ? c : []).map((t => t.instance));\n        this.R = \"canLoad\" in t;\n        this.C = \"load\" in t;\n        this.I = \"canUnload\" in t;\n        this.N = \"unload\" in t;\n    }\n    static for(t, i, e, s) {\n        let n = Qt.get(t);\n        if (void 0 === n) {\n            const o = s.container;\n            const r = RouteDefinition.resolve(t.constructor, s.definition);\n            const h = y.$el(o, t, i.host, null);\n            Qt.set(t, n = new ComponentAgent(t, h, r, e, s));\n        }\n        return n;\n    }\n    activate(t, i, e) {\n        if (null === t) {\n            this.$.trace(`activate() - initial`);\n            return this.controller.activate(this.controller, i, e);\n        }\n        this.$.trace(`activate()`);\n        void this.controller.activate(t, i, e);\n    }\n    deactivate(t, i, e) {\n        if (null === t) {\n            this.$.trace(`deactivate() - initial`);\n            return this.controller.deactivate(this.controller, i, e);\n        }\n        this.$.trace(`deactivate()`);\n        void this.controller.deactivate(t, i, e);\n    }\n    dispose() {\n        this.$.trace(`dispose()`);\n        this.controller.dispose();\n    }\n    canUnload(t, i, e) {\n        this.$.trace(`canUnload(next:%s) - invoking ${this.canUnloadHooks.length} hooks`, i);\n        e.push();\n        for (const s of this.canUnloadHooks) t.run((() => {\n            e.push();\n            return s.canUnload(this.instance, i, this.routeNode);\n        }), (i => {\n            if (true === t.guardsResult && true !== i) t.guardsResult = false;\n            e.pop();\n        }));\n        if (this.I) t.run((() => {\n            e.push();\n            return this.instance.canUnload(i, this.routeNode);\n        }), (i => {\n            if (true === t.guardsResult && true !== i) t.guardsResult = false;\n            e.pop();\n        }));\n        e.pop();\n    }\n    canLoad(t, i, e) {\n        this.$.trace(`canLoad(next:%s) - invoking ${this.canLoadHooks.length} hooks`, i);\n        e.push();\n        for (const s of this.canLoadHooks) t.run((() => {\n            e.push();\n            return s.canLoad(this.instance, i.params, i, this.routeNode);\n        }), (i => {\n            if (true === t.guardsResult && true !== i) t.guardsResult = false === i ? false : ViewportInstructionTree.create(i);\n            e.pop();\n        }));\n        if (this.R) t.run((() => {\n            e.push();\n            return this.instance.canLoad(i.params, i, this.routeNode);\n        }), (i => {\n            if (true === t.guardsResult && true !== i) t.guardsResult = false === i ? false : ViewportInstructionTree.create(i);\n            e.pop();\n        }));\n        e.pop();\n    }\n    unload(t, i, e) {\n        this.$.trace(`unload(next:%s) - invoking ${this.unloadHooks.length} hooks`, i);\n        e.push();\n        for (const s of this.unloadHooks) t.run((() => {\n            e.push();\n            return s.unload(this.instance, i, this.routeNode);\n        }), (() => {\n            e.pop();\n        }));\n        if (this.N) t.run((() => {\n            e.push();\n            return this.instance.unload(i, this.routeNode);\n        }), (() => {\n            e.pop();\n        }));\n        e.pop();\n    }\n    load(t, i, e) {\n        this.$.trace(`load(next:%s) - invoking ${this.loadHooks.length} hooks`, i);\n        e.push();\n        for (const s of this.loadHooks) t.run((() => {\n            e.push();\n            return s.load(this.instance, i.params, i, this.routeNode);\n        }), (() => {\n            e.pop();\n        }));\n        if (this.C) t.run((() => {\n            e.push();\n            return this.instance.load(i.params, i, this.routeNode);\n        }), (() => {\n            e.pop();\n        }));\n        e.pop();\n    }\n    toString() {\n        return `CA(ctx:'${this.ctx.friendlyPath}',c:'${this.definition.component.name}')`;\n    }\n}\n\nconst Xt = e.createInterface(\"IRouteContext\");\n\nconst ti = \"au$residue\";\n\nclass RouteContext {\n    constructor(t, i, e, s, o) {\n        var r;\n        this.parent = i;\n        this.component = e;\n        this.definition = s;\n        this.parentContainer = o;\n        this.childViewportAgents = [];\n        this.childRoutes = [];\n        this.T = null;\n        this.A = null;\n        this.prevNode = null;\n        this.V = null;\n        this.P = null;\n        this.P = t;\n        if (null === i) {\n            this.root = this;\n            this.path = [ this ];\n            this.friendlyPath = e.name;\n        } else {\n            this.root = i.root;\n            this.path = [ ...i.path, this ];\n            this.friendlyPath = `${i.friendlyPath}/${e.name}`;\n        }\n        this.logger = o.get(n).scopeTo(`RouteContext<${this.friendlyPath}>`);\n        this.logger.trace(\"constructor()\");\n        this.moduleLoader = o.get(p);\n        const h = this.container = o.createChild();\n        h.registerResolver(k, this.hostControllerProvider = new v, true);\n        h.registerResolver(Xt, new v(\"IRouteContext\", this));\n        h.register(s);\n        h.register(...e.dependencies);\n        this.recognizer = new H;\n        const a = [];\n        const c = [];\n        for (const t of s.config.routes) if (t instanceof Promise) {\n            const i = this.addRoute(t);\n            a.push(i);\n            c.push(i);\n        } else {\n            const i = RouteDefinition.resolve(t, s, this);\n            if (i instanceof Promise) if (_(t) && null != t.path) {\n                for (const e of W(t.path)) this.$addRoute(e, null !== (r = t.caseSensitive) && void 0 !== r ? r : false, i);\n                const e = this.childRoutes.length;\n                const s = i.then((t => this.childRoutes[e] = t));\n                this.childRoutes.push(s);\n                c.push(s.then(g));\n            } else throw new Error(`Invalid route config. When the component property is a lazy import, the path must be specified.`); else {\n                for (const t of i.path) this.$addRoute(t, i.caseSensitive, i);\n                this.childRoutes.push(i);\n            }\n        }\n        if (a.length > 0) this.T = Promise.all(a).then((() => {\n            this.T = null;\n        }));\n        if (c.length > 0) this.A = Promise.all(c).then((() => {\n            this.A = null;\n        }));\n    }\n    get id() {\n        return this.container.id;\n    }\n    get isRoot() {\n        return null === this.parent;\n    }\n    get depth() {\n        return this.path.length - 1;\n    }\n    get resolved() {\n        return this.T;\n    }\n    get allResolved() {\n        return this.A;\n    }\n    get node() {\n        const t = this.V;\n        if (null === t) throw new Error(`Invariant violation: RouteNode should be set immediately after the RouteContext is created. Context: ${this}`);\n        return t;\n    }\n    set node(t) {\n        const i = this.prevNode = this.V;\n        if (i !== t) {\n            this.V = t;\n            this.logger.trace(`Node changed from %s to %s`, this.prevNode, t);\n        }\n    }\n    get vpa() {\n        const t = this.P;\n        if (null === t) throw new Error(`RouteContext has no ViewportAgent: ${this}`);\n        return t;\n    }\n    set vpa(t) {\n        if (null === t || void 0 === t) throw new Error(`Cannot set ViewportAgent to ${t} for RouteContext: ${this}`);\n        const i = this.P;\n        if (i !== t) {\n            this.P = t;\n            this.logger.trace(`ViewportAgent changed from %s to %s`, i, t);\n        }\n    }\n    static setRoot(t) {\n        const i = t.get(n).scopeTo(\"RouteContext\");\n        if (!t.has(C, true)) ei(new Error(`The provided container has no registered IAppRoot. RouteContext.setRoot can only be used after Aurelia.app was called, on a container that is within that app's component tree.`), i);\n        if (t.has(Xt, true)) ei(new Error(`A root RouteContext is already registered. A possible cause is the RouterConfiguration being registered more than once in the same container tree. If you have a multi-rooted app, make sure you register RouterConfiguration only in the \"forked\" containers and not in the common root.`), i);\n        const {controller: e} = t.get(C);\n        if (void 0 === e) ei(new Error(`The provided IAppRoot does not (yet) have a controller. A possible cause is calling this API manually before Aurelia.start() is called`), i);\n        const s = t.get(Mt);\n        const o = s.getRouteContext(null, e.definition, e.container, null);\n        t.register(w.instance(Xt, o));\n        o.node = s.routeTree.root;\n    }\n    static resolve(t, i) {\n        const e = t.container;\n        const s = e.get(n).scopeTo(\"RouteContext\");\n        if (null === i || void 0 === i) {\n            s.trace(`resolve(context:%s) - returning root RouteContext`, i);\n            return t;\n        }\n        if (ii(i)) {\n            s.trace(`resolve(context:%s) - returning provided RouteContext`, i);\n            return i;\n        }\n        if (i instanceof e.get(b).Node) try {\n            const t = R.for(i, {\n                searchParents: true\n            });\n            s.trace(`resolve(context:Node(nodeName:'${i.nodeName}'),controller:'${t.definition.name}') - resolving RouteContext from controller's RenderContext`);\n            return t.container.get(Xt);\n        } catch (t) {\n            s.error(`Failed to resolve RouteContext from Node(nodeName:'${i.nodeName}')`, t);\n            throw t;\n        }\n        if (m(i)) {\n            const t = i.$controller;\n            s.trace(`resolve(context:CustomElementViewModel(name:'${t.definition.name}')) - resolving RouteContext from controller's RenderContext`);\n            return t.container.get(Xt);\n        }\n        if (I(i)) {\n            const t = i;\n            s.trace(`resolve(context:CustomElementController(name:'${t.definition.name}')) - resolving RouteContext from controller's RenderContext`);\n            return t.container.get(Xt);\n        }\n        ei(new Error(`Invalid context type: ${Object.prototype.toString.call(i)}`), s);\n    }\n    dispose() {\n        this.container.dispose();\n    }\n    resolveViewportAgent(t) {\n        this.logger.trace(`resolveViewportAgent(req:%s)`, t);\n        const i = this.childViewportAgents.find((i => i.handles(t)));\n        if (void 0 === i) throw new Error(`Failed to resolve ${t} at:\\n${this.printTree()}`);\n        return i;\n    }\n    getAvailableViewportAgents(t) {\n        return this.childViewportAgents.filter((i => i.isAvailable(t)));\n    }\n    getFallbackViewportAgent(t, i) {\n        var e;\n        return null !== (e = this.childViewportAgents.find((e => e.isAvailable(t) && e.viewport.name === i && e.viewport.fallback.length > 0))) && void 0 !== e ? e : null;\n    }\n    createComponentAgent(t, i) {\n        this.logger.trace(`createComponentAgent(routeNode:%s)`, i);\n        this.hostControllerProvider.prepare(t);\n        const e = RouteDefinition.resolve(i.component, this.definition);\n        const s = this.container.get(e.component.key);\n        const n = ComponentAgent.for(s, t, i, this);\n        this.hostControllerProvider.dispose();\n        return n;\n    }\n    registerViewport(t) {\n        const i = ViewportAgent.for(t, this);\n        if (this.childViewportAgents.includes(i)) this.logger.trace(`registerViewport(agent:%s) -> already registered, so skipping`, i); else {\n            this.logger.trace(`registerViewport(agent:%s) -> adding`, i);\n            this.childViewportAgents.push(i);\n        }\n        return i;\n    }\n    unregisterViewport(t) {\n        const i = ViewportAgent.for(t, this);\n        if (this.childViewportAgents.includes(i)) {\n            this.logger.trace(`unregisterViewport(agent:%s) -> unregistering`, i);\n            this.childViewportAgents.splice(this.childViewportAgents.indexOf(i), 1);\n        } else this.logger.trace(`unregisterViewport(agent:%s) -> not registered, so skipping`, i);\n    }\n    recognize(t, i = false) {\n        var e;\n        this.logger.trace(`recognize(path:'${t}')`);\n        let s = this;\n        let n = true;\n        let o = null;\n        while (n) {\n            o = s.recognizer.recognize(t);\n            if (null === o) {\n                if (!i || s.isRoot) return null;\n                s = s.parent;\n            } else n = false;\n        }\n        let r;\n        if (Reflect.has(o.params, ti)) r = null !== (e = o.params[ti]) && void 0 !== e ? e : null; else r = null;\n        return new $RecognizedRoute(o, r);\n    }\n    addRoute(t) {\n        this.logger.trace(`addRoute(routeable:'${t}')`);\n        return r(RouteDefinition.resolve(t, this.definition, this), (t => {\n            for (const i of t.path) this.$addRoute(i, t.caseSensitive, t);\n            this.childRoutes.push(t);\n        }));\n    }\n    $addRoute(t, i, e) {\n        this.recognizer.add({\n            path: t,\n            caseSensitive: i,\n            handler: e\n        });\n        this.recognizer.add({\n            path: `${t}/*${ti}`,\n            caseSensitive: i,\n            handler: e\n        });\n    }\n    resolveLazy(t) {\n        return this.moduleLoader.load(t, (i => {\n            let e;\n            let s;\n            for (const t of i.items) if (t.isConstructable) {\n                const i = t.definitions.find(si);\n                if (void 0 !== i) if (\"default\" === t.key) e = i; else if (void 0 === s) s = i;\n            }\n            if (void 0 === e) {\n                if (void 0 === s) throw new Error(`${t} does not appear to be a component or CustomElement recognizable by Aurelia`);\n                return s;\n            }\n            return e;\n        }));\n    }\n    toString() {\n        const t = this.childViewportAgents;\n        const i = t.map(String).join(\",\");\n        return `RC(path:'${this.friendlyPath}',viewports:[${i}])`;\n    }\n    printTree() {\n        const t = [];\n        for (let i = 0; i < this.path.length; ++i) t.push(`${\" \".repeat(i)}${this.path[i]}`);\n        return t.join(\"\\n\");\n    }\n}\n\nfunction ii(t) {\n    return t instanceof RouteContext;\n}\n\nfunction ei(t, i) {\n    i.error(t);\n    throw t;\n}\n\nfunction si(t) {\n    return R.isType(t.Type);\n}\n\nclass $RecognizedRoute {\n    constructor(t, i) {\n        this.route = t;\n        this.residue = i;\n    }\n    toString() {\n        const t = this.route;\n        const i = t.endpoint.route;\n        return `RR(route:(endpoint:(route:(path:${i.path},handler:${i.handler})),params:${JSON.stringify(t.params)}),residue:${this.residue})`;\n    }\n}\n\nlet ni = class ViewportCustomElement {\n    constructor(t, i) {\n        this.logger = t;\n        this.ctx = i;\n        this.name = Zt;\n        this.usedBy = \"\";\n        this.default = \"\";\n        this.fallback = \"\";\n        this.stateful = false;\n        this.agent = void 0;\n        this.controller = void 0;\n        this.logger = t.scopeTo(`au-viewport<${i.friendlyPath}>`);\n        this.logger.trace(\"constructor()\");\n    }\n    hydrated(t) {\n        this.logger.trace(\"hydrated()\");\n        this.controller = t;\n        this.agent = this.ctx.registerViewport(this);\n    }\n    attaching(t, i, e) {\n        this.logger.trace(\"attaching()\");\n        return this.agent.activateFromViewport(t, this.controller, e);\n    }\n    detaching(t, i, e) {\n        this.logger.trace(\"detaching()\");\n        return this.agent.deactivateFromViewport(t, this.controller, e);\n    }\n    dispose() {\n        this.logger.trace(\"dispose()\");\n        this.ctx.unregisterViewport(this);\n        this.agent.dispose();\n        this.agent = void 0;\n    }\n    toString() {\n        const t = [];\n        for (const i of oi) {\n            const e = this[i];\n            switch (typeof e) {\n              case \"string\":\n                if (\"\" !== e) t.push(`${i}:'${e}'`);\n                break;\n\n              case \"boolean\":\n                if (e) t.push(`${i}:${e}`);\n                break;\n\n              default:\n                t.push(`${i}:${String(e)}`);\n            }\n        }\n        return `VP(ctx:'${this.ctx.friendlyPath}',${t.join(\",\")})`;\n    }\n};\n\nst([ N ], ni.prototype, \"name\", void 0);\n\nst([ N ], ni.prototype, \"usedBy\", void 0);\n\nst([ N ], ni.prototype, \"default\", void 0);\n\nst([ N ], ni.prototype, \"fallback\", void 0);\n\nst([ N ], ni.prototype, \"stateful\", void 0);\n\nni = st([ T({\n    name: \"au-viewport\"\n}), nt(0, n), nt(1, Xt) ], ni);\n\nconst oi = [ \"name\", \"usedBy\", \"default\", \"fallback\", \"stateful\" ];\n\nlet ri = class LoadCustomAttribute {\n    constructor(t, i, e, s, n, o, r) {\n        this.target = t;\n        this.el = i;\n        this.router = e;\n        this.events = s;\n        this.delegator = n;\n        this.ctx = o;\n        this.locationMgr = r;\n        this.attribute = \"href\";\n        this.active = false;\n        this.href = null;\n        this.instructions = null;\n        this.eventListener = null;\n        this.navigationEndListener = null;\n        this.onClick = t => {\n            if (null === this.instructions) return;\n            if (t.altKey || t.ctrlKey || t.shiftKey || t.metaKey || 0 !== t.button) return;\n            t.preventDefault();\n            void this.router.load(this.instructions, {\n                context: this.ctx\n            });\n        };\n        this.isEnabled = !i.hasAttribute(\"external\") && !i.hasAttribute(\"data-external\");\n    }\n    binding() {\n        if (this.isEnabled) this.eventListener = this.delegator.addEventListener(this.target, this.el, \"click\", this.onClick);\n        this.valueChanged();\n        this.navigationEndListener = this.events.subscribe(\"au:router:navigation-end\", (t => {\n            this.valueChanged();\n            this.active = null !== this.instructions && this.router.isActive(this.instructions, this.ctx);\n        }));\n    }\n    attaching() {\n        if (null !== this.ctx.allResolved) return this.ctx.allResolved.then((() => {\n            this.valueChanged();\n        }));\n    }\n    unbinding() {\n        if (this.isEnabled) this.eventListener.dispose();\n        this.navigationEndListener.dispose();\n    }\n    valueChanged() {\n        const t = this.router.options.useUrlFragmentHash;\n        if (null !== this.route && void 0 !== this.route && null === this.ctx.allResolved) {\n            const i = this.ctx.childRoutes.find((t => t.id === this.route));\n            if (void 0 !== i) {\n                const e = this.ctx.node.computeAbsolutePath();\n                let s = i.path[0];\n                if (\"object\" === typeof this.params && null !== this.params) {\n                    const t = Object.keys(this.params);\n                    for (const i of t) {\n                        const t = this.params[i];\n                        if (null != t && String(t).length > 0) s = s.replace(new RegExp(`[*:]${i}[?]?`), t);\n                    }\n                }\n                s = s.replace(/\\/[*:][^/]+[?]/g, \"\").replace(/[*:][^/]+[?]\\//g, \"\");\n                if (e) if (s) this.href = `${t ? \"#\" : \"\"}${[ e, s ].join(\"/\")}`; else this.href = `${t ? \"#\" : \"\"}${e}`; else this.href = `${t ? \"#\" : \"\"}${s}`;\n                this.instructions = this.router.createViewportInstructions(`${t ? \"#\" : \"\"}${s}`, {\n                    context: this.ctx\n                });\n            } else {\n                if (\"object\" === typeof this.params && null !== this.params) this.instructions = this.router.createViewportInstructions({\n                    component: this.route,\n                    params: this.params\n                }, {\n                    context: this.ctx\n                }); else this.instructions = this.router.createViewportInstructions(this.route, {\n                    context: this.ctx\n                });\n                this.href = this.instructions.toUrl(this.router.options.useUrlFragmentHash);\n            }\n        } else {\n            this.instructions = null;\n            this.href = null;\n        }\n        const i = R.for(this.el, {\n            optional: true\n        });\n        if (null !== i) i.viewModel[this.attribute] = this.instructions; else if (null === this.href) this.el.removeAttribute(this.attribute); else {\n            const i = t ? this.href : this.locationMgr.addBaseHref(this.href);\n            this.el.setAttribute(this.attribute, i);\n        }\n    }\n};\n\nst([ N({\n    mode: z.toView,\n    primary: true,\n    callback: \"valueChanged\"\n}) ], ri.prototype, \"route\", void 0);\n\nst([ N({\n    mode: z.toView,\n    callback: \"valueChanged\"\n}) ], ri.prototype, \"params\", void 0);\n\nst([ N({\n    mode: z.toView\n}) ], ri.prototype, \"attribute\", void 0);\n\nst([ N({\n    mode: z.fromView\n}) ], ri.prototype, \"active\", void 0);\n\nri = st([ A(\"load\"), nt(0, V), nt(1, P), nt(2, Mt), nt(3, ot), nt(4, L), nt(5, Xt), nt(6, ct) ], ri);\n\nlet hi = class HrefCustomAttribute {\n    constructor(t, i, e, s, n, o) {\n        this.target = t;\n        this.el = i;\n        this.router = e;\n        this.delegator = s;\n        this.ctx = n;\n        this.isInitialized = false;\n        if (e.options.useHref && \"A\" === i.nodeName) switch (i.getAttribute(\"target\")) {\n          case null:\n          case o.name:\n          case \"_self\":\n            this.isEnabled = true;\n            break;\n\n          default:\n            this.isEnabled = false;\n            break;\n        } else this.isEnabled = false;\n    }\n    get isExternal() {\n        return this.el.hasAttribute(\"external\") || this.el.hasAttribute(\"data-external\");\n    }\n    binding() {\n        if (!this.isInitialized) {\n            this.isInitialized = true;\n            this.isEnabled = this.isEnabled && null === U(this.el, O.getDefinition(ri).key);\n        }\n        if (null == this.value) this.el.removeAttribute(\"href\"); else this.el.setAttribute(\"href\", this.value);\n        this.eventListener = this.delegator.addEventListener(this.target, this.el, \"click\", this);\n    }\n    unbinding() {\n        this.eventListener.dispose();\n    }\n    valueChanged(t) {\n        if (null == t) this.el.removeAttribute(\"href\"); else this.el.setAttribute(\"href\", t);\n    }\n    handleEvent(t) {\n        this.L(t);\n    }\n    L(t) {\n        if (t.altKey || t.ctrlKey || t.shiftKey || t.metaKey || 0 !== t.button || this.isExternal || !this.isEnabled) return;\n        const i = this.el.getAttribute(\"href\");\n        if (null !== i) {\n            t.preventDefault();\n            void this.router.load(i, {\n                context: this.ctx\n            });\n        }\n    }\n};\n\nst([ N({\n    mode: z.toView\n}) ], hi.prototype, \"value\", void 0);\n\nhi = st([ A({\n    name: \"href\",\n    noMultiBindings: true\n}), nt(0, V), nt(1, P), nt(2, Mt), nt(3, L), nt(4, Xt), nt(5, E) ], hi);\n\nconst ai = Mt;\n\nconst ci = [ ai ];\n\nconst ui = ni;\n\nconst li = ri;\n\nconst di = hi;\n\nconst fi = [ ni, ri, hi ];\n\nfunction pi(i, e) {\n    return i.register(j.hydrated(u, RouteContext.setRoot), j.afterActivate(Mt, (i => {\n        if (t(e)) if (\"function\" === typeof e) return e(i); else return i.start(e, true);\n        return i.start({}, true);\n    })), j.afterDeactivate(Mt, (t => {\n        t.stop();\n    })), ...ci, ...fi);\n}\n\nconst vi = {\n    register(t) {\n        return pi(t);\n    },\n    customize(t) {\n        return {\n            register(i) {\n                return pi(i, t);\n            }\n        };\n    }\n};\n\nclass ScrollState {\n    constructor(t) {\n        this.el = t;\n        this.top = t.scrollTop;\n        this.left = t.scrollLeft;\n    }\n    static has(t) {\n        return t.scrollTop > 0 || t.scrollLeft > 0;\n    }\n    restore() {\n        this.el.scrollTo(this.left, this.top);\n        this.el = null;\n    }\n}\n\nfunction gi(t) {\n    t.restore();\n}\n\nclass HostElementState {\n    constructor(t) {\n        this.scrollStates = [];\n        this.save(t.children);\n    }\n    save(t) {\n        let i;\n        for (let e = 0, s = t.length; e < s; ++e) {\n            i = t[e];\n            if (ScrollState.has(i)) this.scrollStates.push(new ScrollState(i));\n            this.save(i.children);\n        }\n    }\n    restore() {\n        this.scrollStates.forEach(gi);\n        this.scrollStates = null;\n    }\n}\n\nconst wi = e.createInterface(\"IStateManager\", (t => t.singleton(ScrollStateManager)));\n\nclass ScrollStateManager {\n    constructor() {\n        this.cache = new WeakMap;\n    }\n    saveState(t) {\n        this.cache.set(t.host, new HostElementState(t.host));\n    }\n    restoreState(t) {\n        const i = this.cache.get(t.host);\n        if (void 0 !== i) {\n            i.restore();\n            this.cache.delete(t.host);\n        }\n    }\n}\n\nexport { wt as AST, ActionExpression, Ot as AuNavId, ComponentAgent, ComponentExpression, CompositeSegmentExpression, ci as DefaultComponents, fi as DefaultResources, pt as ExpressionKind, hi as HrefCustomAttribute, di as HrefCustomAttributeRegistration, ht as IBaseHrefProvider, ct as ILocationManager, Xt as IRouteContext, Mt as IRouter, ot as IRouterEvents, wi as IStateManager, zt as IViewportInstruction, ri as LoadCustomAttribute, li as LoadCustomAttributeRegistration, LocationChangeEvent, Navigation, NavigationCancelEvent, NavigationEndEvent, NavigationErrorEvent, NavigationOptions, NavigationStartEvent, ParameterExpression, ParameterListExpression, Jt as Route, RouteConfig, RouteContext, RouteDefinition, RouteExpression, RouteNode, RouteTree, Ht as Router, vi as RouterConfiguration, RouterOptions, ai as RouterRegistration, ScopedSegmentExpression, SegmentExpression, SegmentGroupExpression, Transition, ViewportAgent, ni as ViewportCustomElement, ui as ViewportCustomElementRegistration, ViewportExpression, jt as isManagedState, _t as route, Bt as toManagedState };\n//# sourceMappingURL=index.mjs.map\n","import { DI as e, Registration as t } from \"@aurelia/kernel\";\n\nexport { ColorOptions, ConsoleSink, DI, EventAggregator, IContainer, IEventAggregator, ILogger, IServiceLocator, InstanceProvider, LogLevel, LoggerConfiguration, Registration, all, bound, camelCase, emptyArray, emptyObject, inject, isArrayIndex, kebabCase, lazy, noop, optional, pascalCase, singleton, toArray, transient } from \"@aurelia/kernel\";\n\nimport { Aurelia as o, IPlatform as r, StandardConfiguration as a, CustomElement as i } from \"@aurelia/runtime-html\";\n\nexport { AppTask, AuSlotsInfo, Bindable, Controller, CustomAttribute, CustomElement, DefaultDialogDom, DefaultDialogDomRenderer, DefaultDialogGlobalSettings, DialogCloseResult, DialogConfiguration, DialogController, DialogDeactivationStatuses, DialogDefaultConfiguration, DialogOpenResult, DialogService, IAppRoot, IAttrMapper, IAttributePattern, IAuSlotsInfo, IAurelia, IDialogController, IDialogDom, IDialogDomRenderer, IDialogGlobalSettings, IDialogService, IEventTarget, ILifecycleHooks, INode, IPlatform, IRenderLocation, ITemplateCompiler, ITemplateCompilerHooks, IWcElementRegistry, IWorkTracker, LifecycleHooks, NodeObserverLocator, ShortHandBindingSyntax, StyleConfiguration, TemplateCompilerHooks, ViewFactory, WcCustomElementRegistry, attributePattern, bindable, bindingCommand, children, coercer, containerless, createElement, cssModules, customAttribute, customElement, lifecycleHooks, renderer, shadowCSS, templateCompilerHooks, templateController, useShadowDOM } from \"@aurelia/runtime-html\";\n\nimport { BrowserPlatform as l } from \"@aurelia/platform-browser\";\n\nexport { HttpClient, HttpClientConfiguration, IHttpClient, json } from \"@aurelia/fetch-client\";\n\nexport { Metadata } from \"@aurelia/metadata\";\n\nexport { Platform, Task, TaskAbortError, TaskQueue, TaskQueuePriority, TaskStatus } from \"@aurelia/platform\";\n\nexport { IRouteContext, IRouter, IRouterEvents, Route, RouteConfig, RouteNode, Router, RouterConfiguration, RouterOptions, RouterRegistration, route } from \"@aurelia/router-lite\";\n\nexport { BindingBehavior, BindingMode, CollectionKind, ComputedObserver, IObserverLocator, ISignaler, LifecycleFlags, ValueConverter, alias, bindingBehavior, observable, registerAliases, subscriberCollection, valueConverter } from \"@aurelia/runtime\";\n\nconst n = l.getOrCreate(globalThis);\n\nfunction u() {\n    return e.createContainer().register(t.instance(r, n), a);\n}\n\nclass Aurelia extends o {\n    constructor(e = u()) {\n        super(e);\n    }\n    static start(e) {\n        return (new Aurelia).start(e);\n    }\n    static app(e) {\n        return (new Aurelia).app(e);\n    }\n    static enhance(e, t) {\n        return (new Aurelia).enhance(e, t);\n    }\n    static register(...e) {\n        return (new Aurelia).register(...e);\n    }\n    app(e) {\n        if (i.isType(e)) {\n            const t = i.getDefinition(e);\n            let o = document.querySelector(t.name);\n            if (null === o) o = document.body;\n            return super.app({\n                host: o,\n                component: e\n            });\n        }\n        return super.app(e);\n    }\n}\n\nexport { Aurelia, n as PLATFORM, Aurelia as default };\n//# sourceMappingURL=index.mjs.map\n"],"names":["getOwnMetadata","Metadata","getOwn","hasOwnMetadata","hasOwn","defineMetadata","define","isFunction","v","isString","createObject","Object","create","isNumericLookup","isArrayIndex","value","result","length","ch","i","charCodeAt","isNumberOrBigInt","isStringOrDate","Date","baseCase","CharKind","isDigit","assign","charToKind","char","toUpperCase","toLowerCase","input","cb","len","sep","output","prevKind","curChar","curKind","nextChar","charAt","nextKind","camelCase","cache","callback","pascalCase","slice","kebabCase","toArray","arr","Array","ids","nextId","context","resetId","compareNumber","a","b","mergeDistinct","arr1","arr2","emptyArray","lookup","arr3","len1","len2","item","push","bound","target","key","descriptor","configurable","enumerable","get","boundFn","bind","this","Reflect","defineProperty","writable","mergeArrays","arrays","k","arraysLen","arrayLen","array","j","mergeObjects","objects","objectsLen","object","firstDefined","values","Error","getPrototypeChain","functionPrototype","Function","prototype","getPrototypeOf","WeakMap","proto","chain","Type","set","toLookup","objs","isNativeFunction","isNative","sourceText","fn","toString","onResolve","maybePromise","resolveCallback","Promise","then","resolveAll","maybePromises","firstPromise","promises","ii","all","annoBaseName","getAnnotationKeyFor","name","appendAnnotation","keys","annotation","freeze","appendTo","prop","getKeys","isKey","startsWith","keyFor","resBaseName","resource","has","getAll","map","Protocol","hasOwnProperty","fromAnnotationOrDefinitionOrTypeOrDefault","def","getDefault","call","fromAnnotationOrTypeOrDefault","fromDefinitionOrDefault","applyMetadataPolyfill","ResolverBuilder","constructor","container","instance","registerResolver","singleton","transient","cachedCallback","cacheCallbackResult","aliasTo","destinationKey","strategy","state","Resolver","cloneArrayWithPossibleProps","source","clone","DefaultResolver","none","ContainerConfiguration","inheritParentResources","defaultResolver","static","config","DEFAULT","_a","_b","from","DI","createContainer","Container","getDesignParamtypes","getAnnotationParamtypes","getOrCreateAnnotationParamTypes","getDependencies","createInterface","configureOrName","configuror","configure","friendlyName","undefined","Interface","property","index","annotationParamtypes","$isInterface","register","inject","dependencies","dep","registration","Registration","registerInRequestor","options","defaultSingletonOptions","scoped","designParamtypes","Proto","auAnnotationParamtype","IContainer","IServiceLocator","createResolver","getter","resolver","$isResolver","resolve","handler","requestor","transientDecorator","targetOrOptions","$target","createAllResolver","searchAncestors","lazy","optional","ignore","factory","args","getFactory","construct","newInstanceForScope","createNewInstance","instanceProvider","InstanceProvider","String","newInstanceOf","ResolverStrategy","resolving","getResolver","_c","containerGetKey","d","transformInstance","inst","transform","Factory","transformers","dynamicDependencies","reduce","registerTransformer","transformer","containerResolver","isRegistry","obj","isSelfRegistry","isRegisterInRequester","isClass","isResourceKey","indexOf","InstrinsicTypeNames","Set","containerId","parent","id","_registerDepth","_disposableResolvers","Map","root","_resolvers","_factories","res","depth","params","current","jj","isObject","defs","isDisposable","validateKey","resolvers","autoRegister","_jitRegister","resolutions","concat","buildAllResponse","invoke","createNativeInvocationError","registerFactory","createChild","disposeResolvers","disposableResolvers","disposable","entries","dispose","delete","clear","find","kind","keyFrom","definition","size","keyAsValue","registrationResolver","newResolver","ParameterizedRegistry","registry","filter","x","containerLookup","fun","resolverLookup","t","originalKey","aliasKey","defer","_instance","_name","prepare","results","emptyObject","noop","IPlatform","__decorate","decorators","desc","c","arguments","r","getOwnPropertyDescriptor","decorate","__param","paramIndex","decorator","LogLevel","ColorOptions","ILogConfig","LogConfig","ISink","ILogEventFactory","DefaultLogEventFactory","ILogger","DefaultLogger","ILogScopes","LoggerSink","handles","getHandles","sink","format","red","str","green","yellow","blue","magenta","cyan","white","grey","colorOptions","level","getLogLevelString","logLevelString","TRC","DBG","INF","WRN","ERR","FTL","QQQ","getScopeString","scope","join","getIsoString","timestamp","toISOString","DefaultLogEvent","severity","message","optionalParams","createLogEvent","logger","now","ConsoleSink","p","$console","console","handleEvent","emit","event","msg","debug","info","warn","error","offset","includes","replace","sinks","scopedLoggers","traceSinks","debugSinks","infoSinks","warnSinks","errorSinks","fatalSinks","$sink","_d","_e","_f","trace","messageOrGetMessage","fatal","scopeTo","scopedLogger","msgOrGetMsg","LoggerConfiguration","IModuleLoader","ModuleLoader","noTransform","m","ModuleTransformer","$transform","_promiseCache","_objectCache","objOrPromise","_transformPromise","_transformObject","promise","ret","_analyze","isConstructable","definitions","items","ModuleItem","AnalyzedModule","load","raw","Handler","messageType","handle","IEventAggregator","EventAggregator","eventLookup","messageHandlers","publish","channelOrInstance","subscribers","subscribe","channelOrType","idx","splice","subscribeOnce","sub","isNullOrUndefined","metadataInternalSlot","$typeError","operation","paramName","actualValue","expectedType","TypeError","toPropertyKeyOrUndefined","propertyKey","toPropertyKey","ensurePropertyKeyOrUndefined","GetOrCreateMetadataMap","O","P","Create","targetMetadata","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","OrdinaryHasMetadata","OrdinaryGetOwnMetadata","OrdinaryGetMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","keysObj","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeysLen","parentKeysLen","add","OrdinaryDeleteMetadata","metadata","metadataKey","metadataValue","attributes","isArray","DecorateProperty","DecorateConstructor","decorated","$define","$has","$hasOwn","$get","$getOwn","$getKeys","$getOwnKeys","$delete","getOwnKeys","internalSlotName","hasInternalSlot","reflect","$applyMetadataPolyfill","throwIfConflict","forceOverwrite","presentProps","implementationSummary","impl","notImplemented","BrowserPlatform","Platform","g","overrides","super","_domReadRequested","_domReadHandle","_domWriteRequested","_domWriteHandle","split","forEach","flushDomRead","flushDomWrite","domReadQueue","TaskQueue","requestDomRead","cancelDomRead","domWriteQueue","requestDomWrite","cancelDomWrite","platform","requestAnimationFrame","clearTimeout","cancelAnimationFrame","flush","setTimeout","macroTaskRequested","macroTaskHandle","globalThis","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","clearInterval","queueMicrotask","setInterval","_h","_g","_k","_j","performanceNow","_o","_m","_l","performance","flushMacroTask","taskQueue","requestMacroTask","cancelMacroTask","isPersistent","task","persistent","$request","$cancel","_suspenderTask","_pendingAsyncCount","processing","pending","delayed","flushRequested","_yieldPromise","taskPool","_taskPoolSize","_lastRequest","_lastFlush","_requestFlush","_tracer","Tracer","isEmpty","_hasNoMoreFiniteWork","every","time","queueTime","cur","shift","run","status","suspend","cancel","async","createExposedPromise","queueTask","opts","delay","preempt","reusable","defaultQueueTaskOptions","reuse","Task","remove","returnToPool","resetPersistentTask","reset","createdTime","completeAsyncTask","TaskAbortError","TaskStatus","tracer","_resolve","_reject","_result","_status","reject","$ret","enabled","catch","err","taskStatus","enter","method","log","repeat","leave","prefix","flushReq","susTask","created","Math","round","queue","TaskQueuePriority","$resolve","$reject","executor","getResourceKeyFor","appendResourceKey","appendAnnotationKey","getAllAnnotations","createLookup","IsDataAttribute","isDataAttribute","svgAnalyzer","isStandardSvgAttribute","isPromise","bindable","configOrTarget","$prop","baseName","BindableDefinition","Bindable","isBindableAnnotation","type","bindableLists","bindables","addName","addDescription","addList","maybeList","for","builder","configOrProp","mode","attribute","primary","setInterpreter","propStart","prototypeChain","iProto","iDefs","keysLen","Class","BindingMode","toView","getInterceptor","coercer","_descriptor","Coercer","getMetadata","Number","Boolean","BigInt","$coercer","coerce","createCoercer","nullable","coercionConfiguration","enableCoercion","coerceNullish","BindableObserver","cbName","$controller","_coercionConfig","_value","_oldValue","f","cbAll","propertyChanged","hasCb","_hasCb","hasCbAll","_hasCbAll","hasSetter","_hasSetter","val","_obj","_key","_cbAll","_observing","_createGetterSetter","getValue","setValue","newValue","flags","currentValue","is","isBound","subscriber","subs","oV","notify","subscriberCollection","withFlushQueue","CharSpec","chars","isSymbol","isInverted","_hasOfNoneInverse","_hasOfSingleInverse","_hasOfMultipleInverse","_hasOfNone","_hasOfSingle","_hasOfMultiple","equals","other","_char","Interpretation","parts","_pattern","_currentRecord","_partsRecord","pattern","append","currentRecord","next","partsRecord","State","charSpec","patterns","nextStates","types","isEndpoint","findChild","child","findMatches","interpretation","childLen","StaticSegment","text","specs","eachChar","DynamicSegment","symbols","spec","SymbolSegment","SegmentTypes","statics","dynamics","ISyntaxInterpreter","SyntaxInterpreter","rootState","initialStates","sort","d1","d2","currentState","segments","charSpecCb","parse","interpret","states","getNextStates","sortEndpoint","start","aTypes","bTypes","AttrSyntax","rawName","rawValue","command","IAttributePattern","IAttributeParser","AttributeParser","interpreter","attrPatterns","_cache","_interpreter","_patterns","allDefs","attrPattern","patternDefs","getAllPatternDefinitions","attributePattern","AttributePattern","AttributePatternResourceDefinition","apBaseName","annotationKey","definitionAnnotationKey","getPatternDefinitions","DotSeparatedAttributePattern","RefAttributePattern","ref","_parts","ColonPrefixedBindAttributePattern","AtPrefixedTriggerAttributePattern","SpreadAttributePattern","$IPlatform","ISVGAnalyzer","NoopSVGAnalyzer","_node","_attributeName","o","SVGAnalyzer","_svgElements","altGlyph","altglyph","altGlyphDef","altglyphdef","altGlyphItem","altglyphitem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","cursor","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","font","foreignObject","glyph","glyphRef","glyphref","hkern","image","line","linearGradient","marker","mask","mpath","path","polygon","polyline","radialGradient","rect","script","stop","style","svg","switch","symbol","textPath","title","tref","tspan","use","view","vkern","_svgPresentationElements","_svgPresentationAttributes","SVGElement","div","document","createElement","innerHTML","firstElementChild","nodeName","tmp","node","attributeName","IAttrMapper","AttrMapper","fns","_tagAttrMap","_globalAttrMap","useMapping","LABEL","IMG","usemap","INPUT","maxlength","minlength","formaction","formenctype","formmethod","formnovalidate","formtarget","inputmode","TEXTAREA","TD","rowspan","colspan","TH","useGlobalMapping","accesskey","contenteditable","tabindex","textcontent","innerhtml","scrolltop","scrollleft","readonly","newAttrMapping","targetAttrMapping","tagName","attr","createMappedError","mapper","useTwoWay","isTwoWay","attrName","shouldDefaultToTwoWay","some","element","hasAttribute","CallBinding","sourceExpression","targetProperty","observerLocator","locator","interceptor","targetObserver","getAccessor","callSource","overrideContext","$scope","$event","evaluate","deleteProperty","$bind","$unbind","hasBind","$args","hasUnbind","unbind","observe","propertyName","handleChange","previousValue","AttributeObserver","_hasChanges","_prop","_attr","_flushChanges","classList","toggle","priority","setProperty","removeAttribute","setAttribute","handleMutation","mutationRecords","shouldProcess","record","contains","getPropertyValue","count","getAttribute","startObservation","ownerDocument","defaultView","MutationObserver","unsubscribe","stopObservation","$MutationObserver","$eMObs","$mObs","$eMObservers","disconnect","invokeHandleMutation","s","BindingTargetSubscriber","_","updateSource","oneTime","fromView","toViewOrOneTime","taskOptions","AttributeBinding","targetAttribute","targetSubscriber","persistentFlags","oL","updateTarget","_previousValue","shouldQueueFlush","shouldConnect","$kind","obs","version","$mode","clearAll","connectable","queueTaskOptions","InterpolationBinding","interpolation","expressions","partBindings","InterpolationPartBinding","staticParts","owner","oldValue","obsRecord","canOptimize","observeCollection","handleCollectionChange","indexMap","ContentBinding","strict","NodeCtor","Node","parentNode","removeChild","textContent","insertBefore","queueUpdate","LetBinding","toBindingContext","_toBindingContext","bindingContext","updateTaskOpts","PropertyBinding","getObserver","RefBinding","_propertyName","_newValue","_flags","IAppTask","$AppTask","slot","AppTask","beforeCreate","createAppTaskSlotHook","hydrating","hydrated","beforeActivate","afterActivate","beforeDeactivate","afterDeactivate","slotName","appTaskFactory","keyOrCallback","children","ChildrenDefinition","Children","isChildrenObserverAnnotation","childrenObserverLists","childrenObservers","childObserverOptions","childList","query","ChildrenObserver","controller","defaultChildQuery","defaultChildFilter","defaultChildMap","observing","observer","host","_onChildrenChanged","filterChildren","childNodes","viewModel","forOpts","nodes","CustomElement","customAttribute","nameOrDef","CustomAttribute","templateController","isTemplateController","CustomAttributeDefinition","aliases","defaultBindingMode","noMultiBindings","watches","getAttributeAnnotation","Watch","getAnnotation","registerAliases","caBaseName","getAttributeKeyFrom","isType","getRef","getDefinition","annotate","watch","expressionOrPropertyAccessFn","changeHandlerOrCallback","isClassDecorator","watchDef","WatchDefinition","expression","noDefinitions","watchBaseName","watchDefinitions","customElement","useShadowDOM","annotateElementMetadata","containerless","definitionLookup","CustomElementDefinition","capture","template","instructions","injectable","needsCompile","surrogates","isStrictBinding","shadowOptions","hasSlots","enhance","processContent","generateElementName","generateType","returnZero","returnFalse","returnNull","returnTrue","returnEmptyArray","getElementAnnotation","partialDefinition","ceBaseName","defaultForOpts","searchParents","getElementKeyFrom","foundAController","getEffectiveParentNode","generateName","createInjectable","$injectable","_container","nameDescriptor","defaultProto","pcHookMetadataProperty","hook","ensureHook","ClassAttributeAccessor","_nameIndex","_version","doNotCache","nameIndex","classesToAdd","getClassesToAdd","_addClassesAndUpdateIndex","classes","className","splitClassString","classString","matches","match","cssModules","modules","CSSModulesProcessorRegistry","classLookup","ClassCustomAttribute","CustomAttributeClass","binding","valueChanged","INode","shadowCSS","css","ShadowDOMRegistry","IShadowDOMStyleFactory","AdoptedStyleSheetsStyles","supported","AdoptedStyleSheetsStylesFactory","StyleElementStylesFactory","sharedStyles","IShadowDOMGlobalStyles","IShadowDOMStyles","createStyles","localStyles","StyleElementStyles","applyTo","styleSheetCache","styleSheets","sheet","CSSStyleSheet","replaceSync","ShadowRoot","shadowRoot","adoptedStyleSheets","styles","prepend","StyleConfiguration","shadowDOM","exit","ConnectableSwitcher","wrap","unwrap","ProxyObservable","ComputedWatcher","useProxy","running","compute","ExpressionWatcher","expr","ILifecycleHooks","LifecycleHooksEntry","LifecycleHooksDefinition","propertyNames","getOwnPropertyNames","lhBaseName","LifecycleHooks","ctx","LifecycleHooksLookupImpl","instances","entry","lifecycleHooks","IViewFactory","ViewFactory","isCaching","cacheSize","setCacheSize","doNotOverrideIfAlreadySet","maxCacheSize","parseInt","canReturnToCache","_controller","tryReturnToCache","parentController","pop","Controller","$view","seenViews","WeakSet","notYetSeen","toCustomElementDefinition","viewsBaseName","Views","$views","views","IViewLocator","ViewLocator","_modelInstanceToBoundComponent","_modelTypeToUnboundComponent","getViewComponentForObject","viewNameOrSelector","availableViews","resolvedViewName","_getViewName","_getOrCreateBoundComponent","BoundComponent","UnboundComponent","_getOrCreateUnboundComponent","_getView","hydrationContext","vm","Scope","fromParent","initiator","attaching","attached","detaching","unbinding","requestedName","IRendering","Rendering","_compilationCache","_fragmentCache","_p","_ctn","_empty","FragmentNodeSequence","createDocumentFragment","renderers","rs","IRenderer","instructionType","compile","compilationInstruction","compiledMap","compiler","ITemplateCompiler","compiled","getViewFactory","getOrCreate","createNodes","fragment","doc","tpl","adoptNode","content","appendChild","cloneNode","render","targets","rows","row","instruction","MountTarget","optionalCeFind","controllerLookup","vmKind","viewFactory","head","tail","bindings","hasLockedScope","hostController","mountTarget","location","_fullyNamed","_childrenObs","$initiator","$flags","$promise","_activatingStack","_detachingStack","_unbindingStack","_rendering","hooks","HooksDefinition","isActive","$el","getCached","ctn","hydrationInst","IHydrationContext","HydrationContext","hydrate","_hydrateCustomElement","_hydrateCustomAttribute","_hydrateSynthetic","createWatchers","createObservers","createChildrenObservers","hasDefine","_hydrate","_hydrateChildren","hasHydrating","compiledDef","_compiledDef","setRef","attachShadow","defaultShadowOptions","convertToRenderLocation","hasHydrated","findTargets","hasCreated","activate","stringifyState","parentScope","_enterActivating","hasBinding","_ensurePromise","hasBound","_attach","_append","$start","hasAttaching","_leaveActivating","deactivate","_enterDetaching","hasDetaching","_leaveDetaching","removeNodes","unlink","hasAttached","_retPromise","_enterUnbinding","hasUnbinding","_leaveUnbinding","addBinding","addChild","lockScope","setHost","setShadowRoot","setLocation","release","hasDispose","callDispose","accept","visitor","hasAccept","getLookup","$observers","observableNames","observers","ICoercionConfiguration","childObserverNames","childrenDescription","AccessScopeAstMap","getAccessScopeAst","ast","AccessScopeExpression","IObserverLocator","expressionParser","IExpressionParser","isCustomElementController","isCustomElementViewModel","ViewModelKind","names","IController","IAppRoot","IWorkTracker","WorkTracker","_stack","_promise","_logger","finish","wait","AppRoot","rootProvider","_hydratePromise","work","HTMLElement","Element","_runAppTasks","component","childCtn","projections","Refs","$au","IEventTarget","IRenderLocation","NodeType","effectiveParentNodeOverrides","containerlessOffset","nextSibling","nodeType","setEffectiveParentNode","childNodeOrNodeSequence","isRenderLocation","locationEnd","createComment","locationStart","replaceChild","isMounted","isLinked","refNode","targetNodeList","querySelectorAll","childNodeList","firstChild","lastChild","addToLinked","end","link","obtainRefNode","IWindow","window","ILocation","IHistory","history","DelegationStrategy","capturing","bubbling","Listener","targetEvent","delegationStrategy","preventDefault","eventDelegator","addEventListener","removeEventListener","defaultOptions","ListenerTracker","_publisher","_eventName","_options","_count","_captureLookups","_bubbleLookups","_increment","_decrement","_getLookup","lookups","composedPath","reverse","listener","cancelBubble","DelegateSubscription","_tracker","_lookup","EventSubscriber","callbackOrListener","events","IEventDelegator","EventDelegator","_trackerMaps","publisher","eventName","trackerMap","tracker","IProjections","IAuSlotsInfo","AuSlotsInfo","projectedSlots","InstructionType","IInstruction","isInstruction","InterpolationInstruction","to","PropertyBindingInstruction","IteratorBindingInstruction","CallBindingInstruction","RefBindingInstruction","SetPropertyInstruction","HydrateElementInstruction","alias","props","captures","auSlot","HydrateAttributeInstruction","HydrateTemplateController","HydrateLetElementInstruction","LetBindingInstruction","TextBindingInstruction","ListenerBindingInstruction","StylePropertyBindingInstruction","SetAttributeInstruction","SetClassAttributeInstruction","SetStyleAttributeInstruction","AttributeBindingInstruction","SpreadBindingInstruction","SpreadElementPropBindingInstruction","renderer","decoratedTarget","metadataKeys","ownProperties","getOwnPropertyDescriptors","ensureExpression","parser","srcOrExpr","expressionType","getTarget","potentialTarget","getRefTarget","refHost","refTargetName","caController","ceController","SetPropertyRenderer","renderingCtrl","CustomElementRenderer","rendering","_platform","Ctor","childCtrl","ctxContainer","createElementContainer","propInst","CustomAttributeRenderer","invokeAttribute","childController","$attr","TemplateControllerRenderer","renderLocation","LetElementRenderer","exprParser","_exprParser","_observerLocator","childInstructions","childInstruction","applyBindingBehavior","CallBindingRenderer","RefBindingRenderer","InterpolationBindingRenderer","partBinding","PropertyBindingRenderer","IteratorBindingRenderer","iterable","behaviorExpressionIndex","behaviorExpressions","BindingBehaviorExpression","behaviorExpression","behaviorOrFactory","behaviorKey","BindingBehaviorFactory","TextBindingRenderer","dynamicParts","part","createTextNode","ListenerBindingRenderer","_eventDelegator","SetAttributeRenderer","SetClassAttributeRenderer","addClasses","SetStyleAttributeRenderer","cssText","StylePropertyBindingRenderer","AttributeBindingRenderer","SpreadRenderer","_compiler","_instruction","getHydrationContext","ancestor","currentLevel","currentContext","renderSpreadInstruction","spreadBinding","createSurrogateBinding","compileSpread","SpreadBinding","_innerBindings","_hydrationContext","ctrl","_scope","innerScope","controllerProviderName","instructionProviderName","locationProviderName","slotInfoProviderName","auSlotsInfo","noLocationProvider","noViewFactoryProvider","noAuSlotProvider","ViewFactoryProvider","CommandType","bindingCommand","nameOrDefinition","BindingCommand","BindingCommandDefinition","getCommandAnnotation","getCommandKeyFrom","cmdBaseName","OneTimeBindingCommand","xp","_attrMapper","build","ToViewBindingCommand","attrMapper","FromViewBindingCommand","TwoWayBindingCommand","twoWay","DefaultBindingCommand","defaultMode","default","CallBindingCommand","ForBindingCommand","TriggerBindingCommand","DelegateBindingCommand","CaptureBindingCommand","AttrBindingCommand","StyleBindingCommand","ClassBindingCommand","RefBindingCommand","SpreadBindingCommand","_info","ITemplateElementFactory","TemplateElementFactory","markupCache","_template","createTemplate","nextElementSibling","allResources","TemplateCompiler","resolveResources","emptyCompilationInstructions","CompilationContext","_templateFactory","isTemplateElement","ITemplateCompilerHooks","compiling","localTemplateIdentifier","_compileLocalElement","_compileNode","_generateElementName","deps","_compileSurrogate","hasSlot","attrSyntaxs","el","elDef","_findElement","attrSyntax","attrDef","attrInstructions","attrBindableInstructions","bindablesInfo","primaryBindable","isMultiBindings","attrTarget","attrValue","_createCommand","commandBuildInfo","_findAttr","BindablesInfo","hasInlineBindings","_compileMultiBindings","attrs","resetCommandBuildInfo","bindableInfo","realAttrTarget","realAttrValue","_attrParser","invalidSurrogateAttribute","_compileLet","_compileElement","_compileText","letInstructions","PrimitiveLiteralExpression","_markAsTarget","elName","shouldCapture","removeAttr","plainAttrInstructions","elBindableInstructions","tcInstructions","tcInstruction","elementInstruction","processContentResult","hasContainerless","voidDefinition","_shouldReorderAttrs","_reorder","h","fallbackContentContext","_createChild","fallback","_replaceByMarker","shouldCompileContent","mostInnerTemplate","childContext","childEl","targetSlot","slotTemplateRecord","slotTemplates","slotTemplate","projectionCompilationContext","attrRawValue","bindableAttrsInfo","valueLength","localTemplates","numLocalTemplates","childElementCount","localTemplateNames","localElTypes","localTemplate","processTemplateName","LocalTemplateType","LocalTemplate","bindableEls","bindableInstructions","properties","bindableEl","getBindingMode","ignoredAttributes","getAttributeNames","allowedLocalTemplateBindableAttributes","_addDep","orderSensitiveInputType","_instructions","modelOrValueOrMatcherIndex","checkedIndex","found","_commands","hasParent","ci","localEls","syntax","checkbox","radio","bindableAttrsInfoCache","isAttr","hasPrimary","LocalTemplateBindableAttributes","typeToHooksDefCache","hooksBaseName","TemplateCompilerHooks","TemplateCompilerHooksDefinition","templateCompilerHooks","BindingModeBehavior","_originalModes","OneTimeBindingBehavior","ToViewBindingBehavior","FromViewBindingBehavior","TwoWayBindingBehavior","bindingBehavior","defaultDelay","DebounceBindingBehavior","BindingInterceptor","firstArg","isNaN","SignalBindingBehavior","signaler","_signaler","addSignalListener","removeSignalListener","ISignaler","ThrottleBindingBehavior","lastCall","_taskQueue","_queueTask","nextDelay","DataAttributeAccessor","attrAccessor","AttrBindingBehavior","_binding","handleSelfEvent","selfEventCallSource","SelfBindingBehavior","nsMap","AttributeNSAccessor","ns","getAttributeNS","removeAttributeNS","setAttributeNS","defaultMatcher","CheckedObserver","_collectionObserver","_valueObserver","_observe","_synchronizeElement","_indexMap","elementValue","model","isRadio","matcher","checked","hasMatch","findIndex","pair","existingItem","$isChecked","isChecked","unset","currItem","getCollectionObserver","subtree","characterData","SelectValueObserver","_arrayObserver","_nodeObserver","multiple","getSelectedOptions","_observeArray","syncOptions","option","optionValue","selected","syncValue","_start","_handleNodeChange","_stop","getArrayObserver","shouldNotify","_records","selection","customPropertyPrefix","StyleAttributeAccessor","_getStyleTuplesFromString","styleTuples","urlRegexTester","currentChunk","nextSplit","indexOfColon","substring","test","trim","_getStyleTuplesFromObject","_getStyleTuples","_getStyleTuplesFromArray","tuple","removeProperty","ValueAttributeObserver","xlinkNS","xmlNS","xmlnsNS","nsAttributes","xmlns","elementPropertyAccessor","PropertyAccessor","NodeObserverConfig","NodeObserverLocator","dirtyChecker","allowDirtyCheck","_events","_globalEvents","_overrides","_globalOverrides","inputEvents","inputEventsConfig","useConfig","valueAsNumber","files","SELECT","contentEventsConfig","scrollEventsConfig","useConfigGlobal","scrollTop","scrollLeft","overrideAccessorGlobal","overrideAccessor","INodeObserverLocator","nodeNameOrConfig","eventsConfig","existingMapping","throwMappingExisted","newMapping","configOrKey","nsProps","forNs","tagNameOrOverrides","existingTagOverride","createProperty","SetterObserver","IDirtyChecker","collection","getMapObserver","getSetObserver","UpdateTriggerBindingBehavior","originalHandler","Focus","_element","_needsApply","_apply","afterDetachChildren","e","_isElFocused","isFocused","shouldFocus","focus","blur","activeElement","Show","instr","_isActive","_task","$val","$prio","update","_isToggled","_base","getPropertyPriority","Portal","originalLoc","_currentTarget","callbackContext","newTarget","_resolveTarget","_activating","_deactivating","targetChanged","oldTarget","activating","_activate","_activated","activated","deactivating","_deactivate","_deactivated","deactivated","$document","renderContext","body","queryContext","querySelector","FlagsTemplateController","FrequentMutations","ObserveShallow","If","ifFactory","elseFactory","elseView","ifView","_wantsDeactivate","_swapId","swapId","isCurrent","currView","Else","_childController","_target","ifBehavior","wrappedExprs","Repeat","_location","_parent","_factory","_observer","_observingInnerItems","_reevaluating","_innerItemsExpression","_normalizedItems","_hasDestructuredLocal","forOf","_forOfBinding","_checkCollectionObserver","dec","declaration","local","_normalizeToArray","_activateAllViews","_deactivateAllViews","itemsChanged","oldLength","applyMutationsToIndices","deletedItems","_deactivateAndRemoveViewsByKey","_createAndActivateAndSortViewsByKey","innerItems","_innerItems","observingInnerItems","oldObserver","newObserver","normalizedItems","iterate","viewScope","newLen","BindingContext","setContextualProperties","deleted","deletedLen","mapLen","synchronizeIndices","seq","longestIncreasingSubsequence","seqLen","maxLen","prevIndices","Int32Array","tailIndices","prev","low","high","mid","oc","isFirst","isLast","isEven","$index","$first","$last","$middle","$even","$odd","$length","With","Switch","cases","activeCases","swap","caseChanged","$case","_handleCaseChange","isMatch","numActiveCases","_clearActiveCases","newActiveCases","fallThrough","_activateCases","defaultCase","numCases","firstCase","acc","action","previousPromise","Case","_locator","_debug","switchController","$switch","linkToSwitch","$value","_observeCollection","auSwitch","DefaultCase","PromiseTemplateController","preSettledTask","postSettledTask","q","fulfilled","rejected","preSettlePromise","defaultQueuingOptions","$swap","data","fulfill","postSettlePromise","PendingTemplateController","getPromiseController","FulfilledTemplateController","resolvedValue","RejectedTemplateController","promiseController","PromiseAttributePattern","FulfilledAttributePattern","RejectedAttributePattern","tagOrType","createElementForTag","createElementForType","RenderPlan","_dependencies","_lazyDef","createView","parentContainer","mergeInto","allInstructions","hasInstructions","addChildren","AuRender","_hdrContext","composing","_lastSubject","_properties","compose","componentChanged","subject","resolvedSubject","_resolveView","resolvedView","_provideViewFor","comp","isController","AuCompose","contextFactory","scopeBehavior","_composition","_contextFactory","CompositionContextFactory","_pending","composition","ChangeInfo","cmpstn","invalidate","change","compositionCtrl","compositionHost","removeCompositionHost","loc","srcDef","getDef","getVm","CompositionController","attachInitiator","deactachInitiator","targetDef","detachInitiator","EmptyComponent","isLocation","changes","loaded","CompositionContext","src","LoadedChangeInfo","detachInitator","AuSlot","hdrContext","_parentScope","_outerScope","slotInfo","projection","_hasProjection","_initiator","outerScope","$host","expose","exposeChanged","SCRIPT_REGEX","ISanitizer","sanitize","SanitizeValueConverter","_sanitizer","untrustedMarkup","valueConverter","ViewValueConverter","_viewLocator","DebounceBindingBehaviorRegistration","OneTimeBindingBehaviorRegistration","ToViewBindingBehaviorRegistration","FromViewBindingBehaviorRegistration","SignalBindingBehaviorRegistration","ThrottleBindingBehaviorRegistration","TwoWayBindingBehaviorRegistration","ITemplateCompilerRegistration","INodeObserverLocatorRegistration","DefaultComponents","SVGAnalyzerRegistration","AtPrefixedTriggerAttributePatternRegistration","ColonPrefixedBindAttributePatternRegistration","RefAttributePatternRegistration","DotSeparatedAttributePatternRegistration","SpreadAttributePatternRegistration","DefaultBindingSyntax","ShortHandBindingSyntax","CallBindingCommandRegistration","DefaultBindingCommandRegistration","ForBindingCommandRegistration","FromViewBindingCommandRegistration","OneTimeBindingCommandRegistration","ToViewBindingCommandRegistration","TwoWayBindingCommandRegistration","RefBindingCommandRegistration","TriggerBindingCommandRegistration","DelegateBindingCommandRegistration","CaptureBindingCommandRegistration","AttrBindingCommandRegistration","ClassBindingCommandRegistration","StyleBindingCommandRegistration","SpreadBindingCommandRegistration","DefaultBindingLanguage","SanitizeValueConverterRegistration","ViewValueConverterRegistration","FrequentMutationsRegistration","ObserveShallowRegistration","IfRegistration","ElseRegistration","RepeatRegistration","WithRegistration","SwitchRegistration","CaseRegistration","DefaultCaseRegistration","PromiseTemplateControllerRegistration","PendingTemplateControllerRegistration","FulfilledTemplateControllerRegistration","RejectedTemplateControllerRegistration","PromiseAttributePatternRegistration","FulfilledAttributePatternRegistration","RejectedAttributePatternRegistration","AttrBindingBehaviorRegistration","SelfBindingBehaviorRegistration","UpdateTriggerBindingBehaviorRegistration","AuRenderRegistration","AuComposeRegistration","PortalRegistration","FocusRegistration","ShowRegistration","DefaultResources","CallBindingRendererRegistration","CustomAttributeRendererRegistration","CustomElementRendererRegistration","InterpolationBindingRendererRegistration","IteratorBindingRendererRegistration","LetElementRendererRegistration","PropertyBindingRendererRegistration","RefBindingRendererRegistration","SetPropertyRendererRegistration","TemplateControllerRendererRegistration","ListenerBindingRendererRegistration","AttributeBindingRendererRegistration","SetAttributeRendererRegistration","SetClassAttributeRendererRegistration","SetStyleAttributeRendererRegistration","StylePropertyBindingRendererRegistration","TextBindingRendererRegistration","SpreadRendererRegistration","DefaultRenderers","StandardConfiguration","createConfiguration","optionsProvider","runtimeConfigurationOptions","coercingOptions","customize","IAurelia","Aurelia","_isRunning","_isStarting","_isStopping","_root","_startPromise","_stopPromise","_rootProvider","isRunning","isStarting","isStopping","app","_initPlatform","bc","yield","_dispatchEvent","ev","CustomEvent","detail","bubbles","cancelable","dispatchEvent","DefinitionType","IDialogService","IDialogController","IDialogDomRenderer","IDialogDom","IDialogGlobalSettings","DialogOpenResult","wasCancelled","dialog","DialogCloseResult","DialogDeactivationStatuses","DialogController","closed","settings","rejectOnCancel","hostRenderer","dialogTargetHost","dom","rootEventTarget","contentHost","cmp","getOrCreateVm","$dialog","canActivate","createDialogCancelError","ctrlr","overlay","mouseEvent","_closingPromise","dialogResult","canDeactivate","reason","ok","closeError","createDialogCloseError","overlayDismiss","Component","DialogService","_defaultSettings","dlgs","controllers","top","dialogService","closeAll","openDialogController","open","asDialogOpenPromise","$settings","DialogSettings","loadedSettings","dialogController","openResult","$removeController","unclosedControllers","unclosed","keyEvent","getActionKey","keyboard","srcs","_validate","_normalize","loadedCmp","loadedTpl","lock","whenClosed","onfulfilled","onrejected","code","keyCode","DefaultDialogGlobalSettings","startingZIndex","baseWrapperCss","DefaultDialogDomRenderer","wrapperCss","overlayCss","hostCss","dialogHost","wrapper","DefaultDialogDom","createDialogConfiguration","settingsProvider","registrations","regs","DialogConfiguration","NoopDialogGlobalSettings","DialogDefaultConfiguration","IWcElementRegistry","WcCustomElementRegistry","BaseClass","extends","CustomElementClass","auInit","auInited","auCtrl","connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback","observedAttributes","bindableProp","customElements","hasOwnProp","defineHiddenProp","ensureProto","defaultValue","force","existing","keyOrObj","currentScope","isBoundary","OverrideContext","ps","Signaler","signals","dispatchSignal","listeners","BindingBehaviorStrategy","BindingBehavior","BindingBehaviorDefinition","inheritsFromInterceptor","getBehaviorAnnotation","bbBaseName","ValueConverter","ValueConverterDefinition","getConverterAnnotation","vcBaseName","ExpressionKind","Unparser","visitAccessMember","visitAccessKeyed","visitAccessThis","visitAccessScope","visitArrayLiteral","elements","visitObjectLiteral","visitPrimitiveLiteral","escaped","visitCallFunction","func","writeArgs","visitCallMember","visitCallScope","visitTemplate","cooked","visitTaggedTemplate","visitUnary","visitBinary","left","right","visitConditional","condition","yes","no","visitAssign","visitValueConverter","visitBindingBehavior","visitArrayBindingPattern","visitObjectBindingPattern","visitBindingIdentifier","visitHtmlLiteral","_expr","visitForOfStatement","visitInterpolation","visitDestructuringAssignmentExpression","isObjDes","list","visitDestructuringAssignmentSingleExpression","initializer","visitDestructuringAssignmentRestExpression","CustomExpression","_s","l","behavior","$b","unparse","ValueConverterExpression","converterKey","vc","AssignExpression","ConditionalExpression","AccessThisExpression","$this","$parent","evaluatedValue","AccessMemberExpression","AccessKeyedExpression","CallScopeExpression","getFunction","apply","CallMemberExpression","CallFunctionExpression","BinaryExpression","UnaryExpression","$undefined","$null","$true","$false","$empty","HtmlLiteralExpression","_projection","ArrayLiteralExpression","ObjectLiteralExpression","TemplateExpression","TaggedTemplateExpression","ArrayBindingPattern","ObjectBindingPattern","BindingIdentifier","toStringTag","ForOfStatement","$array","$map","$set","$number","Interpolation","isMulti","firstExpression","DestructuringAssignmentExpression","DestructuringAssignmentSingleExpression","DestructuringAssignmentRestExpression","indexOrProperties","restValue","_visitor","LifecycleFlags","SubscriberFlags","CollectionKind","AccessorType","copyIndexMap","isIndexMap","createIndexMap","cloneIndexMap","subscriberCollectionDeco","getSubscriberRecord","addSubscriber","removeSubscriber","SubscriberRecord","sf","subscriberFlags","s0","s1","s2","sr","any","oldVal","sub0","sub1","sub2","notifyCollection","queueableDeco","getFlushQueue","FlushQueue","_flushing","_items","callable","flushItem","CollectionLengthObserver","_oldvalue","CollectionSizeObserver","implementLengthObserver","klass","observerLookup","sortCompare","y","preSortCompare","insertionSort","compareFn","velement","ielement","vtmp","itmp","order","quickSort","thirdIndex","v0","v1","v2","i0","i1","i2","c01","c02","c12","vpivot","ipivot","lowEnd","highStart","vtopElement","partition","$push","$unshift","unshift","$pop","$shift","$splice","$reverse","$sort","native","methods","argCount","inserts","deleteCount","relativeStart","actualStart","max","min","actualDeleteCount","itemCount","middle","lower","upper","lowerValue","lowerIndex","upperValue","upperIndex","enableArrayObservationCalled","enableArrayObservation","disableArrayObservation","ArrayObserver","indexObservers","lenObs","getLengthObserver","getIndexObserver","ArrayIndexObserver","arrayObserver","noChange","prevValue","currValue","copy","$add","$clear","oldSize","newSize","deleteResult","descriptorProps","enableSetObservationCalled","enableSetObservation","disableSetObservation","SetObserver","observedSet","enableMapObservationCalled","enableMapObservation","disableMapObservation","MapObserver","getObserverRecord","BindingObserverRecord","subscribeTo","subscribable","noopHandleChange","noopHandleCollectionChange","unsubscribeStale","unsubscribeAll","connectableDecorator","BindingMediator","ExpressionParser","_expressionLookup","_forOfLookup","_interpolationLookup","$parse","$state","ip","_currentChar","Char","unescapeCode","Access","Precedence","Token","ExpressionType","ParserState","_startIndex","_lastIndex","_tokenValue","_assignable","_tokenRaw","parseExpression","access","minPrecedence","parseInterpolation","nextToken","_currentToken","op","TokenValues","consumeOpt","consume","search","parseArrayDestructuring","parseArrayLiteralExpression","parseObjectLiteralExpression","parseTemplate","parseForOfStatement","strings","opToken","dae","DAE","$continue","addItem","DASE","statement","currentChar","currentToken","fromCharCode","tagged","scanTemplateTail","CharScanners","scanIdentifier","IdParts","token","KeywordLookup","scanNumber","isFloat","parseFloat","scanString","quote","unescaped","buffer","last","unescapedStr","scanTemplate","true","null","false","in","instanceof","typeof","void","of","codes","AsciiIdPart","IdStart","Digit","Skip","decompress","compressed","rangeCount","fill","returnToken","unexpectedCharacter","notMapped","AsciiIdParts","Uint8Array","_connectable","connectables","connecting","pauseConnecting","resumeConnecting","currentConnectable","enterConnectable","exitConnectable","pause","resume","R$get","proxyMap","canWrap","rawKey","getProxy","createProxy","getRaw","doNotCollect","Symbol","toPrimitive","arrayHandler","collectionHandler","objectHandler","proxiedObj","Proxy","receiver","wrappedArrayMap","wrappedArrayIncludes","wrappedArrayIndexOf","wrappedArrayLastIndexOf","wrappedArrayEvery","wrappedArrayFilter","wrappedArrayFind","wrappedArrayFindIndex","wrappedArrayFlat","wrappedArrayFlatMap","wrappedArrayJoin","wrappedArrayPush","wrappedArrayPop","wrappedReduce","wrappedReduceRight","wrappedArrayReverse","wrappedArrayShift","wrappedArrayUnshift","wrappedArraySlice","wrappedArraySplice","wrappedArraySome","wrappedArraySort","wrappedKeys","iterator","wrappedValues","wrappedEntries","thisArg","lastIndexOf","flat","flatMap","separator","_args","initValue","curr","reduceRight","wrappedClear","wrappedDelete","wrappedForEach","wrappedAdd","wrappedGet","wrappedSet","wrappedHas","done","ComputedObserver","_isDirty","_useProxy","setter","DirtyChecker","DirtyCheckSettings","timeoutsPerCheck","disabled","throw","resetToDefault","queueTaskOpts","tracked","_elapsedFrames","check","isDirty","DirtyCheckProperty","addProperty","_dirtyChecker","PrimitiveObserver","SetterNotifier","callbackKey","initialValue","_setter","propertyAccessor","ObserverLocator","DefaultNodeObserverLocator","_nodeObserverLocator","_adapters","addAdapter","adapter","createObserver","cached","observedArray","observedMap","pd","getOwnPropDesc","getProto","_getAdapterObserver","IObservation","Observation","effect","Effect","maxRunCount","queued","runCount","stopped","getObserversLookup","noValue","observable","targetOrConfig","deco","notifier","getNotifier","gO","exports","module","amd","self","__webpack_modules__","897","__unused_webpack_module","__webpack_exports__","__webpack_require__","ContextMenu","_createAbsoluteAnchor__WEBPACK_IMPORTED_MODULE_0__","_util__WEBPACK_IMPORTED_MODULE_1__","_i18n__WEBPACK_IMPORTED_MODULE_2__","_defineProperties","me","anchor","eventListeners","onClose","close","limitHeight","menu","focusButton","li","overflow","height","createMenuItems","domItems","domItem","button","buttonSubmenu","domSubItems","icon","_li","_li2","click","onclick","hide","submenu","divIcon","divText","buttonExpand","buttonExpandInner","submenuTitle","divExpand","_onExpandItem","subItems","ul","Iu","maxHeight","Constructor","protoProps","staticProps","buttons","expandedItem","subItem","frame","ignoreParent","showBelow","anchorRect","getBoundingClientRect","parentRect","frameRect","topGap","absoluteAnchor","w","bottom","anchorHeight","offsetHeight","maxPossibleMenuHeight","overflowY","getSelection","visibleMenu","destroy","alreadyVisible","padding","display","removeClassName","clientHeight","childsHeight","addClassName","targetIndex","prevButton","nextButton","keynum","which","handled","setSelection","shiftKey","_getVisibleButtons","stopPropagation","6436","Q","ErrorTable","errorTableVisible","onToggleVisibility","onFocusLine","onChangeHeight","validationErrorsContainer","additionalErrorsIndication","validationErrorIcon","validationErrorCount","parseErrorIndication","errors","errorLocations","tbody","_this","validationErrorsCount","validationErrors","table","dataPath","errLoc","trEl","td1","td2","td34","colSpan","pre","td3","td4","_pre","scrollHeight","onscroll","statusBar","innerText","toggleTableVisibility","2474","R","FocusTracker","onFocus","onBlur","_onClick","_onEvent","_onKeyUp","_onBlur","focusFlag","firstEventFlag","3161","__unused_webpack_exports","ace","VanillaPicker","treeModeMixins","textModeMixins","previewModeMixins","_require4","extend","getInnerText","getInternetExplorerVersion","tryRequireAjv","showTransformModal","showSortModal","Ajv","JSONEditor","json","ieVersion","onError","onChange","editable","onEditable","onChangeJSON","modes","VALID_OPTIONS","_create","DEBOUNCE_INTERVAL","setMode","setText","jsonText","getText","JSON","stringify","setName","getName","oldMode","asText","mixin","onModeChange","getMode","_onError","alert","setSchema","schema","schemaRefs","ajv","allErrors","verbose","schemaId","$data","addMetaSchema","removeSchema","addSchema","validateSchema","validate","refresh","registerMode","reserved","6617","ModeSwitcher","_ContextMenu__WEBPACK_IMPORTED_MODULE_0__","_i18n__WEBPACK_IMPORTED_MODULE_1__","onSwitch","availableModes","form","tree","preview","currentMode","currentTitle","box","show","position","8170","jsonWorkerDataUrl","setModuleUrl","4864","acequire","isDark","cssClass","importCssString","6589","yy","symbols_","JSONString","STRING","JSONNumber","NUMBER","JSONNullLiteral","NULL","JSONBooleanLiteral","TRUE","FALSE","JSONText","JSONValue","EOF","JSONObject","JSONArray","{","}","JSONMemberList","JSONMember",":",",","[","]","JSONElementList","$accept","$end","terminals_","2","4","6","8","10","11","14","17","18","21","22","23","24","productions_","performAction","yytext","yyleng","yylineno","yystate","$$","_$","$0","$","3","5","7","9","12","13","15","16","1","19","20","25","defaultActions","parseError","hash","stack","vstack","lstack","recovering","yyloc","lexer","setInput","yylloc","lex","preErrorSymbol","newState","expected","n","yyval","errStr","showPosition","first_line","last_line","first_column","last_column","_input","_more","_less","matched","conditionStack","unput","more","less","pastInput","past","substr","upcomingInput","tempMatch","lines","rules","_currentRules","flex","begin","popState","conditions","topState","pushState","yy_","$avoiding_name_collisions","YY_START","INITIAL","inclusive","jsonlint","3879","Events","defaultConfig","defaultSelected","width","searchable","clearable","sortSelected","allowDeselect","closeOnScroll","nativeDropdown","placeholder","taggable","tagPlaceholder","util","on","off","each","hasClass","RegExp","addClass","removeClass","closest","isInt","isFinite","floor","debounce","abs","pageXOffset","pageYOffset","truncate","isset","appendItem","custom","pages","pagination","pageIndex","customOption","navIndex","createItem","renderOption","opt","class","html","role","aria-selected","total","page","clearSearch","searching","inputContainer","Selectr","that","rendered","originalType","originalIndex","tabIndex","originalOptionCount","opened","navigating","mobileDevice","navigator","userAgent","customSelected","renderSelection","requiresPagination","customClass","aria-expanded","label","optgroup","first","dropdown","group","aria-hidden","notice","tags","selectedValues","getSelectedProperties","selectedIndexes","selectClear","tagIndex","autocomplete","autocorrect","autocapitalize","spellcheck","tagSeperators","inputClear","Option","setSelected","paginate","placeEl","setPlaceholder","disable","bindEvents","optsRect","selectedIndex","getSelected","dismiss","navigate","direction","prevEl","lastElementChild","changedTouches","indexes","added","removed","getChangedOptions","select","deselect","setMessage","invert","paginateItems","selectedValue","maxSelections","docFrag","tag","btn","$1","$2","Infinity","ac","ax","by","nn","localeCompare","tg","selIndex","valIndex","toObject","toJson","checkDuplicate","dupe","getOptionByIndex","getOptionByValue","removeAll","string","firstEl","removeMessage","exec","before","after","highlight","enable","serialise","serialize","rt","oh","wh","innerHeight","4188","EX","SIZE_LARGE","WF","MAX_PREVIEW_CHARACTERS","oW","PREVIEW_HISTORY_LIMIT","qD","DEFAULT_MODAL_ANCHOR","2602","createAbsoluteAnchor","_util__WEBPACK_IMPORTED_MODULE_0__","onDestroy","destroyTimer","destroyOnMouseOut","getRootNode","destroyIfOutside","isChildOf","boxSizing","mousedown","mousewheel","onmouseover","onmouseout","7923","7907","translate","cC","setLanguages","m0","setLanguage","_defs","en","auto","appendText","appendTitle","appendSubmenuTitle","appendTitleAuto","ascending","ascendingTitle","actionsMenu","cannotParseFieldError","cannotParseValueError","collapseAll","compactTitle","descending","descendingTitle","drag","duplicateKey","duplicateText","duplicateTitle","duplicateField","duplicateFieldError","empty","expandAll","expandTitle","formatTitle","insert","insertTitle","insertSub","redo","removeText","removeTitle","removeField","repairTitle","searchTitle","searchNextResultTitle","searchPreviousResultTitle","selectNode","showAll","showMore","showMoreStatus","sortTitle","sortTitleShort","sortFieldLabel","sortDirectionLabel","sortFieldTitle","sortAscending","sortAscendingTitle","sortDescending","sortDescendingTitle","transformTitle","transformTitleShort","extract","extractTitle","transformQueryTitle","transformWizardLabel","transformWizardFilter","transformWizardSortBy","transformWizardSelectFields","transformQueryLabel","transformPreviewLabel","typeTitle","openUrl","undo","validationCannotMove","autoType","objectType","arrayType","stringType","modeEditorTitle","modeCodeText","modeCodeTitle","modeFormText","modeFormTitle","modeTextText","modeTextTitle","modeTreeText","modeTreeTitle","modeViewText","modeViewTitle","modePreviewText","modePreviewTitle","examples","containsInvalidProperties","containsInvalidItems","es","zh-CN","pt-BR","tr","ja","fr-FR","de","ru","ko","_locales","_defaultLang","userLang","language","userLanguage","_lang","lang","langFound","languages","_loop","dataKey","6056","J","executeQuery","createQuery","jmespath__WEBPACK_IMPORTED_MODULE_0__","jmespath__WEBPACK_IMPORTED_MODULE_0___default","queryOptions","value1","examplePath","field","parsePath","parseString","relation","fields","4987","polyfill","CharacterData","DocumentType","predicate","341","index_commonjs","index_commonjs_default","constants","History","calculateItemSize","limit","_calculateHistorySize","totalSize","canUndo","canRedo","i18n","jmespathQuery","textmode","previewmode_textmode","previewmode","mainMenuBar","enableSort","enableTransform","indentation","focusTrackerConfig","_debouncedValidate","clientWidth","frameFocusTracker","busy","busyContent","previewContent","previewText","buttonFormat","executeWithBusyMessage","buttonCompact","compact","_sort","_showSortModal","_showTransformModal","buttonRepair","repair","_applyHistory","modeSwitcher","errorTable","totalHeight","marginBottom","paddingBottom","getErrorTable","fileSizeInfo","arrayInfo","getErrorCounter","getWarningIcon","getErrorIcon","_renderPreview","nodeValue","limitCharacters","formatSize","_onChange","onChangeText","modalAnchor","sortedBy","sortedObject","sortedArray","_setAndFireOnChange","sortObjectKeys","_this$options","queryDescription","onTransform","updatedJson","_setTextAndFireOnChange","repairedText","_set","_pushHistory","escapeUnicode","escapeUnicodeChars","_setText","updateText","_renderErrors","6210","picomodal__WEBPACK_IMPORTED_MODULE_0__","picomodal__WEBPACK_IMPORTED_MODULE_0___default","_util__WEBPACK_IMPORTED_MODULE_2__","onSort","paths","getChildPaths","selectedPath","selectedDirection","overlayClass","overlayStyles","backgroundColor","opacity","modalClass","afterCreate","modal","modalElem","setDirection","onsubmit","afterClose","2558","picoModal","picoModal_default","selectr","selectr_default","_typeof","stringifyValue","space","indent","stringifyArray","childIndent","stringifyObject","toJSON","jsonUtils_hasOwnProperty","times","DEFAULT_DESCRIPTION","_ref","_ref$queryDescription","elem","wizard","filterField","filterRelation","filterValue","sortField","sortOrder","selectFields","fontStyle","formattedPath","preprocessPath","filterOption","sortOption","selectablePaths","selectrFilterField","selectFieldsPart","selectrFilterRelation","selectrSortField","selectrSortOrder","selectrSelectFields","generateQueryFromWizard","oninput","debouncedUpdatePreview","transformed","_space","tryCreateQuery","selectedField","selectionStart","selectionEnd","5956","ace_default","tryRequireThemeJsonEditor","DEFAULT_THEME","poweredBy","originalSetAnnotations","lnVal","_ace","theme","onTextSelectionChange","aceEditor","textarea","annotations","lastSchemaErrors","_validateAndCatch","onkeydown","_onKeyDown","isReadOnly","getSession","getUndoManager","href","editorDom","aceSession","edit","$blockScrolling","setTheme","setOptions","readOnly","setShowPrintMargin","setFontSize","setTabSize","setUseSoftTabs","setUseWrapMode","setAnnotations","commands","bindKey","_onSelect","onchange","onselect","onmousedown","_onMouseDown","onblur","_updateHistoryButtons","setTextSelection","column","curserInfoElements","lnLabel","colLabel","colVal","countLabel","countVal","_this2","onChangeDisabled","undoManager","hasUndo","hasRedo","_sortedJson","sortedJson","_this3","_createQuery","_executeQuery","_updateCursorInfo","_emitSelectionChange","ctrlKey","curserPos","selectedText","col","updateDisplay","selectionRange","getInputSelection","startIndex","endIndex","cursorInfo","getCursorPosition","getSelectedText","currentSelection","_selectionChangedHandler","getTextSelection","_refreshAnnotations","errEnnotations","session","getAnnotations","resize","clearHistory","_this4","_this5","schemaErrors","parseErrors","improveSchemaError","validationSequence","onValidate","customValidateResults","customValidationPathErrors","valid","isValidValidationError","stringifyPath","validateCustom","customValidationErrors","onValidationError","isValidationErrorChanged","errorPaths","getPositionForPath","setErrors","range","lead","aceSelection","getRange","getSelectionLead","startPos","endPos","lineHeight","selectionScrollPos","_range","getIndexForPosition","setSelectionRange","createTextRange","collapse","moveEnd","moveStart","setRange","scrollToLine","8038","defaultFilterFunction","contain","Highlighter","locked","setHighlight","_cancelUnhighlight","unhighlightTimer","naturalSort","naturalSort_default","js_showSortModal","js_showTransformModal","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_slicedToArray","_arrayWithHoles","_i","_arr","_n","_iterableToArrayLimit","_nonIterableRest","_createForOfIteratorHelper","allowArrayLike","it","F","_e2","normalCompletion","didErr","step","_e3","minLen","Node_defineProperties","editor","expanded","setField","fieldEditable","setInternalValue","internalValue","_debouncedOnChangeValue","_onChangeValue","_debouncedOnChangeField","_onChangeField","visibleChilds","getMaxVisibleChilds","maxVisibleChilds","DEFAULT_MAX_VISIBLE_CHILDS","getPath","internalPath","getIndex","childs","findNodeByPath","childIndex","jsonPath","parents","errorChild","updateError","fieldError","valueError","tdError","tdValue","popupAnchor","createPopup","buttonRect","getPopupAnchor","popupWidth","popover","onfocus","findParents","expand","scrollTo","previousField","_getDomField","visible","childValue","newChild","previousChilds","_getType","Node_hasOwnProperty","childField","_child","findChildByProperty","_visible","hideChilds","recreateDom","updateDom","updateIndexes","domAnchor","_detachFromDom","clearDom","_attachToDom","getField","_getDomValue","getInternalValue","getLevel","getNodePath","cloneChilds","fieldInnerText","valueInnerText","childClone","setParent","recurse","showChilds","getAppendDom","iMax","nextTr","_getNextTr","getDom","getShowMoreDom","resetVisibleChilds","onClassName","removeAllClassNames","_updateCssClassName","recursivelyUpdateCssClassesOnNodes","currentNode","_hasChilds","newTr","beforeNode","trTemp","lastVisibleNode","AppendNode","afterNode","searchField","searchValue","MAX_SEARCH_RESULTS","_updateDomField","_updateDomValue","expandPathToNode","offsetTop","elementName","focusElement","selectContentEditable","containsNode","removedNode","newType","oldType","deepEqual","_clearValueError","_unescapeHTML","_setValueError","redoDiff","oldSelection","getDomSelection","newSelection","undoDiff","textDiff","startOffset","endOffset","_onAction","getInternalPath","previous","parentPath","domValue","classNames","valueType","getType","valueIsUrl","isUrl","searchValueActive","tdCheckbox","getUTCMilliseconds","defaultOption","_updateEnumOptions","tdSelect","valueFieldHTML","visibility","colorPicker","isValidColor","color","tdColor","_deleteDomColor","_showTimestampTag","date","timestampFormat","stripFormatting","_updateDomDefault","tooltip","domField","makeFieldTooltip","searchFieldActive","forceUnique","_clearFieldError","existingFieldNames","getFieldNames","findUniqueName","_setFieldError","inputElement","timestampTag","isTimestamp","tdMenu","_updateEditability","tdDrag","domDrag","tdField","_createDomTree","escapedValue","domTree","marginLeft","contentEditable","fieldText","_findSchema","escapedField","_escapeHTML","_updateSchema","updateNodeName","_updateDomIndexes","_findEnum","borderCollapse","tdExpand","_createDomExpandButton","tdSeparator","_createDomField","_createDomValue","highlighter","srcElement","expandable","unhighlight","showContextMenu","unlock","_onExpand","_showColorPicker","hasMoved","offsetX","pageX","getAbsoluteLeft","setEndOfContentEditable","onKeyDown","onEvent","isField","isValue","prevNode","oldNextNode","oldParent","oldIndexRedo","newIndexRedo","oldParentPathRedo","newParentPathRedo","multiselection","nextNode","nextNode2","prevDom","_nextNode2","altKey","selectedNodes","firstNode","lastNode","onDuplicate","onRemove","_onInsertBefore","_onInsertAfter","endNode","_lastNode","_getElementName","homeNode","_firstNode","prevElement","_previousElement","nextDom","appendDom","getNodeFromTarget","nextDom2","moveBefore","fieldNames","oldParentPath","newParentPath","oldIndex","newIndex","_previousNode","_findTopLevelNodes","nextElement","_nextElement","previousSibling","isVisible","_nextNode","colorAnchor","onColorPicker","excludeNode","newNode","beforePath","insertAfter","afterPath","changeType","oldChilds","triggerAction","nodeA","getNestedChild","nodeB","valueA","valueB","newChilds","lastTr","oldInternalValue","newInternalValue","_setRoot","ShowMoreNode","firstDom","lastDom","templates","_onAppend","_onChangeType","appendSubmenu","addTemplates","insertSubmenu","onCreateMenu","pathArray","_this$editor$options","htmlEscaped","escapedText","_escapeJSON","onNodeName","recursivelyUpdateNodeName","editableDiv","onDragStart","offsetY","draggedNode","getAbsoluteTop","mousemove","onDrag","mouseup","onDragEnd","oldCursor","oldPaths","mouseX","trNext","nodeNext","topPrev","topFirst","heightNext","mouseY","pageY","moved","trThis","topThis","heightThis","trPrev","nodePrev","trRoot","limitDragging","trFirst","trLast","bottomNext","diffX","diffLevel","levelNext","isDraggedNode","isDescendantOf","startAutoScroll","sameParent","stopAutoScroll","composite","oneOf","anyOf","allOf","topLevelSchema","currentSchema","nextPath","nextKey","possibleSchemas","subSchemas","_step","_iterator","$ref","_ref$match","referencedSchema","reference","auxNextPath","_ref$split2","schemaUrl","relativePath","_step2","refPath","_iterator2","segment","patternProperties","additionalProperties","firstIndex","blurNodes","_remove","clones","clonePaths","targetIsColorPicker","trAppend","tdAppend","domText","td","paddingLeft","showMoreButton","showAllButton","moreContents","moreText","_getShowMoreText","tdContents","moreTr","totalChilds","NodeHistory_defineProperties","NodeHistory","findNode","findNodeByInternalPath","actions","editField","updateField","editValue","updateValue","appendNodes","insertBeforeNodes","insertAfterNodes","duplicateNodes","moveNodes","oldParentNode","newParentNode","oldBeforeNode","newBeforeNode","setDomSelection","SearchBox_defineProperties","SearchBox","searchBox","timeout","lastText","divInput","refreshSearch","searchNext","_onDelayedSearch","_onSearch","onkeyup","searchPrevious","resultIndex","_setActiveResult","activeResult","_clearDelay","forceSearch","activeResultIndex","resultCount","TreePath_defineProperties","TreePath","contentMenuClicked","pathObjs","pathObj","sepEl","pathEl","selectionCallback","contextMenuCallback","leftRectPos","offsetWidth","showAllBtn","setPath","vanilla_picker","vanilla_picker_default","treemode","setEndOfContenteditable","contentEditableElement","createRange","selectNodeContents","removeAllRanges","addRange","moveToElementText","calculateWidthForText","spacer","outline","margin","border","whiteSpace","fontSize","fontFamily","fontWeight","onMouseOver","onMouseOut","onMouseDown","onmouseselection","__hint","leftSide","dropDown","ix","dropDownController","keyDownHandler","onBlurHandler","errorNodes","focusTarget","_setOptions","trigger","confirmKeys","caseSensitive","onArrowDown","onArrowUp","onEnter","onTab","startFrom","elementHint","elementStyle","getComputedStyle","marginTop","zIndex","borderColor","parentElement","repaint","hideDropDown","optionsLength","realInnerText","vph","documentElement","distanceToTop","distanceToBottom","filterFn","filtered","divRow","move","wasDropDownHidden","_token","_createFrame","_createTable","navigationBar","onSelectionChange","showOnTop","getWindow","popup","onDone","hex","rgba","startNode","repairedJsonText","tryJsonRepair","repairJsonText","scrollableContent","treePath","selectedNode","_updateTreePath","_validateCustom","_renderValidationErrors","setError","parentPairs","autoScrollStep","autoScrollTimer","domName","setSelectionOffset","getSelectionOffset","animateCallback","finalScrollTop","animateTimeout","diff","contentOuter","oncut","onpaste","onmouseup","onfocusin","onfocusout","_onUndo","_onRedo","navBar","onSectionSelected","_onTreePathSectionSelected","onContextMenuItemSelected","_onTreePathMenuItemSelected","_showAutoComplete","_startDragDistance","_updateDragDistance","hasParentNode","_onMultiSelectStart","pathNodes","childNode","expandTo","selectionObj","dragDistanceEvent","initialTarget","initialPageX","initialPageY","dragDistance","diffY","sqrt","_onMultiSelect","_onMultiSelectEnd","clearStartAndEnd","selectionChanged","startPath","endPath","startChild","endChild","lastIndex","jsonElementType","getOptions","metaKey","currentTarget","colgroupContent","selection1","selection2","_getNodeInstancesByRange","getNodesByRange","serializableNodes","2744","9125","9791","compileJSONPointer","getColorCSS","insideRect","isFirefox","removeReturnsAndSurroundingWhitespace","javascript_natural_sort__WEBPACK_IMPORTED_MODULE_1__","javascript_natural_sort__WEBPACK_IMPORTED_MODULE_1___default","jsonrepair__WEBPACK_IMPORTED_MODULE_2__","jsonrepair__WEBPACK_IMPORTED_MODULE_2___default","_assets_jsonlint_jsonlint__WEBPACK_IMPORTED_MODULE_3__","json_source_map__WEBPACK_IMPORTED_MODULE_4__","_i18n__WEBPACK_IMPORTED_MODULE_5__","MAX_ITEMS_FIELDS_COLLECTION","YEAR_2000","jsonString","isUrlRegex","divElement","specified","sel","getRangeAt","startContainer","endContainer","setStart","setEnd","trimmedValue","_text","hasChildNodes","prevName","prevChild","rv","_ieVersion","appName","useCapture","attachEvent","detachEvent","parseIndex","parseProperty","enums","keyword","additionalProperty","validationError","_margin","immediate","callNow","oldText","newText","oldEnd","newEnd","normalizedValue","textInputRange","endRange","moveToBookmark","getBookmark","compareEndPoints","_positionForIndex","textTillIndex","columnCount","jsmap","pointerName","pointer","pointers","ele","locale","description","example","existingPropNames","strippedName","validName","includeObjects","pathsMap","getObjectChildPaths","rootPath","parsedPath","sign","aValue","bValue","sortedFields","num","numFloat","valueOf","toFixed","KB","MB","GB","maxCharacterCount","currErr","prevErr","_ret","schemaPath","8037","Picker","6225","parentId","moduleName","mod","normalizeModule","payloads","uri","packaged","_require","global","require","nmd","payload","original","packagedModule","chunks","OS","LINUX","MAC","WINDOWS","getOS","isMac","isLinux","_navigator","os","ua","isWin","isIE","isOldIE","isGecko","isMozilla","isOpera","opera","isWebKit","isChrome","isEdge","isAIR","isAndroid","isChromeOS","isIOS","MSStream","isMobile","strictCSP","useragent","cssCache","buildDom","refs","txt","els","getDocumentHead","getElementsByTagName","createElementNS","removeChildren","createFragment","hasCssClass","addCssClass","removeCssClass","toggleCssClass","setCssClass","include","hasCssString","sheets","insertPendingStyles","useStrictCSP","importCssStylsheet","rel","scrollbarWidth","inner","outer","minWidth","noScrollbar","withScrollbar","computedStyle","setStyle","HAS_CSS_ANIMATION","HAS_CSS_TRANSFORMS","HI_DPI","devicePixelRatio","animationName","tx","ty","inherits","ctor","superCtor","super_","implement","oop","Keys","MODIFIER_KEYS","224","91","92","93","KEY_MODS","alt","meta","cmd","control","FUNCTION_KEYS","27","32","33","34","35","36","37","38","39","40","44","45","46","96","97","98","99","100","101","102","103","104","105","-13","112","113","114","115","116","117","118","119","120","121","122","123","144","145","PRINTABLE_KEYS","48","49","50","51","52","53","54","55","56","57","59","61","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","107","109","110","186","187","188","189","190","191","192","219","220","221","222","111","106","escape","esc","del","mods","pow","keyCodeToString","keyString","activeListenerOptions","pressedKeys","ts","getListenerOptions","detectListenerOptionsSupport","passive","EventListener","removeListener","getModifierHash","postMessageId","addListener","destroyer","$toDestroy","stopEvent","getButton","eventHandler","releaseCaptureHandler","onMouseUp","addMouseWheelListener","wheelDeltaX","wheelX","wheelY","wheelDeltaY","wheelDelta","deltaMode","DOM_DELTA_PIXEL","deltaX","deltaY","DOM_DELTA_LINE","DOM_DELTA_PAGE","axis","HORIZONTAL_AXIS","addMultiMouseDownListener","timeouts","callbackName","startX","startY","timer","clicks","eventNames","onMousedown","isNewClick","clientX","clientY","_clicks","normalizeCommandKeys","hashId","getModifierState","altGr","keyLocation","timeStamp","defaultPrevented","resetPressedKeys","getModifierString","addCommandKeyListener","lastKeyDownKeyCode","lastDefaultPrevented","isOldGecko","postMessage","nextTick","win","messageName","$idleBlocked","onIdle","$idleBlockId","blockIdle","nextFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","oRequestAnimationFrame","Range","startRow","startColumn","endRow","endColumn","isEqual","compare","compareRange","comparePoint","containsRange","intersects","isEnd","isStart","inside","insideStart","insideEnd","isMultiLine","compareStart","compareEnd","compareInside","clipRows","firstRow","lastRow","fromPoints","collapseRows","toScreenRange","screenPosStart","documentToScreenPosition","screenPosEnd","moveBy","comparePoints","p1","p2","stringReverse","stringRepeat","trimBeginRegexp","trimEndRegexp","stringTrimLeft","stringTrimRight","copyObject","copyArray","deepCopy","arrayToMap","createMap","arrayRemove","escapeRegExp","escapeHTML","getMatchOffsets","regExp","deferredCall","fcn","deferred","schedule","isPending","delayedCall","defaultTimeout","_self","$cancelT","lineMode","pasteCancelled","clipboard","BROKEN_SETDATA","USE_IE_MIME_TYPE","HAS_FOCUS_ARGS","KEYS","MODS","valueResetRegex","TextInput","copied","pasted","inComposition","sendingText","tempStyle","commandMode","ignoreFocusEvents","lastValue","lastSelectionStart","lastSelectionEnd","lastRestoreEnd","hasFocus","resetSelection","$focusScroll","preventScroll","isTransformed","ancestors","curOp","commandName","isUserAction","docChanged","onCompositionEnd","onCut","doCopy","onCopy","onPaste","handleClipboardData","afterContextMenu","nextLine","getLine","prevLine","isAllSelected","inputHandler","setInputHandler","getInputHandler","sendText","fromInput","extendLeft","extendRight","inserted","restoreStart","restoreEnd","shouldReset","onTextInput","onInput","onCompositionUpdate","inputType","execCommand","MAX_LINE_LENGTH","forceIEMime","clipboardData","mime","setData","getData","isCut","getCopyText","onCommandKey","selectAll","$readOnly","cancelComposition","useTextareaForIME","markerRange","compositionStartOffset","closeTimeout","syncComposition","onContextMenuClose","$isMousePressed","$keepTextAreaAtCursor","$moveTextAreaToCursor","onCompositionStart","_signal","getSelectionRange","msGetInputContext","getInputContext","getElement","setCommandMode","setReadOnly","setCopyWithEmptySelection","onContextMenu","_emit","domEvent","moveToMouse","bringToFront","characterWidth","maxTop","borderTopWidth","borderLeftWidth","textInput","scroller","addIosSelectionHandler","detectArrowKeys","typing","$mouseHandler","isMousePressed","modifier","up","home","down","findKeyCommand","typingResetTimeout","$setUserAgentForTests","_isMobile","_isIOS","DefaultHandlers","mouseHandler","$clickSelection","setDefaultHandler","onDoubleClick","onTripleClick","onQuadClick","onMouseWheel","selectByLines","extendSelectionBy","selectByWords","calcRangeOrientation","inSelection","pos","getDocumentPosition","mousedownEvent","moveToPosition","$focusTimeout","inMultiSelectMode","captureMouse","startSelect","setState","waitForClickSelection","screenToTextCoordinates","getShiftKey","selectToPosition","setCapture","orientedRange","setSelectionAnchor","scrollCursorIntoView","unitName","cmpEnd","cmpStart","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","unsetStyle","releaseCapture","focusWait","ay","bx","distance","getBracketRange","getWordRange","getLineRange","prevScroll","vx","vy","canScroll","getAccelKey","$lastScroll","allowed","dt","isScrollableBy","speed","scrollBy","Tooltip","isOpen","$element","$parentNode","$init","setHtml","setPosition","setClassName","getHeight","getWidth","GutterTooltip","windowWidth","innerWidth","windowHeight","GutterHandler","tooltipTimeout","tooltipAnnotation","gutter","$gutterLayer","hideTooltip","moveTooltip","gutterRegion","getRegion","selectTo","$tooltipFollowsMouse","$annotations","getLength","screenRow","pixelToScreenCoordinates","$pos","documentToScreenRow","$gutter","MouseEvent","$inSelection","propagationStopped","DragdropHandler","dragSelectionMarker","timerId","dragCursor","dragOperation","isInternal","autoScrollStartTime","cursorMovedTime","cursorPointOnCaretMoved","dragImage","mouseTarget","counter","onDragInterval","prevCursor","editorRect","nearestXOffset","nearestYOffset","scrollCursor","vMovement","hMovement","moveCursorToPosition","calcDistance","layerConfig","offsets","vScroll","hScroll","addDragMarker","toOrientedRange","addMarker","getSelectionStyle","clearSelection","$cursorLayer","setBlinking","onMouseMove","clearDragMarker","removeMarker","fromOrientedRange","$resetCursorStyle","cancelDrag","draggable","dataTransfer","effectAllowed","getReadOnly","setDragImage","clearData","getTextRange","dropEffect","setCursorStyle","onDragEnter","canAccept","getDropEffect","onDragOver","onMouseMoveTimer","onDragLeave","onDrop","moveText","dropData","copyAllowed","copyModifierState","dragWait","getDragDelay","startDrag","dragWaitEnd","dragReadyEnd","cursorStyle","onMouseDrag","dragDrop","eventTarget","$dragEnabled","unselectable","addTouchListeners","touchStartT","lastT","longTouchTimer","animationTimer","pressed","contextMenu","animationSteps","clickCount","vX","vY","createContextMenu","handleClick","readText","writeText","ontouchstart","ontouchend","pagePos","textToScreenCoordinates","leftOffset","hideContextMenu","handleLongTap","selectWord","touches","touchObj","cursorPos","getPixelPosition","anchorPos","offsetLeft","weightedDistance","diff1","diff2","oldScrollTop","getScrollTop","url","xhr","XMLHttpRequest","onreadystatechange","readyState","responseText","send","loadScript","onload","isAbort","qualifyURL","EventEmitter","_eventRegistry","_defaultHandlers","defaultHandler","once","newCallback","handlers","_disabled_","old","removeDefaultHandler","removeAllListeners","optList","setOption","optionNames","$options","hidden","getOption","forwardTo","handlesSet","reportError","AppConfig","$defaultOptions","defineOptions","resetOptions","setDefaultValue","setDefaultValues","optionHash","net","workerPath","modePath","themePath","basePath","suffix","$moduleUrls","loadWorkerFromBlob","sharedPopups","reportErrorIfPathIsNotConfigured","$modes","moduleUrl","base","re","subst","$loading","loadModule","onLoad","moduleType","afterLoad","init","amdD","scriptOptions","scriptUrl","currentScript","_currentScript","scripts","m1","MouseHandler","focusEditor","DefaultGutterHandler","getMouseEventTarget","gutterEl","onMouseEvent","scrollBarV","scrollBarH","$dragDelay","character","$scrollSpeed","mouseMoveHandler","releaseMouse","$mouseMoved","onCaptureEnd","onOperationEnd","onCaptureInterval","$onCaptureMouseMove","endOperation","startOperation","cancelContextMenu","scrollSpeed","dragDelay","dragEnabled","focusTimeout","tooltipFollowsMouse","FoldHandler","fold","getFoldAt","removeFold","expandFold","getUseWrapMode","foldWidgets","onFoldWidgetClick","getParentFoldRangeData","firstRange","addFold","KeyBinding","$editor","$handlers","keyUtil","kb","removeKeyboardHandler","$defaultHandler","addKeyboardHandler","setKeyboardHandler","handleKeyboard","attach","detach","getKeyboardHandler","getStatusText","$callKeyboardHandlers","toExecute","success","passEvent","dir","hiLevel","lastArabic","hasUBAT_B","hasUBAT_S","impTab_LTR","impTab_RTL","L","EN","AN","ON","B","S","AL","WS","CS","ES","ET","NSM","LRE","RLE","PDF","LRO","RLO","BN","UnicodeTBL00","UnicodeTBL20","_computeLevels","levels","charTypes","newClass","newLevel","impTab","condPos","_getCharacterType","prevState","wType","cType","nType","rtlCandidate","_getCharClass","_invertLevel","lev","_array","lo","hi","uc","ON_R","R_H","DOT","doBidiReorder","textCharTypes","isRtl","logicalFromVisual","bidiLevels","hasBidiCharacters","getVisualFromLogicalIdx","logIdx","rowMap","BidiHandler","bidiMap","currentRow","bidiUtil","charWidths","EOL","showInvisibles","isRtlDir","$isRtl","wrapIndent","contentWidth","fontMetrics","rtlLineOffset","wrapOffset","isMoveLeftOperation","seenBidi","bidiRE","isBidiRow","docRow","splitIndex","updateRowLine","updateBidiMap","delta","getDocumentRow","rowCache","$screenRowCache","$getRowCacheIndex","$docRowCache","getSplitIndex","currentIndex","prevIndex","endOfLine","$useWrapMode","splits","$wrapData","isFullWidth","getScreenTabSize","$main","markAsDirty","updateCharacterWidths","$characterSize","bidiCharWidth","$measureCharWidth","setShowInvisibles","setEolChar","eolChar","setContentWidth","isRtlLine","setRtlDirection","getSelectionAnchor","$bidiHandler","removeInLine","getPosLeft","leftBoundary","logicalIdx","getOverwrite","visualIdx","getSelections","startCol","endCol","selections","selColMin","selColMax","isSelected","isSelectedPrev","visIdx","offsetToCol","posX","charWidth","Selection","getDocument","createAnchor","$silent","$cursorChanged","$isEmpty","$keepDesiredColumnOnChange","$desiredColumn","$anchorChanged","getCursor","getPosition","getAnchor","isBackwards","$setSelection","MAX_VALUE","anchorRow","anchorColumn","cursorRow","cursorColumn","wasEmpty","wasMultiselect","$moveSelection","mover","moveCursorTo","moveTo","selectUp","moveCursorUp","selectDown","moveCursorDown","selectRight","moveCursorRight","selectLeft","moveCursorLeft","selectLineStart","moveCursorLineStart","selectLineEnd","moveCursorLineEnd","selectFileEnd","moveCursorFileEnd","selectFileStart","moveCursorFileStart","selectWordRight","moveCursorWordRight","selectWordLeft","moveCursorWordLeft","selectAWord","getAWordRange","excludeLastChar","rowStart","foldLine","getFoldLine","rowEnd","selectLine","moveCursorBy","wouldMoveIntoSoftTab","tabSize","isTabStop","getTabSize","getNavigateWithinSoftTabs","firstColumnPosition","screenToDocumentPosition","leadingSpace","getDisplayLine","$useEmacsStyleLineStart","textEnd","lineEnd","getDocumentLastRowColumnPosition","moveCursorLongWordRight","rightOfCursor","nonTokenRe","tokenRe","moveCursorLongWordLeft","getFoldStringAt","leftOfCursor","$shortWordEndIndex","whitespaceRe","moveCursorShortWordRight","moveCursorShortWordLeft","$selectLongWords","screenPos","docPos","lineWidgets","widget","rowsAbove","rowCount","keepDesiredColumn","moveCursorToScreen","desiredColumn","getRangeOfMovements","ranges","r1","fromJSON","rangeList","toSingleRange","Tokenizer","regExps","matchMappings","ruleRegExps","matchTotal","mapping","defaultToken","flag","splitterRurles","adjustedregex","matchcount","rule","caseInsensitive","regex","groupCount","tokenArray","onMatch","$arrayTokens","$applyToken","digit","removeCapturingGroups","splitRegex","createSplitterRegexp","MAX_TOKEN_COUNT","$setMaxTokenCount","tokens","inChClass","lastCapture","parenOpen","parenClose","square","getLineTokens","startState","matchAttempts","skipped","consumeLineEnd","merge","TextHighlightRules","$rules","addRules","nextState","getRules","embedRules","HighlightRules","escapeRules","$embeds","getEmbeds","normalizeRules","processState","processed","toInsert","stateName","includeName","noEscape","keywordMap","createKeywordMapper","ignoreCase","splitChar","keywords","$keywordList","word","getKeywords","$keywords","Behaviour","$behaviours","addBehaviours","behaviours","inherit","getBehaviours","TokenIterator","initialRow","initialColumn","$session","$row","$rowTokens","getTokens","getTokenAt","$tokenIndex","stepBackward","stepForward","getCurrentToken","getCurrentTokenRow","getCurrentTokenColumn","rowTokens","tokenIndex","getCurrentTokenPosition","getCurrentTokenRange","initContext","multiSelect","contextCache","autoInsertedBrackets","autoInsertedRow","autoInsertedLineEnd","maybeInsertedBrackets","maybeInsertedRow","maybeInsertedLineStart","maybeInsertedLineEnd","getWrapped","opening","closing","rowDiff","CstyleBehaviour","getWrapBehavioursEnabled","isSaneInsertion","braces","recordAutoInsert","recordMaybeInsert","rightChar","$findOpeningBracket","isAutoInsertedClosing","popAutoInsertedClosing","isMaybeInsertedClosing","clearMaybeInsertedClosing","openBracePos","findMatchingBracket","next_indent","$getIndent","getTabString","quotes","$quotes","defaultQuotes","lineCommentStart","leftChar","rightToken","stringBefore","stringAfter","wordRe","isWordBefore","isWordAfter","charBefore","SAFE_INSERT_IN_TOKENS","SAFE_INSERT_BEFORE_TOKENS","\"","'","$matchTokenType","iterator2","bracket","wordChars","Mode","unicode","$defaultBehaviour","getTokenizer","$tokenizer","$highlightRules","$highlightRuleConfig","blockComment","toggleCommentLines","ignoreBlankLines","shouldRemove","minIndent","insertAtTabStop","regexpStart","getUseSoftTabs","uncomment","shouldInsertSpace","commentWithSpace","comment","insertInLine","testRemove","spaces","lineCommentEnd","regexpEnd","minEmptyLength","toggleBlockComment","colDiff","initialRange","startRange","getNextLineIndent","tab","checkOutdent","autoOutdent","createWorker","createModeDelegates","$id","delegations","functionName","$delegator","transformAction","param","$behaviour","completionKeywords","ruleItr","aLength","$createKeywordList","getCompletions","score","applyDelta","docLines","doNotValidate","Anchor","$onChange","$pointsInOrder","point1","point2","equalPointsInOrder","bColIsAfter","$clipPositionToDocument","$insertRight","point","moveIfEqual","deltaIsInsert","deltaRowShift","deltaColShift","deltaStart","deltaEnd","$getTransformedPoint","noClip","Document","textOrLines","$lines","insertMergedLines","getAllLines","getNewLineCharacter","$split","$detectNewLine","$autoNewLine","$newLineMode","setNewLineMode","newLineMode","getNewLineMode","isNewLine","getLines","getLinesForRange","insertLines","insertFullLines","removeLines","removeFullLines","insertNewLine","clippedPos","clonePos","$clipPosition","deleteFirstNewLine","deleteLastNewLine","deletedLines","removeNewLine","applyDeltas","deltas","revertDeltas","revertDelta","isInsert","$splitAndapplyLargeDelta","$safeApplyDelta","docLength","MAX","chunk","indexToPosition","newlineLength","positionToIndex","BackgroundTokenizer","tokenizer","currentLine","$worker","workerStart","endLine","startLine","processedLines","$tokenizeRow","fireUpdateEvent","setTokenizer","setDocument","scheduleStart","$updateOnChange","getState","SearchHighlight","clazz","setRegexp","MAX_RANGES","markerLayer","drawSingleLineMarker","FoldLine","foldData","folds","setFoldLine","shiftRow","sameRow","containsRow","walk","lastEnd","isNewRow","getNextFoldTo","addRemoveChars","foldBefore","newFoldLine","foldLineNext","idxToPosition","lastFoldEndColumn","RangeList","$bias","pointIndex","excludeEdges","substractPoint","containsPoint","rangeAtPoint","clipped","lineDif","Fold","subFolds","consumePoint","restorePoint","subFold","collapseChildren","addSubFold","afterStart","firstConsumed","consumedFolds","restoreRange","Folding","side","getFoldsInRange","foldLines","$foldData","foundFolds","getFoldsInRangeList","getAllFolds","lastFold","startFoldLine","getNextFoldLine","getFoldedRowCount","$addFoldLine","$clipRangeToDocument","startFold","endFold","removeFolds","$updateWrapData","$updateRowLengthCache","$modified","addFolds","$updating","cloneFolds","foldAll","expandFolds","unfold","expandInner","outermostFolds","isRowFolded","startFoldRow","getRowFoldEnd","getRowFoldStart","getFoldDisplayLine","textLine","lastColumn","$cloneFoldData","fd","toggleFold","tryToUnfold","bracketPos","getCommentFoldRange","getFoldWidget","getFoldWidgetRange","foldToLevel","foldAllComments","$foldStyles","manual","markbegin","markbeginend","$foldStyle","setFoldStyle","$foldMode","$setFolding","foldMode","$updateFoldWidgets","$tokenizerUpdateFoldWidgets","updateFoldWidgets","tokenizerUpdateFoldWidgets","ignoreCurrent","fw","siblings","$toggleFoldWidget","toggleFoldWidget","toggleParent","BracketMatch","chr","charBeforeCursor","$findClosingBracket","getMatchingBracketRanges","$brackets",")","(","<",">","typeRe","openBracket","valueIndex","closingBracket","EditSession","$breakpoints","$decorations","$frontMarkers","$backMarkers","$markerId","$undoSelect","$uid","onChangeFold","TextMode","bgTokenizer","resetCaches","$resetRowCache","cacheArray","$rowLengthCache","removedFolds","$updateInternalDataOnChange","$fromUndo","$undoManager","mergeUndoDeltas","$informUndoManager","setUndoManager","addSession","$syncInformUndoManager","markUndoGroup","$defaultUndoManager","addSelection","startNewGroup","$useSoftTabs","$indentWithTabs","$tabSize","setNavigateWithinSoftTabs","navigateWithinSoftTabs","$navigateWithinSoftTabs","$overwrite","setOverwrite","overwrite","toggleOverwrite","addGutterDecoration","removeGutterDecoration","getBreakpoints","setBreakpoints","clearBreakpoints","setBreakpoint","clearBreakpoint","inFront","addDynamicMarker","markerId","getMarkers","$searchHighlight","highlightLines","clearAnnotations","inToken","wordRange","setUseWorker","useWorker","getUseWorker","$useWorker","onReloadTokenizer","$modeId","$onChangeMode","$isPlaceholder","$stopWorker","$startWorker","attachToSession","wrapMethod","$wrapMethod","foldingRules","terminate","$scrollTop","setScrollTop","$scrollLeft","setScrollLeft","getScrollLeft","getScreenWidth","$computeWidth","getLineWidgetMaxWidth","screenWidth","lineWidgetsWidth","lineWidgetWidth","$wrapLimit","longestScreenLine","foldIndex","foldStart","$getStringScreenWidth","undoChanges","dontSelect","selectionBefore","$getUndoSelection","redoChanges","selectionAfter","setUndoSelect","isUndo","fromRange","toPosition","oldStart","collDiff","toRange","newStart","indentRows","indentString","outdentRows","rowRange","deleteRange","$moveLines","$clipRowToDocument","moveLinesUp","moveLinesDown","duplicateLines","$clipColumnToRow","$wrapLimitRange","useWrapMode","setWrapLimitRange","adjustWrapLimit","desiredLimit","$printMargin","limits","wrapLimit","$constrainWrapLimit","getWrapLimit","setWrapLimit","getWrapLimitRange","foldLineBefore","wrapData","walkTokens","$getDisplayTokens","PLACEHOLDER_START","PLACEHOLDER_BODY","$computeWrapSplits","displayLength","lastSplit","lastDocSplit","isCode","$wrapAsCode","indentedSoftWrap","$indentedSoftWrap","maxIndent","addSplit","getWrapIndent","minSplit","maxScreenColumn","screenColumn","getRowLength","getRowLineCount","getRowWrapIndent","getScreenLastRowColumn","documentToScreenColumn","getDocumentLastRowColumn","docColumn","getRowSplitData","screenToDocumentRow","screenToDocumentColumn","doCache","rowLength","maxRow","foldStartRow","wrapRow","screenRowOffset","getScreenLength","screenRows","$getWidgetScreenLength","$setFontMetrics","fm","$enableVarChar","getCharacterWidth","$wrap","firstLineNumber","useSoftTabs","foldStyle","Search","$matchIterator","sc","er","ec","skipCurrent","findAll","needle","$assembleRegExp","$isMultiLine","prevRange","replacement","preserveCase","$disableFakeMultiline","wordBoundary","wholeWord","$assembleMultilineRegExp","forEachInLine","backwards","HashHandler","commandKeyBinding","addCommands","$singleCommand","MultiHashHandler","isDefault","addCommand","removeCommand","_buildKeyHash","keepCommand","keyId","ckb","cmdGroup","keyPart","parseKeys","_addCommandToBinding","removeCommands","bindKeys","keyList","$keyChain","CommandManager","byName","$checkCommandState","isAvailable","returnValue","toggleRecording","$inReplay","recording","macro","$addCommandToMacro","oldMacro","replay","trimMacro","mac","showSettingsMenu","showErrorMarker","scrollIntoView","centerSelection","gotoLine","prompt","$type","multiSelectAction","getAllRanges","findNext","findPrevious","aceCommandGroup","navigateFileStart","navigateUp","navigateFileEnd","navigateDown","navigateWordLeft","navigateLineStart","navigateLeft","navigateWordRight","navigateLineEnd","navigateRight","selectPageDown","scrollPageDown","gotoPageDown","selectPageUp","scrollPageUp","gotoPageUp","jumpToMatching","$copyWithEmptySelection","$handlePaste","duplicateSelection","sortLines","modifyNumber","copyLinesUp","copyLinesDown","removeToLineStart","removeToLineEnd","removeWordLeft","removeWordRight","blockOutdent","blockIndent","splitLine","transposeLetters","transposeSelections","autoIndent","firstLineEndCol","selectedCount","insertLine","curLine","newRanges","exitMultiSelectMode","Editor","getContainerElement","defaultCommands","getTextAreaContainer","keyBinding","$search","$historyTracker","$initOperationListeners","_$emitInputEvent","setSession","relativeNumberRenderer","$opResetTimer","$lastSel","prevOp","commandEvent","previousCommand","scrollSelectionIntoView","animateScrolling","$mergeableCommands","mergeableCommands","shouldMerge","$mergeUndoDeltas","mergeNextCommand","sequenceStartTime","keyboardHandler","$keybindingId","oldSession","$onDocumentChange","$onTokenizerUpdate","$onChangeTabSize","$onChangeWrapLimit","$onChangeWrapMode","$onChangeFold","$onChangeFrontMarker","$onChangeBackMarker","$onChangeBreakpoint","$onChangeAnnotation","$onCursorChange","$onScrollTopChange","$onScrollLeftChange","$onSelectionChange","onDocumentChange","onChangeMode","onTokenizerUpdate","onChangeTabSize","onChangeWrapLimit","onChangeWrapMode","onChangeFrontMarker","onChangeBackMarker","onChangeBreakpoint","onChangeAnnotation","onCursorChange","onScrollTopChange","onScrollLeftChange","updateFull","oldEditor","onResize","getTheme","getFontSize","$highlightBrackets","$highlightPending","markerType","$bracketHighlight","markerIds","getMatching","$highlightTags","$highlightTagPending","$tagHighlight","currentTag","prevToken","stepCount","tmpToken","sbm","$isFocused","showCursor","visualizeFocus","hideCursor","visualizeBlur","$cursorChange","updateCursor","$updateHighlightActiveLine","updateLines","scrollToY","scrollToX","$highlightActiveLine","$selectionStyle","$selectionColorConflict","$maxLines","$minLines","$highlightLineMarker","$selectionMarker","$highlightSelectedWord","$getSelectionHighLightRegexp","wordWithBoundary","updateFrontMarkers","updateBackMarkers","updateBreakpoints","nl","copyLine","inVirtualSelectionMode","isFullLine","getBehavioursEnabled","lineState","shouldOutdent","$enableAutoIndent","lineIndent","selectedRange","prevLineState","currIndent","applyComposition","forEachSelection","setScrollSpeed","getScrollSpeed","setDragDelay","setSelectionStyle","setHighlightActiveLine","shouldHighlight","getHighlightActiveLine","setHighlightGutterLine","getHighlightGutterLine","setHighlightSelectedWord","getHighlightSelectedWord","setAnimatedScroll","shouldAnimate","getAnimatedScroll","getShowInvisibles","setDisplayIndentGuides","getDisplayIndentGuides","showPrintMargin","getShowPrintMargin","setPrintMarginColumn","getPrintMarginColumn","setBehavioursEnabled","setWrapBehavioursEnabled","setShowFoldWidgets","getShowFoldWidgets","setFadeFoldWidgets","fade","getFadeFoldWidgets","new_range","originalRange","$getSelectedRows","getNumberAt","_numberRx","amount","decimals","nnr","charRange","nr","fp","replaceRange","toggleWord","$toggleWordPairs","itLength","currWordStart","wordParts","curLength","wordPairs","negate","firstCondition","reg","endPoint","totalDiff","rangeIndex","subRows","compositionState","showComposition","setCompositionText","hideComposition","getFirstVisibleRow","getLastVisibleRow","isRowVisible","isRowFullyVisible","getFirstFullyVisibleRow","getLastFullyVisibleRow","$getVisibleRowCount","getScrollBottomRow","getScrollTopRow","$moveByPage","scrollToRow","center","alignCursor","getCursorPositionScreen","matchType","bracketType","brackets","lineNumber","navigateTo","replaced","$tryReplace","replaceAll","getLastSearchOptions","newRange","revealRange","setAutoScrollEditorIntoView","shouldScroll","scrollAnchor","onChangeSelection","onBeforeRender","onAfterRender","$scrollAnchor","$pixelPos","$cursorStyle","cursorLayer","setSmoothBlinking","isBlinking","selectionStyle","highlightActiveLine","highlightSelectedWord","copyWithEmptySelection","behavioursEnabled","wrapBehavioursEnabled","enableAutoIndent","autoScrollEditorIntoView","showLineNumbers","setShowLineNumbers","$loop","CHANGE_GUTTER","$relativeLineNumbers","relativeLineNumbers","$showLineNumbers","$updatePlaceholder","$composition","placeholderNode","$placeholder","hScrollBarAlwaysVisible","vScrollBarAlwaysVisible","highlightGutterLine","animatedScroll","printMarginColumn","printMargin","fadeFoldWidgets","showFoldWidgets","displayIndentGuides","showGutter","maxLines","minLines","scrollPastEnd","fixedWidthGutter","hasCssTransforms","maxPixelHeight","lastLineNumber","$renderer","UndoManager","$maxRev","allowMerge","$lastDelta","$keepRedoStack","$redoStack","lastDeltas","$undoStack","$rev","rev","markIgnored","getRevision","getDeltas","getChangedRanges","getChangedLines","undoSelectionRange","deltaSet","swapped","ds1","ds2","swapGroups","rearrangeUndoStack","$redoStackBaseRev","$syncRev","redoStack","deltaSets","moveDeltasByOne","xformed","cloneDelta","c1","splitDelta","shiftPos","xform","redoSelectionRange","nextDelta","mark","bookmark","isAtBookmark","isClean","markClean","$prettyPrint","stringifyDelta","stringifyRange","rowsBefore","otherLines","Lines","canvasHeight","cells","cellCache","$offsetCoefficient","moveContainer","firstRowScreen","pageChanged","oldConfig","newConfig","computeLineTop","screenTop","screenPage","computeLineHeight","$cacheCell","cell","insertAdjacentElement","createCell","initElement","Gutter","parentEl","$showFoldWidgets","gutterWidth","$updateAnnotations","onCreateCell","textNode","foldWidget","rowInfo","annoText","gutterOffset","oldLastRow","$updateCursorRow","$renderCell","$updateGutterWidth","gutterRenderer","$firstLineNumber","lastLineText","$fixedWidth","$padding","$computePadding","ceil","$highlightGutterLine","$cursorRow","updateLineHighlight","$cursorCell","scrollLines","$renderLines","breakpoints","decorations","foldHeight","getShowLineNumbers","borderRightWidth","paddingRight","Marker","setPadding","setMarkers","markers","elt","$getTop","drawFullLineMarker","drawScreenLineMarker","drawTextMarker","drawMultiLineMarker","stringBuilder","extraStyle","lineRange","range1","drawBidiSingleLineMarker","radiusClass","extraLength","Text","$updateEolChar","EOF_CHAR","EOL_CHAR_LF","EOL_CHAR_CRLF","EOL_CHAR","TAB_CHAR","SPACE_CHAR","getLineHeight","$fontMetrics","measure","$pollSizeChanges","checkForSizeChanges","$pollSizeChangesTimer","$computeTabString","showSpaces","showTabs","showEOL","$tabStrings","spaceClass","spaceContent","tabClass","tabContent","span","tabStr","$indentGuideRe","lineElements","lineElementsIdx","heightChanged","lineElement","$renderLine","$renderLinesFragment","lineEl","$useLineGroups","$textToken","rparen","lparen","$renderToken","valueFragment","simpleSpace","controlCharacter","cjkSpace","cjk","com","renderIndentGuide","cols","$createLineElement","$renderWrappedLine","splitChars","$renderOverflowMessage","$renderSimpleLine","overflowEl","invisibleEl","lastLineEl","$getFoldLineTokens","renderTokens","addTokens","Cursor","blinkInterval","smoothBlinking","cursors","addCursor","$updateCursors","$updateOpacity","$startCssAnimation","animationDuration","$isAnimating","$stopCssAnimation","blinking","restartTimer","setBlinkInterval","removeCursor","blink","intervalId","timeoutId","$isSmoothBlinking","onScreen","isCursorInView","pixelPos","$selectionMarkers","cursorIndex","drawCursor","$setOverwrite","ScrollBar","classSuffix","setVisible","skipEvent","onScroll","VScrollBar","$scrollbarWidth","$minWidth","HScrollBar","coeff","setHeight","setInnerHeight","setScrollHeight","setWidth","setInnerWidth","setScrollWidth","ScrollBarV","ScrollBarH","RenderLoop","onRender","$recursionLimit","_flush","USE_OBSERVER","ResizeObserver","FontMetrics","$setMeasureNodeStyles","$measureNode","$addObserver","isRoot","boldSize","$measureSizes","charSizes","allowBoldFonts","$observer","setPolling","$getZoom","getZoom","zoom","$initTransformMeasureNodes","transformCoordinates","clientPos","elPos","solve","l1","l2","det","mul","m2","ut","u","VirtualRenderer","textLayer","GutterLayer","onGutterResize","$markerBack","MarkerLayer","$textLayer","TextLayer","canvas","$markerFront","CursorLayer","$horizScroll","$vScroll","scrollBar","$scrollAnimation","scrollMargin","updateCharacterSize","$size","scrollerHeight","scrollerWidth","$dirty","minHeight","$renderChanges","CHANGE_FULL","editorCss","HIDE_TEXTAREA","CHANGE_CURSOR","CHANGE_MARKER","CHANGE_SCROLL","CHANGE_LINES","CHANGE_TEXT","CHANGE_SIZE","CHANGE_MARKER_BACK","CHANGE_MARKER_FRONT","CHANGE_H_SCROLL","$allowBoldFonts","$updatePrintMargin","onChangeNewLineMode","$changedLines","updateFontSize","$changes","$updateSizeAsync","resizing","scrollWidth","$updateCachedSize","$extraHeight","$showGutter","$computeLayerConfig","availableWidth","$showPrintMargin","$printMarginColumn","$animatedScroll","getShowGutter","setShowGutter","$printMarginEl","containerEl","posTop","posLeft","setScrollMargin","sm","setMargin","getHScrollBarAlwaysVisible","$hScrollBarAlwaysVisible","setHScrollBarAlwaysVisible","alwaysVisible","getVScrollBarAlwaysVisible","$vScrollBarAlwaysVisible","setVScrollBarAlwaysVisible","$updateScrollBarV","$scrollPastEnd","$updateScrollBarH","$frozen","unfreeze","st","$updateLines","$autosize","desiredHeight","$maxPixelHeight","$gutterWidth","firstRowHeight","hideScrollbars","longestLine","$getLongestLine","horizScroll","hScrollChanged","vScrollBefore","vScrollChanged","lineCount","charCount","$viewMargin","topMargin","bottomMargin","alignment","STEPS","$calcSteps","fromValue","toValue","x_min","steps","initialScroll","oldSteps","$timer","$hasCssTransforms","canvasPos","$blockCursor","$useTextareaForIME","addToken","removeExtraToken","newToken","$themeId","$theme","setMouseCursor","attachToShadowRoot","workerUrl","Worker","blob","Blob","blobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","getBlob","$workerBlob","blobURL","URL","webkitURL","createObjectURL","WorkerClient","worker","$createWorkerFromOldConfig","$sendDeltaQueue","changeListener","onMessage","callbackId","callbacks","onmessage","topLevelNamespaces","classname","importScripts","normalizePath","tlns","nameToUrl","toUrl","$normalizePath","deltaQueue","$doc","ex","attachToDocument","UIWorkerClient","main","emitSync","sender","messageBuffer","workerClient","processNext","setEmitSync","Main","PlaceHolder","others","mainClass","othersClass","undoStack","$onUpdate","onUpdate","$others","$undostack","$undoStackDepth","setup","showOtherMarkers","othersActive","hideOtherMarkers","updateAnchors","lengthDiff","inMainRange","distanceFromStart","newPos","otherPos","updateMarkers","updateMarker","undosRequired","isSamePoint","accel","selectionMode","oldRange","rectSel","blockSelect","onSelectionInterval","isMultiSelect","screenAnchor","screenCursor","$enableJumpToDef","$blockSelectEnabled","addSelectionMarker","removeSelectionMarker","tmpSel","newCursor","removeSelectionMarkers","rectangularRangeBlock","updateSelectionMarkers","selectMoreLines","selectMore","joinSelections","splitIntoLines","alignCursors","multiSelectCommands","getSelectionMarkers","$blockChangeEvents","$onAddRange","$onRemoveRange","mergeOverlappingRanges","lastRange","$initRangeList","toggleBlockSelection","includeEmptyLines","startOffsetX","endOffsetX","docEnd","xBackwards","yBackwards","MultiSelect","altCursor","$multiselectOnSessionChange","$onMultiSelect","$onSingleSelect","onSessionChange","$checkMultiselectChange","altDown","selectionMarkerCount","markerList","$onMultiSelectExec","inVirtualMode","keepOrder","$byLines","cmdResult","anim","buf","additive","skip","toRemove","screenLead","words","stopAtFirst","sameRowRanges","maxCol","minSpace","spaceOffsets","spaceOffset","fr","lr","guessRange","$reAlignText","forceLeft","startW","textW","endW","isLeftAligned","isRightAligned","alignLeft","enableMultiselect","enableBlockSelect","FoldMode","foldingStartMarker","foldingStopMarker","indentationBlock","startLevel","openingBracketBlock","closingBracketBlock","LineWidgets","widgetManager","updateOnChange","renderWidgets","measureWidgets","_changedWidgets","$onChangeEditor","updateOnFold","_inDocument","removeLineWidget","$updateRows","noWidgets","$oldWidget","$registerLineWidget","addLineWidget","coverGutter","pixelHeight","$fold","onWidgetChanged","w1","getWidgetsAtRow","changedWidgets","fixedWidth","coverLine","fullWidth","findAnnotations","comparator","binarySearch","gutterAnno","oldWidget","arrow","Renderer","_id","getElementById","env","oldNode","createEditSession","3330","showReplaceForm","setEditor","searchboxCss","searchRange","$syncOptions","$initElements","sb","replaceBox","searchOption","replaceOption","regExpOption","caseSensitiveOption","wholeWordOption","searchInput","replaceInput","searchCounter","activeInput","$searchBarKb","$closeSearchBarKb","Ctrl-f|Command-f","isReplace","Ctrl-H|Command-Option-F","Ctrl-G|Command-G","Ctrl-Shift-G|Command-Shift-G","findPrev","Return","Shift-Return","Alt-Return","Tab","setSearchRange","searchRangeMarker","noMatch","updateCounter","MAX_COUNT","replaceAndFindNext","active","4091","JsonHighlightRules","MatchingBraceOutdent","BaseFoldMode","commentRegex","singleLineBlockCommentRe","tripleStarBlockCommentRe","startRegionRe","_getFoldWidgetBase","forceMultiline","getCommentRegionBlock","getSectionRange","startIndent","subRange","$outdent","CStyleFoldMode","8903","compileSchema","Cache","SchemaObject","stableStringify","formats","$dataMetaSchema","customKeyword","schemaKeyRef","getSchema","schemaObj","_addSchema","_compile","$async","_meta","_skipValidation","_getId","checkUnique","normalizeId","_schemas","skipValidation","throwOrLogError","$schema","_opts","defaultMeta","META_SCHEMA_ID","errorsText","keyRef","_getSchemaObj","baseId","_fragments","_getSchemaFragment","_removeAllSchemas","_refs","cacheKey","addFormat","_formats","dataVar","shouldAddSchema","addUsedSchema","recursiveMeta","willValidate","localRefs","put","callValidate","currentOpts","_metaOpts","refVal","compileAsync","errorClasses","addKeyword","getKeyword","removeKeyword","validateKeyword","ValidationError","Validation","MissingRefError","MissingRef","META_IGNORE_OPTIONS","META_SUPPORT_DATA","setLogger","_loadingSchemas","_compilations","RULES","_get$IdOrId","_get$Id","chooseGetId","loopRequired","errorDataPath","_errorDataPathProperty","metaOpts","getMetaSchemaOptions","addInitialFormats","addInitialKeywords","addDefaultMetaSchema","metaSchema","$dataSchema","optsSchemas","schemas","5255","9677","loadSchema","loadMetaSchemaOf","_compileAsync","loadMissingSchema","missingSchema","missingRef","schemaPromise","removePromise","sch","5359","fullPath","errorSubclass","Subclass","validation","3368","DATE","DAYS","TIME","HOSTNAME","URI","URITEMPLATE","UUID","JSON_POINTER","JSON_POINTER_URI_FRAGMENT","RELATIVE_JSON_POINTER","year","month","day","full","hour","minute","second","timeZone","fast","date-time","uri-reference","uri-template","email","hostname","ipv4","ipv6","uuid","json-pointer","json-pointer-uri-fragment","relative-json-pointer","dateTime","DATE_TIME_SEPARATOR","NOT_URI_FRAGMENT","Z_ANCHOR","5689","validateGenerator","ucs2length","equal","patternsHash","defaults","defaultsHash","customRules","compIndex","compilation","localCompile","cv","sourceCode","_schema","isTop","errSchemaPath","errorPath","resolveRef","usePattern","useDefault","useCustomRule","vars","refValCode","patternCode","defaultCode","customRuleCode","processCode","makeValidate","refIndex","resolvedRef","_refVal","refCode","rootRefId","addLocalRef","localSchema","inlineRef","inlineRefs","refId","inline","regexStr","toQuotedString","valueStr","parentSchema","3969","traverse","resolveSchema","_getFullPath","getFullPath","parsedRef","resolveUrl","getJsonPointer","baseIds","","fullPaths","allKeys","jsonPtr","rootSchema","parentJsonPtr","parentKeyword","keyIndex","escapeFragment","PREVENT_SCOPE_CHANGE","toHash","unescapeFragment","SIMPLE_INLINED","checkNoRef","countKeys","normalize","TRAILING_SLASH_HASH","742","ruleModules","maximum","minimum","ALL","implKeywords","implements","$comment","4293","6887","3724","checkDataType","dataType","strictNumbers","EQUAL","AND","OK","NOT","checkDataTypes","dataTypes","number","integer","coerceToTypes","optionCoerceTypes","COERCE_TO_TYPES","getProperty","escapeQuotes","varOccurences","varReplace","schemaHasRules","schemaHasRulesExcept","exceptKeyword","schemaUnknownRules","getPathExpr","currentPath","jsonPointers","isNumber","joinPaths","escapeJsonPointer","lvl","jsonPointer","unescapeJsonPointer","IDENTIFIER","SINGLE_QUOTE","9394","KEYWORDS","keywordsJsonPointers","5868","simpleTypes","statements","not","required","modifying","const","1796","$keyword","$ruleType","$exclusive","$exclType","$exclIsNumber","$opStr","$opExpr","out","$lvl","$dataLvl","dataLevel","$schemaPath","$errSchemaPath","$breakOnError","$isData","$schemaValue","dataPathArr","$isMax","$exclusiveKeyword","$schemaExcl","$isDataExcl","$op","$notOp","$errorKeyword","$schemaValueExcl","$$outStack","createErrors","messages","__err","compositeRule","2407","1250","2596","9486","$it","$closingBraces","$nextValid","$currentBaseId","$allSchemasEmpty","$sch","$i","strictKeywords","5347","$valid","$errs","$wasComposite","923","2617","2119","$idx","$dataNxt","$nextData","$nonEmptySchema","$passData","$code","1793","$compile","$inline","$macro","$definition","$rDef","$validateCode","$validateSchema","$ruleValidate","$parentData","$parentDataProperty","def_callRuleValidate","$ruleErrs","$ruleErr","$asyncKeyword","passContext","def_customError","9115","$deps","$schemaDeps","$propertyDeps","$ownProperties","$property","$currentErrorPath","$propertyKey","$propertyPath","$missingProperty","$useData","9317","$vSchema","8327","$format","$unknownFormats","unknownFormats","$allowUnknown","$isObject","$formatType","$formatRef","5926","$ifClause","$thenSch","$elseSch","$thenPresent","$elsePresent","9646","enum","if","maxItems","minItems","maxLength","minLength","maxProperties","minProperties","multipleOf","uniqueItems","392","$currErrSchemaPath","$additionalItems","additionalItems","6039","multipleOfPrecision","7946","$allErrorsOption","9344","$prevValid","$passingSchemas","9737","$regexp","2537","$requiredHash","$key","$dataProperties","$schemaKeys","notProto","$pProperties","$pPropertyKeys","$aProperties","$someProperties","$noAdditional","$additionalIsSchema","$removeAdditional","removeAdditional","$checkAdditional","$required","$pProperty","$additionalProperty","$useDefaults","useDefaults","i3","l3","$hasDefault","arr4","i4","l4","2127","$invalidName","2331","$refCode","$refVal","$message","missingRefs","__callValidate","1204","$propertySch","$loopRequired","1985","$itemType","$typeIsArray","1869","$refKeywords","$unknownKwd","$keywordsMsg","$top","rootId","strictDefaults","$defaultMsg","$closingBraces1","$closingBraces2","$typeSchema","extendRefs","coerceTypes","$coerceToTypes","$rulesGroup","$shouldUseGroup","$dataType","$coerced","arr5","$rule","i5","l5","$shouldUseRule","$ruleImplementsSomeKeyword","7931","definitionSchema","throwError","_validateKeyword","_addRule","ruleGroup","rg","2303","3508","cycles","aobj","bobj","seen","seenIndex","233","insensitive","oFxNcL","oFyNcL","sre","dre","hre","ore","xN","yN","xD","yD","cLoc","numS","5156","strictDeepEqual","key2","keysSeen","isFalse","trimLeft","TYPE_NAME_TABLE","0","TOK_UNQUOTEDIDENTIFIER","TOK_QUOTEDIDENTIFIER","TOK_RBRACKET","TOK_RPAREN","TOK_COMMA","TOK_COLON","TOK_RBRACE","TOK_NUMBER","TOK_CURRENT","TOK_EXPREF","TOK_PIPE","TOK_FLATTEN","TOK_STAR","TOK_FILTER","TOK_LBRACE","TOK_LBRACKET","TOK_LPAREN","TOK_LITERAL","basicTokens",".","*","@","operatorStartToken","=","!","skipChars"," ","\t","\n","isNum","Lexer","tokenize","stream","identifier","_current","_consumeUnquotedIdentifier","_consumeNumber","_consumeLBracket","_consumeQuotedIdentifier","_consumeRawStringLiteral","literal","_consumeLiteral","_consumeOperator","startingChar","literalString","_looksLikeJSON","bindingPower","Parser","TreeInterpreter","runtime","Runtime","functionTable","_func","_functionAbs","_signature","avg","_functionAvg","_functionCeil","_functionContains","ends_with","_functionEndsWith","_functionFloor","_functionLength","_functionMap","_functionMax","_functionMerge","variadic","max_by","_functionMaxBy","sum","_functionSum","starts_with","_functionStartsWith","_functionMin","min_by","_functionMinBy","_functionType","_functionKeys","_functionValues","_functionSort","sort_by","_functionSortBy","_functionJoin","_functionReverse","to_array","_functionToArray","to_string","_functionToString","to_number","_functionToNumber","not_null","_functionNotNull","_loadTokens","_lookahead","_lookaheadToken","rbp","leftToken","_advance","nud","led","Not","_parseProjectionRHS","Star","_parseMultiselectHash","Flatten","_parseIndexExpression","_projectIfSlice","_parseMultiselectList","Expref","_match","_errorToken","tokenName","Dot","_parseDotRHS","Pipe","Or","And","Filter","_parseComparator","tokenType","_parseSliceExpression","indexExpr","lookahead","keyName","pairs","identifierTypes","keyToken","visit","sliceParams","computed","computeSliceParams","collected","objValues","finalResults","merged","resolvedArgs","callFunction","jmespathType","arrayLength","stepValueNegative","capSliceRange","functionEntry","_validateArgs","signature","pluralized","typeMatched","currentSpec","actualType","_getTypeName","_typeMatches","typeIdentifier","actual","argValue","subtype","searchStr","reversedArray","originalStr","reversedStr","inputArray","mapped","exprefNode","maxElement","minElement","listToSum","joinChar","typeName","convertedValue","requiredType","exprA","exprB","maxRecord","resolvedArray","keyFunction","createKeyFunction","maxNumber","minRecord","minNumber","allowedTypes","500","_traverse","post","arrayKeywords","propsKeywords","escapeJsonPtr","skipKeywords","exclusiveMaximum","exclusiveMinimum","7026","escapedChars","/","\\","A_CODE","VALID_TYPES","bigint","_parse","ptr","topLevel","whitespace","getChar","read","backChar","itemPtr","wasUnexpectedToken","parseArray","getLoc","propPtr","mapLoc","parseObject","numStr","getDigits","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","parseNumber","unexpectedToken","loop","getCharCode","checkUnexpectedEnd","digits","SyntaxError","validType","wsLine","wsPos","wsColumn","es6","_stringify","_data","quoted","BYTES_PER_ELEMENT","stringifyMapSet","itemLvl","propLvl","isSet","ESC_QUOTE","ESC_B","ESC_F","ESC_N","ESC_R","ESC_T","ESC_0","ESC_1","483","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","__WEBPACK_AMD_DEFINE_ARRAY__","isNode","unprevented","isHidden","Elem","buildOverlay","make","stylize","background","onClick","anyAncestor","autoinc","buildModal","-ms-transform","-moz-transform","-webkit-transform","-o-transform","borderRadius","isCloseClick","buildClose","textAlign","buildElemAccessor","escapeKey","tabKey","manageFocus","iface","isEnabled","selector","msMatchesSelector","webkitMatchesSelector","canFocus","firstFocusable","lastFocusable","focused","beforeShow","getActiveFocus","afterShow","focusModal","focusable","returnFocus","tabKeyPress","manageBodyOverflow","origOverflow","onKeyPress","keycode","afterCreateEvent","beforeShowEvent","afterShowEvent","beforeCloseEvent","afterCloseEvent","shadowElem","closeElem","forceClose","returnIface","built","overlayElem","beforeClose","escapeKeyPress","7533","_len","sets","xl","subexp","typeOf","buildExps","isIRI","ALPHA$$","CR$","DIGIT$$","DQUOTE$$","HEXDIG$$","LF$$","SP$$","PCT_ENCODED$","GEN_DELIMS$$","SUB_DELIMS$$","RESERVED$$","UCSCHAR$$","IPRIVATE$$","UNRESERVED$$","SCHEME$","USERINFO$","DEC_OCTET$","DEC_OCTET_RELAXED$","IPV4ADDRESS$","H16$","LS32$","IPV6ADDRESS1$","IPV6ADDRESS2$","IPV6ADDRESS3$","IPV6ADDRESS4$","IPV6ADDRESS5$","IPV6ADDRESS6$","IPV6ADDRESS7$","IPV6ADDRESS8$","IPV6ADDRESS9$","IPV6ADDRESS$","ZONEID$","IPV6ADDRZ$","IPV6ADDRZ_RELAXED$","IPVFUTURE$","IP_LITERAL$","REG_NAME$","HOST$","PORT$","AUTHORITY$","PCHAR$","SEGMENT$","SEGMENT_NZ$","SEGMENT_NZ_NC$","PATH_ABEMPTY$","PATH_ABSOLUTE$","PATH_NOSCHEME$","PATH_ROOTLESS$","PATH_EMPTY$","PATH$","QUERY$","FRAGMENT$","HIER_PART$","URI$","RELATIVE_PART$","RELATIVE$","URI_REFERENCE$","ABSOLUTE_URI$","GENERIC_REF$","RELATIVE_REF$","ABSOLUTE_REF$","SAMEDOC_REF$","AUTHORITY_REF$","NOT_SCHEME","NOT_USERINFO","NOT_HOST","NOT_PATH","NOT_PATH_NOSCHEME","NOT_QUERY","NOT_FRAGMENT","ESCAPE","UNRESERVED","OTHER_CHARS","PCT_ENCODED","IPV4ADDRESS","IPV6ADDRESS","URI_PROTOCOL","IRI_PROTOCOL","slicedToArray","sliceIterator","toConsumableArray","maxInt","tMin","tMax","skew","damp","initialBias","initialN","delimiter","regexPunycode","regexNonASCII","regexSeparators","not-basic","invalid-input","baseMinusTMin","stringFromCharCode","error$1","RangeError","mapDomain","labels","encoded","ucs2decode","extra","ucs2encode","basicToDigit","codePoint","digitToBasic","adapt","numPoints","firstTime","decode","inputLength","bias","basic","oldi","baseMinusT","fromCodePoint","encode","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_currentValue2","return","basicLength","handledCPCount","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","handledCPCountPlusOne","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","_currentValue","qMinusT","toUnicode","toASCII","punycode","ucs2","SCHEMES","pctEncChar","pctDecChars","newStr","il","c2","c3","_normalizeComponentEncoding","components","protocol","decodeUnreserved","decStr","scheme","userinfo","_stripLeadingZeros","_normalizeIPv4","_matches","address","_normalizeIPv6","_matches2","zone","_address$toLowerCase$","_address$toLowerCase$2","firstFields","lastFields","isLastFieldIPv4Address","fieldCount","lastFieldsStart","allZeroFields","lastLongest","longestZeroFields","newHost","newFirst","newLast","URI_PARSE","NO_MATCH_IS_UNDEFINED","uriString","iri","port","schemeHandler","unicodeSupport","domainHost","_recomposeAuthority","uriTokens","RDS1","RDS2","RDS3","RDS5","removeDotSegments","im","authority","absolutePath","resolveComponents","relative","skipNormalization","tolerant","baseURI","relativeURI","schemelessOptions","uriA","uriB","escapeComponent","unescapeComponent","secure","handler$1","isSecure","wsComponents","handler$2","resourceName","_wsComponents$resourc","_wsComponents$resourc2","handler$3","ATEXT$$","QTEXT$$","VCHAR$$","SOME_DELIMS$$","NOT_LOCAL_PART","NOT_HFNAME","NOT_HFVALUE","handler$4","parse$$1","mailtoComponents","unknownHeaders","headers","hfields","hfield","toAddrs","_x","_xl","_x2","_xl2","addr","serialize$$1","toAddr","atIdx","localPart","domain","URN_PARSE","handler$5","urnComponents","nid","nss","urnScheme","uriComponents","handler$6","uuidComponents","4049","classCallCheck","createClass","defineProperties","colorNames","padStart","pad","tqw","qmrn","zr","bg","bsq","bck","nch","bvt","brwn","brw","ctb","hrt","chcT","cr","rnw","crns","crms","cn","Db","Dcn","Dgnr","Dgr","Dgrn","Dkhk","Dmgn","Dvgr","Drng","Drch","Dr","Dsmn","Dsgr","DsTb","DsTg","Dtrq","Dvt","ppnk","pskb","mgr","grb","rbrc","rwht","stg","chs","gnsb","gnr","gr","grn","grnw","hnw","htpn","ng","vr","khk","vnr","nrb","wngr","mnch","Lb","Lcr","Lcn","Lgnr","Lgr","Lgrn","Lpnk","Lsmn","Lsgr","Lskb","LsTg","Lstb","Lw","mgrn","mgnt","mrn","mqm","mmb","mmrc","mmpr","mmsT","mtr","mmvt","mnLb","ntc","mstr","mccs","vjw","nv","vrb","rng","rngr","rch","pgnr","pgrn","ptrq","pvtr","ppwh","pchp","pr","pnk","pm","pwrb","prp","cc","sbr","rb","sbrw","smn","nbr","sgrn","ssh","snn","svr","skb","sTb","sTgr","snw","stb","tn","thst","tmT","trqs","vt","whT","wht","hts","wgrn","printNum","decs","Color","_input$match$map","_input$match$map2","hsla","_input$match$map3","_input$match$map4","_r","_a2","hexToRgb","nameToRgb","printRGB","alpha","rgb","vals","printHSL","mults","suff","hsl","printHex","_rgba","_hsla","hslToRgb","rgbToHsl","_ref2","_ref3","_ref4","hue2rgb","EventBucket","_doRemove","parseHTML","htmlString","dragTrack","eventBucket","area","dragging","clamp","onMove","starting","bounds","relX","relY","onMouse","onTouch","BG_TRANSP","HUES","EVENT_KEY","EVENT_CLICK_OUTSIDE","EVENT_TAB_MOVE","onKey","bucket","layout","editorFormat","cancelButton","defaultColor","onOpen","transfer","skipKeys","_popupInited","colour","_setColor","openProxy","openHandler","pointerEvents","toFocus","_domEdit","domElement","closeHandler","doHide","knownTime","__containedEvent","movePopup","setColor","silent","failSilently","_setHSLA","setColour","toggled","_toggleDOM","_setPosition","_domH","_domSL","_domA","_domSample","_domOkay","_domCancel","_ifPopup","_updateUI","_bindEvents","addEvent","editInput","fromEditor","popupCloseProxy","timeKeeper","onDoneProxy","elm","cssHue","cssHSL","hslString","cssHSLA","hslaString","uiH","uiSL","uiA","thumbH","thumbSL","thumbA","posY","opaque","transp","actionIf","actionElse","toVisible","displayStyle","StyleElement","402","JsonRepairError","3860","7490","UNKNOWN","processNextToken","rootLevelTokenType","skipComma","tokenIsStartOfValue","stashedOutput","_stringUtils","insertBeforeLastWhitespace","_JsonRepairError","__esModule","DELIMITER","SYMBOL","WHITESPACE","COMMENT","DELIMITERS",";","+","ESCAPE_CHARACTERS","CONTROL_CHARACTERS","\b","\f","\r","SYMBOLS","PYTHON_SYMBOLS","None","True","False","nextSkipEscape","getTokenString","normalizeWhitespace","getNext","isQuote","normalizeQuote","isEndQuote","isSingleQuote","isDoubleQuote","isHex","isAlpha","isWhitespace","isSpecialWhitespace","getTokenUnknown","stripLastOccurrence","symbolIndex","insertAtIndex","9422","ALPHA_REGEX","HEX_REGEX","DIGIT_REGEX","normalized","SINGLE_QUOTES","DOUBLE_QUOTES","textToStrip","textToInsert","","","`","","","","894","7171","6273","6680","__webpack_module_cache__","moduleId","cachedModule"],"sourceRoot":""}